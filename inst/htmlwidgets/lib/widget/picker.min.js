/*! For license information please see picker.min.js.LICENSE.txt */
(()=>{var t={5318:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},8:t=>{function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0},8082:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(600),i=n(6497);const o={transitionDuration:0},s={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:r.r.BREAK},a=t=>1-(1-t)*(1-t),u=["wheel"],c=["panstart","panmove","panend"],l=["pinchstart","pinchmove","pinchend"],h=["tripanstart","tripanmove","tripanend"],A=["doubletap"],f=["keydown"];class p{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new r.Z(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...s,transitionInterpolator:new i.Z({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:p=!0}=t,d=Boolean(this.onViewStateChange);this.toggleEvents(u,d&&n),this.toggleEvents(c,d&&(r||i)),this.toggleEvents(l,d&&(s||a)),this.toggleEvents(h,d&&a),this.toggleEvents(A,d&&o),this.toggleEvents(f,d&&p),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e={},n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,o,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,o,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,o,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,o,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:a},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,o,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,o,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),u=Math.pow(2,o+s*e/2);i=i.zoom({pos:r,scale:u}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:a},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const u={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),u.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),u.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),u.isRotating=!0):(a=s.moveLeft(r),u.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),u.isRotating=!0):(a=s.moveRight(r),u.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),u.isRotating=!0):(a=s.moveUp(r),u.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),u.isRotating=!0):(a=s.moveDown(r),u.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),u),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new i.Z({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:o}}},6883:(t,e,n)=>{"use strict";n.d(e,{U:()=>u,Z:()=>c});var r=n(4034),i=n(8082),o=n(6442),s=n(7013),a=n(5304);class u extends o.Z{constructor({makeViewport:t,width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s=0,pitch:u=0,altitude:c=1.5,maxZoom:l=20,minZoom:h=0,maxPitch:A=60,minPitch:f=0,startPanLngLat:p,startZoomLngLat:d,startRotatePos:g,startBearing:y,startPitch:m,startZoom:_,normalize:v}={}){(0,a.Z)(Number.isFinite(i)),(0,a.Z)(Number.isFinite(r)),(0,a.Z)(Number.isFinite(o)),super({width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s,pitch:u,altitude:c,maxZoom:l,minZoom:h,maxPitch:A,minPitch:f,normalize:v}),this._state={startPanLngLat:p,startZoomLngLat:d,startRotatePos:g,startBearing:y,startPitch:m,startZoom:_},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,r),startBearing:i,startPitch:o}):{bearing:i+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=(0,r.uZ)(i,n,e);const{maxPitch:o,minPitch:a,pitch:u}=t;t.pitch=(0,r.uZ)(u,a,o);const{normalize:c=!0}=t;return c&&Object.assign(t,(0,s.QA)(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this._viewportProps,o=e+Math.log2(t);return(0,r.uZ)(o,i,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:i}){e=(0,r.uZ)(e,-1,1);const{minPitch:o,maxPitch:s}=this._viewportProps;let a=i;return e>0?a=i+e*(s-i):e<0&&(a=i-e*(o-i)),{pitch:a,bearing:n+180*t}}_getRotationParams(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],{width:s,height:a}=this._viewportProps,u=n/s;let c=0;return r>0?Math.abs(a-o)>5&&(c=r/(o-a)*1.2):r<0&&o>5&&(c=1-i/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:u,deltaScaleY:c}}}class c extends i.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(u,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}},7557:(t,e,n)=>{"use strict";n.d(e,{G:()=>u,Z:()=>c});var r=n(4034),i=n(8082),o=n(6442),s=n(5126);const a=[0,0,0];class u extends o.Z{constructor({makeViewport:t,width:e,height:n,rotationX:r=0,rotationOrbit:i=0,target:o=a,zoom:s=0,minRotationX:u=-90,maxRotationX:c=90,minZoom:l=-(1/0),maxZoom:h=Infinity,startPanPosition:A,startRotatePos:f,startRotationX:p,startRotationOrbit:d,startZoomPosition:g,startZoom:y}){super({width:e,height:n,rotationX:r,rotationOrbit:i,target:o,zoom:s,minRotationX:u,maxRotationX:c,minZoom:l,maxZoom:h}),this._state={startPanPosition:A,startRotatePos:f,startRotationX:p,startRotationOrbit:d,startZoomPosition:g,startZoom:y},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this._state.startPanPosition||e;if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let u;if(t){let e=(t[0]-r[0])/s;const n=(t[1]-r[1])/a;(i<-90||i>90)&&(e*=-1),u={rotationX:i+180*n,rotationOrbit:o+180*e}}else u={rotationX:i+n,rotationOrbit:o+e};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){const{zoom:r}=this._viewportProps;let{startZoom:i,startZoomPosition:o}=this._state;Number.isFinite(i)||(i=r,o=this._unproject(e)||this._unproject(t));const s=this._calculateNewZoom({scale:n,startZoom:i}),a=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:i}=this._viewportProps;Number.isFinite(e)||(e=this._viewportProps.zoom);const o=e+Math.log2(t);return(0,r.uZ)(o,i,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new u({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i,maxRotationX:o,minRotationX:a,rotationOrbit:u}=t;return t.zoom=(0,r.uZ)(i,n,e),t.rotationX=(0,r.uZ)(t.rotationX,a,o),(u<-180||u>180)&&(t.rotationOrbit=(0,s.wQ)(u+180,360)-180),t}}class c extends i.Z{constructor(t){super(u,t)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}},2577:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(8082),i=n(7557);class o extends r.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(i.G,t)}_onPanRotate(t){return!1}get linearTransitionProps(){return["target","zoom"]}}},600:(t,e,n)=>{"use strict";n.d(e,{r:()=>o,Z:()=>a});var r=n(3630);const i=()=>{},o={BREAK:1,SNAP_TO_END:2,IGNORE:3},s={transitionEasing:t=>t,transitionInterruption:o.BREAK,onTransitionStart:i,onTransitionInterrupt:i,onTransitionEnd:i};class a{constructor(t,e={}){this.ControllerState=t,this.props={...s,...e},this.propsInTransition=null,this.transition=new r.Z(e.timeline),this.onViewStateChange=e.onViewStateChange||i,this.onStateChange=e.onStateChange||i,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...s,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:r,endProps:i}=this.transition.settings,s={...n,...r===o.SNAP_TO_END?i:this.propsInTransition||n};this._triggerTransition(s,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===o.IGNORE||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:i}=e,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=t,a=s(e/o),u=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}},6442:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}},3803:(t,e,n)=>{"use strict";n.d(e,{z:()=>o,Z:()=>s});var r=n(744);let i={};function o(t){i=t}function s(t){r.Z.level>0&&i[t]&&i[t].call(...arguments)}},5361:(t,e,n)=>{"use strict";n.d(e,{M:()=>s});const r=[255,255,255],i=1;let o=0;class s{constructor(t={}){const{color:e=r}=t,{intensity:n=i}=t;this.id=t.id||"ambient-".concat(o++),this.color=e,this.intensity=n,this.type="ambient"}}},9152:(t,e,n)=>{"use strict";n.d(e,{O:()=>u});var r=n(3855);const i=[255,255,255],o=1,s=[0,0,-1];let a=0;class u{constructor(t={}){const{color:e=i}=t,{intensity:n=o}=t,{direction:u=s}=t,{_shadow:c=!1}=t;this.id=t.id||"directional-".concat(a++),this.color=e,this.intensity=n,this.type="directional",this.direction=new r.Z(u).normalize().toArray(),this.shadow=c}getProjectedLight(){return this}}},9601:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var r=n(1731),i=n(4912),o=n(5361),s=n(9152),a=n(1215),u=n(5451),c=n(3855),l=n(3182),h=n(9830),A=n(3849),f=n(9450);class p extends l.Z{constructor(t,e){super(t,e),this.shadowMap=new i.Z(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new h.Z(t,{format:33189,width:1,height:1}),this.fbo=new A.Z(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;(0,f.s8)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],r=(0,f.w)(this.gl),i=n.width*r,o=n.height*r;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var d=n(3115);const g={color:[255,255,255],intensity:1},y=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],m=[0,0,0,200/255];class _ extends a.Z{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=m,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,{layers:e,layerFilter:n,viewports:o,onViewportActive:s,views:a}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=r.Z.getDefaultProgramManager(t),d.Z&&this.programManager.addDefaultModule(d.Z)),this.dummyShadowMap||(this.dummyShadowMap=new i.Z(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:o,onViewportActive:s,views:a,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(d.Z),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new u.Z).lookAt({eye:new c.Z(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new p(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new o.M(g),this.directionalLights.push(new s.O(y[0]),new s.O(y[1])))}}},2860:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AmbientLight:()=>o.M,AttributeManager:()=>F.Z,COORDINATE_SYSTEM:()=>r.Df,CompositeLayer:()=>B.Z,Controller:()=>st.Z,Deck:()=>N.Z,DeckRenderer:()=>j.Z,DirectionalLight:()=>s.O,Effect:()=>x.Z,FirstPersonController:()=>ft,FirstPersonView:()=>dt,FlyToInterpolator:()=>Lt,Layer:()=>k.Z,LayerExtension:()=>Tt.Z,LayerManager:()=>D.Z,LightingEffect:()=>i.Z,LinearInterpolator:()=>It.Z,MapController:()=>wt.Z,MapView:()=>rt.Z,OrbitController:()=>gt.Z,OrbitView:()=>vt,OrthographicController:()=>Pt.Z,OrthographicView:()=>bt.Z,PointLight:()=>f,PostProcessEffect:()=>O,TRANSITION_EVENTS:()=>Ct.r,Tesselator:()=>Ft.Z,TransitionInterpolator:()=>Mt.Z,View:()=>nt.Z,Viewport:()=>U.Z,WebMercatorViewport:()=>z.Z,_CameraLight:()=>d,_GlobeController:()=>xt,_GlobeView:()=>St,_GlobeViewport:()=>Y,_LayersPass:()=>L.Z,_SunLight:()=>E,_compareProps:()=>zt.tg,_count:()=>Bt.Q,_fillArray:()=>kt.k,_flatten:()=>kt.x,_memoize:()=>jt.Z,_mergeShaders:()=>Ut.l,createIterable:()=>Dt.jB,fp64LowPart:()=>ut.Ks,gouraudLighting:()=>tt.N,log:()=>Nt.Z,phongLighting:()=>tt.s,picking:()=>K.Z,project:()=>J.Z,project32:()=>$.Z,shadow:()=>et.Z});var r=n(4088),i=n(9601),o=n(5361),s=n(9152),a=n(8547);const u=[255,255,255],c=1,l=[0,0,1],h=[0,0,1];let A=0;class f{constructor(t={}){const{color:e=u}=t,{intensity:n=c}=t,{position:r=h}=t;this.id=t.id||"point-".concat(A++),this.color=e,this.intensity=n,this.type="point",this.position=r,this.attenuation=function(t){return"attenuation"in t?t.attenuation:"intensity"in t?[0,0,t.intensity]:l}(t),this.projectedLight={...this}}getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:i,coordinateOrigin:o}=t.props,s=(0,a.D)(this.position,{viewport:n,coordinateSystem:i,coordinateOrigin:o,fromCoordinateSystem:n.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}var p=n(8771);class d extends f{getProjectedLight({layer:t}){const{projectedLight:e}=this,n=t.context.viewport,{coordinateSystem:r,coordinateOrigin:i,modelMatrix:o}=t.props,{project_uCameraPosition:s}=(0,p.C)({viewport:n,modelMatrix:o,coordinateSystem:r,coordinateOrigin:i});return e.color=this.color,e.intensity=this.intensity,e.position=s,e}}const g=Math.PI/180,y=23.4397*g;function m(t,e,n){const{azimuth:r,altitude:i}=function(t,e,n){const r=g*-n,i=g*e,o=function(t){return function(t){return t/864e5-.5+2440588}(t)-2451545}(t),s=function(t){const e=function(t){const e=t;return e+g*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e))+102.9372*g+Math.PI}(g*(357.5291+.98560028*t));return{declination:v(e,0),rightAscension:_(e,0)}}(o),a=function(t,e){return g*(280.147+360.9856235*t)-e}(o,r)-s.rightAscension;return{azimuth:b(a,i,s.declination),altitude:w(a,i,s.declination)}}(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function _(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(y)-Math.tan(e)*Math.sin(y),Math.cos(n))}function v(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(y)+Math.cos(e)*Math.sin(y)*Math.sin(n))}function b(t,e,n){const r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function w(t,e,n){const r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}class E extends s.O{constructor({timestamp:t,...e}){super(e),this.timestamp=t}getProjectedLight({layer:t}){const{viewport:e}=t.context;if(e.resolution>0){const[t,e,n]=m(this.timestamp,0,0);this.direction=[t,-n,e]}else{const{latitude:t,longitude:n}=e;this.direction=m(this.timestamp,t,n)}return this}}var x=n(1215),S=n(6234),P=n(9450),T=n(6047),C=n(830);class M extends C.Z{constructor(t,e={}){super(t,e);const{module:n,fs:r,id:i}=e;this.model=new S.Z(t,{id:i,fs:r,modules:[n]})}render(t){const e=this.gl;(0,P.dR)(e,{viewport:[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}),(0,P.s8)(e,{framebuffer:t.outputBuffer,clearColor:[0,0,0,0]},(()=>this._renderPass(e,t)))}delete(){this.model.delete(),this.model=null}_renderPass(t,{inputBuffer:e,outputBuffer:n}){(0,T.Z)(t,{color:!0}),this.model.draw({moduleSettings:this.props.moduleSettings,uniforms:{texture:e,texSize:[e.width,e.height]},parameters:{depthWrite:!1,depthTest:!1}})}}var I=n(6119);class O extends x.Z{constructor(t,e={}){super(e),this.id="".concat(t.name,"-pass"),(0,I.v)(t),this.module=t}postRender(t,e){this.passes||(this.passes=function(t,e,n,r){if(e.filter||e.sampler){const i=R(e);return[new M(t,{id:n,module:e,fs:i,moduleSettings:r})]}return(e.passes||[]).map(((i,o)=>{const s=R(e,i),a="".concat(n,"-").concat(o);return new M(t,{id:a,module:e,fs:s,moduleSettings:r})}))}(t,this.module,this.id,this.props));const{target:n}=e;let r=e.inputBuffer,i=e.swapBuffer;for(let t=0;t<this.passes.length;t++){n&&t===this.passes.length-1&&(i=n),this.passes[t].render({inputBuffer:r,outputBuffer:i});const e=i;i=r,r=e}return r}cleanup(){if(this.passes){for(const t of this.passes)t.delete();this.passes=null}}}function R(t,e=t){return e.filter?(n="string"==typeof e.filter?e.filter:"".concat(t.name,"_filterColor"),"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = texture2D(texture, texCoord);\n  gl_FragColor = ".concat(n,"(gl_FragColor, texSize, texCoord);\n}\n")):e.sampler?(t=>"uniform sampler2D texture;\nuniform vec2 texSize;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main() {\n  vec2 texCoord = coordinate;\n\n  gl_FragColor = ".concat(t,"(texture, texSize, texCoord);\n}\n"))("string"==typeof e.sampler?e.sampler:"".concat(t.name,"_sampleColor")):null;var n}var L=n(3182),N=n(1431),D=n(2289),F=n(3518),k=n(4185),B=n(8918),j=n(9877),U=n(9225),z=n(6935),G=n(5451),V=n(7160),Z=n(8333);const H=Math.PI/180,q=180/Math.PI,W=6370972,X=256;class Y extends U.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,nearZMultiplier:i=.1,farZMultiplier:o=2,resolution:s=10}=t;let{width:a,height:u,altitude:c=1.5}=t;a=a||1,u=u||1,c=Math.max(.75,c);const l=(new G.Z).lookAt({eye:[0,-c,0],up:[0,0,1]}),h=Math.pow(2,r);l.rotateX(e*H),l.rotateZ(-n*H),l.scale(h/u);const A=Math.atan(.5/c),f=512*h/u;super({...t,width:a,height:u,viewMatrix:l,longitude:n,latitude:e,zoom:r,fovyRadians:2*A,aspect:a/u,focalDistance:c,near:i,far:Math.min(2,1/f+1)*c*o}),this.resolution=s,this.distanceScales=function(){const t=4018225162502676e-20,e=Math.PI/180*X;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[24886.609375,24886.609375,24886.609375],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,24886.609375]}}()}get projectionMode(){return r.zG.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),r=this.unproject([this.width/2,0],e),i=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return i[0]<this.longitude&&(i[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,{pixelUnprojectionMatrix:a}=this;let u;if(Number.isFinite(o))u=Q(a,[r,s,o,1]);else{const t=Q(a,[r,s,-1,1]),e=Q(a,[r,s,1,1]),i=((n||0)/W+1)*X,o=V.x9(V.lu([],t,e)),c=V.x9(t),l=V.x9(e),h=(4*c*l-(o-c-l)**2)/16*4/o,A=(Math.sqrt(c-h)-Math.sqrt(Math.max(0,i*i-h)))/Math.sqrt(o);u=V.t7([],t,e,A)}const[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n,r=0]=t,i=e*H,o=n*H,s=Math.cos(o),a=(r/W+1)*X;return[Math.sin(i)*s*a,-Math.cos(i)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,r]=t,i=V.Zh(t),o=Math.asin(r/i);return[Math.atan2(e,-n)*q,o*q,(i/X-1)*W]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function Q(t,e){const n=Z.fF([],e,t);return Z.bA(n,n,1/n[3]),n}var K=n(3117),J=n(2967),$=n(3844),tt=n(7287),et=n(3115),nt=n(4897),rt=n(4009),it=n(7013),ot=n(7858),st=n(8082),at=n(6442),ut=n(5126),ct=n(3855),lt=n(4034);const ht=[0,0,0];class At extends at.Z{constructor({width:t,height:e,position:n=ht,bearing:r=0,pitch:i=0,longitude:o,latitude:s,maxPitch:a=90,minPitch:u=-90,startRotatePos:c,startBearing:l,startPitch:h,startZoomPosition:A,startZoom:f}){super({width:t,height:e,position:n,bearing:r,pitch:i,longitude:o,latitude:s,maxPitch:a,minPitch:u}),this._state={startRotatePos:c,startBearing:l,startPitch:h,startZoomPosition:A,startZoom:f}}getDirection(t=!1){return new ot.Z({bearing:this._viewportProps.bearing,pitch:t?90:90+this._viewportProps.pitch}).toVector3().normalize()}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let u;return u=t?{bearing:i-(t[0]-r[0])/s*180,pitch:o-(t[1]-r[1])/a*90}:{bearing:i-e,pitch:o-n},this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this._viewportProps.position,startZoom:this._viewportProps.zoom})}zoom({scale:t}){let{startZoomPosition:e}=this._state;e||(e=this._viewportProps.position);const n=this.getDirection();return this._move(n,20*Math.log2(t),e)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}moveLeft(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:Math.PI/2}),t)}moveRight(t=20){const e=this.getDirection(!0);return this._move(e.rotateZ({radians:-Math.PI/2}),t)}moveUp(t=20){const e=this.getDirection(!0);return this._move(e,t)}moveDown(t=20){const e=this.getDirection(!0);return this._move(e.negate(),t)}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}zoomIn(t=2){return this.zoom({scale:t})}zoomOut(t=2){return this.zoom({scale:1/t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_move(t,e,n=this._viewportProps.position){const r=t.scale(e);return this._getUpdatedState({position:new ct.Z(n).add(r)})}_getUpdatedState(t){return new At({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{pitch:e,maxPitch:n,minPitch:r,longitude:i,bearing:o}=t;return t.pitch=(0,lt.uZ)(e,r,n),(i<-180||i>180)&&(t.longitude=(0,ut.wQ)(i+180,360)-180),(o<-180||o>180)&&(t.bearing=(0,ut.wQ)(o+180,360)-180),t}}class ft extends st.Z{constructor(t){super(At,t)}get linearTransitionProps(){return["position","pitch","bearing"]}}class pt extends U.Z{constructor(t){const{modelMatrix:e=null,bearing:n=0,pitch:r=0,up:i=[0,0,1]}=t,o=function({bearing:t,pitch:e}){return new ot.Z({bearing:t,pitch:e}).toVector3().normalize()}({bearing:n,pitch:-90===r?1e-4:90+r}),s=e?e.transformDirection(o):o,a=(0,it.Bf)(t),u=Math.pow(2,a),c=(new G.Z).lookAt({eye:[0,0,0],center:s,up:i}).scale(u);super({...t,zoom:a,viewMatrix:c})}}class dt extends nt.Z{constructor(t){super({...t,type:pt})}get controller(){return this._getControllerProps({type:ft})}}dt.displayName="FirstPersonView";var gt=n(7557);const yt=Math.PI/180;function mt({height:t,fovy:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:o}){const s=.5/Math.tan(e*yt/2),a="Z"===n?[0,0,1]:[0,1,0],u="Z"===n?[0,-s,0]:[0,0,s],c=(new G.Z).lookAt({eye:u,up:a});c.rotateX(r*yt),"Z"===n?c.rotateZ(i*yt):c.rotateY(i*yt);const l=Math.pow(2,o)/(t||1);return c.scale(l),c}class _t extends U.Z{constructor(t){const{height:e,fovy:n,orbitAxis:r,target:i=[0,0,0],rotationX:o=0,rotationOrbit:s=0,zoom:a=0}=t;super({...t,longitude:null,viewMatrix:mt({height:e,fovy:n,orbitAxis:r,rotationX:o,rotationOrbit:s,zoom:a}),fovy:n,position:i,zoom:a}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,o=e?r:this.height-r,[s,a,u]=(0,it.CT)([n,o,i],this.pixelUnprojectionMatrix);return[s,a,u]}panByPosition(t,e){const n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class vt extends nt.Z{constructor(t={}){const{orbitAxis:e="Z"}=t;super({...t,orbitAxis:e,type:_t})}get controller(){return this._getControllerProps({type:gt.Z})}}vt.displayName="OrbitView";var bt=n(743),wt=n(6883);class Et extends wt.U{_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,lt.uZ)(r,n,e);const{longitude:i,latitude:o}=t;return(i<-180||i>180)&&(t.longitude=(0,ut.wQ)(i+180,360)-180),t.latitude=(0,lt.uZ)(o,-89,89),t}}class xt extends st.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(Et,t)}setProps(t){super.setProps(t),this.dragRotate=!1,this.touchRotate=!1}get linearTransitionProps(){return["longitude","latitude","zoom"]}}class St extends nt.Z{constructor(t){super({...t,type:Y})}get controller(){return this._getControllerProps({type:xt})}}St.displayName="GlobeView";var Pt=n(2577),Tt=n(3693),Ct=n(600),Mt=n(6507),It=n(6497);const Ot=["bearing","pitch"],Rt={speed:1.2,curve:1.414};class Lt extends Mt.Z{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),this.props={...Rt,...t}}interpolateProps(t,e,n){const r=(0,it.if)(t,e,n,this.props);for(const i of Ot)r[i]=(0,lt.t7)(t[i]||0,e[i]||0,n);return r}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=(0,it.up)(t,e,this.props)),n}}var Nt=n(744),Dt=n(8550),Ft=n(8005),kt=n(1855),Bt=n(5015),jt=n(8177),Ut=n(7870),zt=n(1761)},3518:(t,e,n)=>{"use strict";n.d(e,{Z:()=>C});var r=n(4211),i=n(6948),o=n(3478);class s{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var a=n(6610),u=n(5126),c=n(744);function l(t){return t.stride||t.size*t.bytesPerElement}function h(t,e){e.offset&&c.Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=l(t),r=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:r,stride:n}}var A=n(5304),f=n(8550),p=n(1855);const d=[],g=[[0,1/0]];var y=n(9006);class m extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,o=5130===n;let{defaultValue:s}=e;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),e.defaultValue=s;let a=n;o?a=5126:!a&&e.isIndexed?a=t&&(0,r.U6)(t,i.h.ELEMENT_INDEX_UINT32)?5125:5123:a||(a=5126),e.logicalType=n,e.type=a;let u=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||a||5126);this.shaderAttributes={},this.doublePrecision=o,o&&!1===e.fp64&&(u=Float32Array),e.bytesPerElement=u.BYTES_PER_ELEMENT,this.defaultType=u,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new o.Z(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*l(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),a.Z.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(t,e){const n=h(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new s(this,i.high),n["".concat(t,"64Low")]=r?new s(this,i.low):new Float32Array(this.size),n}if(e){const n=h(this.getAccessor(),e);return{[t]:new s(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof o.Z&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,t.constant){let n=t.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n)),e.constant&&this._areValuesEqual(n,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const r=t.buffer;e.externalBuffer=r,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;n.type=t.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=l(n)}else if(t.value){this._checkExternalBuffer(t);let r=t.value;e.externalBuffer=null,e.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=l(n);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=(0,u.TK)(r,n));const s=r.byteLength+o+2*n.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:r,offset:o}),n.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?(0,u.TK)(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:n}=this,r=n.allocatedValue,i=a.Z.allocate(r,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&r&&o.subData({data:r instanceof Float64Array?(0,u.TK)(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||c.Z.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=r[0],e;switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let o=i;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:r[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}{constructor(t,e={}){super(t,e);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:g,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition,r=Array.isArray(e)?t[e.find((e=>t[e]))]:t[e];return(0,y.M0)(r,n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===g)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const r=t[o];r[1]<e[0]?(n.push(r),i=o+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=g}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=d}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==g}),!0)}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant});else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t}),r.transform||e!==this.startIndices){(0,A.Z)(ArrayBuffer.isView(t.value),"invalid ".concat(r.accessor));const i=t.size&&t.size!==this.size;return n.binaryAccessor=(0,f.jr)(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:u,size:c,startIndices:l}=t,{accessor:h,transform:d}=s,g=a.binaryAccessor||("function"==typeof h?h:i[h]);(0,A.Z)("function"==typeof g,'accessor "'.concat(h,'" is not a function'));let y=t.getVertexOffset(n);const{iterable:m,objectInfo:_}=(0,f.jB)(e,n,r);for(const e of m){_.index++;let n=g(e,_);if(d&&(n=d.call(this,n)),l){const e=(_.index<l.length-1?l[_.index+1]:o)-l[_.index];if(n&&Array.isArray(n[0])){let e=y;for(const r of n)t._normalizeValue(r,u,e),e+=c}else n&&n.length>c?u.set(n,y):(t._normalizeValue(n,_.target,0),(0,p.k)({target:u,source:_.target,start:y,count:e}));y+=e*c}else t._normalizeValue(n,u,y),y+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var _=n(3803),v=n(3346),b=n(3630);var w=n(1953),E=n(4912),x=n(3849);const S={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="interpolation",this.transition=new b.Z(n),this.attribute=e,this.attributeInTransition=new m(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=(0,y.w)(e.size);return new v.Z(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new o.Z(t,r),new o.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:n,buffers:r,attribute:i}=this;(0,y.DY)(r);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,y.IV)({buffer:t,...o});this.currentStartIndices=i.startIndices,this.currentLength=(0,y.pi)(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:(0,y.AQ)(n,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,r=n(t/e);this.transform.run({uniforms:{time:r}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="spring",this.transition=new b.Z(n),this.attribute=e,this.attributeInTransition=new m(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new E.Z(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new x.Z(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const r=(0,y.w)(e.size);return new v.Z(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new o.Z(t,r),new o.Z(t,r),new o.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of r)(0,y.IV)({buffer:t,...o});this.currentStartIndices=i.startIndices,this.currentLength=(0,y.pi)(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:(0,y.AQ)(n,i)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;return!!r.update()&&(e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),(0,y.DY)(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value}),(0,w.z6)(n)[0]>0||r.end(),!0)}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class P{constructor(t,{id:e,timeline:n}){this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=v.Z.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const r=t[n],i=r.getTransitionSetting(e);i&&this._updateAttribute(n,r,i)}for(const n in this.transitions){const r=t[n];r&&r.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void c.Z.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const o=S[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(c.Z.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const T="attributeManager.invalidate";class C{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new P(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,_.Z)(T,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,_.Z)(T,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}={}){let a=!1;(0,_.Z)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const r in this.attributes){const u=this.attributes[r],l=u.settings.accessor;u.startIndices=n,i[r]&&c.Z.removed("props.".concat(r),"data.attributes.".concat(r))(),u.setExternalBuffer(o[r])||u.setBinaryValue(o[l],t.startIndices)||!o[l]&&u.setConstantValue(i[l])||u.needsUpdate()&&(a=!0,this._updateAttribute({attribute:u,numInstances:e,data:t,props:i,context:s})),this.needsRedraw|=u.needsRedraw()}a&&(0,_.Z)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e,n={}){e&&c.Z.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const e in t){const r=t[e];this.attributes[e]=this._createAttribute(e,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new m(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach((t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)})),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;(0,_.Z)("attribute.updateStart",e),e.allocate(n)&&(0,_.Z)("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,(0,_.Z)("attribute.updateEnd",e,n))}}},9006:(t,e,n)=>{"use strict";function r({source:t,target:e,start:n=0,end:r,size:i,getData:o}){r=r||e.length;const s=t.length,a=r-n;if(s>a)return void e.set(t.subarray(0,a),n);if(e.set(t,n),!o)return;let u=s;for(;u<a;){const r=o(u,t);for(let t=0;t<i;t++)e[n+u]=r[t]||0,u++}}n.d(e,{DY:()=>u,pi:()=>c,w:()=>a,AQ:()=>s,M0:()=>o,IV:()=>l});const i={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function o(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...i[t.type],...e,...t}):null}function s(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function a(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function u(t){t.push(t.shift())}function c(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*s}function l({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:o,getData:s=(t=>t)}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,u=n.size*a,l=n.byteOffset,h=n.startIndices,A=o&&h,f=c(n,e),p=n.state.constant;if(!A&&i>=f)return;const d=p?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!p){const t=s;s=(e,r)=>n._normalizeConstant(t(e,r))}const g=p?(t,e)=>s(d,e):(t,e)=>s(d.subarray(t,t+u),e),y=t.getData({length:i}),m=new Float32Array(f);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:o,targetStartIndices:s}){if(!Array.isArray(s))return r({source:t,target:e,size:n,getData:i}),e;let a=0,u=0;const c=i&&((t,e)=>i(t+u,e)),l=Math.min(o.length,s.length);for(let i=1;i<l;i++){const l=o[i]*n,h=s[i]*n;r({source:t.subarray(a,l),target:e,start:u,end:h,size:n,getData:c}),a=l,u=h}u<e.length&&r({source:[],target:e,start:u,size:n,getData:c})}({source:y,target:m,sourceStartIndices:o,targetStartIndices:h,size:u,getData:g}),t.byteLength<m.byteLength+l&&t.reallocate(m.byteLength+l),t.subData({data:m,offset:l})}},8918:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4185),i=n(3803),o=n(1855);class s extends r.Z{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:A,modelMatrix:f,extensions:p,fetch:d,_subLayerProps:g}=this.props,y={opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:h,positionFormat:A,modelMatrix:f,extensions:p,fetch:d},m=g&&g[t.id],_=m&&m.updateTriggers,v=t.id||"sublayer";if(m){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in m){const r=n[t]||e[t];r&&"accessor"===r.type&&(m[t]=this.getSubLayerAccessor(m[t]))}}Object.assign(y,t,m),y.id="".concat(this.props.id,"-").concat(v),y.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,..._};for(const t of p){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(y,e,{updateTriggers:Object.assign(y.updateTriggers,e.updateTriggers)})}return y}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=(0,o.x)(t,Boolean),this.internalState.subLayers=t),(0,i.Z)("compositeLayer.renderLayers",this,e,t);for(const e of t)e.parent=this}}s.layerName="CompositeLayer"},4088:(t,e,n)=>{"use strict";n.d(e,{Df:()=>i,zG:()=>o,FP:()=>s});var r=n(744);const i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:()=>r.Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}}},9877:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(3803),i=n(3182);class o extends i.Z{}var s=n(930),a=n(3849);class u{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new o(t),this.pickLayersPass=new s.Z(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=this.layerFilter,t.effects=t.effects||[],t.target=t.target||a.Z.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,i=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,(0,r.Z)("deckRenderer.renderLayers",this,i,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const r of t)r.preRender(this.gl,e),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new a.Z(this.gl),new a.Z(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}},1431:(t,e,n)=>{"use strict";n.d(e,{Z:()=>Tt});var r=n(2289),i=n(6871),o=n(744),s=n(1855);class a{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return"string"==typeof t?this.views.find((e=>e.id===t)):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,s.x)(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!(0,i.v)(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):o.Z.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,n,r){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(t,i),r):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=n.length;o--;){const s=n[o],a=this.getViewState(s),u=s.makeViewport({width:t,height:e,viewState:a});let c=r[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,u,c),this._viewports.unshift(u)}for(const t in r)r[t]&&!this.controllers[t]&&r[t].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,r)=>!t[r].equals(e[r])))}}var u=n(4009),c=n(9601);const l=new c.Z;class h{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&(0,i.v)(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some((t=>t instanceof c.Z))||this._internalEffects.push(l)}}var A=n(1215),f=n(9877),p=n(3849),d=n(4912),g=n(9450),y=n(1953),m=n(930);const _={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function v({pickedColors:t,layers:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){if(t){const{x:a,y:u,width:c,height:l}=s;let h=i*i,A=-1,f=0;for(let e=0;e<l;e++){const i=e+u-r,o=i*i;if(o>h)f+=4*c;else for(let e=0;e<c;e++){if(t[f+3]-1>=0){const t=e+a-n,r=t*t+o;r<=h&&(h=r,A=f)}f+=4}}if(A>=0){const n=t[A+3]-1,r=t.slice(A,A+4),i=e[n];if(i){const t=i.decodePickingColor(r),e=Math.floor(A/4/c);return{pickedColor:r,pickedLayer:i,pickedObjectIndex:t,pickedX:a+(A/4-e*c),pickedY:u+e}}o.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return _}function b({pickInfo:t,mode:e,viewports:n,layerFilter:r,pixelRatio:i,x:o,y:s,z:a}){const u=t&&t.pickedLayer,c=function(t,e,n){for(let r=t.length-1;r>=0;r--){const i=t[r];if(i.containsPixel(e)&&(!n||n(i)))return i}return t[0]}(n,{x:o,y:s},r&&u&&(t=>r({layer:u,viewport:t,isPicking:!0,renderPass:"picking:".concat(e)}))),l=c&&c.unproject([o-c.x,s-c.y],{targetZ:a});return{color:null,layer:null,viewport:c,index:-1,picked:!1,x:o,y:s,pixel:[o,s],coordinate:l,devicePixel:t&&[t.pickedX,t.pickedY],pixelRatio:i}}function w(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,u=s?[s]:[];if("hover"===r){const t=n.index,e=n.layerId,r=s&&s.props.id;if(r!==e||a!==t){if(r!==e){const t=i.find((t=>t.props.id===e));t&&u.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const c=b(t),l=new Map;return l.set(null,c),u.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=E({layer:t,info:e,mode:r}),t===s&&"hover"===r&&(n.info=e),l.set(e.layer.id,e),"hover"===r&&e.layer.updateAutoHighlight(e)})),l}function E({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}class x{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new m.Z(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find((t=>t.id===o)):null,u=s&&r.find((t=>t.id===s))||r[0],c=u&&u.unproject([t-u.x,e-u.y]),l={x:t,y:e,viewport:u,coordinate:c,layer:a};return a?{...i,...l}:Object.assign(l,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new p.Z(t),p.Z.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new p.Z(t),this.depthFBO.attach({36064:new d.Z(t,{format:(0,g.D0)(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length>255?(o.Z.warn("Too many pickable layers, only picking the first 255")(),e.slice(0,255)):e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:u,onViewportActive:c}){if(!(t=this._getPickable(t)))return{result:[],emptyInfo:b({viewports:n,x:r,y:i})};this._resizeBuffer();const l=(0,g.w)(this.gl),h=(0,g.JY)(this.gl,[r,i],!0),A=[h.x+Math.floor(h.width/2),h.y+Math.floor(h.height/2)],f=Math.round(o*l),{width:p,height:d}=this.pickingFBO,y=this._getPickingRect({deviceX:A[0],deviceY:A[1],deviceRadius:f,deviceWidth:p,deviceHeight:d});let m;const _=[],E={};for(let o=0;o<s;o++){const h=v({pickedColors:y&&this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:y,pass:"picking:".concat(a),redrawReason:a}),layers:t,deviceX:A[0],deviceY:A[1],deviceRadius:f,deviceRect:y});let p;if(h.pickedLayer&&u&&this.depthFBO&&(p=this._drawAndSample({layers:[h.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:h.pickedX,y:h.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0})[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]),h.pickedColor&&o+1<s){const e=h.pickedColor[3]-1;E[e]=!0,t[e].disablePickingIndex(h.pickedObjectIndex)}m=w({pickInfo:h,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,layerFilter:this.layerFilter,viewports:n,x:r,y:i,z:p,pixelRatio:l});for(const t of m.values())t.layer&&_.push(t);if(!h.pickedColor)break}for(const e in E)t[e].restorePickingColors();return{result:_,emptyInfo:m&&m.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:s=1,height:a=1,mode:u="query",maxObjects:c=null,onViewportActive:l}){if(!(t=this._getPickable(t)))return[];this._resizeBuffer();const h=(0,g.w)(this.gl),A=(0,g.JY)(this.gl,[r,i],!0),f=A.x,p=A.y+A.height,d=(0,g.JY)(this.gl,[r+s,i+a],!0),y=d.x+d.width,m=d.y,_={x:f,y:m,width:y-f,height:p-m},v=function({pickedColors:t,layers:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4){const i=t[r+3]-1;if(i>=0){const s=t.slice(r,r+4),a=s.join(",");if(!n.has(a)){const t=e[i];t?n.set(a,{pickedColor:s,pickedLayer:t,pickedObjectIndex:t.decodePickingColor(s)}):o.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}({pickedColors:this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:l,deviceRect:_,pass:"picking:".concat(u),redrawReason:u}),layers:t}),b=new Map,w=Number.isFinite(c);for(let t=0;t<v.length&&!(w&&b.size>=c);t++){const e=v[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:r,y:i,width:s,height:a,pixelRatio:h};n=E({layer:e.pickedLayer,info:n,mode:u}),b.has(n.object)||b.set(n.object,n)}return Array.from(b.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){if(t.length<1)return null;const u=a?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:i,pass:o,redrawReason:s,pickZ:a});const{x:c,y:l,width:h,height:A}=i,f=new(a?Float32Array:Uint8Array)(h*A*4);return(0,y.z6)(u,{sourceX:c,sourceY:l,sourceWidth:h,sourceHeight:A,target:f}),f}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(r,t+n+1)-o,u=Math.min(i,e+n+1)-s;return a<=0||u<=0?null:{x:o,y:s,width:a,height:u}}}const S={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class P{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,S),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const r=this.el;if("string"==typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");"text"in t&&(r.innerText=t.text),"html"in t&&(r.innerHTML=t.html),"className"in t&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}var T=n(6610),C=n(6228),M=n(2378),I=n(9718),O=n(3803);const R={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},L="8.5.7",N=I.CO.deck&&I.CO.deck.VERSION;if(N&&N!==L)throw new Error("deck.gl - multiple versions detected: ".concat(N," vs ").concat(L));N||(o.Z.log(1,"deck.gl ".concat(L))(),I.CO.deck=Object.assign(I.CO.deck||{},{VERSION:L,version:L,log:o.Z,_registerLoggers:O.z}),(0,C.fh)([R,[M.S,{imagebitmap:{premultiplyAlpha:"none"}}]]));const D=I.CO.deck;var F=n(9902),k=n(8055),B=n(9835),j=n(8295),U=n(840),z=n.n(U);const G={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(z().PointerEventInput),z().MouseInput.prototype.handler=function(t){let e=G[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const V=z().Manager,Z=z(),H=Z?[[Z.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Z.Rotate,{enable:!1}],[Z.Pinch,{enable:!1}],[Z.Swipe,{enable:!1}],[Z.Pan,{threshold:0,enable:!1}],[Z.Press,{enable:!1}],[Z.Tap,{event:"doubletap",taps:2,enable:!1}],[Z.Tap,{event:"anytap",enable:!1}],[Z.Tap,{enable:!1}]]:null,q={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},W={doubletap:["tap"]},X={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Y={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Q={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},K={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},J="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",$="undefined"!=typeof window?window:n.g;void 0!==n.g?n.g:window,"undefined"!=typeof document&&document;let tt=!1;try{const t={get passive(){return tt=!0,!0}};$.addEventListener("test",t,t),$.removeEventListener("test",t,t)}catch(t){}const et=-1!==J.indexOf("firefox"),{WHEEL_EVENTS:nt}=Y,rt="wheel",it=4.000244140625;class ot{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=nt.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!tt&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===rt&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;$.WheelEvent&&(et&&t.deltaMode===$.WheelEvent.DOM_DELTA_PIXEL&&(e/=$.devicePixelRatio),t.deltaMode===$.WheelEvent.DOM_DELTA_LINE&&(e*=40));const n={x:t.clientX,y:t.clientY};0!==e&&e%it==0&&(e=Math.floor(e/it)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:rt,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:st}=Y,at="pointermove",ut="pointerover",ct="pointerout",lt="pointerleave";class ht{constructor(t,e,n={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=st.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===at&&(this.enableMoveEvent=e),t===ut&&(this.enableOverEvent=e),t===ct&&(this.enableOutEvent=e),t===lt&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:ut,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:ct,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:lt,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:at,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:At}=Y,ft="keydown",pt="keyup";class dt{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=At.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===ft&&(this.enableDownEvent=e),t===pt&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:ft,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:pt,srcEvent:t,key:t.key,target:t.target}))}}const gt="contextmenu";class yt{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===gt&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:gt,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const mt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},_t={srcElement:"root",priority:0};class vt{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!=typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},_t,n):_t;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const u={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=u.priority);)c--;a.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);const t=r.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&r.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:u,once:c}=n[s];if(u(Object.assign({},t,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=mt[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===i,s=2===i,a=3===i):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===r,s=1===r,a=2===r),{leftButton:o,middleButton:s,rightButton:a}}(t),function(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/s}}}(t,e),{handled:!1,rootElement:e})}}const bt={events:null,recognizers:null,recognizerOptions:{},Manager:V,touchAction:"none",tabIndex:0};class wt{constructor(t=null,e={}){this.options=Object.assign({},bt,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||H}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(q).forEach((t=>{const e=this.manager.get(t);e&&q[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const r=e.recognizerOptions[t];delete r.enable,n.set(r)}}this.wheelInput=new ot(t,this._onOtherEvent,{enable:!1}),this.moveInput=new ht(t,this._onOtherEvent,{enable:!1}),this.keyInput=new dt(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new yt(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=W[t];i&&!this.options.recognizers&&i.forEach((i=>{const o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:o,events:s}=this,a=K[t]||t;let u=s.get(a);u||(u=new vt(this),s.set(a,u),u.recognizerName=Q[a]||a,o&&o.on(a,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=K[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=X[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}var Et=n(5304),xt=n(4088);function St(){}const Pt={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:St,onResize:St,onViewStateChange:St,onInteractionStateChange:St,onBeforeRender:St,onAfterRender:St,onLoad:St,onError:(t,e)=>o.Z.error(t)(),_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",debug:!1,drawPickingColors:!1};class Tt{constructor(t){t={...Pt,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&o.Z.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,I.qs)()&&o.Z.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new j.Z({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&T.Z.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&o.Z.removed("onLayerHover","onHover")(),"onLayerClick"in t&&o.Z.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,i.v)(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),(0,Et.Z)(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:u,useDevicePixels:c,autoResizeDrawingBuffer:l}=t;return new F.Z({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:l,autoResizeViewport:!1,gl:r,onCreateContext:t=>(0,g.s9)({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:u,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new u.Z({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let r=n,i=!1;for(const n of e)r=n,i=n.layer.onHover(n,t.event);if(!i&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,(0,g.yW)(t,{enable:!0,copyState:!0})),this.tooltip=new P(this.canvas),(0,g.dR)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new k.T;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new wt(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in xt.FP)this.eventManager.on(t,this._onEvent);this.viewManager=new a({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new r.Z(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new h,this.deckRenderer=new f.Z(t),this.deckPicker=new x(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;(0,g.dR)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),o.Z.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=xt.FP[t.type],n=t.offsetCenter;if(!e||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let u=!1;s&&(u=s.call(o,i,t)),!u&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:e.x,y:e.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=B.l.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}Tt.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(A.Z)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},Tt.defaultProps=Pt,Tt.VERSION=D.VERSION},1215:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}},3693:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(6871);class i{constructor(t={}){this.opts=t}equals(t){return this===t||this.constructor===t.constructor&&(0,r.v)(this.opts,t.opts)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e={}}=t.constructor,n={updateTriggers:{}};for(const t in e)if(t in this.props){const r=e[t],i=this.props[t];n[t]=i,r&&"accessor"===r.type&&(n.updateTriggers[t]=this.props.updateTriggers[t],"function"==typeof i&&(n[t]=this.getSubLayerAccessor(i,!0)))}return n}initializeState(t,e){}updateState(t,e){}draw(t,e){}finalizeState(t){}}},2289:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});var r=n(8055),i=n(5409),o=n(744),s=n(3803),a=n(1855),u=n(8295),c=n(3079);class l{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"==typeof t&&(r=(0,c.z)(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=null,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class h{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new l(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(i[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(n,r,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[e]=s,s.onChange=r,s.resource=n,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var A=n(9225),f=n(1731);const p=[{name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},n(2967).Z],d=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function g(t){const e=f.Z.getDefaultProgramManager(t);for(const t of p)e.addDefaultModule(t);for(const t of d)e.addShaderHook(t);return e}const y=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class m{constructor(t,{deck:e,stats:n,viewport:i,timeline:o}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new h({gl:t,protocol:"deck://"}),this.context={...y,layerManager:this,gl:t,deck:e,programManager:t&&g(t),stats:n||new u.Z({id:"deck.gl"}),viewport:i||new A.Z({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new r.T,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,s.Z)("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=(0,a.x)(t,Boolean);for(const e of t)e.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return(0,s.Z)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?o.Z.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const t of r)if(t.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const r of t){r.context=this.context;const t=e[r.id];null===t&&o.Z.warn("Multiple new layers with same id ".concat(r.id))(),e[r.id]=null;let i=null;try{this._debug&&t!==r&&r.validateProps(),t?(this._transferLayerState(t,r),this._updateLayer(r)):this._initializeLayer(r),n.push(r),i=r.isComposite&&r.getSubLayers()}catch(t){this._handleError("matching",t,r)}i&&this._updateSublayersRecursively(i,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=i.d.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=i.d.MATCHED,e!==t&&(t.lifecycle=i.d.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=i.d.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=i.d.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}},4185:(t,e,n)=>{"use strict";n.d(e,{Z:()=>ct});var r=n(4088),i=n(3518),o=n(9006),s=n(4034),a=n(3630);class u extends a.Z{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,o=i(t/r);this._value=(0,s.t7)(e,n,o)}}const c=1e-5;function l(t,e,n,r,i){const o=e-t;return(n-e)*i+-o*r+o+e}function h(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class A extends a.Z{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=function(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=l(t[s],e[s],n[s],r,i);return o}return l(t,e,n,r,i)}(i,o,e,n,r);const a=h(s,e),u=h(s,o);a<c&&u<c&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}var f=n(744);const p={interpolation:u,spring:A};class d{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(!(r=(0,o.M0)(r)))return;const s=p[r.type];if(!s)return void f.Z.error("unsupported transition type '".concat(r.type,"'"))();const a=new s(this.timeline);a.start({...r,fromValue:e,toValue:n}),i.set(t,a)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var g=n(1761),y=n(5015),m=n(3803),_=n(9450),v=n(5304),b=n(8177),w=n(7870),E=n(8547),x=n(6610),S=n(5409),P=n(8550),T=n(4912);const C={10241:9987,10240:9729,10242:33071,10243:33071},M={},I={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||N(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>O(t,e)},accessor:{validate(t,e){const n=D(t);return"function"===n||n===D(e.value)},equal:(t,e,n)=>"function"==typeof e||O(t,e)},array:{validate:(t,e)=>e.optional&&!t||N(t),equal:(t,e,n)=>n.compare?O(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:r}=n?n.props:{};return r&&t?r(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof T.Z)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const i=new T.Z(n,{...e,parameters:{...C,...r,...t.props.textureParameters}});return M[i.id]=!0,i}(n,t),release:t=>{var e;(e=t)&&e instanceof T.Z&&M[e.id]&&(e.delete(),delete M[e.id])}}};function O(t,e){if(t===e)return!0;if(!N(t)||!N(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function R(t,e){switch(D(e)){case"object":return L(t,e);case"array":return L(t,{type:"array",value:e,compare:!1});case"boolean":return L(t,{type:"boolean",value:e});case"number":return L(t,{type:"number",value:e});case"function":return L(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function L(t,e){return"type"in e?{name:t,...I[e.type],...e}:"value"in e?{name:t,type:D(e.value),...e}:{name:t,type:"object",value:e}}function N(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function D(t){return N(t)?"array":null===t?"null":typeof t}const{COMPONENT:F,ASYNC_ORIGINAL:k,ASYNC_RESOLVED:B,ASYNC_DEFAULTS:j}=S.A;function U(){const t=this,e=z(t.constructor),n=Object.create(e);n[F]=t,n[k]={},n[B]={};for(let t=0;t<arguments.length;++t){const e=arguments[t];for(const t in e)n[t]=e[t]}return Object.freeze(n),n}function z(t){return Z(t,"_mergedDefaultProps")||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=z(e),r=function(t){const e={},n={},r={};for(const[i,o]of Object.entries(t))if(o&&o.deprecatedFor)r[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const t=R(i,o);e[i]=t,n[i]=t.value}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(Z(t,"defaultProps")||{}),i=function(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=function(t){const e=Z(t,"layerName")||Z(t,"componentName");return e||f.Z.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,t),o={...e._propTypes,...r.propTypes};!function(t,e){const n={},r={};for(const t in e){const i=e[t],{name:o,value:s}=i;i.async&&(n[o]=s,r[o]=G(o))}t[j]=n,t[k]={},Object.defineProperties(t,r)}(i,o);const s={...e._deprecatedProps,...r.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const r of e[n])V(this,r)||(this[r]=t);f.Z.deprecated(r,e[n].join("/"))()}})})(i,s),t._mergedDefaultProps=i,t._propTypes=o,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function G(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||(0,P.D0)(e)?this[k][t]=e:this[B][t]=e},get(){if(this[B]){if(t in this[B])return this[B][t]||this[j][t];if(t in this[k]){const e=this[F]&&this[F].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[j][t]}}return this[j][t]}}}function V(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t,e){return V(t,e)&&t[e]}const{ASYNC_ORIGINAL:H,ASYNC_RESOLVED:q,ASYNC_DEFAULTS:W}=S.A,X=Object.freeze({});class Y{constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=X,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[q]||{},n=t[H]||t,r=t[W]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,r[t]),this._updateAsyncProp(t,e)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"==typeof e){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=e;r&&(e=r(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):(0,P.D0)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){const n=this.asyncProps[t];e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];n.pendingLoadCount++;const r=n.pendingLoadCount;e.then((e=>{var i;e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&o&&o(e,{propName:t,layer:this.layer})})).catch((e=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}))}async _resolveAsyncIterable(t,e){var n;"data"!==t&&this._setPropValue(t,e);const r=this.asyncProps[t];r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],s=0;for await(const n of e){const{dataTransform:e}=this.component?this.component.props:{};o=e?e(n,o):o.concat(n),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(o,{propName:t,layer:this.layer})}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Q,ASYNC_RESOLVED:K,ASYNC_DEFAULTS:J}=S.A;let $=0;class tt{constructor(){this.props=U.apply(this,arguments),this.id=this.props.id,this.count=$++,this.lifecycle=S.d.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:e}=this,n={};for(const t in e[J])t in e[K]?n[t]=e[K][t]:t in e[Q]&&(n[t]=e[Q][t]);return new this.constructor({...e,...n,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new Y({})}}tt.componentName="Component",tt.defaultProps={};class et extends Y{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}var nt=n(7013),rt=n(3079);const it=2**24-1,ot=Object.freeze([]),st=(0,b.Z)((({oldViewport:t,viewport:e})=>t.equals(e)));let at=new Uint8ClampedArray(0);const ut={data:{type:"data",value:ot,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;i=i||n.getLoadOptions(),r=r||n.props.loaders,o&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let u=s.contains(t);return u||i||(s.add({resourceId:t,data:(0,rt.z)(t,r),persistent:!1}),u=!0),u?s.subscribe({resourceId:t,onChange:t=>n.internalState.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):(0,rt.z)(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:r.Df.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ct extends tt{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,r,i,o;e&&(t.message="".concat(e,": ").concat(t.message)),(null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,t))||null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this)}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=(0,E.T)(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=(0,nt.aW)(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return(0,E.D)(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.Df.DEFAULT||t===r.Df.LNGLAT||t===r.Df.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,v.Z)(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=(0,w.l)(t,e.getShaders.call(this,e));return t}shouldUpdateState({oldProps:t,props:e,context:n,changeFlags:r}){return r.propsOrDataChanged}updateState({oldProps:t,props:e,context:n,changeFlags:r}){const i=this.getAttributeManager();if(r.dataChanged&&i){const{dataChanged:t}=r;if(Array.isArray(t))for(const e of t)i.invalidateAll(e);else i.invalidateAll()}const o=t.highlightedObjectIndex>=0||t.pickable,s=e.highlightedObjectIndex>=0||e.pickable;if(o!==s&&i){const{pickingColors:t,instancePickingColors:e}=i.attributes,n=t||e;n&&(s&&n.constant&&(n.constant=!1,i.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const t of this.getModels())t.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e}){const{index:n}=t;return n>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[n]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&st({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const n=this.getAttributeManager();n&&("all"===t?n.invalidateAll():n.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),r=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(at.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>it&&f.Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),at=x.Z.allocate(at,e,{size:3,copy:!0,maxCount:Math.max(e,it)});const t=Math.floor(at.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),at[3*e+0]=r[0],at[3*e+1]=r[1],at[3*e+2]=r[2]}t.value=at.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n,i=r.getVertexOffset(t),o=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==at.buffer&&(n.value=at.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:(0,y.Q)(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){(0,m.Z)("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();(0,m.Z)("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),r=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(t){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const i=this.getModels()[0]!==r[0];this._updateModules(n,i),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){(0,m.Z)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];(0,_.dR)(this.context.gl,{polygonOffset:o}),(0,_.s8)(this.context.gl,n,(()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:this.context};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let r=!1;switch(n){case"dataChanged":Array.isArray(e[n])&&(e[n]=Array.isArray(t[n])?e[n].concat(t[n]):t[n],r=!0);default:e[n]||(e[n]=t[n],r=!0)}r&&(0,m.Z)("layer.changeFlag",this,n,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=(0,g.Yt)(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,e[r],t[r],t.transitions[r]);return this.setChangeFlags(n)}validateProps(){(0,g.eQ)(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:o}=t;if(n||e.autoHighlight!==r||e.highlightedObjectIndex!==i||e.highlightColor!==o){const t={};r||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(t);return e=e||r,e}_getAttributeManager(){return new i.Z(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){(0,v.Z)(!this.internalState&&!this.state),(0,v.Z)(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new et({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(f.Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new d(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){(0,m.Z)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}ct.layerName="Layer",ct.defaultProps=ut},5409:(t,e,n)=>{"use strict";n.d(e,{d:()=>r,A:()=>i});const r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},i={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")}},1761:(t,e,n)=>{"use strict";n.d(e,{eQ:()=>o,Yt:()=>s,tg:()=>u});var r=n(5409);const{COMPONENT:i}=r.A;function o(t){const e=A(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function s(t,e){const n=u({newProps:t,oldProps:e,propTypes:A(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}(t,e);let i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers&&h(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)"all"!==i&&h(t,e,i)&&(n[i]=!0,r=n);return r}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:l(t,e),transitionsChanged:a(t,e)}}function a(t,e){if(!t.transitions)return null;const n={},r=A(t);for(const i in t.transitions){const o=r[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&c(t[i],e[i],o)&&(n[i]=!0)}return n}function u({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(e===t)return null;if("object"!=typeof t||null===t)return"".concat(i," changed shallowly");if("object"!=typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const n=c(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=c(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return null}function c(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function l(t,e){if(null===e)return"oldProps is null, initial diff";const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(r.length!==n.length)return!0;for(let t=0;t<r.length;t++)if(!r[t].equals(n[t]))return!0;return!1}function h(t,e,n){let r=t.updateTriggers[n];r=null==r?{}:r;let i=e.updateTriggers[n];return i=null==i?{}:i,u({oldProps:i,newProps:r,triggerName:n})}function A(t){const e=t[i],n=e&&e.constructor;return n?n._propTypes:{}}},3182:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(830),i=n(9450),o=n(6047);class s extends r.Z{render(t){const e=this.gl;return(0,i.dR)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:n,onViewportActive:r,clearCanvas:o=!0}=t;t.pass=t.pass||"unknown";const s=this.gl;o&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;(0,i.dR)(t,{viewport:[0,0,e,n]}),t.clear(16640)}(s);const a=[];for(const i of e){const e=i.viewport||i,o=n&&n[e.id];r(e);const u=this._getDrawLayerParams(e,t);t.view=o;const c=e.subViewports||[e];for(const e of c){t.viewport=e;const n=this._drawLayersInViewport(s,t,u);a.push(n)}}return a}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:r,effects:i,moduleParameters:o}){const s=[],u=a(),c={viewport:t,isPicking:n.startsWith("picking"),renderPass:n};for(let t=0;t<e.length;t++){const a=e[t],l=this._shouldDrawLayer(a,c,r),h={shouldDrawLayer:l,layerRenderIndex:u(a,l)};l&&(h.moduleParameters=this._getModuleParameters(a,i,n,o),h.layerParameters=this.getLayerParameters(a,t)),s[t]=h}return s}_drawLayersInViewport(t,{layers:e,pass:n,viewport:r,view:s},a){const u=function(t,{viewport:e}){const n=t.canvas?t.canvas.clientHeight||t.canvas.height:100,r=e,o=(0,i.w)(t);return[r.x*o,(n-r.y-r.height)*o,r.width*o,r.height*o]}(t,{viewport:r});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;(0,i.s8)(t,{scissorTest:!0,scissor:u},(()=>(0,o.Z)(t,e)))}const c={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,i.dR)(t,{viewport:u});for(let t=0;t<e.length;t++){const i=e[t],{shouldDrawLayer:o,layerRenderIndex:s,moduleParameters:u,layerParameters:l}=a[t];if(o&&i.props.pickable&&c.pickableCount++,i.isComposite)c.compositeCount++;else if(o){c.visibleCount++,u.viewport=r;try{i.drawLayer({moduleParameters:u,uniforms:{layerIndex:s},parameters:l})}catch(t){i.raiseError(t,"drawing ".concat(i," to ").concat(n))}}}return c}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,n){if(!this.shouldDrawLayer(t)||!t.props.visible)return!1;if(e.layer=t,n&&!n(e))return!1;let r=t.parent;for(;r;){if(!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){const o=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:(0,i.w)(this.gl)});if(e)for(const n of e)Object.assign(o,n.getModuleParameters(t));return Object.assign(o,this.getModuleParameters(t,e),r)}}function a(t=0,e={}){const n={},r=(i,o)=>{const s=i.props._offset,u=i.id,c=i.parent&&i.parent.id;let l;if(c&&!(c in e)&&r(i.parent,!1),c in n){const t=n[c]=n[c]||a(e[c],e);l=t(i,o),n[u]=t}else Number.isFinite(s)?(l=s+(e[c]||0),n[u]=null):l=t;return o&&l>=t&&(t=l+1),e[u]=l,l};return r}},830:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});class r{constructor(t,e={}){const{id:n="pass"}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}},930:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(3182),i=n(9450);const o={blendFunc:[1,0,32771,0],blendEquation:32774};class s extends r.Z{render(t){t.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(t)):(this.useAlpha=!1,super.render(t))}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:s,pickingFBO:a,deviceRect:{x:u,y:c,width:l,height:h},pass:A="picking",redrawReason:f,pickZ:p}){const d=this.gl;return this.pickZ=p,(0,i.s8)(d,{scissorTest:!0,scissor:[u,c,l,h],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...o,blend:!p},(()=>{super.render({target:a,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:s,pass:A,redrawReason:f})}))}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e){const n=this.pickZ?{blend:!1}:{...o,blend:!0,blendColor:[0,0,0,this.useAlpha?(e+1)/255:1]};return{...t.props.parameters,...n}}}},3117:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...n(3330).q}},8547:(t,e,n)=>{"use strict";n.d(e,{T:()=>l,D:()=>h});var r=n(4088),i=n(8771),o=n(6935),s=n(8333),a=n(7160),u=n(7013);function c(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof o.Z){const[n,i,o=0]=t,s=e.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function l(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:a}){let[l,h,A=0]=t;switch(n&&([l,h,A]=s.fF([],[l,h,A,1],n)),i){case r.Df.LNGLAT:return c([l,h,A],e,a);case r.Df.LNGLAT_OFFSETS:return c([l+o[0],h+o[1],A+(o[2]||0)],e,a);case r.Df.METER_OFFSETS:return c((0,u.eG)(o,[l,h,A]),e,a);case r.Df.CARTESIAN:default:return e.isGeospatial?[l+o[0],h+o[1],A+o[2]]:e.projectPosition([l,h,A])}}function h(t,e){const{viewport:n,coordinateSystem:o,coordinateOrigin:s,modelMatrix:u,fromCoordinateSystem:c,fromCoordinateOrigin:h}=function(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:i,coordinateOrigin:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return n===r.Df.DEFAULT&&(n=i.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=n),void 0===a&&(e.fromCoordinateOrigin=o),e.coordinateSystem=n,e}(e),{geospatialOrigin:A,shaderCoordinateOrigin:f,offsetMode:p}=(0,i.v)(n,o,s),d=l(t,{viewport:n,modelMatrix:u,coordinateSystem:c,coordinateOrigin:h,offsetMode:p});if(p){const t=n.projectPosition(A||f);a.lu(d,d,t)}return d}},2967:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(5502),i=n(4088);const o=Object.keys(i.Df).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(i.Df[t],";"))).join(""),s=Object.keys(i.zG).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(i.zG[t],";"))).join(""),a="".concat(o,"\n").concat(s,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    dy = clamp(dy, -1., 1.);\n  }\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  );\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy) * WORLD_SCALE,\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n");var u=n(8771);const c={},l={name:"project",dependencies:[r.O],vs:a,getUniforms:function(t=c){return t.viewport?(0,u.C)(t):{}}}},8771:(t,e,n)=>{"use strict";n.d(e,{v:()=>f,C:()=>p});var r=n(5975),i=n(8333),o=n(4088),s=n(8177);const a=[0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[0,0,0],h=[0,0,0],A=(0,s.Z)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:c,viewProjectionMatrix:h,cameraPosCommon:A,shaderCoordinateOrigin:p,geospatialOrigin:d}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:c,viewProjectionMatrix:l}=t,h=a,A=t.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:d,offsetMode:g}=f(t,e,n);if(g){const e=t.projectPosition(p||d);A=[A[0]-e[0],A[1]-e[1],A[2]-e[2]],e[3]=1,h=i.fF([],e,l),c=o||c,l=r.Jp([],s,c),l=r.Jp([],l,u)}return{viewMatrix:c,viewProjectionMatrix:l,projectionCenter:h,cameraPosCommon:A,shaderCoordinateOrigin:d,geospatialOrigin:p}}(t,n,s),g=t.getDistanceScales(),y=[t.width*e,t.height*e],m=t.projectionMatrix.transform([0,0,-t.focalDistance,1])[3]||1,_={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:p,project_uCenter:c,project_uViewportSize:y,project_uDevicePixelRatio:e,project_uFocalDistance:m,project_uCommonUnitsPerMeter:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:l,project_uScale:t.scale,project_uViewProjectionMatrix:h,project_uCameraPosition:A};if(d){const e=t.getDistanceScales(d);switch(n){case o.Df.METER_OFFSETS:_.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,_.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.Df.LNGLAT:case o.Df.LNGLAT_OFFSETS:_.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,_.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.Df.CARTESIAN:_.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],_.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return _}));function f(t,e,n=h){let r,i=n,s=!0;switch(r=e===o.Df.LNGLAT_OFFSETS||e===o.Df.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.zG.WEB_MERCATOR:e!==o.Df.LNGLAT&&e!==o.Df.CARTESIAN||(s=!1);break;case o.zG.WEB_MERCATOR_AUTO_OFFSET:e===o.Df.LNGLAT?i=r:e===o.Df.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case o.zG.IDENTITY:i=t.position.map(Math.fround);break;case o.zG.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function p({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=o.Df.DEFAULT,coordinateOrigin:i,autoWrapLongitude:s=!1}={}){r===o.Df.DEFAULT&&(r=t.isGeospatial?o.Df.LNGLAT:o.Df.CARTESIAN);const a=A({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||c,a}},3844:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={name:"project32",dependencies:[n(2967).Z],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},3115:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(4088),i=n(2967),o=n(5451),s=n(3855),a=n(8177),u=n(7013);const c=(0,a.Z)((function({viewport:t,center:e}){return new o.Z(t.viewProjectionMatrix).invert().transform(e)})),l=(0,a.Z)((function({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,a=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,r,i]=t,o=(0,u.CT)([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}(t,r)));for(const r of e){const e=r.clone().translate(new s.Z(t.center).negate()),i=a.map((t=>e.transform(t))),u=(new o.Z).ortho({left:Math.min(...i.map((t=>t[0]))),right:Math.max(...i.map((t=>t[0]))),bottom:Math.min(...i.map((t=>t[1]))),top:Math.max(...i.map((t=>t[1]))),near:Math.min(...i.map((t=>-t[2]))),far:Math.max(...i.map((t=>-t[2])))});n.push(u.multiplyRight(r))}return n})),h=[0,0,0,1],A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],f={name:"shadow",dependencies:[i.Z],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?function(t={},e={}){const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||h,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=c({viewport:t.viewport,center:e.project_uCenter}),o=[],a=l({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const u=a[n],c=u.clone().translate(new s.Z(t.viewport.center).negate());e.project_uCoordinateSystem===r.Df.LNGLAT&&e.project_uProjectionMode===r.zG.WEB_MERCATOR?(a[n]=c,o[n]=i):(a[n]=u.clone().multiplyRight(A),o[n]=c.transform(i))}for(let e=0;e<a.length;e++)n["shadow_uViewProjectionMatrices[".concat(e,"]")]=a[e],n["shadow_uProjectCenters[".concat(e,"]")]=o[e],t.shadowMaps&&t.shadowMaps.length>0?n["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:n["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return n}(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}}},6497:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6507),i=n(4034);const o=["longitude","latitude","zoom","bearing","pitch"],s=["longitude","latitude","zoom"];class a extends r.Z{constructor(t={}){super((Array.isArray(t)?t:t.transitionProps)||{compare:o,extract:o,required:s}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(t),s=r(e),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const o of this._propsToExtract)r[o]=(0,i.t7)(t[o]||0,e[o]||0,n);if(e.aroundPosition){const o=this.opts.makeViewport({...e,...r});Object.assign(r,o.panByPosition(e.aroundPosition,(0,i.t7)(t.around,e.around,n)))}return r}}},6507:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(4034),i=n(5304);class o{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!(0,r.fS)(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=t[n],i[n]=e[n];n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,i.Z)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}},3630:(t,e,n)=>{"use strict";function r(){}n.d(e,{Z:()=>o});const i={onStart:r,onUpdate:r,onInterrupt:r,onEnd:r};class o{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...i,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},5304:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{Z:()=>r})},5015:(t,e,n)=>{"use strict";function r(t){if(null===(e=t)||"object"!=typeof e)throw new Error("count(): argument not an object");var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}n.d(e,{Q:()=>r})},6871:(t,e,n)=>{"use strict";function r(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],o=e[n];if(!(i===o||Array.isArray(i)&&Array.isArray(o)&&r(i,o)))return!1}return!0}n.d(e,{v:()=>r})},1855:(t,e,n)=>{"use strict";function r(t,e=(()=>!0)){return Array.isArray(t)?i(t,e,[]):e(t)?[t]:[]}function i(t,e,n){let r=-1;for(;++r<t.length;){const o=t[r];Array.isArray(o)?i(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let r=n;s<i;s++)t[r++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{x:()=>r,k:()=>o})},8550:(t,e,n)=>{"use strict";n.d(e,{jB:()=>o,D0:()=>s,jr:()=>a});const r=[],i=[];function o(t,e=0,n=1/0){let o=r;const s={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?o=t:t.length>0&&(i.length=t.length,o=i):o=r,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,{size:e,stride:n,offset:r,startIndices:i,nested:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:e,u=r?r/s:0,c=Math.floor((t.length-u)/a);return(n,{index:r,target:s})=>{if(!i){const n=r*a+u;for(let r=0;r<e;r++)s[r]=t[n+r];return s}const l=i[r],h=i[r+1]||c;let A;if(o){A=new Array(h-l);for(let n=l;n<h;n++){const r=n*a+u;s=new Array(e);for(let n=0;n<e;n++)s[n]=t[r+n];A[n-l]=s}}else if(a===e)A=t.subarray(l*e+u,h*e+u);else{A=new t.constructor((h-l)*e);let n=0;for(let r=l;r<h;r++){const i=r*a+u;for(let r=0;r<e;r++)A[n++]=t[i+r]}}return A}}},744:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new(n(4708).Z)({id:"deck"})},5126:(t,e,n)=>{"use strict";n.d(e,{bS:()=>o,wQ:()=>s,Xt:()=>a,Du:()=>u,Ks:()=>h,TK:()=>f});var r=n(6610),i=n(3855);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function u(t){const e={};return e.left=l(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=l(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=l(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=l(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=l(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=l(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}const c=new i.Z;function l(t,e,n,r){c.set(t,e,n);const o=c.len();return{distance:r/o,normal:new i.Z(-t/o,-e/o,-n/o)}}function h(t){return t-Math.fround(t)}let A;function f(t,{size:e=1,startIndex:n=0,endIndex:i}){Number.isFinite(i)||(i=t.length);const o=(i-n)/e;A=r.Z.allocate(A,o,{type:Float32Array,size:2*e});let s=n,a=0;for(;s<i;){for(let n=0;n<e;n++){const r=t[s++];A[a+n]=r,A[a+n+e]=h(r)}a+=2*e}return A.subarray(0,o*e*2)}},8177:(t,e,n)=>{"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){let e,n={};return i=>{for(const o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,{Z:()=>i})},7870:(t,e,n)=>{"use strict";function r(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}n.d(e,{l:()=>r})},8005:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(8550),i=n(6610),o=n(5304),s=n(3478);class a{constructor(t={}){const{attributes:e={}}=t;this.typedArrayManager=i.Z,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t),Object.seal(this)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:s,dataChanged:a,normalize:u=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===s?2:3),this.buffers=n,this.normalize=u,i&&((0,o.Z)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),u||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(a))for(const t of a)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}normalizeGeometry(t){return t}updateGeometryAttributes(t,e,n){throw new Error("Not implemented")}getGeometrySize(t){throw new Error("Not implemented")}getGeometryFromBuffer(t){const e=t.value||t;return(0,o.Z)(ArrayBuffer.isView(e)),(0,r.jr)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices})}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=e,n[s]=o.allocate(n[s],t,r)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:o}=this,{iterable:s,objectInfo:a}=(0,r.jB)(i,e,n);for(const e of s)a.index++,t(o(e,a),a.index)}_rebuildGeometry(t){if(!this.data||!this.getGeometry)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:a=0,endRow:u=1/0}=t||{},c={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{t=this.normalizeGeometry(t),c[e]=t,n[e+1]=n[e]+this.getGeometrySize(t)}),a,u),r=n[n.length-1];else if(o.buffer instanceof s.Z){const t=o.stride||4*this.positionSize;n=i.startIndices,r=n[i.length]||o.buffer.byteLength/t}else{const t=o.value||o,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=i.startIndices,r=n[i.length]||t.length/e}this._allocate(r,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const l={};this._forEachGeometry(((t,i)=>{t=c[i]||t,l.vertexStart=n[i],l.indexStart=e[i];const o=i<n.length-1?n[i+1]:r;l.geometrySize=o-n[i],l.geometryIndex=i,this.updateGeometryAttributes(t,l)}),a,u),this.vertexCount=e[e.length-1]}}},6610:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const u=r||t&&t.constructor||Float32Array,c=e*n+i;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new u(t.buffer,0,c)}let l;a&&(l=a*n+i);const h=this._allocate(u,c,s,l);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>r&&(i=r);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex((t=>t.byteLength>=r));i<0?e.push(n):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,n),e.length>this.props.poolSize&&e.shift()}}},9225:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r=n(744),i=n(5126),o=n(4034),s=n(5451),a=n(3855),u=n(5975),c=n(7013),l=n(4088);const h=Math.PI/180,A=(0,i.bS)(),f=[0,0,0],p={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class d{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?l.zG.WEB_MERCATOR:l.zG.WEB_MERCATOR_AUTO_OFFSET:l.zG.IDENTITY}equals(t){return t instanceof d&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,o.fS)(t.projectionMatrix,this.projectionMatrix)&&(0,o.fS)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=(0,c.aW)(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=(0,c.CT)([r,s,o],this.pixelUnprojectionMatrix,a),[l,h,A]=this.unprojectPosition(u);return Number.isFinite(o)?[l,h,A]:Number.isFinite(n)?[l,h,n]:[l,h]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?(0,c.w5)(t):t}unprojectFlat(t){return this.isGeospatial?(0,c.es)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(t=null){return t?(0,c.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,i.Du)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:n,focalDistance:r,near:i,far:o}){return t?(new s.Z).orthographic({fovy:e,aspect:n,focalDistance:r,near:i,far:o}):(new s.Z).perspective({fovy:e,aspect:n,near:i,far:o})}_initViewMatrix(t){const{viewMatrix:e=A,longitude:n=null,latitude:r=null,zoom:i=null,position:o=null,modelMatrix:u=null,focalDistance:l=1,distanceScales:h=null}=t;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?(0,c.Bf)({latitude:r})+Math.log2(l):0);const d=Math.pow(2,this.zoom);this.scale=d,this.distanceScales=this.isGeospatial?(0,c.ro)({latitude:r,longitude:n}):h||p,this.focalDistance=l,this.distanceScales.metersPerUnit=new a.Z(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new a.Z(this.distanceScales.unitsPerMeter),this.position=f,this.meterOffset=f,o&&(this.position=o,this.modelMatrix=u,this.meterOffset=u?u.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new s.Z).multiplyRight(this.viewMatrixUncentered).translate(new a.Z(this.center||f).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:n,distanceScales:r}=this,i=new a.Z(this.projectPosition([t,e,0]));if(n){const t=new a.Z(n).scale(r.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*h,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const t=(0,i.bS)();u.Jp(t,t,this.projectionMatrix),u.Jp(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=u.U_([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,i.Xt)(this.viewMatrixInverse);const e=(0,i.bS)(),n=(0,i.bS)();u.bA(e,e,[this.width/2,-this.height/2,1]),u.Iu(e,e,[1,-1,0]),u.Jp(n,e,this.viewProjectionMatrix),this.pixelProjectionMatrix=n,this.viewportMatrix=e,this.pixelUnprojectionMatrix=u.U_((0,i.bS)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.Z.warn("Pixel project matrix not invertible")()}}d.displayName="Viewport"},6935:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(9225),i=n(7013),o=n(1437),s=n(5451);class a extends r.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,pitch:o=0,bearing:a=0,nearZMultiplier:u=.1,farZMultiplier:c=1.01,orthographic:l=!1,repeat:h=!1,worldOffset:A=0}=t;let{width:f,height:p,altitude:d=1.5}=t;const g=Math.pow(2,r);f=f||1,p=p||1,d=Math.max(.75,d);const{fov:y,aspect:m,focalDistance:_,near:v,far:b}=(0,i.wl)({width:f,height:p,pitch:o,altitude:d,nearZMultiplier:u,farZMultiplier:c});let w=(0,i.lf)({height:p,pitch:o,bearing:a,scale:g,altitude:d});A&&(w=(new s.Z).translate([512*A,0,0]).multiplyLeft(w)),super({...t,width:f,height:p,viewMatrix:w,longitude:n,latitude:e,zoom:r,orthographic:l,fovyRadians:y,aspect:m,focalDistance:_,near:v,far:b}),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=o,this.bearing=a,this.altitude=d,this.orthographic=l,this._subViewports=h?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new a({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}addMetersToLngLat(t,e){return(0,i.eG)(t,e)}panByPosition(t,e){const n=(0,i.CT)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),s=o.IH([],r,o.tk([],n)),a=o.IH([],this.center,s),[u,c]=this.unprojectFlat(a);return{longitude:u,latitude:c}}getBounds(t={}){const e=(0,i.zX)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:s,zoom:u}=(0,i.Xg)({width:n,height:r,bounds:t,...e});return new a({width:n,height:r,longitude:o,latitude:s,zoom:u})}}a.displayName="WebMercatorViewport"},4009:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4897),i=n(6935),o=n(6883);class s extends r.Z{constructor(t){super({...t,type:i.Z})}get controller(){return this._getControllerProps({type:o.Z})}}s.displayName="MapView"},743:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(4897),i=n(9225),o=n(5451),s=n(7013),a=n(1437),u=n(2577);const c=(new o.Z).lookAt({eye:[0,0,1]});function l({width:t,height:e,near:n,far:r}){return t=t||1,e=e||1,(new o.Z).ortho({left:-t/2,right:t/2,bottom:-e/2,top:e/2,near:n,far:r})}class h extends i.Z{constructor(t){const{width:e,height:n,near:r=.1,far:i=1e3,zoom:o=0,target:s=[0,0,0],flipY:a=!0}=t,u=Math.pow(2,o);super({...t,longitude:null,position:s,viewMatrix:c.clone().scale([u,u*(a?-1:1),u]),projectionMatrix:l({width:e,height:n,near:r,far:i}),zoom:o})}panByPosition(t,e){const n=(0,s.CT)(e,this.pixelUnprojectionMatrix),r=a.IH([],t,a.tk([],n));return{target:a.IH([],this.center,r)}}}class A extends r.Z{constructor(t){super({...t,type:h})}get controller(){return this._getControllerProps({type:u.Z})}}A.displayName="OrthographicView"},4897:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(9225);const i=/([0-9]+\.?[0-9]*)(%|px)/;function o(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(i);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function s(t,e){return t.relative?Math.round(t.position*e):t.position}var a=n(6871),u=n(5304);class c{constructor(t={}){const{id:e=null,x:n=0,y:i=0,width:o="100%",height:s="100%",projectionMatrix:a=null,fovy:c=50,near:l=.1,far:h=1e3,modelMatrix:A=null,viewportInstance:f=null,type:p=r.Z}=t;(0,u.Z)(!f||f instanceof r.Z),this.viewportInstance=f,this.id=e||this.constructor.displayName||"view",this.type=p,this.props={...t,id:this.id,projectionMatrix:a,fovy:c,near:l,far:h,modelMatrix:A},this._parseDimensions({x:n,y:i,width:o,height:s}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):(0,a.v)(this.props,t.props))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:s(this._x,t),y:s(this._y,e),width:s(this._width,t),height:s(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"==typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:n,height:r}){this._x=o(t),this._y=o(e),this._width=o(n),this._height=o(r)}}},8215:(t,e,n)=>{"use strict";n.r(e),n.d(e,{GreatCircleLayer:()=>i,H3ClusterLayer:()=>Zt,H3HexagonLayer:()=>Qt,MVTLayer:()=>Zr,S2Layer:()=>y,TerrainLayer:()=>vr,Tile3DLayer:()=>pr,TileLayer:()=>Bt,TripsLayer:()=>Ut});var r=n(4717);class i extends r.Z{}i.layerName="GreatCircleLayer",i.defaultProps={getHeight:{type:"accessor",value:0},greatCircle:!0};var o=n(8918),s=n(3121),a=n(514),u=n.n(a);const c=180/Math.PI;function l(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function h(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function A(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function f([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*c,r*c]}function p(t,e,n,r){if(0===r){1===n&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}function d(t){return function({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(100*Math.pow(2,-n))),o=new Float64Array(4*i*2+2);let s=0,a=0;for(let c=0;c<4;c++){const p=r[c].slice(0),d=r[c+1],g=(d[0]-p[0])/i,y=(d[1]-p[1])/i;for(let r=0;r<i;r++){p[0]+=g,p[1]+=y;const r=f(A(t,[h((u=l(e,n,p))[0]),h(u[1])]));Math.abs(r[1])>89.999&&(r[0]=a);const i=r[0]-a;r[0]+=i>180?-360:i<-180?360:0,o[s++]=r[0],o[s++]=r[1],a=r[0]}}var u;return o[s++]=o[0],o[s++]=o[1],o}(function(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,o=[0,0];let s;for(let t=i-1;t>=0;t--){s=i-t;const e=r[t];let n=0,a=0;"1"===e?a=1:"2"===e?(n=1,a=1):"3"===e&&(n=1);const u=Math.pow(2,s-1);p(u,o,n,a),o[0]+=u*n,o[1]+=u*a}if(n%2==1){const t=o[0];o[0]=o[1],o[1]=t}return{face:n,ij:o,level:s}}(function(t){if("string"==typeof t){if(t.indexOf("/")>0)return t;t=function(t){const e=t.padEnd(16,"0");return u().fromString(e,16)}(t)}return function(t){let e=u().fromString(t,!0,10).toString(2);for(;e.length<64;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,s=u().fromString(r,!0,2).toString(10);let a=u().fromString(i,!0,2).toString(4);for(;a.length<o;)a="0"+a;return"".concat(s,"/").concat(a)}(t.toString())}(t)))}const g={...s.Z.defaultProps,getS2Token:{type:"accessor",value:t=>t.token}};class y extends o.Z{renderLayers(){const{data:t,getS2Token:e}=this.props,{elevationScale:n,extruded:r,wireframe:i,filled:o,stroked:a,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:A,lineMiterLimit:f,lineDashJustified:p,getElevation:g,getFillColor:y,getLineColor:m,getLineWidth:_,getLineDashArray:v}=this.props,{updateTriggers:b,material:w}=this.props;return new(this.getSubLayerClass("cell",s.Z))({filled:o,wireframe:i,extruded:r,elevationScale:n,stroked:a,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:l,lineWidthMaxPixels:h,lineJointRounded:A,lineMiterLimit:f,lineDashJustified:p,material:w,getElevation:g,getFillColor:y,getLineColor:m,getLineWidth:_,getLineDashArray:v},this.getSubLayerProps({id:"cell",updateTriggers:{getElevation:b.getElevation,getFillColor:b.getFillColor,getLineColor:b.getLineColor,getLineWidth:b.getLineWidth,getLineDashArray:b.getLineDashArray}}),{data:t,_normalize:!1,positionFormat:"XY",getPolygon:(t,n)=>d(e(t,n))})}}y.layerName="S2Layer",y.defaultProps=g;var m=n(1855),_=n(9026),v=n(744);class b{constructor({x:t,y:e,z:n,onTileLoad:r,onTileError:i}){this.x=t,this.y=e,this.z=n,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=r,this.onTileError=i}get data(){return this._isLoaded?this.content:this._loader}get isLoaded(){return this._isLoaded}get isLoading(){return Boolean(this._loader)}get isCancelled(){return this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||v.Z.error("byteLength not defined in tile data")(),t}async _loadData(t,e){const{x:n,y:r,z:i,bbox:o}=this;this._abortController=new AbortController;const{signal:s}=this._abortController,a=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!a)return void(this._isCancelled=!0);if(this._isCancelled)return void a.done();let u,c;try{u=await t({x:n,y:r,z:i,bbox:o,signal:s})}catch(t){c=t||!0}finally{a.done(),this._isCancelled&&!u?this._isLoaded=!1:(this._isLoaded=!0,this._isCancelled=!1)}this._isLoaded&&(c?this.onTileError(c,this):(this.content=u,this.onTileLoad(this)))}loadData(t,e){t&&(this._isCancelled=!1,this._loader=this._loadData(t,e),this._loader.finally((()=>{this._loader=void 0})))}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}}const w=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});var E=n(3855);const x=new E.Z,S=new E.Z;class P{constructor(t=[0,0,0],e=[0,0,0],n=null){n=n||x.copy(t).add(e).scale(.5),this.center=new E.Z(n),this.halfDiagonal=new E.Z(e).subtract(this.center),this.minimum=new E.Z(t),this.maximum=new E.Z(e)}clone(){return new P(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=S.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?w.INSIDE:i+r<0?w.OUTSIDE:w.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=x.from(t).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(e.x)-n.x,r>0&&(i+=r*r),r=Math.abs(e.y)-n.y,r>0&&(i+=r*r),r=Math.abs(e.z)-n.z,r>0&&(i+=r*r),i}}var T=n(5975);const C=new E.Z,M=new E.Z;class I{constructor(t=[0,0,0],e=0){this.radius=-0,this.center=new E.Z,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=C.from(e),this.center=(new E.Z).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new I(this.center,this.radius)}union(t){const e=this.center,n=this.radius,r=t.center,i=t.radius,o=C.copy(r).subtract(e),s=o.magnitude();if(n>=s+i)return this.clone();if(i>=s+n)return t.clone();const a=.5*(n+s+i);return M.copy(o).scale((-n+a)/s).add(e),this.center.copy(M),this.radius=a,this}expand(t){const e=(t=C.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=T.Q$(C,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=(t=C.from(t)).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?w.OUTSIDE:r<n?w.INTERSECTING:w.INSIDE}}var O=n(540),R=n(4782);const L=new E.Z,N=new E.Z,D=new E.Z,F=new E.Z,k=new E.Z,B=new E.Z,j=new E.Z;class U{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){this.center=(new E.Z).from(t),this.halfAxes=new O.Z(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new E.Z(t).len(),new E.Z(e).len(),new E.Z(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new E.Z(t).normalize(),i=new E.Z(e).normalize(),o=new E.Z(n).normalize();return(new R.Z).fromMatrix3(new O.Z([...r,...i,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const r=new R.Z(n),i=(new O.Z).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new E.Z).from(t),this.halfAxes=i,this}clone(){return new U(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new I){const e=this.halfAxes,n=e.getColumn(0,D),r=e.getColumn(1,F),i=e.getColumn(2,k),o=L.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,s=n.z,a=Math.abs(i*r[0]+o*r[1]+s*r[2])+Math.abs(i*r[3]+o*r[4]+s*r[5])+Math.abs(i*r[6]+o*r[7]+s*r[8]),u=n.dot(e)+t.distance;return u<=-a?w.OUTSIDE:u>=a?w.INSIDE:w.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=N.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,D),i=n.getColumn(1,F),o=n.getColumn(2,k),s=r.magnitude(),a=i.magnitude(),u=o.magnitude();r.normalize(),i.normalize(),o.normalize();let c,l=0;return c=Math.abs(e.dot(r))-s,c>0&&(l+=c*c),c=Math.abs(e.dot(i))-a,c>0&&(l+=c*c),c=Math.abs(e.dot(o))-u,c>0&&(l+=c*c),l}computePlaneDistances(t,e,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,D),u=s.getColumn(1,F),c=s.getColumn(2,k),l=B.copy(a).add(u).add(c).add(o),h=j.copy(l).subtract(t);let A=e.dot(h);return r=Math.min(A,r),i=Math.max(A,i),l.copy(o).add(a).add(u).subtract(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),l.copy(o).add(a).subtract(u).add(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),l.copy(o).add(a).subtract(u).subtract(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),o.copy(l).subtract(a).add(u).add(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),o.copy(l).subtract(a).add(u).subtract(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),o.copy(l).subtract(a).subtract(u).add(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),o.copy(l).subtract(a).subtract(u).subtract(c),h.copy(l).subtract(t),A=e.dot(h),r=Math.min(A,r),i=Math.max(A,i),n[0]=r,n[1]=i,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,D);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,F);n.transformAsPoint(t);const r=this.halfAxes.getColumn(2,k);return r.transformAsPoint(t),this.halfAxes=new O.Z([...e,...n,...r]),this}getTransform(){throw new Error("not implemented")}}var z=n(394),G=n(4034);const V=new E.Z,Z=new E.Z;class H{constructor(t=[0,0,1],e=0){this.normal=new E.Z,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return(0,z.Z)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=V.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,r){return this.normal.set(t,e,n),(0,z.Z)((0,G.fS)(this.normal.len(),1)),this.distance=r,this}clone(t){return new H(this.normal,this.distance)}equals(t){return(0,G.fS)(this.distance,t.distance)&&(0,G.fS)(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=Z.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=V.from(t);const n=this.getPointDistance(t),r=Z.copy(this.normal).scale(n);return t.subtract(r).to(e)}}const q=[new E.Z([1,0,0]),new E.Z([0,1,0]),new E.Z([0,0,1])],W=new E.Z,X=new E.Z;new H(new E.Z(1,0,0),0);class Y{static get MASK_OUTSIDE(){return 4294967295}static get MASK_INSIDE(){return 0}static get MASK_INDETERMINATE(){return 2147483647}constructor(t=[]){this.planes=t,(0,z.Z)(this.planes.every((t=>t instanceof H)))}fromBoundingSphere(t){this.planes.length=2*q.length;const e=t.center,n=t.radius;let r=0;for(const t of q){let i=this.planes[r],o=this.planes[r+1];i||(i=this.planes[r]=new H),o||(o=this.planes[r+1]=new H);const s=W.copy(t).scale(-n).add(e);t.dot(s),i.fromPointNormal(s,t);const a=W.copy(t).scale(n).add(e),u=X.copy(t).negate();u.dot(a),o.fromPointNormal(a,u),r+=2}return this}computeVisibility(t){(0,z.Z)(t);let e=w.INSIDE;for(const n of this.planes)switch(t.intersectPlane(n)){case w.OUTSIDE:return w.OUTSIDE;case w.INTERSECTING:e=w.INTERSECTING}return e}computeVisibilityWithPlaneMask(t,e){if((0,z.Z)(t,"boundingVolume is required."),(0,z.Z)(Number.isFinite(e),"parentPlaneMask is required."),e===Y.MASK_OUTSIDE||e===Y.MASK_INSIDE)return e;let n=Y.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&0==(e&o))continue;const s=r[i],a=t.intersectPlane(s);if(a===w.OUTSIDE)return Y.MASK_OUTSIDE;a===w.INTERSECTING&&(n|=o)}return n}}new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,new E.Z,Math.PI;var Q=n(9057);const K=new O.Z,J=new O.Z,$=new O.Z,tt=new O.Z,et=new O.Z;const nt=[1,0,0],rt=[2,2,1];function it(t){let e=0;for(let n=0;n<3;++n){const r=t[K.getElementIndex(rt[n],nt[n])];e+=2*r*r}return Math.sqrt(e)}function ot(t,e){const n=Q.Z.EPSILON15;let r=0,i=1;for(let e=0;e<3;++e){const n=Math.abs(t[K.getElementIndex(rt[e],nt[e])]);n>r&&(i=e,r=n)}const o=nt[i],s=rt[i];let a=1,u=0;if(Math.abs(t[K.getElementIndex(s,o)])>n){const e=(t[K.getElementIndex(s,s)]-t[K.getElementIndex(o,o)])/2/t[K.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),u=n*a}return O.Z.IDENTITY.to(e),e[K.getElementIndex(o,o)]=e[K.getElementIndex(s,s)]=a,e[K.getElementIndex(s,o)]=u,e[K.getElementIndex(o,s)]=-u,e}const st=new E.Z,at=new E.Z,ut=new E.Z,ct=new E.Z,lt=new E.Z,ht=new O.Z,At={diagonal:new O.Z,unitary:new O.Z},ft=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],pt=ft.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),dt=pt.concat([[.25,.5],[.75,.5]]);class gt{constructor(t,e,n){this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new gt(t,e,n),new gt(t,e+1,n),new gt(t+1,e,n),new gt(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:o,offset:s,project:a}=t,u=this.getBoundingVolume(r,s,a);if(n.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=i){const n=u.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}getBoundingVolume(t,e,n){if(n){const e=this.z<1?dt:this.z<2?pt:ft,r=[];for(const i of e){const e=Et(this.x+i[0],this.y+i[1],this.z);e[2]=t[0],r.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],r.push(n(e)))}return function(t,e=new U){if(!t||0===t.length)return e.halfAxes=new O.Z([0,0,0,0,0,0,0,0,0]),e.center=new E.Z,e;const n=t.length,r=new E.Z(0,0,0);for(const e of t)r.add(e);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,u=0,c=0,l=0;for(const e of t){const t=st.copy(e).subtract(r);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,u+=t.y*t.y,c+=t.y*t.z,l+=t.z*t.z}o*=i,s*=i,a*=i,u*=i,c*=i,l*=i;const h=ht;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=u,h[5]=c,h[6]=a,h[7]=c,h[8]=l;const{unitary:A}=function(t,e={}){const n=Q.Z.EPSILON20;let r=0,i=0;const o=J,s=$;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(s);for(;i<10&&it(s)>a;)ot(s,tt),et.copy(tt).transpose(),s.multiplyRight(tt),s.multiplyLeft(et),o.multiplyRight(tt),++r>2&&(++i,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}(h,At),f=e.halfAxes.copy(A);let p=f.getColumn(0,ut),d=f.getColumn(1,ct),g=f.getColumn(2,lt),y=-Number.MAX_VALUE,m=-Number.MAX_VALUE,_=-Number.MAX_VALUE,v=Number.MAX_VALUE,b=Number.MAX_VALUE,w=Number.MAX_VALUE;for(const e of t)st.copy(e),y=Math.max(st.dot(p),y),m=Math.max(st.dot(d),m),_=Math.max(st.dot(g),_),v=Math.min(st.dot(p),v),b=Math.min(st.dot(d),b),w=Math.min(st.dot(g),w);p=p.multiplyByScalar(.5*(v+y)),d=d.multiplyByScalar(.5*(b+m)),g=g.multiplyByScalar(.5*(w+_)),e.center.copy(p).add(d).add(g);const x=at.set(y-v,m-b,_-w).multiplyByScalar(.5),S=new O.Z([x[0],0,0,0,x[1],0,0,0,x[2]]);return e.halfAxes.multiplyRight(S),e}(r)}const r=512/Math.pow(2,this.z),i=this.x*r+512*e,o=512-(this.y+1)*r;return new P([i,o,t[0]],[i+r,o+r,t[1]])}}const yt=512,mt=[-1/0,-1/0,1/0,1/0],_t={type:"url",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function vt(t,e){const n=[e.transformPoint([t[0],t[1]]),e.transformPoint([t[2],t[1]]),e.transformPoint([t[0],t[3]]),e.transformPoint([t[2],t[3]])];return[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))]}function bt(t,e){if(!t||!t.length)return null;Array.isArray(t)&&(t=t[Math.abs(e.x+e.y)%t.length]);const{x:n,y:r,z:i}=e;return t.replace("{x}",n).replace("{y}",r).replace("{z}",i).replace("{-y}",Math.pow(2,i)-r-1)}function wt(t,e){return Math.pow(2,t)*yt/e}function Et(t,e,n){const r=wt(n,yt),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function xt(t,e,n,r){const i=wt(n,r);return[t/i*yt,e/i*yt]}function St(t,e,n,r,i=512){if(t.isGeospatial){const[t,i]=Et(e,n,r),[o,s]=Et(e+1,n+1,r);return{west:t,north:i,east:o,south:s}}const[o,s]=xt(e,n,r,i),[a,u]=xt(e+1,n+1,r,i);return{left:o,top:s,right:a,bottom:u}}function Pt({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=512,modelMatrix:s,modelMatrixInverse:a,zoomOffset:u=0}){let c=t.isGeospatial?Math.round(t.zoom+Math.log2(yt/o))+u:Math.ceil(t.zoom)+u;if(Number.isFinite(n)&&c<n){if(!i)return[];c=n}Number.isFinite(e)&&c>e&&(c=e);let l=i;return s&&a&&i&&!t.isGeospatial&&(l=vt(i,s)),t.isGeospatial?function(t,e,n){const r=t.resolution?t.projectPosition:null,i=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new H(t.clone().negate(),e))),o=new Y(i),s=t.distanceScales.unitsPerMeter[2],a=n&&n[0]*s||0,u=n&&n[1]*s||0,c=t.pitch<=60?e:0,l=new gt(0,0,0),h={viewport:t,project:r,cullingVolume:o,elevationBounds:[a,u],minZ:c,maxZ:e,offset:0};if(l.update(h),t.subViewports&&t.subViewports.length>1){for(h.offset=-1;l.update(h)&&!(--h.offset<-3););for(h.offset=1;l.update(h)&&!(++h.offset>3););}return l.getSelected()}(t,c,r):function(t,e,n,r,i){const o=function(t,e,n){let r;return r=t.getBounds(),t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(t,0,r),s=wt(e,n),[a,u,c,l]=function(t,e,n){return n?vt(t,n).map((t=>t*e/yt)):t.map((t=>t*e/yt))}(o,s,i),h=[];for(let t=Math.floor(a);t<c;t++)for(let n=Math.floor(u);n<l;n++)h.push({x:t,y:n,z:e});return h}(t,c,o,l||mt,a)}var Tt=n(4942),Ct=n(8295);const Mt={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class It{constructor(t={}){(0,Tt.Z)(this,"props",void 0),(0,Tt.Z)(this,"stats",void 0),(0,Tt.Z)(this,"activeRequestCount",0),(0,Tt.Z)(this,"requestQueue",[]),(0,Tt.Z)(this,"requestMap",new Map),(0,Tt.Z)(this,"deferredUpdate",null),this.props={...Mt,...t},this.stats=new Ct.Z({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t,e=(()=>0)){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}}var Ot=n(5451);const Rt="best-available";class Lt{constructor(t){this.opts=t,this._getTileData=t.getTileData,this.onTileError=t.onTileError,this.onTileLoad=e=>{t.onTileLoad(e),this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this.onTileUnload=t.onTileUnload,this._requestScheduler=new It({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles.every((t=>t.isLoaded))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort()}update(t,{zRange:e,modelMatrix:n}={}){const r=new Ot.Z(n),i=!r.equals(this._modelMatrix);if(!t.equals(this._viewport)||i){i&&(this._modelMatrixInverse=n&&r.clone().invert(),this._modelMatrix=n&&r),this._viewport=t;const o=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=o.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:r,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:u}=this.opts;return Pt({viewport:t,maxZoom:e,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:i,modelMatrixInverse:o,zoomOffset:u})}getTileMetadata({x:t,y:e,z:n}){const{tileSize:r}=this.opts;return{bbox:St(this._viewport,t,e,n,r)}}getParentIndex(t){return t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),t.z-=1,t}updateTileStates(){this._updateTileStates(this.selectedTiles);const{maxRequests:t}=this.opts,e=[];let n=0,r=!1;for(const t of this._cache.values()){const i=Boolean(1&t.state);t.isVisible!==i&&(r=!0,t.isVisible=i),t.isSelected=5===t.state,t.isLoading&&(n++,t.isSelected||e.push(t))}if(t>0)for(;n>t&&e.length>0;)e.shift().abort(),n--;return r}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children.length=0;for(const e of t.values()){const t=this._getNearestAncestor(e.x,e.y,e.z);e.parent=t,t&&t.children.push(e)}}_updateTileStates(t){const{_cache:e}=this,n=this.opts.refinementStrategy||Rt;for(const t of e.values())t.state=0;for(const e of t)e.state=5;if("never"!==n){for(const e of t)Dt(e,n);for(const e of t)Nt(e)&&Ft(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>r){for(const[i,o]of t)if(o.isVisible||(this._cacheByteSize-=e.maxCacheByteSize?o.byteLength:0,t.delete(i),this.onTileUnload(o)),t.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.z-e.z)),this._dirty=!1)}_getTile({x:t,y:e,z:n},r){const i="".concat(t,",").concat(e,",").concat(n);let o=this._cache.get(i);return!o&&r?(o=new b({x:t,y:e,z:n,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(o,this.getTileMetadata(o)),o.loadData(this._getTileData,this._requestScheduler),this._cache.set(i,o),this._dirty=!0):o&&o.isCancelled&&!o.isLoading&&o.loadData(this._getTileData,this._requestScheduler),o}_getNearestAncestor(t,e,n){const{_minZoom:r=0}=this;let i={x:t,y:e,z:n};for(;i.z>r;){i=this.getParentIndex(i);const t=this._getTile(i);if(t)return t}return null}}function Nt(t){let e=t;for(;e;){if(!1&e.state)return!0;if(e.isLoaded)return!1;e=e.parent}return!0}function Dt(t,e){let n,r=3;for(;n=t.parent;){if(t.isLoaded&&(r=4,e===Rt))return;n.state=Math.max(n.state,r),t=n}}function Ft(t){for(const e of t.children)e.state=Math.max(e.state,3),e.isLoaded||Ft(e)}const kt={data:[],dataComparator:_t.equals,renderSubLayers:{type:"function",value:t=>new _.Z(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:Rt,zRange:null,maxRequests:6,zoomOffset:0};class Bt extends o.Z{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t;null===(t=this.state.tileset)||void 0===t||t.finalize()}get isLoaded(){const{tileset:t}=this.state;return t.selectedTiles.every((t=>t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,changeFlags:e}){let{tileset:n}=this.state;!n||e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData)?(n&&n.finalize(),n=new Lt({...this._getTilesetOptions(t),getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}),this.setState({tileset:n})):(e.propsChanged||e.updateTriggersChanged)&&(n.setOptions(this._getTilesetOptions(t)),this.state.tileset.tiles.forEach((t=>{t.layers=null}))),this._updateTileset()}_getTilesetOptions(t){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:a,maxRequests:u,zoomOffset:c}=t;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:a,tileSize:e,refinementStrategy:i,extent:o,maxRequests:u,zoomOffset:c}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,r=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:i}=t,o=this.state.isLoaded!==i,s=this.state.frameNumber!==r;i&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.getCurrentLayer().props.onTileLoad(t),t.isVisible&&this.setNeedsUpdate()}_onTileError(t,e){const n=this.getCurrentLayer();n.props.onTileError(t),n._updateTileset(),e.isVisible&&this.setNeedsUpdate()}_onTileUnload(t){this.getCurrentLayer().props.onTileUnload(t)}getTileData(t){const{data:e}=this.props,{getTileData:n,fetch:r}=this.getCurrentLayer().props,{signal:i}=t;return t.url=bt(e,t),n?n(t):t.url?r(t.url,{propName:"data",layer:this,signal:i}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getHighlightedObjectIndex(){return-1}getPickingInfo({info:t,sourceLayer:e}){return t.tile=e.props.tile,t}_updateAutoHighlight(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getHighlightedObjectIndex(t);if(t.isLoaded)if(t.layers)t.layers[0]&&t.layers[0].props.highlightedObjectIndex!==e&&(t.layers=t.layers.map((t=>t.clone({highlightedObjectIndex:e}))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(t.x,"-").concat(t.y,"-").concat(t.z),data:t.data,_offset:0,tile:t});t.layers=(0,m.x)(n,Boolean).map((n=>n.clone({tile:t,highlightedObjectIndex:e})))}return t.layers}))}filterSubLayer({layer:t}){return this.props.visible&&t.props.tile.isVisible}}Bt.layerName="TileLayer",Bt.defaultProps=kt;var jt=n(2112);class Ut extends jt.Z{getShaders(){const t=super.getShaders();return t.inject={"vs:#decl":"uniform float trailLength;\nattribute float instanceTimestamps;\nattribute float instanceNextTimestamps;\nvarying float vTime;\n","vs:#main-end":"vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;\n","fs:#decl":"uniform bool fadeTrail;\nuniform float trailLength;\nuniform float currentTime;\nvarying float vTime;\n","fs:#main-start":"if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {\n  discard;\n}\n","fs:DECKGL_FILTER_COLOR":"if(fadeTrail) {\n  color.a *= 1.0 - (currentTime - vTime) / trailLength;\n}\n"},t}initializeState(t){super.initializeState(t),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(t){const{fadeTrail:e,trailLength:n,currentTime:r}=this.props;t.uniforms={...t.uniforms,fadeTrail:e,trailLength:n,currentTime:r},super.draw(t)}}Ut.layerName="TripsLayer",Ut.defaultProps={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:null}};var zt=n(9947),Gt=n(8550);const Vt={...s.Z.defaultProps,getHexagons:{type:"accessor",value:t=>t.hexagons}};class Zt extends o.Z{updateState({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggers&&n.updateTriggers.getHexagons){const{data:e,getHexagons:n}=t,r=[],{iterable:i,objectInfo:o}=(0,Gt.jB)(e);for(const t of i){o.index++;const e=n(t,o),i=(0,zt.h3SetToMultiPolygon)(e,!0);for(const e of i)r.push(this.getSubLayerRow({polygon:e},t,o.index))}this.setState({polygons:r})}}renderLayers(){const{elevationScale:t,extruded:e,wireframe:n,filled:r,stroked:i,lineWidthScale:o,lineWidthMinPixels:a,lineWidthMaxPixels:u,lineJointRounded:c,lineMiterLimit:l,lineDashJustified:h,material:A,getFillColor:f,getLineColor:p,getLineWidth:d,getLineDashArray:g,getElevation:y,transitions:m,updateTriggers:_}=this.props;return new(this.getSubLayerClass("cluster-region",s.Z))({filled:r,wireframe:n,extruded:e,elevationScale:t,stroked:i,lineWidthScale:o,lineWidthMinPixels:a,lineWidthMaxPixels:u,lineJointRounded:c,lineMiterLimit:l,lineDashJustified:h,material:A,transitions:m,getFillColor:this.getSubLayerAccessor(f),getLineColor:this.getSubLayerAccessor(p),getLineWidth:this.getSubLayerAccessor(d),getLineDashArray:this.getSubLayerAccessor(g),getElevation:this.getSubLayerAccessor(y)},this.getSubLayerProps({id:"cluster-region",updateTriggers:_}),{data:this.state.polygons,getPolygon:t=>t.polygon})}}Zt.defaultProps=Vt,Zt.layerName="H3ClusterLayer";var Ht=n(5103);function qt(t,e){e=void 0===e?t[0][0]:e;for(const n of t){const t=n[0]-e;t>180?n[0]-=360:t<-180&&(n[0]+=360)}}function Wt(t,e,n){const r=t(e,n),[i,o]=(0,zt.h3ToGeo)(r);return[o,i]}function Xt(t,e=1,n){const r=(0,zt.h3ToGeoBoundary)(t,!0);if(1!==e?function(t,e,n){const[r,i]=(0,zt.h3ToGeo)(t),o=e.length;qt(e,i);const s=e[0]===e[o-1]?o-1:o;for(let t=0;t<s;t++)e[t][0]=(0,G.t7)(i,e[t][0],n),e[t][1]=(0,G.t7)(r,e[t][1],n)}(t,r,e):qt(r),n){const t=new Float64Array(2*r.length);let e=0;for(const n of r)t[e++]=n[0],t[e++]=n[1];return t}return r}const Yt={...s.Z.defaultProps,highPrecision:!1,coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};delete Yt.getLineDashArray;class Qt extends o.Z{shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggers&&n.updateTriggers.getHexagon){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:o}=(0,Gt.jB)(t.data);for(const s of i){o.index++;const i=t.getHexagon(s,o),a=(0,zt.h3GetResolution)(i);if(e<0)e=a;else if(e!==a){r=!0;break}if((0,zt.h3IsPentagon)(i)){n=!0;break}}this.setState({resolution:e,edgeLengthKM:e>=0?(0,zt.edgeLength)(e,zt.UNITS.km):0,hasMultipleRes:r,hasPentagon:n})}this._updateVertices(this.context.viewport)}_shouldUseHighPrecision(){const{resolution:t,hasPentagon:e,hasMultipleRes:n}=this.state,{viewport:r}=this.context;return this.props.highPrecision||r.resolution||n||e||t>=0&&t<=5}_updateVertices(t){if(this._shouldUseHighPrecision())return;const{resolution:e,edgeLengthKM:n,centerHex:r}=this.state;if(e<0)return;const i=this.props.centerHexagon||(0,zt.geoToH3)(t.latitude,t.longitude,e);if(r===i)return;if(r){const t=(0,zt.h3Distance)(r,i);if(t>=0&&t*n<10)return}const{unitsPerMeter:o}=t.distanceScales;let s=Xt(i);const[a,u]=(0,zt.h3ToGeo)(i),[c,l]=t.projectFlat([u,a]);s=s.map((e=>{const n=t.projectFlat(e);return[(n[0]-c)/o[0],(n[1]-l)/o[1]]})),this.setState({centerHex:i,vertices:s})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:t,material:e,coverage:n,extruded:r,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:u,lineWidthMinPixels:c,lineWidthMaxPixels:l,getFillColor:h,getElevation:A,getLineColor:f,getLineWidth:p,transitions:d,updateTriggers:g}=this.props;return{elevationScale:t,extruded:r,coverage:n,wireframe:i,stroked:o,filled:s,lineWidthUnits:a,lineWidthScale:u,lineWidthMinPixels:c,lineWidthMaxPixels:l,material:e,getElevation:A,getFillColor:h,getLineColor:f,getLineWidth:p,transitions:d,updateTriggers:{getFillColor:g.getFillColor,getElevation:g.getElevation,getLineColor:g.getLineColor,getLineWidth:g.getLineWidth}}}_renderPolygonLayer(){const{data:t,getHexagon:e,updateTriggers:n,coverage:r}=this.props,i=this.getSubLayerClass("hexagon-cell-hifi",s.Z),o=this._getForwardProps();return o.updateTriggers.getPolygon=function(t,e){let n;return n=null==t?e:"object"==typeof t?{...t,coverage:e}:{getHexagon:t,coverage:e},n}(n.getHexagon,r),new i(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(t,n)=>Xt(e(t,n),r,!0)})}_renderColumnLayer(){const{data:t,getHexagon:e,updateTriggers:n}=this.props,r=this.getSubLayerClass("hexagon-cell",Ht.Z),i=this._getForwardProps();return i.updateTriggers.getPosition=n.getHexagon,new r(i,this.getSubLayerProps({id:"hexagon-cell",updateTriggers:i.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:Wt.bind(null,e)})}}Qt.defaultProps=Yt,Qt.layerName="H3HexagonLayer";var Kt=n(3982),Jt=n(4088),$t=n(7693),te=n(2377),ee=n(1307),ne=n(4080),re=n(1113),ie=n(3989);class oe extends ie.Z{getShaders(){const t=super.getShaders();return t.modules.push(ne.b),{...t,vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nuniform bool u_pickFeatureIds;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec4 uvRegions;\nin vec3 featureIdsPickingColors;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  vec2 uv = fract(texCoords) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;\n\n  geometry.uv = uv;\n  geometry.uv = texCoords;\n\n  if (u_pickFeatureIds) {\n    geometry.pickingColor = featureIdsPickingColors;\n  } else {\n    geometry.pickingColor = instancePickingColors;\n  }\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * normals);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = uv;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  vTexCoord = uv;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale;\n  vec3 projectedPosition = project_position(positions);\n  position_commonspace = vec4(projectedPosition, 1.0);\n  gl_Position = project_common_position_to_clipspace(position_commonspace);\n\n  geometry.position = position_commonspace;\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  \n#ifdef MODULE_PBR\n\n  fragColor = vColor * pbr_filterColor(vec4(0));\n  geometry.uv = pbr_vUV;\n  fragColor.a *= opacity;\n\n#else\n\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n#endif\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n"}}initializeState(){const{featureIds:t}=this.props;super.initializeState(),t&&this.state.attributeManager.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n}),t.pbrMaterial!==e.pbrMaterial&&this.updatePbrMaterialUniforms(t.pbrMaterial)}draw(t){const{featureIds:e}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,u_pickFeatureIds:Boolean(e)}),super.draw(t))}getModel(t){const{id:e,pbrMaterial:n}=this.props,r=this.parseMaterial(n,t),i=this.getShaders();var o;return(o=t.attributes).COLOR_0||o.colors||(o.colors={constant:!0,value:new Float32Array([1,1,1])}),o.uvRegions||(o.uvRegions={constant:!0,value:new Float32Array([0,0,1,1])}),new re.Z(this.context.gl,{...this.getShaders(),id:e,geometry:t,defines:{...i.defines,...null==r?void 0:r.defines},parameters:null==r?void 0:r.parameters,isInstanced:!0})}updatePbrMaterialUniforms(t){const{model:e}=this.state;if(e){const{mesh:n}=this.props,r=this.parseMaterial(t,n);e.setUniforms(r.uniforms)}}parseMaterial(t,e){const n=Boolean(t.pbrMetallicRoughness&&t.pbrMetallicRoughness.baseColorTexture);return new ee.Z(this.context.gl,{attributes:{NORMAL:e.attributes.normals,TEXCOORD_0:e.attributes.texCoords},material:{unlit:n,...t},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(t){const{featureIds:e}=this.props,n=new Uint8ClampedArray(e.length*t.size),r=[];for(let t=0;t<e.length;t++)this.encodePickingColor(e[t],r),n[3*t]=r[0],n[3*t+1]=r[1],n[3*t+2]=r[2];t.value=n}}oe.layerName="_MeshLayer",oe.defaultProps={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};var se=n(3079),ae=n(7160);const ue=6378137,ce=6378137,le=6356752.314245179,he=(Math.max(ue,ce,le),t=>t),Ae=new E.Z;const fe=new E.Z,pe=new E.Z,de=new E.Z,ge=new E.Z,ye={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},me={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},_e={east:new E.Z,north:new E.Z,up:new E.Z,west:new E.Z,south:new E.Z,down:new E.Z},ve=new E.Z,be=new E.Z,we=new E.Z;function Ee(t,e,n,r,i,o){const s=ye[e]&&ye[e][n];let a,u,c;(0,z.Z)(s&&(!r||r===s));const l=ge.copy(i);if((0,G.fS)(l.x,0,1e-14)&&(0,G.fS)(l.y,0,1e-14)){const t=Math.sign(l.z);a=ve.fromArray(me[e]),"east"!==e&&"west"!==e&&a.scale(t),u=be.fromArray(me[n]),"east"!==n&&"west"!==n&&u.scale(t),c=we.fromArray(me[r]),"east"!==r&&"west"!==r&&c.scale(t)}else{const{up:i,east:o,north:s}=_e;o.set(-l.y,l.x,0).normalize(),t.geodeticSurfaceNormal(l,i),s.copy(i).cross(o);const{down:h,west:A,south:f}=_e;h.copy(i).scale(-1),A.copy(o).scale(-1),f.copy(s).scale(-1),a=_e[e],u=_e[n],c=_e[r]}return o[0]=a.x,o[1]=a.y,o[2]=a.z,o[3]=0,o[4]=u.x,o[5]=u.y,o[6]=u.z,o[7]=0,o[8]=c.x,o[9]=c.y,o[10]=c.z,o[11]=0,o[12]=l.x,o[13]=l.y,o[14]=l.z,o[15]=1,o}const xe=new E.Z,Se=new E.Z,Pe=new E.Z,Te=new E.Z,Ce=new E.Z,Me=new E.Z;let Ie;class Oe{static get WGS84(){return Ie=Ie||new Oe(ue,ce,le),Ie}constructor(t=0,e=0,n=0){(0,z.Z)(t>=0),(0,z.Z)(e>=0),(0,z.Z)(n>=0),this.radii=new E.Z(t,e,n),this.radiiSquared=new E.Z(t*t,e*e,n*n),this.radiiToTheFourth=new E.Z(t*t*t*t,e*e*e*e,n*n*n*n),this.oneOverRadii=new E.Z(0===t?0:1/t,0===e?0:1/e,0===n?0:1/n),this.oneOverRadiiSquared=new E.Z(0===t?0:1/(t*t),0===e?0:1/(e*e),0===n?0:1/(n*n)),this.minimumRadius=Math.min(t,e,n),this.maximumRadius=Math.max(t,e,n),this.centerToleranceSquared=Q.Z.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,e=[0,0,0]){const n=Se,r=Pe,[,,i]=t;this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);const o=Math.sqrt(n.dot(r));return r.scale(1/o),n.scale(i),r.add(n),r.to(e)}cartesianToCartographic(t,e=[0,0,0]){Me.from(t);const n=this.scaleToGeodeticSurface(Me,Te);if(!n)return;const r=this.geodeticSurfaceNormal(n,Se),i=Ce;i.copy(Me).subtract(n);return function(t,e,n=he){return(0,G.kJ)(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}([Math.atan2(r.y,r.x),Math.asin(r.z),Math.sign(ae.AK(i,Me))*ae.kE(i)],e,G.vc._cartographicRadians?he:G.Ux)}eastNorthUpToFixedFrame(t,e=new Ot.Z){return Ee(this,"east","north","up",t,e)}localFrameToFixedFrame(t,e,n,r,i=new Ot.Z){return Ee(this,t,e,n,r,i)}geocentricSurfaceNormal(t,e=[0,0,0]){return xe.from(t).normalize().to(e)}geodeticSurfaceNormalCartographic(t,e=[0,0,0]){const n=function(t,e=Ae){return function(t,e,n=he){return(0,G.kJ)(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}(t,e,G.vc._cartographicRadians?he:G.Yr)}(t),r=n[0],i=n[1],o=Math.cos(i);return xe.set(o*Math.cos(r),o*Math.sin(r),Math.sin(i)).normalize(),xe.to(e)}geodeticSurfaceNormal(t,e=[0,0,0]){return xe.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}scaleToGeodeticSurface(t,e){return function(t,e,n=new E.Z){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:o}=e;fe.from(t);const s=t.x,a=t.y,u=t.z,c=r.x,l=r.y,h=r.z,A=s*s*c*c,f=a*a*l*l,p=u*u*h*h,d=A+f+p,g=Math.sqrt(1/d);if(!Number.isFinite(g))return;const y=pe;if(y.copy(t).scale(g),d<o)return y.to(n);const m=i.x,_=i.y,v=i.z,b=de;b.set(y.x*m*2,y.y*_*2,y.z*v*2);let w,x,S,P,T=(1-g)*t.len()/(.5*b.len()),C=0;do{T-=C,w=1/(1+T*m),x=1/(1+T*_),S=1/(1+T*v);const t=w*w,e=x*x,n=S*S;P=A*t+f*e+p*n-1,C=P/(-2*(A*(t*w)*m+f*(e*x)*_+p*(n*S)*v))}while(Math.abs(P)>Q.Z.EPSILON12);return fe.scale([w,x,S]).to(n)}(t,this,e)}scaleToGeocentricSurface(t,e=[0,0,0]){Te.from(t);const n=Te.x,r=Te.y,i=Te.z,o=this.oneOverRadiiSquared,s=1/Math.sqrt(n*n*o.x+r*r*o.y+i*i*o.z);return Te.multiplyScalar(s).to(e)}transformPositionToScaledSpace(t,e=[0,0,0]){return Te.from(t).scale(this.oneOverRadii).to(e)}transformPositionFromScaledSpace(t,e=[0,0,0]){return Te.from(t).scale(this.radii).to(e)}getSurfaceNormalIntersectionWithZAxis(t,e=0,n=[0,0,0]){(0,z.Z)((0,G.fS)(this.radii.x,this.radii.y,Q.Z.EPSILON15)),(0,z.Z)(this.radii.z>0),Te.from(t);const r=Te.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return Te.set(0,0,r).to(n)}}var Re=n(6269);function Le(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}class Ne{constructor(t,e,n){this.item=t,this.previous=e,this.next=n}}class De{constructor(){this.head=null,this.tail=null,this._length=0}get length(){return this._length}add(t){const e=new Ne(t,this.tail,null);return this.tail?(this.tail.next=e,this.tail=e):(this.head=e,this.tail=e),++this._length,e}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,e){t!==e&&(this.remove(e),this._insert(t,e))}_insert(t,e){const n=t.next;t.next=e,this.tail===t?this.tail=e:n.previous=e,e.next=n,e.previous=t,++this._length}}function Fe(t){return null!=t}class ke{constructor(){(0,Tt.Z)(this,"_list",void 0),(0,Tt.Z)(this,"_sentinel",void 0),(0,Tt.Z)(this,"_trimTiles",void 0),this._list=new De,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const e=t._cacheNode;Fe(e)&&this._list.splice(this._sentinel,e)}add(t,e,n){Fe(e._cacheNode)||(e._cacheNode=this._list.add(e),n&&n(t,e))}unloadTile(t,e,n){const r=e._cacheNode;Fe(r)&&(this._list.remove(r),e._cacheNode=void 0,n&&n(t,e))}unloadTiles(t,e){const n=this._trimTiles;this._trimTiles=!1;const r=this._list,i=1024*t.maximumMemoryUsage*1024,o=this._sentinel;let s=r.head;for(;s!==o&&(t.gpuMemoryUsageInBytes>i||n);){const n=s.item;s=s.next,this.unloadTile(t,n,e)}}trim(){this._trimTiles=!0}}const Be=new E.Z,je=new E.Z,Ue=new Y([new H,new H,new H,new H,new H,new H]);function ze(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:o}=t.distanceScales,s=[t.longitude,t.latitude,0],a=Oe.WGS84.cartographicToCartesian(s,new E.Z),u=Oe.WGS84.eastNorthUpToFixedFrame(a),c=t.unprojectPosition(t.cameraPosition),l=Oe.WGS84.cartographicToCartesian(c,new E.Z),h=new E.Z(u.transformAsVector(new E.Z(n).scale(o))).normalize(),A=new E.Z(u.transformAsVector(new E.Z(r).scale(o))).normalize();return function(t,e){const n=t.getFrustumPlanes();let r=0;for(const i in n){const o=n[i],s=o.normal.dot(t.center);je.copy(o.normal).scale(o.distance-s).add(t.center);const a=t.unprojectPosition(je),u=Oe.WGS84.cartographicToCartesian(a,new E.Z);Ue.planes[r++].fromPointNormal(u,Be.copy(e).subtract(u))}}(t,a),{camera:{position:l,direction:h,up:A},viewport:t,height:i,cullingVolume:Ue,frameNumber:e,sseDenominator:1.15}}const Ge=6356752.314245179,Ve=new E.Z;const Ze="scenegraph",He="pointcloud",qe="I3S",We="TILES3D",Xe="geometricError";function Ye(t){return null!=t}const Qe=new E.Z,Ke=new E.Z,Je=new E.Z;function $e(t,e,n){if((0,Re.h)(t,"3D Tile: boundingVolume must be defined"),t.box)return function(t,e,n){const r=new E.Z(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(10===t.length){const e=t.slice(3,6),n=new R.Z;n.fromArray(t,6);const r=new E.Z([1,0,0]),o=new E.Z([0,1,0]),s=new E.Z([0,0,1]);r.transformByQuaternion(n),r.scale(e[0]),o.transformByQuaternion(n),o.scale(e[1]),s.transformByQuaternion(n),s.scale(e[2]),i=[...r.toArray(),...o.toArray(),...s.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const o=e.transformAsVector(i.slice(0,3)),s=e.transformAsVector(i.slice(3,6)),a=e.transformAsVector(i.slice(6,9)),u=new O.Z([o[0],o[1],o[2],s[0],s[1],s[2],a[0],a[1],a[2]]);return Ye(n)?(n.center=r,n.halfAxes=u,n):new U(r,u)}(t.box,e,n);if(t.region){const[e,n,r,i,o,s]=t.region,a=Oe.WGS84.cartographicToCartesian([(0,G.RW)(e),(0,G.RW)(i),o],Ke),u=Oe.WGS84.cartographicToCartesian([(0,G.RW)(r),(0,G.RW)(n),s],Je),c=(new E.Z).addVectors(a,u).multiplyScalar(.5),l=(new E.Z).subVectors(a,u).len()/2;return tn([c[0],c[1],c[2],l],new Ot.Z)}if(t.sphere)return tn(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function tn(t,e,n){const r=new E.Z(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(Qe),o=Math.max(Math.max(i[0],i[1]),i[2]),s=t[3]*o;return Ye(n)?(n.center=r,n.radius=s,n):new I(r,s)}new E.Z,new E.Z,new Ot.Z,new E.Z,new E.Z,new E.Z;const en=6378137,nn=Math.PI/2;function rn([t,e,n]){const r=(0,G.Yr)(t),i=(0,G.Yr)(e),o=1+n/en,s=o*Math.cos(i);return[t=s*Math.cos(r),e=s*Math.sin(r),n=o*Math.sin(i)]}function on(t,e){const[n,r,i=0]=t,[o,s,a=0]=e,u=rn([o,s,a]),c=rn([n,r,i]),l=c[0]-u[0],h=c[1]-u[1],A=c[2]-u[2];return l*l+h*h+A*A}function sn(t,e){const n=e.viewport,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],s=t.header.mbs[3],a=[i,r,o],u=on(n.unprojectPosition(n.cameraPosition),a),c=s/en,l=u-c*c;return l<=0?170141175e30:function(t){const{projectionMatrix:e}=t.viewport;return e[5]}(e)*c/Math.sqrt(l)*300}class an{constructor(t=0){this._array=new Array(t),this._map=new Map,this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return(0,Re.h)(t<this._array.length),this._array[t]}set(t,e){(0,Re.h)(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=e,this._map.set(e,t)}delete(t){const e=this._map.get(t);e>=0&&(this._array.splice(e,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const e=this.length++;this._array[e]=t,this._map.set(t,e)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){(0,Re.h)(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){(0,Re.h)(t>=0),this.length=t}trim(t){null==t&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const un={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class cn{constructor(t){(0,Tt.Z)(this,"options",void 0),(0,Tt.Z)(this,"root",void 0),(0,Tt.Z)(this,"requestedTiles",void 0),(0,Tt.Z)(this,"selectedTiles",void 0),(0,Tt.Z)(this,"emptyTiles",void 0),(0,Tt.Z)(this,"_traversalStack",void 0),(0,Tt.Z)(this,"_emptyTraversalStack",void 0),(0,Tt.Z)(this,"_frameNumber",void 0),this.options={...un,...t},this._traversalStack=new an,this._emptyTraversalStack=new an,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}traverse(t,e,n){this.root=t,this.options={...this.options,...n},this.reset(),this.updateTile(t,e),this._frameNumber=e.frameNumber,this.executeTraversal(t,e)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,e){const n=this._traversalStack;for(t._selectionDepth=1,n.push(t);n.length>0;){const t=n.pop();let r=!1;this.canTraverse(t,e)&&(this.updateChildTiles(t,e),r=this.updateAndPushChildren(t,e,n,t.hasRenderContent?t._selectionDepth+1:t._selectionDepth));const i=t.parent,o=Boolean(!i||i._shouldRefine),s=!r;t.hasRenderContent?1===t.refine?(this.loadTile(t,e),this.selectTile(t,e)):2===t.refine&&(this.loadTile(t,e),s&&this.selectTile(t,e)):(this.emptyTiles[t.id]=t,this.loadTile(t,e),s&&this.selectTile(t,e)),this.touchTile(t,e),t._shouldRefine=r&&o}this.options.onTraversalEnd(e)}updateChildTiles(t,e){const n=t.children;for(const t of n)this.updateTile(t,e);return!0}updateAndPushChildren(t,e,n,r){const{loadSiblings:i,skipLevelOfDetail:o}=this.options,s=t.children;s.sort(this.compareDistanceToCamera.bind(this));const a=2===t.refine&&t.hasRenderContent&&!o;let u=!1,c=!0;for(const t of s)if(t._selectionDepth=r,t.isVisibleAndInRequestVolume?(n.find(t)&&n.delete(t),n.push(t),u=!0):(a||i)&&(this.loadTile(t,e),this.touchTile(t,e)),a){let n;if(n=!!t._inRequestVolume&&(t.hasRenderContent?t.contentAvailable:this.executeEmptyTraversal(t,e)),c=c&&n,!c)return!1}return u||(c=!1),c}updateTile(t,e){this.updateTileVisibility(t,e)}selectTile(t,e){this.shouldSelectTile(t)&&(t._selectedFrame=e.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,e){this.shouldLoadTile(t)&&(t._requestedFrame=e.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,e){t.tileset._cache.touch(t),t._touchedFrame=e.frameNumber}canTraverse(t,e,n=!1,r=!1){return!!t.hasChildren&&(t.hasTilesetContent?!t.contentExpired:!(!r&&!t.isVisibleAndInRequestVolume)&&this.shouldRefine(t,e,n))}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,e,n){let r=t._screenSpaceError;return n&&(r=t.getScreenSpaceError(e,!0)),r>this.options.maximumScreenSpaceError}updateTileVisibility(t,e){const n=[];if(this.options.viewportTraversersMap)for(const t in this.options.viewportTraversersMap)this.options.viewportTraversersMap[t]===e.viewport.id&&n.push(t);else n.push(e.viewport.id);t.updateVisibility(e,n)}compareDistanceToCamera(t,e){return t._distanceToCamera-e._distanceToCamera}anyChildrenVisible(t,e){let n=!1;for(const r of t.children)r.updateVisibility(e),n=n||r.isVisibleAndInRequestVolume;return n}executeEmptyTraversal(t,e){let n=!0;const r=this._emptyTraversalStack;for(r.push(t);r.length>0&&n;){const t=r.pop();if(this.updateTile(t,e),t.isVisibleAndInRequestVolume||this.loadTile(t,e),this.touchTile(t,e),!t.hasRenderContent&&this.canTraverse(t,e,!1,!0)){const e=t.children;for(const t of e)r.find(t)&&r.delete(t),r.push(t)}else t.contentAvailable||(n=!1)}return n}}const ln=new E.Z;class hn{constructor(t,e,n,r=""){(0,Tt.Z)(this,"tileset",void 0),(0,Tt.Z)(this,"header",void 0),(0,Tt.Z)(this,"id",void 0),(0,Tt.Z)(this,"url",void 0),(0,Tt.Z)(this,"parent",void 0),(0,Tt.Z)(this,"refine",void 0),(0,Tt.Z)(this,"type",void 0),(0,Tt.Z)(this,"contentUrl",void 0),(0,Tt.Z)(this,"lodMetricType",void 0),(0,Tt.Z)(this,"lodMetricValue",void 0),(0,Tt.Z)(this,"boundingVolume",void 0),(0,Tt.Z)(this,"content",void 0),(0,Tt.Z)(this,"contentState",void 0),(0,Tt.Z)(this,"gpuMemoryUsageInBytes",void 0),(0,Tt.Z)(this,"children",void 0),(0,Tt.Z)(this,"depth",void 0),(0,Tt.Z)(this,"viewportIds",void 0),(0,Tt.Z)(this,"transform",void 0),(0,Tt.Z)(this,"userData",void 0),(0,Tt.Z)(this,"computedTransform",void 0),(0,Tt.Z)(this,"hasEmptyContent",void 0),(0,Tt.Z)(this,"hasTilesetContent",void 0),(0,Tt.Z)(this,"traverser",void 0),(0,Tt.Z)(this,"_cacheNode",void 0),(0,Tt.Z)(this,"_frameNumber",void 0),(0,Tt.Z)(this,"_lodJudge",void 0),(0,Tt.Z)(this,"_expireDate",void 0),(0,Tt.Z)(this,"_expiredContent",void 0),(0,Tt.Z)(this,"_shouldRefine",void 0),(0,Tt.Z)(this,"_distanceToCamera",void 0),(0,Tt.Z)(this,"_centerZDepth",void 0),(0,Tt.Z)(this,"_screenSpaceError",void 0),(0,Tt.Z)(this,"_visibilityPlaneMask",void 0),(0,Tt.Z)(this,"_visible",void 0),(0,Tt.Z)(this,"_inRequestVolume",void 0),(0,Tt.Z)(this,"_stackLength",void 0),(0,Tt.Z)(this,"_selectionDepth",void 0),(0,Tt.Z)(this,"_touchedFrame",void 0),(0,Tt.Z)(this,"_visitedFrame",void 0),(0,Tt.Z)(this,"_selectedFrame",void 0),(0,Tt.Z)(this,"_requestedFrame",void 0),(0,Tt.Z)(this,"_priority",void 0),(0,Tt.Z)(this,"_contentBoundingVolume",void 0),(0,Tt.Z)(this,"_viewerRequestVolume",void 0),(0,Tt.Z)(this,"_initialTransform",void 0),this.header=e,this.tileset=t,this.id=r||e.id,this.url=e.url,this.parent=n,this.refine=this._getRefine(e.refine),this.type=e.type,this.contentUrl=e.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=0,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new cn({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new Ot.Z,this.transform=new Ot.Z,this._initializeLodMetric(e),this._initializeTransforms(e),this._initializeBoundingVolumes(e),this._initializeContent(e),this._initializeRenderingState(e),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}destroy(){this.header=null}isDestroyed(){return null===this.header}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return 3===this.contentState||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return 0===this.contentState}get contentExpired(){return 4===this.contentState}get contentFailed(){return 5===this.contentState}getScreenSpaceError(t,e){switch(this.tileset.type){case qe:return sn(this,t);case We:return function(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(0===o)return 0;const s=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:u}=e,{viewDistanceScale:c}=r.options;let l=o*a*(c||1)/(s*u);return l-=function(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return function(t,e){const n=t*e;return 1-Math.exp(-n*n)}(e,n)*r}return 0}(r,s),l}(this,t,e);default:throw new Error("Unsupported tileset type")}}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:e}=t.options,n=1===this.refine||e;if(n&&!this.isVisible&&void 0!==this._visible)return-1;if(this.tileset._frameNumber-this._touchedFrame>=1)return-1;if(0===this.contentState)return-1;const r=this.parent,i=!r||n&&0!==this._screenSpaceError&&!r.hasTilesetContent?this._screenSpaceError:r._screenSpaceError,o=t.root?t.root._screenSpaceError:0;return Math.max(o-i,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=1;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=0,!1;try{const e=this.tileset.getTileUrl(this.contentUrl),n=this.tileset.loader,r={...this.tileset.loadOptions,[n.id]:{...this.tileset.loadOptions[n.id],isTileset:"json"===this.type,...this._getLoaderSpecificOptions(n.id)}};return this.content=await(0,se.z)(e,n,r),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=3,this._onContentLoaded(),!0}catch(t){throw this.contentState=5,t}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=0,!0}updateVisibility(t,e){if(this._frameNumber===t.frameNumber)return;const n=this.parent,r=n?n._visibilityPlaneMask:Y.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const t=n?n.computedTransform:this.tileset.modelMatrix;this._updateTransform(t)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,r),this._visible=this._visibilityPlaneMask!==Y.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=e}visibility(t,e){const{cullingVolume:n}=t,{boundingVolume:r}=this;return n.computeVisibilityWithPlaneMask(r,e)}contentVisibility(){return!0}distanceToTile(t){const e=this.boundingVolume;return Math.sqrt(Math.max(e.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth({camera:t}){const e=this.boundingVolume;return ln.subVectors(e.center,t.position),t.direction.dot(ln)}insideViewerRequestVolume(t){const e=this._viewerRequestVolume;return!e||e.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(function(t){return null!=t}(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=4,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new Ot.Z(t.transform):new Ot.Z;const e=this.parent,n=this.tileset,r=e&&e.computedTransform?e.computedTransform.clone():n.modelMatrix.clone();this.computedTransform=new Ot.Z(r).multiplyRight(this.transform);const i=e&&e._initialTransform?e._initialTransform.clone():new Ot.Z;this._initialTransform=new Ot.Z(i).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=0,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Y.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||2}_isTileset(){return-1!==this.contentUrl.indexOf(".json")}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0}this._isTileset()&&(this.hasTilesetContent=!0)}_updateBoundingVolume(t){this.boundingVolume=$e(t.boundingVolume,this.computedTransform,this.boundingVolume);const e=t.content;e&&(e.boundingVolume&&(this._contentBoundingVolume=$e(e.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=$e(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(t=new Ot.Z){const e=t.clone().multiplyRight(this.transform);!e.equals(this.computedTransform)&&(this.computedTransform=e,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return{assetGltfUpAxis:(e=this.tileset.tileset).asset&&e.asset.gltfUpAxis||"Y"}}var e}}class An extends cn{compareDistanceToCamera(t,e){return 0===e._distanceToCamera&&0===t._distanceToCamera?e._centerZDepth-t._centerZDepth:e._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,e){if(super.updateTileVisibility(t,e),!t.isVisibleAndInRequestVolume)return;const n=t.children.length>0;if(t.hasTilesetContent&&n){const n=t.children[0];return this.updateTileVisibility(n,e),void(t._visible=n._visible)}if(this.meetsScreenSpaceErrorEarly(t,e))return void(t._visible=!1);const r=2===t.refine,i=1===t._optimChildrenWithinParent;r&&i&&n&&!this.anyChildrenVisible(t,e)&&(t._visible=!1)}meetsScreenSpaceErrorEarly(t,e){const{parent:n}=t;return!(!n||n.hasTilesetContent||1!==n.refine||this.shouldRefine(t,e,!0))}}class fn{constructor(){(0,Tt.Z)(this,"_statusMap",void 0),this._statusMap={}}add(t,e,n,r){this._statusMap[e]||(this._statusMap[e]={request:t,callback:n,key:e,frameState:r,status:"REQUESTED"},t().then((t=>{this._statusMap[e].status="COMPLETED",this._statusMap[e].callback(t,r)})).catch((t=>{this._statusMap[e].status="ERROR",n(t)})))}update(t,e){this._statusMap[t]&&(this._statusMap[t].frameState=e)}find(t){return this._statusMap[t]}}class pn extends cn{constructor(t){super(t),(0,Tt.Z)(this,"_tileManager",void 0),this._tileManager=new fn}shouldRefine(t,e){return t._lodJudge=function(t,e){const n=e.viewport,r=n.metersPerPixel,i=t.header.mbs[1],o=t.header.mbs[0],s=t.header.mbs[2],a=t.header.mbs[3],{height:u,width:c,latitude:l,longitude:h}=n,A=[h,l],f=[o,i,s],p=[h,i],d=[o,l],g=Math.sqrt(u*u+c*c)*r[0],y=on(A,f),m=.5*u+a/en,_=.5*c+a/en;if(y>g+a/en)return"OUT";if(on(A,p)>m)return"OUT";if(on(A,d)>_)return"OUT";if(0===t.lodMetricValue)return"DIG";let v=sn(t,e);return v*=nn,v<.5?"OUT":!t.header.children||v<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}(t,e),"DIG"===t._lodJudge}updateChildTiles(t,e){const n=t.header.children||[],r=t.children,i=t.tileset;for(const o of n){const n=`${o.id}-${e.viewport.id}`,s=r&&r.find((t=>t.id===n));if(s)s&&this.updateTile(s,e);else{let r=()=>this._loadTile(o.id,i);this._tileManager.find(n)?this._tileManager.update(n,e):(i.tileset.nodePages&&(r=()=>i.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(r,n,(e=>this._onTileLoad(e,t,n)),e))}}return!1}async _loadTile(t,e){const{loader:n}=e,r=e.getTileUrl(`${e.url}/nodes/${t}`),i={...e.loadOptions,i3s:{...e.loadOptions.i3s,isTileHeader:!0,loadContent:!1}};return await(0,se.z)(r,n,i)}_onTileLoad(t,e,n){const r=new hn(e.tileset,t,e,n);e.children.push(r);const i=this._tileManager.find(r.id).frameState;this.updateTile(r,i),this._frameNumber===i.frameNumber&&this.executeTraversal(r,i)}}const dn={description:"",ellipsoid:Oe.WGS84,modelMatrix:new Ot.Z,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},gn="Tiles In Tileset(s)",yn="Tiles In Memory",mn="Tiles In View",_n="Tiles To Render",vn="Tiles Loaded",bn="Tiles Loading",wn="Tiles Unloaded",En="Failed Tile Loads",xn="Points",Sn="Tile Memory Use";class Pn{constructor(t,e){(0,Tt.Z)(this,"options",void 0),(0,Tt.Z)(this,"loadOptions",void 0),(0,Tt.Z)(this,"type",void 0),(0,Tt.Z)(this,"tileset",void 0),(0,Tt.Z)(this,"loader",void 0),(0,Tt.Z)(this,"url",void 0),(0,Tt.Z)(this,"basePath",void 0),(0,Tt.Z)(this,"modelMatrix",void 0),(0,Tt.Z)(this,"ellipsoid",void 0),(0,Tt.Z)(this,"lodMetricType",void 0),(0,Tt.Z)(this,"lodMetricValue",void 0),(0,Tt.Z)(this,"refine",void 0),(0,Tt.Z)(this,"root",void 0),(0,Tt.Z)(this,"roots",void 0),(0,Tt.Z)(this,"asset",void 0),(0,Tt.Z)(this,"description",void 0),(0,Tt.Z)(this,"properties",void 0),(0,Tt.Z)(this,"extras",void 0),(0,Tt.Z)(this,"attributions",void 0),(0,Tt.Z)(this,"credits",void 0),(0,Tt.Z)(this,"stats",void 0),(0,Tt.Z)(this,"traverseCounter",void 0),(0,Tt.Z)(this,"geometricError",void 0),(0,Tt.Z)(this,"selectedTiles",void 0),(0,Tt.Z)(this,"cartographicCenter",void 0),(0,Tt.Z)(this,"cartesianCenter",void 0),(0,Tt.Z)(this,"zoom",void 0),(0,Tt.Z)(this,"boundingVolume",void 0),(0,Tt.Z)(this,"gpuMemoryUsageInBytes",void 0),(0,Tt.Z)(this,"dynamicScreenSpaceErrorComputedDensity",void 0),(0,Tt.Z)(this,"_traverser",void 0),(0,Tt.Z)(this,"_cache",void 0),(0,Tt.Z)(this,"_requestScheduler",void 0),(0,Tt.Z)(this,"_frameNumber",void 0),(0,Tt.Z)(this,"_queryParamsString",void 0),(0,Tt.Z)(this,"_queryParams",void 0),(0,Tt.Z)(this,"_extensionsUsed",void 0),(0,Tt.Z)(this,"_tiles",void 0),(0,Tt.Z)(this,"_pendingCount",void 0),(0,Tt.Z)(this,"lastUpdatedVieports",void 0),(0,Tt.Z)(this,"_requestedTiles",void 0),(0,Tt.Z)(this,"_emptyTiles",void 0),(0,Tt.Z)(this,"frameStateData",void 0),(0,Tt.Z)(this,"maximumMemoryUsage",void 0),(0,Re.h)(t),this.options={...dn,...e},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||Le(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new ke,this._requestScheduler=new It({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new Ct.Z({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return 0===this._pendingCount&&0!==this._frameNumber}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return this._queryParamsString||(this._queryParamsString=function(t){const e=[];for(const n of Object.keys(t))e.push(`${n}=${t[n]}`);switch(e.length){case 0:return"";case 1:return`?${e[0]}`;default:return`?${e.join("&")}`}}(this._queryParams)),this._queryParamsString}setProps(t){this.options={...this.options,...t}}setOptions(t){this.options={...this.options,...t}}getTileUrl(t){return t.startsWith("data:")?t:`${t}${this.queryParams}`}hasExtension(t){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(t)>-1)}update(t){if("loadTiles"in this.options&&!this.options.loadTiles)return;if(this.traverseCounter>0)return;!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t instanceof Array||(t=[t]),this._cache.reset(),this._frameNumber++,this.traverseCounter=t.length;const e=[];for(const n of t){const t=n.id;this._needTraverse(t)?e.push(t):this.traverseCounter--}for(const n of t){const t=n.id;if(this.roots[t]||(this.roots[t]=this._initializeTileHeaders(this.tileset,null)),!e.includes(t))continue;const r=ze(n,this._frameNumber);this._traverser.traverse(this.roots[t],r,this.options)}}_needTraverse(t){let e=t;return this.options.viewportTraversersMap&&(e=this.options.viewportTraversersMap[t]),e===t}_onTraversalEnd(t){const e=t.viewport.id;this.frameStateData[e]||(this.frameStateData[e]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const n=this.frameStateData[e],r=Object.values(this._traverser.selectedTiles);n.selectedTiles=r,n._requestedTiles=Object.values(this._traverser.requestedTiles),n._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,this.traverseCounter>0||this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const e=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(e.selectedTiles),this._requestedTiles=this._requestedTiles.concat(e._requestedTiles),this._emptyTiles=this._emptyTiles.concat(e._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,e){if(t.length!==e.length)return!0;const n=new Set(t.map((t=>t.id))),r=new Set(e.map((t=>t.id)));let i=t.filter((t=>!r.has(t.id))).length>0;return i=i||e.filter((t=>!n.has(t.id))).length>0,i}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,((t,e)=>t._unloadTile(e)))}_updateStats(){let t=0,e=0;for(const n of this.selectedTiles)n.contentAvailable&&n.content&&(t++,n.content.pointCount&&(e+=n.content.pointCount));this.stats.get(mn).count=this.selectedTiles.length,this.stats.get(_n).count=t,this.stats.get(xn).count=e}_initializeTileSet(t){this.root=this._initializeTileHeaders(t,null),this.type===We&&this._initializeCesiumTileset(t),this.type===qe&&this._initializeI3STileset(),this._calculateViewProps()}_calculateViewProps(){const t=this.root;(0,Re.h)(t);const{center:e}=t.boundingVolume;if(!e)return console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new E.Z,void(this.zoom=1);this.cartographicCenter=Oe.WGS84.cartesianToCartographic(e,new E.Z),this.cartesianCenter=e,this.zoom=function(t){const{halfAxes:e,radius:n,width:r,height:i}=t;if(e){const t=function(t){t.getColumn(0,Ve);const e=t.getColumn(1),n=t.getColumn(2);return Ve.add(e).add(n).len()}(e);return Math.log2(Ge/t)}return n?Math.log2(Ge/n):i&&r?(Math.log2(6378137/r)+Math.log2(6378137/i))/2:1}(t.boundingVolume)}_initializeStats(){this.stats.get(gn),this.stats.get(bn),this.stats.get(yn),this.stats.get(mn),this.stats.get(_n),this.stats.get(vn),this.stats.get(wn),this.stats.get(En),this.stats.get(xn,"memory"),this.stats.get(Sn,"memory")}_initializeTileHeaders(t,e){const n=new hn(this,t.root,e);if(e&&(e.children.push(n),n.depth=e.depth+1),this.type===We){const t=[];for(t.push(n);t.length>0;){const e=t.pop();this.stats.get(gn).incrementCount();const n=e.header.children||[];for(const r of n){const n=new hn(this,r,e);e.children.push(n),n.depth=e.depth+1,t.push(n)}}}return n}_initializeTraverser(){let t;switch(this.type){case We:t=An;break;case qe:t=pn;break;default:t=cn}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let e;try{this._onStartTileLoading(),e=await t.loadContent()}catch(e){this._onTileLoadError(t,e)}finally{this._onEndTileLoading(),this._onTileLoad(t,e)}}_onTileLoadError(t,e){this.stats.get(En).incrementCount();const n=e.message||e.toString(),r=t.url;console.error(`A 3D tile failed to load: ${t.url} ${n}`),this.options.onTileError(t,n,r)}_onTileLoad(t,e){e&&(t&&t.content&&function(t,e){(0,Re.h)(t),(0,Re.h)(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:o}}=t;let s=new Ot.Z(i);switch(n&&s.translate(n),r){case"Z":break;case"Y":const t=(new Ot.Z).rotateX(Math.PI/2);s=s.multiplyRight(t);break;case"X":const e=(new Ot.Z).rotateY(-Math.PI/2);s=s.multiplyRight(e)}e.isQuantized&&s.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new E.Z(o);e.cartesianModelMatrix=s,e.cartesianOrigin=a;const u=Oe.WGS84.cartesianToCartographic(a,new E.Z),c=Oe.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=c.multiplyRight(s),e.cartographicOrigin=u,e.modelMatrix=e.cartographicModelMatrix}(t,t.content),this._addTileToCache(t),this.options.onTileLoad(t))}_onStartTileLoading(){this._pendingCount++,this.stats.get(bn).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(bn).decrementCount()}_addTileToCache(t){this._cache.add(this,t,(e=>e._updateCacheStats(t)))}_updateCacheStats(t){this.stats.get(vn).incrementCount(),this.stats.get(yn).incrementCount(),this.gpuMemoryUsageInBytes+=t.content.byteLength||0,this.stats.get(Sn).count=this.gpuMemoryUsageInBytes}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.content&&t.content.byteLength||0,this.stats.get(yn).decrementCount(),this.stats.get(wn).incrementCount(),this.stats.get(Sn).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const e=t.pop();for(const n of e.children)t.push(n);this._destroyTile(e)}this.root=null}_destroySubtree(t){const e=t,n=[];for(n.push(e);n.length>0;){t=n.pop();for(const e of t.children)n.push(e);t!==e&&this._destroyTile(t)}e.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeCesiumTileset(t){if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if("0.0"!==this.asset.version&&"1.0"!==this.asset.version)throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed,this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const Tn={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"};function Cn(t,e,n){(0,Re.h)(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}Object.keys(Tn);var Mn=n(7718);const In={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},On={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...In},Rn={[In.DOUBLE]:Float64Array,[In.FLOAT]:Float32Array,[In.UNSIGNED_SHORT]:Uint16Array,[In.UNSIGNED_INT]:Uint32Array,[In.UNSIGNED_BYTE]:Uint8Array,[In.BYTE]:Int8Array,[In.SHORT]:Int16Array,[In.INT]:Int32Array},Ln={DOUBLE:In.DOUBLE,FLOAT:In.FLOAT,UNSIGNED_SHORT:In.UNSIGNED_SHORT,UNSIGNED_INT:In.UNSIGNED_INT,UNSIGNED_BYTE:In.UNSIGNED_BYTE,BYTE:In.BYTE,SHORT:In.SHORT,INT:In.INT},Nn="Failed to convert GL type";class Dn{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in Rn)if(Rn[e]===t)return e;throw new Error(Nn)}static fromName(t){const e=Ln[t];if(!e)throw new Error(Nn);return e}static getArrayType(t){switch(t){case In.UNSIGNED_SHORT_5_6_5:case In.UNSIGNED_SHORT_4_4_4_4:case In.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=Rn[t];if(!e)throw new Error(Nn);return e}}static getByteSize(t){return Dn.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(Dn.getArrayType(t))}static createTypedArray(t,e,n=0,r){return void 0===r&&(r=(e.byteLength-n)/Dn.getByteSize(t)),new(Dn.getArrayType(t))(e,n,r)}}class Fn{constructor(t,e){this.json=t,this.buffer=e,this.featuresLength=0,this._cachedTypedArrays={}}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t,e=On.UNSIGNED_INT,n=1){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}getPropertyArray(t,e,n){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=Dn.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}getProperty(t,e,n,r,i){const o=this.json[t];if(!o)return o;const s=this.getPropertyArray(t,e,n);if(1===n)return s[r];for(let t=0;t<n;++t)i[t]=s[n*r+t];return i}_getTypedArrayFromBinary(t,e,n,r,i){const o=this._cachedTypedArrays;let s=o[t];return s||(s=Dn.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),o[t]=s),s}_getTypedArrayFromArray(t,e,n){const r=this._cachedTypedArrays;let i=r[t];return i||(i=Dn.createTypedArray(e,n),r[t]=i),i}}const kn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Bn={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},jn={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}},Un=t=>void 0!==t;function zn(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){const r=t.classIds,i=t.parentCounts,o=t.parentIds,s=t.parentIndexes,a=r.length,u=scratchVisited;u.length=Math.max(u.length,a);const c=++marker,l=scratchStack;for(l.length=0,l.push(e);l.length>0;){if(u[e=l.pop()]===c)continue;u[e]=c;const r=n(t,e);if(Un(r))return r;const a=i[e],h=s[e];for(let t=0;t<a;++t){const n=o[h+t];n!==e&&l.push(n)}}return null}(t,e,n):function(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Un(i))return i;const o=t.parentIds[e];r=o!==e,e=o}throw new Error("traverseHierarchySingleParent")}(t,e,n)}function Gn(t,e,n){const r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,s=t.classIds.length;if(!Un(i))return;assert(e<s,`Parent index ${e} exceeds the total number of instances: ${s}`),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);const a=Un(r)?r[e]:1,u=Un(r)?o[e]:e;for(let r=0;r<a;++r){const o=i[u+r];o!==e&&Gn(t,o,n)}n.pop(e)}function Vn(t){return null!=t}const Zn=(t,e)=>t,Hn={HIERARCHY:!0,extensions:!0,extras:!0};class qn{constructor(t,e,n,r={}){var i;(0,Re.h)(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=(null===(i=this.json)||void 0===i?void 0:i.extensions)||{},this._properties={};for(const t in this.json)Hn[t]||(this._properties[t]=this.json[t]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=function(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){let n,r,i;const o=t.instancesLength,s=t.classes;let a,u=t.classIds,c=t.parentCounts,l=t.parentIds,h=o;if(Un(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),Un(c))for(Un(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,o)),a=new Uint16Array(o),h=0,n=0;n<o;++n)a[n]=h,h+=c[n];Un(l)&&Un(l.byteOffset)&&(l.componentType=defaultValue(l.componentType,GL.UNSIGNED_SHORT),l.type=AttributeType.SCALAR,i=getBinaryAccessor(l),l=i.createArrayBufferView(e.buffer,e.byteOffset+l.byteOffset,h));const A=s.length;for(n=0;n<A;++n){const t=s[n].length,r=s[n].instances,i=getBinaryProperties(t,r,e);s[n].instances=combine(i,r)}const f=new Array(A).fill(0),p=new Uint16Array(o);for(n=0;n<o;++n)r=u[n],p[n]=f[r],++f[r];const d={classes:s,classIds:u,classIndexes:p,parentCounts:c,parentIndexes:a,parentIds:l};return function(t){const e=t.classIds.length;for(let n=0;n<e;++n)Gn(t,n,stack)}(d),d}(r,n):null}(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){return this._checkBatchId(t),(0,Re.h)("string"==typeof e,e),!!this._hierarchy&&Vn(zn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return t.classes[r].name===e})))}isExactClass(t,e){return(0,Re.h)("string"==typeof e,e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),(0,Re.h)("string"==typeof e,e),Vn(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),(e=Vn(e)?e:[]).length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),(0,Re.h)("string"==typeof e,e),this._binaryProperties){const n=this._binaryProperties[e];if(Vn(n))return this._getBinaryProperty(n,t)}const n=this._properties[e];if(Vn(n))return Zn(n[t]);if(this._hierarchy){const n=this._getHierarchyProperty(t,e);if(Vn(n))return n}}setProperty(t,e,n){const r=this.featureCount;if(this._checkBatchId(t),(0,Re.h)("string"==typeof e,e),this._binaryProperties){const r=this._binaryProperties[e];if(r)return void this._setBinaryProperty(r,t,n)}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let i=this._properties[e];Vn(i)||(this._properties[e]=new Array(r),i=this._properties[e]),i[t]=Zn(n)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&(t=t||{},t[e]=r)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;(0,Re.h)(this.binary,`Property ${t} requires a batch table binary.`),(0,Re.h)(n.type,`Property ${t} requires a type.`);const r=function(t,e,n,r){const{componentType:i}=t;(0,Re.h)(t.componentType);const o="string"==typeof i?Dn.fromName(i):i,s=kn[t.type],a=Bn[t.type],u=jn[t.type];return n+=t.byteOffset,{values:Dn.createTypedArray(o,e,n,s*r),type:o,size:s,unpacker:a,packer:u}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=zn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n];return Vn(t.classes[r].instances[e])}));return Vn(n)}_getPropertyNamesInHierarchy(t,e){zn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r].instances;for(const t in i)i.hasOwnProperty(t)&&-1===e.indexOf(t)&&e.push(t)}))}_getHierarchyProperty(t,e){return zn(this._hierarchy,t,((t,n)=>{const r=t.classIds[n],i=t.classes[r],o=t.classIndexes[n],s=i.instances[e];return Vn(s)?Vn(s.typedArray)?this._getBinaryProperty(s,o):Zn(s[o]):null}))}_setHierarchyProperty(t,e,n,r){const i=zn(this._hierarchy,e,((t,i)=>{const o=t.classIds[i],s=t.classes[o],a=t.classIndexes[i],u=s.instances[n];return!!Vn(u)&&((0,Re.h)(i===e,`Inherited property "${n}" is read-only.`),Vn(u.typedArray)?this._setBinaryProperty(u,a,r):u[a]=Zn(r),!0)}));return Vn(i)}}function Wn(t,e,n=0){const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=4,t.version=r.getUint32(n,!0),n+=4,t.byteLength=r.getUint32(n,!0),n+=4,1!==t.version)throw new Error(`3D Tile Version ${t.version} not supported`);return n}const Xn="b3dm tile in legacy format.";function Yn(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let o=r.getUint32(n,!0);n+=4;let s=r.getUint32(n,!0);n+=4;let a=r.getUint32(n,!0);n+=4;let u=r.getUint32(n,!0);return n+=4,a>=570425344?(n-=8,i=o,a=s,u=0,o=0,s=0,console.warn(Xn)):u>=570425344&&(n-=4,i=a,a=o,u=s,o=0,s=0,console.warn(Xn)),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=s,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=u,t.header.batchLength=i,n}function Qn(t,e,n,r){return n=function(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:o,batchLength:s}=t.header;if(t.featureTableJson={BATCH_LENGTH:s||0},i>0){const r=Cn(e,n,i);t.featureTableJson=JSON.parse(r)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,o),n+o}(t,e,n),function(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:o}=t.header;if(i>0){const r=Cn(e,n,i);t.batchTableJson=JSON.parse(r),n+=i,o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}(t,e,n)}function Kn(t,e=[0,0,0]){const n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function Jn(t,e,n){if(!(e||t&&t.batchIds&&n))return null;const{batchIds:r,isRGB565:i,pointCount:o}=t;if(r&&n){const t=new Uint8ClampedArray(3*o);for(let e=0;e<o;e++){const i=r[e],o=n.getProperty(i,"dimensions").map((t=>255*t));t[3*e]=o[0],t[3*e+1]=o[1],t[3*e+2]=o[2]}return{type:On.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}if(i){const t=new Uint8ClampedArray(3*o);for(let n=0;n<o;n++){const r=Kn(e[n]);t[3*n]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]}return{type:On.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}return e&&e.length===3*o?{type:On.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:On.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var $n=n(7069);function tr(t,e=255){return(0,G.uZ)(t,0,e)/e*2-1}function er(t){return t<0?-1:1}function nr(t,e,n){return function(t,e,n,r){if(function(t,e){if(!t)throw new Error("math.gl assertion failed. undefined")}(r),t<0||t>n||e<0||e>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=tr(t,n),r.y=tr(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const t=r.x;r.x=(1-Math.abs(r.y))*er(t),r.y=(1-Math.abs(t))*er(r.y)}return r.normalize()}(t,e,255,n)}new $n.Z,new E.Z,new $n.Z,new $n.Z,new Uint8Array(1);const rr=new E.Z;async function ir(t,e,n,r,i){n=Qn(t,e,n=Yn(t,e,n=Wn(t,e,n))),function(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}(t);const{featureTable:o,batchTable:s}=function(t){const e=new Fn(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",On.FLOAT,3);const r=function(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",On.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:o}=t;n=new qn(i,o,r)}return n}(t,e);return{featureTable:e,batchTable:r}}(t);return await async function(t,e,n,r,i){let o,s,a;const u=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];u&&(a=u.properties);const c=e.getExtension("3DTILES_draco_point_compression");if(c){s=c.properties;const e=c.byteOffset,n=c.byteLength;if(!s||!Number.isFinite(e)||!n)throw new Error("Draco properties, byteOffset, and byteLength must be defined");o=t.featureTableBinary.slice(e,e+n),t.hasPositions=Number.isFinite(s.POSITION),t.hasColors=Number.isFinite(s.RGB)||Number.isFinite(s.RGBA),t.hasNormals=Number.isFinite(s.NORMAL),t.hasBatchIds=Number.isFinite(s.BATCH_ID),t.isTranslucent=Number.isFinite(s.RGBA)}if(!o)return!0;const l={buffer:o,properties:{...s,...a},featureTableProperties:s,batchTableProperties:a,dequantizeInShader:!1};return await async function(t,e,n,r){const{parse:i}=r,o={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete o["3d-tiles"];const s=await i(e.buffer,Mn.VJ,o),a=s.attributes.POSITION&&s.attributes.POSITION.value,u=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,c=s.attributes.NORMAL&&s.attributes.NORMAL.value,l=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=a&&s.attributes.POSITION.value.quantization,A=c&&s.attributes.NORMAL.value.quantization;if(h){const e=s.POSITION.data.quantization,n=e.range;t.quantizedVolumeScale=new E.Z(n,n,n),t.quantizedVolumeOffset=new E.Z(e.minValues),t.quantizedRange=(1<<e.quantizationBits)-1,t.isQuantizedDraco=!0}A&&(t.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const f={};if(e.batchTableProperties)for(const t of Object.keys(e.batchTableProperties))s.attributes[t]&&s.attributes[t].value&&(f[t.toLowerCase()]=s.attributes[t].value);t.attributes={positions:a,colors:Jn(t,u),normals:c,batchIds:l,...f}}(t,l,r,i)}(t,o,0,r,i),function(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",On.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",On.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",On.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",On.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=function(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){const n=new E.Z,r=new Float32Array(3*t.pointCount);for(let i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:On.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(t,o,r),function(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",On.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",On.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",On.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=Jn(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",On.UNSIGNED_BYTE,4))}(t,o,s),function(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",On.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",On.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(3*t.pointsLength);for(let r=0;r<t.pointsLength;r++)nr(e[2*r],e[2*r+1],rr),rr.toArray(n,3*r);return{type:On.FLOAT,size:2,value:n}}return{type:On.FLOAT,size:2,value:e}}(t,n)}}(t,o),n}var or=n(8130),sr=n(4609);function ar(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(0===i)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=(0,sr.qv)(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4==0||console.warn(`${t.type}: embedded glb is not aligned to a 4-byte boundary.`),t.byteOffset+t.byteLength}async function ur(t,e,n,r){const i=n["3d-tiles"]||{};if(function(t,e,n){switch(e){case 0:const e=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),n=(new TextDecoder).decode(e);t.gltfUrl=n.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case 1:break;default:throw new Error("b3dm: Illegal glTF format field")}}(t,e),i.loadGLTF){const{parse:e,fetch:i}=r;t.gltfUrl&&(t.gltfArrayBuffer=await i(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await e(t.gltfArrayBuffer,or.E,n,r),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}async function cr(t,e=0,n,r,i={}){switch(i.byteOffset=e,i.type=function(t,e=0){const n=new DataView(t);return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(t,e),i.type){case Tn.COMPOSITE:return await async function(t,e,n,r,i,o){n=Wn(t,e,n);const s=new DataView(e);for(t.tilesLength=s.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const s={};t.tiles.push(s),n=await o(e,n,r,i,s)}return n}(i,t,e,n,r,cr);case Tn.BATCHED_3D_MODEL:return await async function(t,e,n,r,i){var o;n=function(t,e,n,r,i){n=ar(t,e,n=Qn(t,e,n=Yn(t,e,n=Wn(t,e,n))),r);const o=new Fn(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=o.getGlobalProperty("RTC_CENTER",On.FLOAT,3),n}(t,e,n,r),await ur(t,1,r,i);const s=null==t||null===(o=t.gltf)||void 0===o?void 0:o.extensions;return s&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),n}(i,t,e,n,r);case Tn.INSTANCED_3D_MODEL:return await async function(t,e,n,r,i){return n=function(t,e,n,r,i){if(n=Wn(t,e,n),1!==t.version)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);n=Yn(t,e,n);const o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n=ar(t,e,n=Qn(t,e,n+=4),r),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const s=new Fn(t.featureTableJson,t.featureTableBinary),a=s.getGlobalProperty("INSTANCES_LENGTH");if(s.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");return t.eastNorthUp=s.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=s.getGlobalProperty("RTC_CENTER",On.FLOAT,3),new qn(t.batchTableJson,t.batchTableBinary,a),function(t,e,n,r){const i=[new Array(r),t._batchTable][0],o=new E.Z,s=new E.Z,a=new E.Z,u=new E.Z,c=new O.Z,l=new R.Z,h=new E.Z,A={},f=new Ot.Z,p=[],d=[],g=new E.Z,y=new E.Z;for(let n=0;n<r;n++){let r;if(e.hasProperty("POSITION"))r=e.getProperty("POSITION",On.FLOAT,3,n,o);else if(e.hasProperty("POSITION_QUANTIZED")){r=e.getProperty("POSITION_QUANTIZED",On.UNSIGNED_SHORT,3,n,o);const t=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",On.FLOAT,3,g);if(!t)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",On.FLOAT,3,y);if(!i)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const s=65535;for(let e=0;e<3;e++)r[e]=r[e]/s*i[e]+t[e]}if(!r)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");o.copy(r),A.translation=o,t.normalUp=e.getProperty("NORMAL_UP",On.FLOAT,3,n,p),t.normalRight=e.getProperty("NORMAL_RIGHT",On.FLOAT,3,n,d);const m=!1;if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",On.UNSIGNED_SHORT,2,p),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",On.UNSIGNED_SHORT,2,d),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(Oe.WGS84.eastNorthUpToFixedFrame(o,f),f.getRotationMatrix3(c)):c.identity()}m&&(u.copy(s).cross(a).normalize(),c.setColumn(0,s),c.setColumn(1,a),c.setColumn(2,u)),l.fromMatrix3(c),A.rotation=l,h.set(1,1,1);const _=e.getProperty("SCALE",On.FLOAT,1,n);Number.isFinite(_)&&h.multiplyByScalar(_);const v=e.getProperty("SCALE_NON_UNIFORM",On.FLOAT,3,n,p);v&&h.scale(v),A.scale=h;let b=e.getProperty("BATCH_ID",On.UNSIGNED_SHORT,1,n);void 0===b&&(b=n);const w=(new Ot.Z).fromQuaternion(A.rotation);f.identity(),f.translate(A.translation),f.multiplyRight(w),f.scale(A.scale);const E=f.clone();i[n]={modelMatrix:E,batchId:b}}t.instances=i}(t,s,0,a),n}(t,e,n,r),await ur(t,t.gltfFormat,r,i),n}(i,t,e,n,r);case Tn.POINT_CLOUD:return await ir(i,t,e,n,r);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}function lr(t,e){if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=`${e.basePath}/${n}`}return t.id=t.contentUrl,t.lodMetricType=Xe,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return"empty";const e=t.contentUrl.split(".").pop();switch(e){case"pnts":return He;case"i3dm":case"b3dm":return Ze;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return 2;case"ADD":case"add":return 1;default:return t}}(t.refine),t}const hr={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:"3.0.11",extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:async function(t,e,n){const r=e["3d-tiles"]||{};let i;return i="auto"===r.isTileset?n.url&&-1!==n.url.indexOf(".json"):r.isTileset,t=i?await async function(t,e,n){const r=JSON.parse((new TextDecoder).decode(t));return r.loader=e.loader||hr,r.url=n.url,r.basePath=Le(r.url),r.root=function(t){const e=t.basePath,n=lr(t.root,t),r=[];for(r.push(n);r.length>0;){const t=r.pop().children||[];for(const n of t)lr(n,{basePath:e}),r.push(n)}return n}(r),r.type=We,r.lodMetricType=Xe,r.lodMetricValue=r.root.lodMetricValue,r}(t,e,n):await async function(t,e,n){const r={content:{featureIds:null}};return await cr(t,0,e,n,r.content),r.content}(t,e,n)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}},Ar=[0],fr={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:hr,onTilesetLoad:{type:"function",value:t=>{},compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:(t,e,n)=>{},compare:!1},_getMeshColor:{type:"function",value:t=>[255,255,255],compare:!1}};class pr extends o.Z{initializeState(){"onTileLoadFail"in this.props&&v.Z.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:t}=this.state;return t&&t.isLoaded()}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,oldProps:e,changeFlags:n}){if(t.data&&t.data!==e.data&&this._loadTileset(t.data),n.viewportChanged){const{activeViewports:t}=this.state;Object.keys(t).length&&(this._updateTileset(t),this.state.lastUpdatedViewports=t,this.state.activeViewports={})}if(n.propsChanged){const{layerMap:t}=this.state;for(const e in t)t[e].needsUpdate=!0}}activateViewport(t){const{activeViewports:e,lastUpdatedViewports:n}=this.state;this.internalState.viewport=t,e[t.id]=t;const r=null==n?void 0:n[t.id];r&&t.equals(r)||(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:t,sourceLayer:e}){const{layerMap:n}=this.state,r=e&&e.id;if(r){const e=r.substring(this.id.length+1),i=e.substring(e.indexOf("-")+1);t.object=n[i]&&n[i].tile}return t}filterSubLayer({layer:t,viewport:e}){const{tile:n}=t.props,{id:r}=e;return this.props.visible&&n.selected&&n.viewportIds.includes(r)}_updateAutoHighlight(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}async _loadTileset(t){const{loadOptions:e={}}=this.props;let n=this.props.loader||this.props.loaders;Array.isArray(n)&&(n=n[0]);const r={loadOptions:{...e}};if(n.preload){const i=await n.preload(t,e);i.headers&&(r.loadOptions.fetch={...r.loadOptions.fetch,headers:i.headers}),Object.assign(r,i)}const i=await(0,se.z)(t,n,r.loadOptions),o=new Pn(i,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileLoadFail:this.props.onTileError,...r});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(t){const{lastUpdatedViewports:e}=this.state;this.props.onTileLoad(t),this._updateTileset(e),this.setNeedsUpdate()}_onTileUnload(t){delete this.state.layerMap[t.id],this.props.onTileUnload(t)}_updateTileset(t){const{tileset3d:e}=this.state,{timeline:n}=this.context,r=Object.keys(t).length;if(!n||!r||!e)return;const i=e.update(Object.values(t));this.state.frameNumber!==i&&this.setState({frameNumber:i})}_getSubLayer(t,e){if(!t.content)return null;switch(t.type){case He:return this._makePointCloudLayer(t,e);case Ze:return this._make3DModelLayer(t,e);case"mesh":return this._makeSimpleMeshLayer(t,e);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(t.content.type))}}_makePointCloudLayer(t,e){const{attributes:n,pointCount:r,constantRGBA:i,cartographicOrigin:o,modelMatrix:s}=t.content,{positions:a,normals:u,colors:c}=n;if(!a)return null;const l=e&&e.props.data||{header:{vertexCount:r},attributes:{POSITION:a,NORMAL:u,COLOR_0:c}},{pointSize:h,getPointColor:A}=this.props;return new(this.getSubLayerClass("pointcloud",$t.Z))({pointSize:h},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(t.id),tile:t,data:l,coordinateSystem:Jt.Df.METER_OFFSETS,coordinateOrigin:o,modelMatrix:s,getColor:i||A,_offset:0})}_make3DModelLayer(t){const{gltf:e,instances:n,cartographicOrigin:r,modelMatrix:i}=t.content;return new(this.getSubLayerClass("scenegraph",te.Z))({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(t.id),tile:t,data:n||Ar,scenegraph:e,coordinateSystem:Jt.Df.METER_OFFSETS,coordinateOrigin:r,modelMatrix:i,getTransformMatrix:t=>t.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(t,e){const n=t.content,{attributes:r,indices:i,modelMatrix:o,cartographicOrigin:s,material:a,featureIds:u}=n,{_getMeshColor:c}=this.props,l=e&&e.props.mesh||new Kt.Z({drawMode:4,attributes:dr(r),indices:i});return new(this.getSubLayerClass("mesh",oe))(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(t.id),tile:t,mesh:l,data:Ar,getColor:c(t),pbrMaterial:a,modelMatrix:o,coordinateOrigin:s,coordinateSystem:Jt.Df.METER_OFFSETS,featureIds:u,_offset:0})}renderLayers(){const{tileset3d:t,layerMap:e}=this.state;return t?t.tiles.map((t=>{const n=e[t.id]=e[t.id]||{tile:t};let{layer:r}=n;return t.selected&&(r?n.needsUpdate&&(r=this._getSubLayer(t,r),n.needsUpdate=!1):r=this._getSubLayer(t)),n.layer=r,r})).filter(Boolean):null}}function dr(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}pr.layerName="Tile3DLayer",pr.defaultProps=fr;var gr=n(6935);const yr=[1],mr={...Bt.defaultProps,elevationData:_t,texture:{..._t,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[{name:"Terrain",id:"terrain",module:"terrain",version:"3.0.11",worker:!0,extensions:["png","pngraw"],mimeTypes:["image/png"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}}]};function _r(t){return Array.isArray(t)?t.join(";"):t}class vr extends o.Z{updateState({props:t,oldProps:e}){const n=t.elevationData!==e.elevationData;if(n){const{elevationData:e}=t,n=e&&(Array.isArray(e)||e.includes("{x}")&&e.includes("{y}"));this.setState({isTiled:n})}const r=n||t.meshMaxError!==e.meshMaxError||t.elevationDecoder!==e.elevationDecoder||t.bounds!==e.bounds;if(!this.state.isTiled&&r){const e=this.loadTerrain(t);this.setState({terrain:e})}t.workerUrl&&v.Z.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:t,bounds:e,elevationDecoder:n,meshMaxError:r,signal:i}){var o;if(!t)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?2*r:0,...null===(o=s)||void 0===o?void 0:o.terrain,bounds:e,meshMaxError:r,elevationDecoder:n}};const{fetch:a}=this.props;return a(t,{propName:"elevationData",layer:this,loadOptions:s,signal:i})}getTiledTerrainData(t){const{elevationData:e,fetch:n,texture:r,elevationDecoder:i,meshMaxError:o}=this.props,s=bt(e,t),a=bt(r,t),{bbox:u,signal:c,z:l}=t,h=new gr.Z({longitude:(u.west+u.east)/2,latitude:(u.north+u.south)/2,zoom:l}),A=h.projectFlat([u.west,u.south]),f=h.projectFlat([u.east,u.north]),p=[A[0],A[1],f[0],f[1]],d=this.loadTerrain({elevationData:s,bounds:p,elevationDecoder:i,meshMaxError:o,signal:c}),g=a?n(a,{propName:"texture",layer:this,loaders:[],signal:c}).catch((t=>null)):Promise.resolve(null);return Promise.all([d,g])}renderSubLayers(t){const e=this.getSubLayerClass("mesh",ie.Z),{data:n,color:r}=t;if(!n)return null;const[i,o]=n;return new e(t,{data:yr,mesh:i,texture:o,coordinateSystem:Jt.Df.CARTESIAN,getPosition:t=>[0,0,0],getColor:r})}onViewportLoad(t){if(!t)return;const{zRange:e}=this.state,n=t.map((t=>t.content)).filter(Boolean).map((t=>t[0].header.boundingBox.map((t=>t[2]))));if(0===n.length)return;const r=Math.min(...n.map((t=>t[0]))),i=Math.max(...n.map((t=>t[1])));(!e||r<e[0]||i>e[1])&&this.setState({zRange:[r,i]})}renderLayers(){const{color:t,material:e,elevationData:n,texture:r,wireframe:i,meshMaxError:o,elevationDecoder:s,tileSize:a,maxZoom:u,minZoom:c,extent:l,maxRequests:h,onTileLoad:A,onTileUnload:f,onTileError:p,maxCacheSize:d,maxCacheByteSize:g,refinementStrategy:y}=this.props;return this.state.isTiled?new Bt(this.getSubLayerProps({id:"tiles"}),{wireframe:i,color:t,material:e,getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:_r(n),texture:_r(r),meshMaxError:o,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:a,maxZoom:u,minZoom:c,extent:l,maxRequests:h,onTileLoad:A,onTileUnload:f,onTileError:p,maxCacheSize:d,maxCacheByteSize:g,refinementStrategy:y}):new(this.getSubLayerClass("mesh",ie.Z))(this.getSubLayerProps({id:"mesh"}),{data:yr,mesh:this.state.terrain,texture:r,_instanced:!1,getPosition:t=>[0,0,0],getColor:t,material:e,wireframe:i})}}vr.layerName="TerrainLayer",vr.defaultProps=mr;n(5215);n(3614);function br(t,e){const n=null==e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=Er(t);for(const t of n){let n=0,r=t.featureIds.value[0];for(let i=0;i<t.featureIds.value.length;i++){const o=t.featureIds.value[i];if(o!==r){if(e===t.globalFeatureIds.value[n])return xr(t,n,i);n=i,r=o}}if(e===t.globalFeatureIds.value[n])return xr(t,n,t.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}(t,n):function(t,e){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let i=0;i<n.featureIds.value.length;i++){const o=n.featureIds.value[i];o!==r&&(e.push(xr(n,t,i)),t=i,r=o)}e.push(xr(n,t,n.featureIds.value.length))}return e}(Er(t,e))}(t,null==e?void 0:e.type)}function wr(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,i=Pr(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}(t,e,n);case"LineString":return function(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2))return{type:"LineString",coordinates:Pr(r,i[0],i[1])};const o=[];for(let t=0;t<i.length-1;t++){const e=Pr(r,i[t],i[t+1]);o.push(e)}return{type:"MultiLineString",coordinates:o}}(t,e,n);case"Polygon":return Sr(t,e,n);default:const r=t;throw new Error(`Unsupported geometry type: ${null==r?void 0:r.type}`)}}function Er(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}(t),[t];const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function xr(t,e,n){return{type:"Feature",geometry:wr(t,e,n),properties:function(t,e=0,n){const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const n in t.numericProps)r[n]=t.numericProps[n].value[e];return r}(t,e),...function(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}(t,e)}}function Sr(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),o=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){const t=[];for(let e=0;e<o.length-1;e++){const n=Pr(r,o[e],o[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const s=[];for(let e=0;e<i.length-1;e++){const n=Sr(t,i[e],i[e+1]).coordinates;s.push(n)}return{type:"MultiPolygon",coordinates:s}}function Pr(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const e=Array();for(let n=i*t.size;n<(i+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}var Tr=n(3693);const Cr={clipBounds:[0,0,1,1]},Mr="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",Ir={name:"clip-vs",vs:Mr},Or={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},Rr={name:"clip-fs",fs:Mr},Lr={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class Nr extends Tr.Z{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(t=this.props.clipByInstance),this.state.clipByInstance=t,t?{modules:[Ir],inject:Or}:{modules:[Rr],inject:Lr}}draw({uniforms:t}){const{clipBounds:e=Cr.clipBounds}=this.props;if(this.state.clipByInstance)t.clip_bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),r=this.projectPosition([e[2],e[3],0]);t.clip_bounds=[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0],r[0]),Math.max(n[1],r[1])]}}}Nr.extensionName="ClipExtension",Nr.defaultProps=Cr;const Dr={Point:Fr,MultiPoint:function(t,e,n){return kr(t,e,n)},LineString:Br,MultiLineString:function(t,e,n){return t.map((t=>Br(t,e,n)))},Polygon:jr,MultiPolygon:function(t,e,n){return t.map((t=>jr(t,e,n)))}};function Fr([t,e],[n,r],i){const o=(0,G.t7)(n[0],r[0],t),s=(0,G.t7)(n[1],r[1],e);return i.unprojectFlat([o,s])}function kr(t,e,n){return t.map((t=>Fr(t,e,n)))}function Br(t,e,n){return kr(t,e,n)}function jr(t,e,n){return t.map((t=>kr(t,e,n)))}const Ur=["points","lines","polygons"];function zr(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(r){const e=function(t,e){if(!t.__layers){const e={},{properties:n}=t;for(let t=0;t<n.length;t++){const{layerName:r}=n[t];r&&(e[r]?e[r][1]=t:e[r]=[t,t])}t.__layers=e}return t.__layers[e]}(t,r);if(!e)return-1;o=e[0],s=e[1]+1}let a=-1;if(e in t.numericProps){const r=t.numericProps[e].value.findIndex(((t,e)=>t===n&&i[e]>=o&&i[e]<s));return r>=0?t.globalFeatureIds.value[r]:-1}return a=e?Gr(t.properties,(t=>t[e]===n),o,s):Gr(t.fields,(t=>t.id===n),o,s),a>=0?function(t,e){if(!t.__ids){const e=[],n=t.featureIds.value,r=t.globalFeatureIds.value;for(let t=0;t<n.length;t++)e[n[t]]=r[t];t.__ids=e}return t.__ids[e]}(t,a):-1}function Gr(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const Vr={uniqueIdProperty:{type:"string",value:""},highlightedFeatureId:null,loaders:[{name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.0.11",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null}}}],binary:!1};class Zr extends Bt{initializeState(){super.initializeState(),this.setState({data:null,tileJSON:null})}get isLoaded(){return this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:t,oldProps:e,context:n,changeFlags:r}){r.dataChanged&&this._updateTileData(),this.state.data&&(super.updateState({props:t,oldProps:e,context:n,changeFlags:r}),this._setWGS84PropertyForTiles())}async _updateTileData(){let{data:t}=this.props,e=null;if("string"!=typeof t||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t))t.tilejson&&(e=t);else{const{onDataLoad:n,fetch:r}=this.props;this.setState({data:null,tileJSON:null});try{e=await r(t,{propName:"data",layer:this,loaders:[]})}catch(e){this.raiseError(e,"loading TileJSON"),t=null}n&&n(e)}e&&(t=e.tiles),this.setState({data:t,tileJSON:e})}_getTilesetOptions(t){const e=super._getTilesetOptions(t),{tileJSON:n}=this.state;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>t.minZoom&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(t.maxZoom)||n.maxzoom<t.maxZoom)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){return this.state.data?super.renderLayers():null}getTileData(t){var e;const n=bt(this.state.data,t);if(!n)return Promise.reject("Invalid URL");let r=this.getLoadOptions();const{binary:i,fetch:o}=this.props,{signal:s,x:a,y:u,z:c}=t;return r={...r,mimeType:"application/x-protobuf",mvt:{...null===(e=r)||void 0===e?void 0:e.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:{x:a,y:u,z:c}},gis:i?{format:"binary"}:{}},o(n,{propName:"data",layer:this,loadOptions:r,signal:s})}renderSubLayers(t){const{tile:e}=t,n=Math.pow(2,e.z),r=512/n,i=-r,o=512*e.x/n,s=512*(1-e.y/n),a=(new Ot.Z).scale([r,i,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=a,t.coordinateOrigin=[o,s,0],t.coordinateSystem=Jt.Df.CARTESIAN,t.extensions=[...t.extensions||[],new Nr]);const u=super.renderSubLayers(t);return!this.props.binary||u instanceof _.Z||v.Z.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),u}_updateAutoHighlight(t){const{uniqueIdProperty:e}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:r}=this.state,i=t.object;let o,s;i&&(o=Hr(i,e),s=qr(i)),n===o&&r===s||this.setState({hoveredFeatureId:o,hoveredFeatureLayerName:s})}getPickingInfo(t){const e=super.getPickingInfo(t),n=this.context.viewport.resolution;if(this.props.binary&&-1!==e.index){const{data:n}=t.sourceLayer.props;e.object=br(n,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=Xr(e.object,e.tile.bbox,this.context.viewport)),e}getHighlightedObjectIndex(t){const{hoveredFeatureId:e,hoveredFeatureLayerName:n}=this.state,{uniqueIdProperty:r,highlightedFeatureId:i,binary:o}=this.props,{data:s}=t,a=Wr(i);if(!Wr(e)&&!a)return-1;const u=a?i:e;return Array.isArray(s)?s.findIndex((t=>{const e=Hr(t,r)===u,i=a||qr(t)===n;return e&&i})):s&&o?function(t,e,n,r){for(const i of Ur){const o=t[i]&&zr(t[i],e,n,r);if(o>=0)return o}return-1}(s,r,u,a?"":n):-1}_pickObjects(t){const{deck:e,viewport:n}=this.context,r=n.width,i=n.height,o=n.x,s=n.y,a=[this.id];return e.pickObjects({x:o,y:s,width:r,height:i,layerIds:a,maxObjects:t})}getRenderedFeatures(t=null){const e=this._pickObjects(t),n=new Set,r=[];for(const t of e){const e=Hr(t.object,this.props.uniqueIdProperty);void 0===e?r.push(t.object):n.has(e)||(n.add(e),r.push(t.object))}return r}_setWGS84PropertyForTiles(){const t="dataInWGS84",{tileset:e}=this.state;e.selectedTiles.forEach((e=>{e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:()=>{if(!e.content)return null;if(this.props.binary&&Array.isArray(e.content)&&!e.content.length)return[];if(void 0===e._contentWGS84){const t=this.props.binary?br(e.content):e.content;e._contentWGS84=t.map((t=>Xr(t,e.bbox,this.context.viewport)))}return e._contentWGS84}})}))}}function Hr(t,e){return e?t.properties[e]:"id"in t?t.id:void 0}function qr(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function Wr(t){return null!=t&&""!==t}function Xr(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>function(t,e,n){const r=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return{...t,coordinates:Dr[t.type](t.coordinates,r,n)}}(t.geometry,e,n).coordinates}),r}Zr.layerName="MVTLayer",Zr.defaultProps=Vr},4717:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(4185),i=n(3844),o=n(3117),s=n(1113),a=n(3982);const u=[0,0,0,255],c={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:u},getTargetColor:{type:"accessor",value:u},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class l extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME arc-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec4 instanceSourceColors;\nattribute vec4 instanceTargetColors;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\nattribute float instanceHeights;\nattribute float instanceTilts;\n\nuniform bool greatCircle;\nuniform bool useShortestPath;\nuniform float numSegments;\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nfloat paraboloid(float distance, float sourceZ, float targetZ, float ratio) {\n\n  float deltaZ = targetZ - sourceZ;\n  float dh = distance * instanceHeights;\n  if (dh == 0.0) {\n    return sourceZ + deltaZ * ratio;\n  }\n  float unitZ = deltaZ / dh;\n  float p2 = unitZ * unitZ + 1.0;\n  float dir = step(deltaZ, 0.0);\n  float z0 = mix(sourceZ, targetZ, dir);\n  float r = mix(ratio, 1.0 - ratio, dir);\n  return sqrt(r * (p2 - r)) * dh + z0;\n}\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nfloat getSegmentRatio(float index) {\n  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n}\n\nvec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {\n  float distance = length(source.xy - target.xy);\n  float z = paraboloid(distance, source.z, target.z, segmentRatio);\n\n  float tiltAngle = radians(instanceTilts);\n  vec2 tiltDirection = normalize(target.xy - source.xy);\n  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n\n  return vec3(\n    mix(source.xy, target.xy, segmentRatio) + tilt,\n    z * cos(tiltAngle)\n  );\n}\nfloat getAngularDist (vec2 source, vec2 target) {\n  vec2 sourceRadians = radians(source);\n  vec2 targetRadians = radians(target);\n  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);\n  vec2 shd_sq = sin_half_delta * sin_half_delta;\n\n  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;\n  return 2.0 * asin(sqrt(a));\n}\n\nvec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {\n  vec2 lngLat;\n  if(abs(angularDist - PI) < 0.001) {\n    lngLat = (1.0 - t) * source.xy + t * target.xy;\n  } else {\n    float a = sin((1.0 - t) * angularDist);\n    float b = sin(t * angularDist);\n    vec3 p = source3D.yxz * a + target3D.yxz * b;\n    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));\n  }\n\n  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);\n\n  return vec3(lngLat, z);\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  float segmentIndex = positions.x;\n  float segmentRatio = getSegmentRatio(segmentIndex);\n  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));\n  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));\n  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));\n  isValid = 1.0;\n\n  uv = vec2(segmentRatio, positions.y);\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n\n  vec4 curr;\n  vec4 next;\n  vec3 source;\n  vec3 target;\n\n  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));\n    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));\n    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);\n\n    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);\n    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);\n    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);\n\n    if (abs(currPos.x - prevPos.x) > 180.0) {\n      indexDir = -1.0;\n      isValid = 0.0;\n    } else if (abs(currPos.x - nextPos.x) > 180.0) {\n      indexDir = 1.0;\n      isValid = 0.0;\n    }\n    nextPos = indexDir < 0.0 ? prevPos : nextPos;\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n\n    if (isValid == 0.0) {\n      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;\n      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);\n      currPos = mix(currPos, nextPos, t);\n      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);\n    }\n\n    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);\n    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);\n  \n    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);\n    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));\n  \n  } else {\n    vec3 source_world = instanceSourcePositions;\n    vec3 target_world = instanceTargetPositions;\n    if (useShortestPath) {\n      source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n      target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n\n      float deltaLng = target_world.x - source_world.x;\n      if (deltaLng > 180.) target_world.x -= 360.;\n      if (deltaLng < -180.) source_world.x -= 360.;\n    }\n    source = project_position(source_world, instanceSourcePositions64Low);\n    target = project_position(target_world, instanceTargetPositions64Low);\n    float antiMeridianX = 0.0;\n\n    if (useShortestPath) {\n      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;\n      }\n      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);\n\n      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {\n        isValid = 0.0;\n        indexDir = sign(segmentRatio - thresholdRatio);\n        segmentRatio = thresholdRatio;\n      }\n    }\n\n    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;\n    vec3 currPos = interpolateFlat(source, target, segmentRatio);\n    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);\n\n    if (useShortestPath) {\n      if (nextPos.x < antiMeridianX) {\n        currPos.x += TILE_SIZE;\n        nextPos.x += TILE_SIZE;\n      }\n    }\n\n    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));\n    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));\n    geometry.position = vec4(currPos, 1.0);\n  }\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale),\n    widthMinPixels, widthMaxPixels\n  );\n  vec3 offset = vec3(\n    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);\n  vColor = vec4(color.rgb, color.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME arc-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid == 0.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  geometry.uv = uv;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:u},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:u},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,greatCircle:s,wrapLongitude:a}=this.props,u="pixels"===n?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({greatCircle:s,widthScale:r*u,widthMinPixels:i,widthMaxPixels:o,useShortestPath:a}).draw()}_getModel(t){let e=[];for(let t=0;t<50;t++)e=e.concat([t,1,0,t,-1,0]);const n=new s.Z(t,{...this.getShaders(),id:this.props.id,geometry:new a.Z({drawMode:5,attributes:{positions:new Float32Array(e)}}),isInstanced:!0});return n.setUniforms({numSegments:50}),n}}l.layerName="ArcLayer",l.defaultProps=c},5103:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(1113),u=n(744),c=n(3982),l=n(4538),h=n(5215);class A extends c.Z{constructor(t={}){const{id:e=(0,l.hQ)("column-geometry")}=t,{indices:n,attributes:r}=function(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(u.Z.assert(i.length>=r),i=i.flatMap((t=>[t[0],t[1]])),(0,h.Ny)(i,h.wG.COUNTER_CLOCKWISE));const o=n>0,s=r+1,a=o?3*s+1:r,c=2*Math.PI/r,l=new Uint16Array(o?3*r*2:0),A=new Float32Array(3*a),f=new Float32Array(3*a);let p=0;if(o){for(let t=0;t<s;t++){const o=t*c,s=t%r,a=Math.sin(o),u=Math.cos(o);for(let t=0;t<2;t++)A[p+0]=i?i[2*s]:u*e,A[p+1]=i?i[2*s+1]:a*e,A[p+2]=(.5-t)*n,f[p+0]=i?i[2*s]:u,f[p+1]=i?i[2*s+1]:a,p+=3}A[p+0]=A[p-3],A[p+1]=A[p-2],A[p+2]=A[p-1],p+=3}for(let t=o?0:1;t<s;t++){const o=Math.floor(t/2)*Math.sign(.5-t%2),s=o*c,a=(o+r)%r,u=Math.sin(s),l=Math.cos(s);A[p+0]=i?i[2*a]:l*e,A[p+1]=i?i[2*a+1]:u*e,A[p+2]=n/2,f[p+2]=1,p+=3}if(o){let t=0;for(let e=0;e<r;e++)l[t++]=2*e+0,l[t++]=2*e+2,l[t++]=2*e+0,l[t++]=2*e+1,l[t++]=2*e+1,l[t++]=2*e+3}return{indices:l,attributes:{POSITION:{size:3,value:A},NORMAL:{size:3,value:f}}}}(t);super({...t,id:e,indices:n,attributes:r})}}const f=[0,0,0,255],p={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:f},getLineColor:{type:"accessor",value:f},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class d extends r.Z{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nvarying vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio -= sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n  geometry.pickingColor = instancePickingColors;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec3 centroidPosition64Low = instancePositions64Low;\n  vec3 pos = vec3(project_size(rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius, 0.);\n  DECKGL_FILTER_SIZE(pos, geometry);\n\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n    vColor = vec4(lightColor, color.a * opacity);\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.N,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:f},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:f},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState({props:t,oldProps:e,changeFlags:n}){super.updateState({props:t,oldProps:e,changeFlags:n});const r=n.extensionsChanged;if(r){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}(r||t.diskResolution!==e.diskResolution||t.vertices!==e.vertices||(t.extruded||t.stroked)!==(e.extruded||e.stroked))&&this._updateGeometry(t)}getGeometry(t,e,n){const r=new A({radius:1,height:n?2:0,vertices:e,nradial:t});let i=0;if(e)for(let n=0;n<t;n++){const r=e[n];i+=Math.sqrt(r[0]*r[0]+r[1]*r[1])/t}else i=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*i}),r}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:t,vertices:e,extruded:n,stroked:r}){const i=this.getGeometry(t,e,n||r);this.setState({fillVertexCount:i.attributes.POSITION.value.length/3,wireframeVertexCount:i.indices.value.length}),this.state.model.setProps({geometry:i})}draw({uniforms:t}){const{viewport:e}=this.context,{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:o,elevationScale:s,extruded:a,filled:u,stroked:c,wireframe:l,offset:h,coverage:A,radius:f,angle:p}=this.props,{model:d,fillVertexCount:g,wireframeVertexCount:y,edgeDistance:m}=this.state,_="pixels"===n?e.metersPerPixel:1;d.setUniforms(t).setUniforms({radius:f,angle:p/180*Math.PI,offset:h,extruded:a,coverage:A,elevationScale:s,edgeDistance:m,widthScale:r*_,widthMinPixels:i,widthMaxPixels:o}),a&&l&&(d.setProps({isIndexed:!0}),d.setVertexCount(y).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(d.setProps({isIndexed:!1}),d.setVertexCount(g).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!a&&c&&(d.setProps({isIndexed:!1}),d.setVertexCount(2*g/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}d.layerName="ColumnLayer",d.defaultProps=p},9026:(t,e,n)=>{"use strict";n.d(e,{Z:()=>b});var r=n(8918),i=n(744),o=n(8452),s=n(6867),a=n(8569),u=n(5555),c=n(2112),l=n(1435);const h={circle:{type:a.Z,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s.Z,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:u.Z,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},A={type:c.Z,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",getLineColor:"getColor",getLineWidth:"getWidth"}},f={type:l.Z,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function p({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function d(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function g(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:o=0,endRow:s=t.length}=n;for(let n=o;n<s;n++){const o=t[n];i.Z.assert(o&&o.geometry,"GeoJSON does not have geometry");const{geometry:s}=o;if("GeometryCollection"===s.type){i.Z.assert(Array.isArray(s.geometries),"GeoJSON does not have geometries array");const{geometries:t}=s;for(let i=0;i<t.length;i++)y(t[i],r,e,o,n)}else y(s,r,e,o,n)}return r}function y(t,e,n,r,o){const{type:s,coordinates:a}=t,{pointFeatures:u,lineFeatures:c,polygonFeatures:l,polygonOutlineFeatures:h}=e;if(function(t,e){let n=m[t];for(i.Z.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(s,a))switch(s){case"Point":u.push(n({geometry:t},r,o));break;case"MultiPoint":a.forEach((t=>{u.push(n({geometry:{type:"Point",coordinates:t}},r,o))}));break;case"LineString":c.push(n({geometry:t},r,o));break;case"MultiLineString":a.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"Polygon":l.push(n({geometry:t},r,o)),a.forEach((t=>{h.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"MultiPolygon":a.forEach((t=>{l.push(n({geometry:{type:"Polygon",coordinates:t}},r,o)),t.forEach((t=>{h.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}))}))}else i.Z.warn("".concat(s," coordinates are malformed"))()}const m={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function _(t){return t.geometry.coordinates}const v={...p(h.circle),...p(h.icon),...p(h.text),...p(A),...p(f),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class b extends r.Z{initializeState(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&i.Z.removed("getLineDashArray","PathStyleExtension")()}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let t=0;t<i.length;t++)e(i[t],o),n[r][3*t+0]=o[0],n[r][3*t+1]=o[1],n[r][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(i.Z.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return i.Z.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),r=this.getSubLayerRow.bind(this);let s={};const a={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)s[e]=t[e].slice(),a[e]=[];for(const i of e.dataChanged){const e=g(n,r,i);for(const n in t)a[n].push((0,o.b)({data:s[n],getIndex:t=>t.__source.index,dataRange:i,replace:e[n]}))}}else s=g(n,r);const u=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=_,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=_,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=_,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=_,n}(s,a);this.setState({features:s,featuresDiff:a,layerProps:u})}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n=t.sourceLayer.id.startsWith(e);for(const r of this.getSubLayers())r.id.startsWith(e)===n&&r.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,f.type);if(i){const o=d(this,f.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!t&&e&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,A.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,A.type);if(o||s){const t=d(this,A.props);return[o&&new o(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=e.points.data.findIndex((t=>t.__source.index===r)));const i=new Set(t.split("+")),o=[];for(const t of i){const n="points-".concat(t),i=h[t],s=i&&this.shouldRenderSubLayer(n,e.points.data)&&this.getSubLayerClass(n,i.type);if(s){const t=d(this,i.props);o.push(new s(t,this.getSubLayerProps({id:n,updateTriggers:t.updateTriggers,highlightedObjectIndex:r}),e.points))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:r,index:i}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?function(t,e,n){const r={properties:{...t.properties[e]}};for(const e in t.numericProps)r.properties[e]=t.numericProps[e].value[n];return r}(t,r,n):null}(r,i);return t(o,n)}:super.getSubLayerAccessor(t)}}b.layerName="GeoJsonLayer",b.defaultProps=v},6867:(t,e,n)=>{"use strict";n.d(e,{Z:()=>E});var r=n(4185),i=n(3844),o=n(3117),s=n(744),a=n(1113),u=n(3982),c=n(3296),l=n(1953),h=n(4912),A=n(2378),f=n(3079),p=n(8550);const d=()=>{},g={10241:9987,10240:9729,10242:33071,10243:33071};function y(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function m(t){return t&&(t.id||t.url)}function _(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r];t[m(i)]={...i,x:o,y:n}}}class v{constructor(t,{onUpdate:e=d,onError:n=d}){this.gl=t,this.onUpdate=e,this.onError=n,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?m(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:r,data:i,getIcon:o}){t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&"undefined"!=typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(i))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(t){var e;null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=t,this.onUpdate()}_updateAutoPacking(t){const e=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=(0,p.jB)(t);for(const t of i){o.index++;const i=e(t,o),s=m(i);if(!i)throw new Error("Icon is missing.");if(!i.url)throw new Error("Icon url is missing.");r[s]||n[s]&&i.url===n[s].url||(r[s]={...i,source:t,sourceIndex:o.index})}return r}(t,this._getIcon,this._mapping)||{});if(e.length>0){const{mapping:t,xOffset:n,yOffset:r,rowHeight:i,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let u=0;u<t.length;u++){const c=t[u];if(!n[m(c)]){const{height:t,width:u}=c;r+u+e>s&&(_(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:c,xOffset:r}),r=r+u+e,o=Math.max(o,t)}}return a.length>0&&_(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:(u=o+i+e,Math.pow(2,Math.ceil(Math.log2(u))))};var u}({icons:e,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=t,this._xOffset=n,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new h.Z(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:g})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,r){const i=e.width,o=e.height,s=(0,c.h)(e,{width:n,height:r});return(0,l.Lv)(e,s,{targetY:0,width:i,height:o}),e.delete(),s}(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(e)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,(0,f.z)(n.url,A.S,this._loadOptions).then((t=>{const r=m(n),{x:i,y:o,width:s,height:a}=this._mapping[r],u=y(e,t,s,a);this._texture.setSubImageData({data:u,x:i,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const b=[0,0,0,255],w={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:b},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class E extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.state={iconManager:new v(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:b},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager(),{iconAtlas:i,iconMapping:o,data:s,getIcon:a}=e,{iconManager:u}=this.state;u.setProps({loadOptions:e.loadOptions});let c=!1;if(i||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==e.iconAtlas&&u.setProps({iconAtlas:i,autoPacking:!1}),t.iconMapping!==e.iconMapping&&(u.setProps({iconMapping:o}),c=!0)):u.setProps({autoPacking:!0}),(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&u.setProps({data:s,getIcon:a}),c&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),n.extensionsChanged){var l;const{gl:t}=this.context;null===(l=this.state.model)||void 0===l||l.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,{viewport:u}=this.context,c=a.getTexture();c&&this.state.model.setUniforms(t).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeScale:e*("pixels"===i?u.metersPerPixel:1),sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:e}=this.getCurrentLayer().props;e?e(t):s.Z.error(t.error)()}getInstanceOffset(t){const e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}}E.layerName="IconLayer",E.defaultProps=w},9119:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ArcLayer:()=>r.Z,BitmapLayer:()=>y,ColumnLayer:()=>E.Z,GeoJsonLayer:()=>C.Z,GridCellLayer:()=>S,IconLayer:()=>m.Z,LineLayer:()=>v,PathLayer:()=>P.Z,PointCloudLayer:()=>b.Z,PolygonLayer:()=>T.Z,ScatterplotLayer:()=>w.Z,SolidPolygonLayer:()=>I.Z,TextLayer:()=>M.Z,_MultiIconLayer:()=>O.Z,_TextBackgroundLayer:()=>R.Z});var r=n(4717),i=n(4088),o=n(4185),s=n(3844),a=n(3117),u=n(1113),c=n(3982),l=n(7013),h=n(4034);const A=new Uint16Array([0,2,1,0,3,2]),f=new Float32Array([0,1,0,0,1,0,1,1]);function p(t,e,n){return(0,h.t7)((0,h.t7)(t[0],t[1],n),(0,h.t7)(t[3],t[2],n),e)}const d="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),g={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:i.Df.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class y extends o.Z{getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:d,modules:[s.Z,a.Z]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}const i=this.getAttributeManager();if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo({info:t}){const{image:e}=this.props;if(!t.color||!e)return t.bitmap=null,t;const{width:n,height:r}=e;t.index=0;const i=function(t){const[e,n,r]=t;return[(e+(15&r)/16)/256,(n+(240&r)/256)/256]}(t.color),o=[Math.floor(i[0]*n),Math.floor(i[1]*r)];return t.bitmap={size:{width:n,height:r},uv:i,pixel:o},t}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return Number.isFinite(t[0])&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),function(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:A,texCoords:f}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,s=(i-1)*(o-1)*6,a=new Uint32Array(s),u=new Float32Array(i*o*2),c=new Float64Array(i*o*3);let l=0,h=0;for(let e=0;e<i;e++){const n=e/(i-1);for(let r=0;r<o;r++){const i=r/(o-1),s=p(t,n,i);c[3*l+0]=s[0],c[3*l+1]=s[1],c[3*l+2]=s[2]||0,u[2*l+0]=n,u[2*l+1]=1-i,e>0&&r>0&&(a[h++]=l-o,a[h++]=l-o-1,a[h++]=l-1,a[h++]=l-o,a[h++]=l-1,a[h++]=l),l++}}return{vertexCount:s,positions:c,indices:a,texCoords:u}}(e,this.context.viewport.resolution)}_getModel(t){return t?new u.Z(t,{...this.getShaders(),id:this.props.id,geometry:new c.Z({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:r,coordinateConversion:i,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:u,transparentColor:c,tintColor:l}=this.props;n.pickingActive&&s||a&&r&&r.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:u,transparentColor:c.map((t=>t/255)),tintColor:l.slice(0,3).map((t=>t/255)),coordinateConversion:i,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=i.Df;let{_imageCoordinateSystem:r}=this.props;if(r!==n){const{bounds:n}=this.props;if(!Number.isFinite(n[0]))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const i=this.context.viewport.resolution?t:e;if(r=r===t?t:e,r===t&&i===e)return{coordinateConversion:-1,bounds:n};if(r===e&&i===t){const t=(0,l.w5)([n[0],n[1]]),e=(0,l.w5)([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}y.layerName="BitmapLayer",y.defaultProps=g;var m=n(6867);const _={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:[0,0,0,255]},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class v extends o.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME line-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceSourcePositions;\nattribute vec3 instanceTargetPositions;\nattribute vec3 instanceSourcePositions64Low;\nattribute vec3 instanceTargetPositions64Low;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute float instanceWidths;\n\nuniform float opacity;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float useShortestPath;\n\nvarying vec4 vColor;\nvarying vec2 uv;\nvec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);\n  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);\n\n  return dir_screenspace * offset_direction * width / 2.0;\n}\n\nvec3 splitLine(vec3 a, vec3 b, float x) {\n  float t = (x - a.x) / (b.x - a.x);\n  return vec3(x, mix(a.yz, b.yz, t));\n}\n\nvoid main(void) {\n  geometry.worldPosition = instanceSourcePositions;\n  geometry.worldPositionAlt = instanceTargetPositions;\n\n  vec3 source_world = instanceSourcePositions;\n  vec3 target_world = instanceTargetPositions;\n  vec3 source_world_64low = instanceSourcePositions64Low;\n  vec3 target_world_64low = instanceTargetPositions64Low;\n\n  if (useShortestPath > 0.5 || useShortestPath < -0.5) {\n    source_world.x = mod(source_world.x + 180., 360.0) - 180.;\n    target_world.x = mod(target_world.x + 180., 360.0) - 180.;\n    float deltaLng = target_world.x - source_world.x;\n\n    if (deltaLng * useShortestPath > 180.) {\n      source_world.x += 360. * useShortestPath;\n      source_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      source_world_64low = vec3(0.0);\n    } else if (deltaLng * useShortestPath < -180.) {\n      target_world.x += 360. * useShortestPath;\n      target_world = splitLine(source_world, target_world, 180. * useShortestPath);\n      target_world_64low = vec3(0.0);\n    } else if (useShortestPath < 0.) {\n      gl_Position = vec4(0.);\n      return;\n    }\n  }\n  vec4 source_commonspace;\n  vec4 target_commonspace;\n  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);\n  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);\n  float widthPixels = clamp(\n    project_size_to_pixel(instanceWidths * widthScale),\n    widthMinPixels, widthMaxPixels\n  );\n  float segmentIndex = positions.x;\n  vec4 p = mix(source, target, segmentIndex);\n  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);\n  uv = positions.xy;\n  geometry.uv = uv;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(\n    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),\n    0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME line-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[s.Z,a.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,wrapLongitude:s}=this.props,a="pixels"===n?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({widthScale:r*a,widthMinPixels:i,widthMaxPixels:o,useShortestPath:s?1:0}).draw(),s&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(t){return new u.Z(t,{...this.getShaders(),id:this.props.id,geometry:new c.Z({drawMode:5,attributes:{positions:new Float32Array([0,-1,0,0,1,0,1,-1,0,1,1,0])}}),isInstanced:!0})}}v.layerName="LineLayer",v.defaultProps=_;var b=n(7693),w=n(8569),E=n(5103),x=n(1167);class S extends E.Z{getGeometry(t){return new x.Z}draw({uniforms:t}){const{elevationScale:e,extruded:n,offset:r,coverage:i,cellSize:o,angle:s}=this.props;this.state.model.setUniforms(t).setUniforms({radius:o/2,angle:s,offset:r,extruded:n,coverage:i,elevationScale:e,edgeDistance:1,isWireframe:!1}).draw()}}S.layerName="GridCellLayer",S.defaultProps={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",min:0,value:[1,1]}};var P=n(2112),T=n(3121),C=n(9026),M=n(5555),I=n(1435),O=n(1290),R=n(1130)},2112:(t,e,n)=>{"use strict";n.d(e,{Z:()=>d});var r=n(4185),i=n(3844),o=n(3117),s=n(744),a=n(1113),u=n(3982),c=n(8005),l=n(5215);class h extends c.Z{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):()=>null}normalizeGeometry(t){return this.normalize?function(t,e,n,r){let i=t;if(Array.isArray(t[0])){const n=t.length*e;i=new Array(n);for(let n=0;n<t.length;n++)for(let r=0;r<e;r++)i[n*e+r]=t[n][r]||0}return n?(0,l.dj)(i,{size:e,gridResolution:n}):r?(0,l.ct)(i,{size:e}):i}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}get(t){return this.attributes[t]}getGeometrySize(t){if(Array.isArray(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const{segmentTypes:n}=this.attributes,r=this.isClosed(t),{vertexStart:i,geometrySize:o}=e;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:r,geometrySize:i}=e,o=new Array(3);for(let e=r,s=0;s<i;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}isClosed(t){if(!this.normalize)return this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}const A=[0,0,0,255],f={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:A},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},p={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class d extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.worldPosition = instanceStartPositions;\n  geometry.worldPositionAlt = instanceEndPositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:p,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:p,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:p,defaultValue:A},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new h({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&s.Z.removed("getDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:i.getPath,buffers:i,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{viewport:e}=this.context,{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:u,widthMaxPixels:c}=this.props,l="pixels"===s?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthScale:a*l,miterLimit:o,widthMinPixels:u,widthMaxPixels:c}).draw()}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}d.layerName="PathLayer",d.defaultProps=f},7693:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(1113),u=n(3982);const c=[0,0,0,255],l=[0,0,1],h={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:l},getColor:{type:"accessor",value:c},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class A extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * radiusPixels, 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.N,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:l},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:c}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}n.dataChanged&&function(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(t.data)}draw({uniforms:t}){const{viewport:e}=this.context,{pointSize:n,sizeUnits:r}=this.props,i="meters"===r?1/e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({radiusPixels:n*i}).draw()}_getModel(t){const e=[];for(let t=0;t<3;t++){const n=t/3*Math.PI*2;e.push(2*Math.cos(n),2*Math.sin(n),0)}return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}A.layerName="PointCloudLayer",A.defaultProps=h},3121:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(8918),i=n(744),o=n(8550),s=n(1435),a=n(2112),u=n(9890),c=n(8452);const l=[0,0,0,255],h={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:l},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class A extends r.Z{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&i.Z.removed("getLineDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon);if(r&&Array.isArray(n.dataChanged)){const t=this.state.paths.slice(),e=n.dataChanged.map((e=>(0,c.b)({data:t,getIndex:t=>t.__source.index,dataRange:e,replace:this._getPaths(e)})));this.setState({paths:t,pathsDiff:e})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){const{data:e,getPolygon:n,positionFormat:r,_normalize:i}=this.props,s=[],a="XY"===r?2:3,{startRow:c,endRow:l}=t,{iterable:h,objectInfo:A}=(0,o.jB)(e,c,l);for(const t of h){A.index++;let e=n(t,A);i&&(e=u.F(e,a));const{holeIndices:r}=e,o=e.positions||e;if(r)for(let e=0;e<=r.length;e++){const n=o.slice(r[e-1]||0,r[e]||o.length);s.push(this.getSubLayerRow({path:n},t,A.index))}else s.push(this.getSubLayerRow({path:o},t,A.index))}return s}renderLayers(){const{data:t,_dataDiff:e,stroked:n,filled:r,extruded:i,wireframe:o,_normalize:u,_windingOrder:c,elevationScale:h,transitions:A,positionFormat:f}=this.props,{lineWidthUnits:p,lineWidthScale:d,lineWidthMinPixels:g,lineWidthMaxPixels:y,lineJointRounded:m,lineMiterLimit:_,lineDashJustified:v}=this.props,{getFillColor:b,getLineColor:w,getLineWidth:E,getLineDashArray:x,getElevation:S,getPolygon:P,updateTriggers:T,material:C}=this.props,{paths:M,pathsDiff:I}=this.state,O=this.getSubLayerClass("fill",s.Z),R=this.getSubLayerClass("stroke",a.Z),L=this.shouldRenderSubLayer("fill",M)&&new O({_dataDiff:e,extruded:i,elevationScale:h,filled:r,wireframe:o,_normalize:u,_windingOrder:c,getElevation:S,getFillColor:b,getLineColor:i&&o?w:l,material:C,transitions:A},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:T.getPolygon,getElevation:T.getElevation,getFillColor:T.getFillColor,lineColors:i&&o,getLineColor:T.getLineColor}}),{data:t,positionFormat:f,getPolygon:P});return[!i&&L,!i&&n&&this.shouldRenderSubLayer("stroke",M)&&new R({_dataDiff:I&&(()=>I),widthUnits:p,widthScale:d,widthMinPixels:g,widthMaxPixels:y,jointRounded:m,miterLimit:_,dashJustified:v,_pathType:"loop",transitions:A&&{getWidth:A.getLineWidth,getColor:A.getLineColor,getPath:A.getPolygon},getColor:this.getSubLayerAccessor(w),getWidth:this.getSubLayerAccessor(E),getDashArray:this.getSubLayerAccessor(x)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:T.getLineWidth,getColor:T.getLineColor,getDashArray:T.getLineDashArray}}),{data:M,positionFormat:f,getPath:t=>t.path}),i&&L]}}A.layerName="PolygonLayer",A.defaultProps=h},8569:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(4185),i=n(3844),o=n(3117),s=n(1113),a=n(3982);const u=[0,0,0,255],c={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:u},getLineColor:{type:"accessor",value:u},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class l extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:s,filled:a,billboard:u,antialiasing:c,lineWidthUnits:l,lineWidthScale:h,lineWidthMinPixels:A,lineWidthMaxPixels:f}=this.props,p="pixels"===n?e.metersPerPixel:1,d="pixels"===l?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({stroked:s?1:0,filled:a,billboard:u,antialiasing:c,radiusScale:r*p,radiusMinPixels:i,radiusMaxPixels:o,lineWidthScale:h*d,lineWidthMinPixels:A,lineWidthMaxPixels:f}).draw()}_getModel(t){return new s.Z(t,{...this.getShaders(),id:this.props.id,geometry:new a.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}l.layerName="ScatterplotLayer",l.defaultProps=c},9890:(t,e,n)=>{"use strict";n.d(e,{F:()=>h,m:()=>A});var r=n(9187),i=n.n(r),o=n(5215);const s=o.wG.CLOCKWISE,a=o.wG.COUNTER_CLOCKWISE,u={isClosed:!0};function c(t,e,n,r,i){let s=e;const a=n.length;for(let e=0;e<a;e++)for(let i=0;i<r;i++)t[s++]=n[e][i]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<r;e++)t[s++]=n[0][e]||0;return u.start=e,u.end=s,u.size=r,(0,o.Ny)(t,i,u),s}function l(t,e,n,r,i=0,s,a){const c=(s=s||n.length)-i;if(c<=0)return e;let l=e;for(let e=0;e<c;e++)t[l++]=n[i+e];if(!function(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}(n,r,i,s))for(let e=0;e<r;e++)t[l++]=n[i+e];return u.start=e,u.end=l,u.size=r,(0,o.Ny)(t,a,u),l}function h(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],r=[];if(t.positions){const{positions:i,holeIndices:o}=t;if(o){let t=0;for(let u=0;u<=o.length;u++)t=l(n,t,i,e,o[u-1],o[u],0===u?s:a),r.push(t);return r.pop(),{positions:n,holeIndices:r}}t=i}if(Number.isFinite(t[0]))return l(n,0,t,e,0,n.length,s),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let i=0;for(const[o,u]of t.entries())i=c(n,i,u,e,0===o?s:a),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return c(n,0,t,e,s),n}function A(t,e,n){let r=null;t.holeIndices&&(r=t.holeIndices.map((t=>t/e)));let o=t.positions||t;if(n){const t=o.length;o=o.slice();const r=[];for(let i=0;i<t;i+=e){r[0]=o[i],r[1]=o[i+1];const t=n(r);o[i]=t[0],o[i+1]=t[1]}}return i()(o,r,e)}},1435:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var r=n(4185),i=n(3844),o=n(7287),s=n(3117),a=n(4088),u=n(4211),c=n(6948),l=n(1113),h=n(3982),A=n(9890),f=n(8005),p=n(5215);class d extends f.Z{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}normalizeGeometry(t){if(this.normalize){if(t=A.F(t,this.positionSize),this.opts.resolution)return(0,p.WZ)(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return(0,p.GU)(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}getGeometrySize(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return(t.positions||t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):()=>null}updateGeometryAttributes(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a)return;let u=r;const c=A.m(t,this.positionSize,this.opts.preproject);a=s.allocate(a,r+c.length,{copy:!0});for(let t=0;t<c.length;t++)a[u++]=c[t]+n;o[e+1]=r+c.length,i.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r)return;const o=t.positions||t;for(let t=e,s=0;s<n;t++,s++){const e=o[s*i],n=o[s*i+1],a=i>2?o[s*i+2]:0;r[3*t]=e,r[3*t+1]=n,r[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{attributes:{vertexValid:r},positionSize:i}=this,o=t&&t.holeIndices;if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)r[e+o[t]/i-1]=0;r[e+n-1]=0}}const g="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",y="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(g,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),m="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(g,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),_=[0,0,0,255],v={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:_},getLineColor:{type:"accessor",value:_},material:!0},b={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class w extends r.Z{getShaders(t){return super.getShaders({vs:"top"===t?y:m,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[i.Z,o.N,s.Z]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===a.Df.DEFAULT&&(n=a.Df.LNGLAT),this.setState({numInstances:0,polygonTesselator:new d({preproject:n===a.Df.LNGLAT&&e.projectFlat,fp64:this.use64bitPositions(),IndexType:!t||(0,u.ag)(t,c.h.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),i=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:b,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,transition:b,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:b,accessor:"getFillColor",defaultValue:_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:b,accessor:"getLineColor",defaultValue:_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,u={...t,extruded:Boolean(e),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(u),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(u).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager();var o;(r.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new l.Z(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new l.Z(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new h.Z({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}w.layerName="SolidPolygonLayer",w.defaultProps=v},1290:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(744),i=n(6867);const o=[];class s extends i.Z{getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&r.Z.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state;t.uniforms={...t.uniforms,buffer:.75,outlineBuffer:r?Math.max(n,.75*(1-r)):-1,gamma:n,sdf:Boolean(e),outlineColor:i},super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map((t=>super.getInstanceOffset(t))):o}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map((t=>super.getInstanceIconFrame(t))):o}}s.layerName="MultiIconLayer",s.defaultProps={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}},1130:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(4185),i=n(3844),o=n(3117),s=n(1113),a=n(3982);const u={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class c extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props;let{padding:u}=this.props;const c="pixels"===i?e.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:n,stroked:Boolean(a),padding:u,sizeScale:r*c,sizeMinPixels:o,sizeMaxPixels:s}).draw()}_getModel(t){return new s.Z(t,{...this.getShaders(),id:this.props.id,geometry:new a.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}c.layerName="TextBackgroundLayer",c.defaultProps=u},5555:(t,e,n)=>{"use strict";n.d(e,{Z:()=>I});var r=n(8918),i=n(8550),o=n(1290),s=n(9296),a=n.n(s),u=n(744);const c=[];function l(t,e,n,r){let i=0;for(let o=e;o<n;o++){const e=t[o];let n=null;const s=r&&r[e];s&&(n=s.width),i+=n}return i}function h(t,e,n,r,i,o){let s=e,a=0;for(let u=e;u<n;u++){const e=l(t,u,u+1,i);a+e>r&&(s<u&&o.push(u),s=u,a=0),a+=e}return a}function A(t,e,n,r,i=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?h(t,i,o,n,r,s):function(t,e,n,r,i,o){let s=e,a=e,u=e,c=0;for(let A=e;A<n;A++)if(" "===t[A]?u=A+1:" "!==t[A+1]&&A+1!==n||(u=A+1),u>a){let e=l(t,a,u,i);c+e>r&&(s<a&&(o.push(a),s=a,c=0),e>r&&(e=h(t,a,u,r,i,o),s=o[o.length-1])),a=u,c+=e}}(t,i,o,n,r,s),s}function f(t,e,n,r,i,o){let s=0,a=0;for(let o=e;o<n;o++){const e=t[o],n=r[e];n?(a||(a=n.height),i[o]=s+n.width/2,s+=n.width):(u.Z.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),i[o]=s,s+=32)}o[0]=s,o[1]=a}function p(t,e,n,r,i){const o=(t=Array.from(t)).length,s=new Array(o),a=new Array(o),u=new Array(o),l=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,h=[0,0],p=[];let d=0,g=0,y=0;for(let m=0;m<=o;m++){const _=t[m];if("\n"!==_&&m!==o||(y=m),y>g){const o=l?A(t,n,r,i,g,y):c;for(let n=0;n<=o.length;n++){const r=0===n?g:o[n-1],c=n<o.length?o[n]:y;f(t,r,c,i,s,p);for(let t=r;t<c;t++)a[t]=d+p[1]/2,u[t]=p[0];d+=p[1]*e,h[0]=Math.max(h[0],p[0])}g=y}"\n"===_&&(s[g]=0,a[g]=0,u[g]=0,g++)}return h[1]=d,{x:s,y:a,rowWidth:u,size:h}}const d=function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),g="Monaco, monospace",y="normal",m=new class{constructor(t=5){this.limit=t,this.clear()}clear(){this._cache={},this._order=[]}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(this._deleteCache(t),this._deleteOrder(t))}_deleteCache(t){delete this._cache[t]}_deleteOrder(t){const e=this._order.findIndex((e=>e===t));e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}(3),_=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function v(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function b(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}class w{constructor(){this.props={fontFamily:g,fontWeight:y,characterSet:d,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(t={}){_.forEach((e=>{e in t&&(this.props[e]=t[e])}));const e=this._key;this._key=this._getKey();const n=function(t,e){const n=m.get(t);if(!n)return e;const r=[],i=n.mapping;let o=Object.keys(i);o=new Set(o);let s=e;return s instanceof Array&&(s=new Set(s)),s.forEach((t=>{o.has(t)||r.push(t)})),r}(this._key,this.props.characterSet),r=m.get(this._key);if(r&&0===n.length)return void(this._key!==e&&(this._atlas=r));const i=this._generateFontAtlas(this._key,n,r);this._atlas=i,m.set(this._key,i)}_generateFontAtlas(t,e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:u,radius:c,cutoff:l}=this.props;let h=n&&n.data;h||(h=document.createElement("canvas"),h.width=1024);const A=h.getContext("2d");b(A,r,o,i);const{mapping:f,canvasHeight:p,xOffset:d,yOffset:g}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let u=0,c=s,l=0;for(const s of t)if(!o[s]){const t=e(s,l++);c+t+2*r>i&&(c=0,u++),o[s]={x:c+r,y:a+u*(n+2*r)+r,width:t,height:n},c+=t+2*r}const h=n+2*r;return{mapping:o,xOffset:c,yOffset:a+u*h,canvasHeight:(A=a+(u+1)*h,Math.pow(2,Math.ceil(Math.log2(A))))};var A}({getFontWidth:t=>A.measureText(t).width,fontHeight:1.2*o,buffer:s,characterSet:e,maxCanvasWidth:1024,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(h.height!==p){const t=A.getImageData(0,0,h.width,h.height);h.height=p,A.putImageData(t,0,0)}if(b(A,r,o,i),u){const t=new(a())(o,s,c,l,r,i),n=A.getImageData(0,0,t.size,t.size);for(const r of e)v(t.draw(r),n),A.putImageData(n,f[r].x-s,f[r].y+s)}else for(const t of e)A.fillText(t,f[t].x,f[t].y+.9*o);return{xOffset:d,yOffset:g,mapping:f,data:h,width:h.width,height:h.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(t," ").concat(e," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(r)}}var E=n(1130);const x={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},S={start:1,middle:0,end:-1},P={top:1,center:0,bottom:-1},T=[0,0,0,255],C=["fontSize","buffer","sdf","radius","cutoff"],M={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:T},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:d},fontFamily:g,fontWeight:y,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:T},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:T},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class I extends r.Z{initializeState(){this.state={styleVersion:0,fontAtlasManager:new w}}updateState({props:t,oldProps:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText),i=this.state.characterSet;r&&this._updateText();const o=i!==this.state.characterSet||this._fontChanged(e,t);o&&this._updateFontAtlas(e,t),(o||t.lineHeight!==e.lineHeight||t.wordBreak!==e.wordBreak||t.maxWidth!==e.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,e){const{fontSettings:n,fontFamily:r,fontWeight:i}=e,{fontAtlasManager:o,characterSet:s}=this.state;o.setProps({...x,...n,characterSet:s,fontFamily:r,fontWeight:i})}_fontChanged(t,e){if(t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;const n=t.fontSettings||{},r=e.fontSettings||{};return C.some((t=>n[t]!==r[t]))}_updateText(){const{data:t,characterSet:e}=this.props,n=t.attributes&&t.attributes.getText;let r,{getText:o}=this.props,{startIndices:s}=t;const a="auto"===e&&new Set;if(n&&s){const{texts:e,characterCount:i}=function({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,u=r?r/s:0,c=i[e]||Math.ceil((t.length-u)/a),l=o&&new Set,h=new Array(e);let A=t;if(a>1||u>0){A=new t.constructor(c);for(let e=0;e<c;e++)A[e]=t[e*a+u]}for(let t=0;t<e;t++){const e=i[t],n=i[t+1]||c,r=A.subarray(e,n);h[t]=String.fromCodePoint.apply(null,r),l&&r.forEach(l.add,l)}if(l)for(const t of l)o.add(String.fromCodePoint(t));return{texts:h,characterCount:c}}({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:s,characterSet:a});r=i,o=(t,{index:n})=>e[n]}else{const{iterable:e,objectInfo:n}=(0,i.jB)(t);s=[0],r=0;for(const t of e){n.index++;const e=Array.from(o(t,n)||"");a&&e.forEach(a.add,a),r+=e.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||e})}getBoundingRect(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{size:[l,h]}=p(c,s,i,o,n);return[(S["function"==typeof a?a(t,e):a]-1)*l/2,(P["function"==typeof u?u(t,e):u]-1)*h/2,l,h]}getIconOffsets(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{x:l,y:h,rowWidth:A,size:[f,d]}=p(c,s,i,o,n),g=S["function"==typeof a?a(t,e):a],y=P["function"==typeof u?u(t,e):u],m=l.length,_=new Array(2*m);let v=0;for(let t=0;t<m;t++){const e=(1-g)*(f-A[t])/2;_[v++]=(g-1)*f/2+e+l[t],_[v++]=(y-1)*d/2+h[t]}return _}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:s},styleVersion:a}=this.state,{data:u,_dataDiff:c,getPosition:l,getColor:h,getSize:A,getAngle:f,getPixelOffset:p,getBackgroundColor:d,getBorderColor:g,getBorderWidth:y,backgroundPadding:m,background:_,billboard:v,fontSettings:b,outlineWidth:w,outlineColor:S,sizeScale:P,sizeUnits:T,sizeMinPixels:C,sizeMaxPixels:M,transitions:I,updateTriggers:O}=this.props,R=this.getSubLayerClass("characters",o.Z),L=this.getSubLayerClass("background",E.Z);return[_&&new L({getFillColor:d,getLineColor:g,getLineWidth:y,padding:m,getPosition:l,getSize:A,getAngle:f,getPixelOffset:p,billboard:v,sizeScale:P/this.state.fontAtlasManager.props.fontSize,sizeUnits:T,sizeMinPixels:C,sizeMaxPixels:M,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:O.getPosition,getAngle:O.getAngle,getSize:O.getSize,getFillColor:O.getBackgroundColor,getLineColor:O.getBorderColor,getLineWidth:O.getBorderWidth,getPixelOffset:O.getPixelOffset,getBoundingRect:{getText:O.getText,getTextAnchor:O.getTextAnchor,getAlignmentBaseline:O.getAlignmentBaseline,styleVersion:a}}}),{data:u.attributes?{length:u.length,attributes:u.attributes.background||{}}:u,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new R({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:x.smoothing,outlineWidth:w,outlineColor:S,iconAtlas:i,iconMapping:s,getPosition:l,getColor:h,getSize:A,getAngle:f,getPixelOffset:p,billboard:v,sizeScale:P*r,sizeUnits:T,sizeMinPixels:C*r,sizeMaxPixels:M*r,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:O.getText,getPosition:O.getPosition,getAngle:O.getAngle,getColor:O.getColor,getSize:O.getSize,getPixelOffset:O.getPixelOffset,getIconOffsets:{getText:O.getText,getTextAnchor:O.getTextAnchor,getAlignmentBaseline:O.getAlignmentBaseline,styleVersion:a}}}),{data:u,_dataDiff:c,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets.bind(this),getIcon:n})]}}I.layerName="TextLayer",I.defaultProps=M},8452:(t,e,n)=>{"use strict";function r({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,u=s;for(let n=0;n<s;n++){const r=e(t[n]);if(a>n&&r>=i&&(a=n),r>=o){u=n;break}}let c=a;const l=u-a!==r.length,h=l&&t.slice(u);for(let e=0;e<r.length;e++)t[c++]=r[e];if(l){for(let e=0;e<h.length;e++)t[c++]=h[e];t.length=c}return{startRow:a,endRow:a+r.length}}n.d(e,{b:()=>r})},1956:(t,e,n)=>{"use strict";n.r(e),n.d(e,{SimpleMeshLayer:()=>r.Z,ScenegraphLayer:()=>i.Z});var r=n(3989),i=n(2377)},2377:(t,e,n)=>{"use strict";n.d(e,{Z:()=>F});var r=n(4185),i=n(3844),o=n(3117),s=n(744),a=n(9450),u=n(4080),c=n(3855),l=n(5451),h=n(4538),A=n(2525);class f{constructor(t={}){const{id:e}=t;this.id=e||(0,h.hQ)(this.constructor.name),this.display=!0,this.position=new c.Z,this.rotation=new c.Z,this.scale=new c.Z(1,1,1),this.matrix=new l.Z,this.userData={},this.props={},this._setScenegraphNodeProps(t)}delete(){}setProps(t){return this._setScenegraphNodeProps(t),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}setPosition(t){return(0,A.Z)(3===t.length,"setPosition requires vector argument"),this.position=t,this}setRotation(t){return(0,A.Z)(3===t.length,"setRotation requires vector argument"),this.rotation=t,this}setScale(t){return(0,A.Z)(3===t.length,"setScale requires vector argument"),this.scale=t,this}setMatrix(t,e=!0){e?this.matrix.copy(t):this.matrix=t}setMatrixComponents({position:t,rotation:e,scale:n,update:r=!0}){return t&&this.setPosition(t),e&&this.setRotation(e),n&&this.setScale(n),r&&this.updateMatrix(),this}updateMatrix(){const t=this.position,e=this.rotation,n=this.scale;return this.matrix.identity(),this.matrix.translate(t),this.matrix.rotateXYZ(e),this.matrix.scale(n),this}update(t={}){const{position:e,rotation:n,scale:r}=t;return e&&this.setPosition(e),n&&this.setRotation(n),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(t,e){(0,A.Z)(t),e=e||this.matrix;const n=new l.Z(t).multiplyRight(e),r=n.invert(),i=r.transpose();return{viewMatrix:t,modelMatrix:e,objectMatrix:e,worldMatrix:n,worldInverseMatrix:r,worldInverseTransposeMatrix:i}}_setScenegraphNodeProps(t){"display"in t&&(this.display=t.display),"position"in t&&this.setPosition(t.position),"rotation"in t&&this.setRotation(t.rotation),"scale"in t&&this.setScale(t.scale),"matrix"in t&&this.setMatrix(t.matrix),Object.assign(this.props,t)}}var p=n(3478),d=n(4072);class g extends f{constructor(t={}){t=Array.isArray(t)?{children:t}:t;const{children:e=[]}=t;a.cM.assert(e.every((t=>t instanceof f)),"every child must an instance of ScenegraphNode"),super(t),this.children=e}add(...t){for(const e of t)Array.isArray(e)?this.add(...e):this.children.push(e);return this}remove(t){const e=this.children,n=e.indexOf(t);return n>-1&&e.splice(n,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach((t=>t.delete())),this.removeAll(),super.delete()}traverse(t,{worldMatrix:e=new l.Z}={}){const n=new l.Z(e).multiplyRight(this.matrix);for(const e of this.children)e instanceof g?e.traverse(t,{worldMatrix:n}):t(e,{worldMatrix:n})}}var y=n(4782);const m={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function v(t){if(!t._animation){const e=_[t.componentType],n=m[t.type],r=n*t.count,{buffer:i,byteOffset:o}=t.bufferView.data,s=new e(i,o+(t.byteOffset||0),r);if(1===n)t._animation=Array.from(s);else{const e=[];for(let t=0;t<s.length;t+=n)e.push(Array.from(s.slice(t,t+n)));t._animation=e}}return t._animation}const b=new l.Z,w=new y.Z;class E{constructor(t){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,t)}animate(t){if(!this.playing)return;const e=(t/1e3-this.startTime)*this.speed;this.channels.forEach((({sampler:t,target:n,path:r})=>{(function(t,{input:e,interpolation:n,output:r},i,o){const s=t%e[e.length-1],u=e.findIndex((t=>t>=s)),c=Math.max(0,u-1);if(!Array.isArray(i[o]))switch(o){case"translation":i[o]=[0,0,0];break;case"rotation":i[o]=[0,0,0,1];break;case"scale":i[o]=[1,1,1];break;default:a.cM.warn("Bad animation path ".concat(o))()}(0,A.Z)(i[o].length===r[c].length);const l=e[c],h=e[u];switch(n){case"STEP":!function(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}(i,o,r[c]);break;case"LINEAR":if(h>l){const t=(s-l)/(h-l);!function(t,e,n,r,i){if("rotation"===e){w.slerp({start:n,target:r,ratio:i});for(let n=0;n<w.length;n++)t[e][n]=w[n]}else for(let o=0;o<n.length;o++)t[e][o]=i*r[o]+(1-i)*n[o]}(i,o,r[c],r[u],t)}break;case"CUBICSPLINE":if(h>l){const t=(s-l)/(h-l),e=h-l;!function(t,e,{p0:n,outTangent0:r,inTangent1:i,p1:o,tDiff:s,ratio:a}){for(let u=0;u<t[e].length;u++){const c=r[u]*s,l=i[u]*s;t[e][u]=(2*Math.pow(a,3)-3*Math.pow(a,2)+1)*n[u]+(Math.pow(a,3)-2*Math.pow(a,2)+a)*c+(-2*Math.pow(a,3)+3*Math.pow(a,2))*o[u]+(Math.pow(a,3)-Math.pow(a,2))*l}}(i,o,{p0:r[3*c+1],outTangent0:r[3*c+2],inTangent1:r[3*u+0],p1:r[3*u+1],tDiff:e,ratio:t})}break;default:a.cM.warn("Interpolation ".concat(n," not supported"))()}})(e,t,n,r),function(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=b.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}(n,n._node)}))}}class x{constructor(t){this.animations=t.animations.map(((e,n)=>{const r=e.name||"Animation-".concat(n),i=e.samplers.map((({input:e,interpolation:n="LINEAR",output:r})=>({input:v(t.accessors[e]),interpolation:n,output:v(t.accessors[r])}))),o=e.channels.map((({sampler:e,target:n})=>({sampler:i[e],target:t.nodes[n.node],path:n.path})));return new E({name:r,channels:o})}))}animate(t){this.setTime(t)}setTime(t){this.animations.forEach((e=>e.animate(t)))}getAnimations(){return this.animations}}var S=n(1113);class P extends f{constructor(t,e={}){super(e),this.onBeforeRender=null,this.AfterRender=null,t instanceof S.Z?(this.model=t,this._setModelNodeProps(e)):this.model=new S.Z(t,e),this.managedResources=e.managedResources||[]}setProps(t){return super.setProps(t),this._setModelNodeProps(t),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach((t=>t.delete())),this.managedResources=[]}draw(...t){return this.model.draw(...t)}setUniforms(...t){return this.model.setUniforms(...t),this}setAttributes(...t){return this.model.setAttributes(...t),this}updateModuleSettings(...t){return this.model.updateModuleSettings(...t),this}_setModelNodeProps(t){this.model.setProps(t)}}var T=n(1307);function C(t,e){return(0,a.D0)(t)?"#version 300 es\n".concat(e):e}const M={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class O{constructor(t,e={}){this.gl=t,this.options=Object.assign({},I,e)}instantiate(t){return this.gltf=t,(t.scenes||[]).map((t=>this.createScene(t)))}createAnimator(){return Array.isArray(this.gltf.animations)?new x(this.gltf):null}createScene(t){const e=(t.nodes||[]).map((t=>this.createNode(t)));return new g({id:t.name||t.id,children:e})}createNode(t){if(!t._node){const e=(t.children||[]).map((t=>this.createNode(t)));t.mesh&&e.push(this.createMesh(t.mesh));const n=new g({id:t.name||t.id,children:e});if(t.matrix)n.setMatrix(t.matrix);else{if(n.matrix.identity(),t.translation&&n.matrix.translate(t.translation),t.rotation){const e=(new l.Z).fromQuaternion(t.rotation);n.matrix.multiplyRight(e)}t.scale&&n.matrix.scale(t.scale)}t._node=n}return t._node}createMesh(t){if(!t._mesh){const e=(t.primitives||[]).map(((e,n)=>this.createPrimitive(e,n,t))),n=new g({id:t.name||t.id,children:e});t._mesh=n}return t._mesh}getVertexCount(t){a.cM.warn("getVertexCount() not found")()}createPrimitive(t,e,n){return function(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:o,modelOptions:s}=e,c=new T.Z(t,e);a.cM.info(4,"createGLTFModel defines: ",c.defines)();const l=[];l.push(...c.generatedTextures),l.push(...Object.values(o).map((t=>t.buffer)));const h=new P(t,Object.assign({id:n,drawMode:r,vertexCount:i,modules:[u.b],defines:c.defines,parameters:c.parameters,vs:C(t,"\n#if (__VERSION__ < 300)\n  #define _attr attribute\n#else\n  #define _attr in\n#endif\n\n  _attr vec4 POSITION;\n\n  #ifdef HAS_NORMALS\n    _attr vec4 NORMAL;\n  #endif\n\n  #ifdef HAS_TANGENTS\n    _attr vec4 TANGENT;\n  #endif\n\n  #ifdef HAS_UV\n    _attr vec2 TEXCOORD_0;\n  #endif\n\n  void main(void) {\n    vec4 _NORMAL = vec4(0.);\n    vec4 _TANGENT = vec4(0.);\n    vec2 _TEXCOORD_0 = vec2(0.);\n\n    #ifdef HAS_NORMALS\n      _NORMAL = NORMAL;\n    #endif\n\n    #ifdef HAS_TANGENTS\n      _TANGENT = TANGENT;\n    #endif\n\n    #ifdef HAS_UV\n      _TEXCOORD_0 = TEXCOORD_0;\n    #endif\n\n    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);\n    gl_Position = u_MVPMatrix * POSITION;\n  }\n"),fs:C(t,"\n#if (__VERSION__ < 300)\n  #define fragmentColor gl_FragColor\n#else\n  out vec4 fragmentColor;\n#endif\n\n  void main(void) {\n    fragmentColor = pbr_filterColor(vec4(0));\n  }\n"),managedResources:l},s));return h.setProps({attributes:o}),h.setUniforms(c.uniforms),h}(this.gl,Object.assign({id:t.name||"".concat(n.name||n.id,"-primitive-").concat(e),drawMode:t.mode||4,vertexCount:t.indices?t.indices.count:this.getVertexCount(t.attributes),attributes:this.createAttributes(t.attributes,t.indices),material:t.material},this.options))}createAttributes(t,e){const n={};return Object.keys(t).forEach((e=>{n[e]=this.createAccessor(t[e],this.createBuffer(t[e],this.gl.ARRAY_BUFFER))})),e&&(n.indices=this.createAccessor(e,this.createBuffer(e,this.gl.ELEMENT_ARRAY_BUFFER))),a.cM.info(4,"glTF Attributes",{attributes:t,indices:e,generated:n})(),n}createBuffer(t,e){t.bufferView||(t.bufferView={});const{bufferView:n}=t;return n.lumaBuffers||(n.lumaBuffers={}),n.lumaBuffers[e]||(n.lumaBuffers[e]=new p.Z(this.gl,{id:"from-".concat(n.id),data:n.data||t.value,target:e})),n.lumaBuffers[e]}createAccessor(t,e){return new d.Z({buffer:e,offset:t.byteOffset||0,stride:t.bufferView.byteStride||0,type:t.componentType,size:M[t.type]})}createSampler(t){return t}needsPOT(){return!1}}var R=n(8130);var L=n(7805);const N=[255,255,255,255],D={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?"object"==typeof t.scene?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:N},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[R.E]};class F extends r.Z{getShaders(){const t=[i.Z,o.Z];return"pbr"===this.props._lighting&&t.push(u.b),{vs:"#version 300 es\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform mat4 sceneModelMatrix;\nuniform bool composeModelMatrix;\nin vec4 POSITION;\n\n#ifdef HAS_UV\n  in vec2 TEXCOORD_0;\n#endif\n\n#ifdef MODULE_PBR\n  #ifdef HAS_NORMALS\n    in vec4 NORMAL;\n  #endif\n#endif\nout vec4 vColor;\n#ifndef MODULE_PBR\n  #ifdef HAS_UV\n    out vec2 vTEXCOORD_0;\n  #endif\n#endif\nvoid main(void) {\n  #if defined(HAS_UV) && !defined(MODULE_PBR)\n    vTEXCOORD_0 = TEXCOORD_0;\n    geometry.uv = vTEXCOORD_0;\n  #endif\n\n  geometry.worldPosition = instancePositions;\n  geometry.pickingColor = instancePickingColors;\n\n  #ifdef MODULE_PBR\n    #ifdef HAS_NORMALS\n      pbr_vNormal = project_normal(instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz);\n      geometry.normal = pbr_vNormal;\n    #endif\n\n    #ifdef HAS_UV\n      pbr_vUV = TEXCOORD_0;\n    #else\n      pbr_vUV = vec2(0., 0.);\n    #endif\n    geometry.uv = pbr_vUV;\n  #endif\n\n  float originalSize = project_size_to_pixel(sizeScale);\n  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);\n\n  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;\n  if(composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  #ifdef MODULE_PBR\n    pbr_vPosition = geometry.position.xyz;\n  #endif\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\nuniform float opacity;\nin vec4 vColor;\n\nout vec4 fragmentColor;\n#ifndef MODULE_PBR\n  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n    in vec2 vTEXCOORD_0;\n    uniform sampler2D u_BaseColorSampler;\n  #endif\n#endif\n\nvoid main(void) {\n  #ifdef MODULE_PBR\n    fragmentColor = vColor * pbr_filterColor(vec4(0));\n    geometry.uv = pbr_vUV;\n  #else\n    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)\n      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);\n      geometry.uv = vTEXCOORD_0;\n    #else\n      fragmentColor = vColor;\n    #endif\n  #endif\n\n  fragmentColor.a *= opacity;\n  DECKGL_FILTER_COLOR(fragmentColor, geometry);\n}\n",modules:t}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:N,transition:!0},instanceModelMatrix:L.P})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;e.scenegraph!==n.scenegraph?this._updateScenegraph(e):e._animations!==n._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,e._animations)}finalizeState(){super.finalizeState(),this._deleteScenegraph()}_updateScenegraph(t){const{gl:e}=this.context;let n=null;if(t.scenegraph instanceof f)n={scenes:[t.scenegraph]};else if(t.scenegraph&&!t.scenegraph.gltf){const r=t.scenegraph,i=function(t,e,n){const r=new O(t,n);return{scenes:r.instantiate(e),animator:r.createAnimator()}}(e,r,this._getModelOptions());n={gltf:r,...i},async function(t){const e=[];return t.scenes.forEach((t=>{t.traverse((t=>{Object.values(t.model.getUniforms()).forEach((t=>{!1===t.loaded&&e.push(t)}))}))})),await async function(t){for(;e.some((t=>!t.loaded));)await new Promise((t=>requestAnimationFrame(t)))}()}(i).then((()=>this.setNeedsRedraw()))}else t.scenegraph&&(s.Z.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),n=t.scenegraph);const r={layer:this,gl:e},i=t.getScene(n,r),o=t.getAnimator(n,r);i instanceof f?(this._deleteScenegraph(),this._applyAllAttributes(i),this._applyAnimationsProp(i,o,t._animations),this.setState({scenegraph:i,animator:o})):null!==i&&s.Z.warn("invalid scenegraph:",i)()}_applyAllAttributes(t){if(this.state.attributesAvailable){const e=this.getAttributeManager().getAttributes();t.traverse((t=>{this._setModelAttributes(t.model,e)}))}}_applyAnimationsProp(t,e,n){if(!t||!e||!n)return;const r=e.getAnimations();Object.keys(n).sort().forEach((t=>{const e=n[t];if("*"===t)r.forEach((t=>{Object.assign(t,e)}));else if(Number.isFinite(Number(t))){const n=Number(t);n>=0&&n<r.length?Object.assign(r[n],e):s.Z.warn("animation ".concat(t," not found"))()}else{const n=r.find((({name:e})=>e===t));n?Object.assign(n,e):s.Z.warn("animation ".concat(t," not found"))()}}))}_deleteScenegraph(){const{scenegraph:t}=this.state;t instanceof f&&t.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:t}=this.props;let e=null;return t&&(e="function"==typeof t?t({gl:this.context.gl,layer:this}):t),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:e,modelOptions:{isInstanced:!0,transpileToGLSL100:!(0,a.D0)(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(t){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse((e=>{this._setModelAttributes(e.model,t)}))}draw({moduleParameters:t=null,parameters:e={},context:n}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(n.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:i,sizeMinPixels:o,sizeMaxPixels:s,opacity:a,coordinateSystem:u}=this.props,c=this.getNumInstances();this.state.scenegraph.traverse(((n,{worldMatrix:l})=>{n.model.setInstanceCount(c),n.updateModuleSettings(t),n.draw({parameters:e,uniforms:{sizeScale:i,opacity:a,sizeMinPixels:o,sizeMaxPixels:s,composeModelMatrix:(0,L.X)(r,u),sceneModelMatrix:l,u_Camera:n.model.getUniforms().project_uCameraPosition}})}))}}F.layerName="ScenegraphLayer",F.defaultProps=D},3989:(t,e,n)=>{"use strict";n.d(e,{Z:()=>y});var r=n(744),i=n(4185),o=n(3844),s=n(7287),a=n(3117),u=n(3982),c=n(9450),l=n(4912),h=n(1113),A=n(4211),f=n(6948),p=n(7805);function d(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),r.Z.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function g(t,e){if(t.attributes)return d(t.attributes,e),t instanceof u.Z?t:new u.Z(t);if(t.positions||t.POSITION)return d(t,e),new u.Z({attributes:t});throw Error("Invalid mesh")}class y extends i.Z{getShaders(){const t=!(0,c.D0)(this.context.gl),e={};return(0,A.U6)(this.context.gl,f.h.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[o.Z,s.s,a.Z],transpileToGLSL100:t,defines:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:p.P}),this.setState({emptyTexture:new l.Z(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),t.mesh!==e.mesh||n.extensionsChanged){var r;if(null===(r=this.state.model)||void 0===r||r.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const e=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(e.NORMAL||e.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==e.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:r,_instanced:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!i||(0,p.X)(e,r),flatShading:!this.state.hasNormals}).draw()}getModel(t){const e=new h.Z(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:g(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:r}=this.state;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;null==n||n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}y.layerName="SimpleMeshLayer",y.defaultProps={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}}},7805:(t,e,n)=>{"use strict";n.d(e,{P:()=>l,X:()=>h});var r=n(8550),i=n(4088);const o=Math.PI/180,s=new Float32Array(16),a=new Float32Array(12);function u(t,e,n){const r=e[0]*o,i=e[1]*o,s=e[2]*o,a=Math.sin(s),u=Math.sin(r),c=Math.sin(i),l=Math.cos(s),h=Math.cos(r),A=Math.cos(i),f=n[0],p=n[1],d=n[2];t[0]=f*A*h,t[1]=f*c*h,t[2]=f*-u,t[3]=p*(-c*l+A*u*a),t[4]=p*(A*l+c*u*a),t[5]=p*h*a,t[6]=d*(c*a+A*u*l),t[7]=d*(-A*a+c*u*l),t[8]=d*h*l}function c(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const l={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:o,getScale:l,getTranslation:h,getTransformMatrix:A}=this.props,f=Array.isArray(A),p=f&&16===A.length,d=Array.isArray(l),g=Array.isArray(o),y=Array.isArray(h),m=p||!f&&Boolean(A(i[0]));t.constant=m?p:g&&d&&y;const _=t.value;if(t.constant){let e;m?(s.set(A),e=c(s)):(e=a,u(e,o,l),e.set(h,9)),t.value=new Float32Array(e)}else{let f=e*t.size;const{iterable:v,objectInfo:b}=(0,r.jB)(i,e,n);for(const t of v){let e;b.index++,m?(s.set(p?A:A(t,b)),e=c(s)):(e=a,u(e,g?o:o(t,b),d?l:l(t,b)),e.set(y?h:h(t,b),9)),_[f++]=e[0],_[f++]=e[1],_[f++]=e[2],_[f++]=e[3],_[f++]=e[4],_[f++]=e[5],_[f++]=e[6],_[f++]=e[7],_[f++]=e[8],_[f++]=e[9],_[f++]=e[10],_[f++]=e[11]}}}};function h(t,e){return e===i.Df.CARTESIAN||e===i.Df.METER_OFFSETS||e===i.Df.DEFAULT&&!t.isGeospatial}},6255:(t,e,n)=>{"use strict";n.d(e,{Kn:()=>i,Ss:()=>o,TW:()=>s,D0:()=>a,Ew:()=>u,Lj:()=>c,zH:()=>l,Os:()=>h});const r=t=>"function"==typeof t,i=t=>null!==t&&"object"==typeof t,o=t=>i(t)&&t.constructor==={}.constructor,s=t=>t&&"function"==typeof t[Symbol.iterator],a=t=>t&&"function"==typeof t[Symbol.asyncIterator],u=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,c=t=>"undefined"!=typeof Blob&&t instanceof Blob,l=t=>t&&"object"==typeof t&&t.isBuffer,h=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||i(t)&&r(t.tee)&&r(t.cancel)&&r(t.getReader))(t)||(t=>i(t)&&r(t.read)&&r(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t)},3079:(t,e,n)=>{"use strict";n.d(e,{z:()=>j});var r=n(6255),i=n(2033),o=n(7504),s=n(6040),a=n(4942),u=n(6013);const c=new Map;function l(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function h(t,e=!0,n){const r=n||new Set;if(t)if(A(t))r.add(t);else if(A(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)h(t[n],e,r);return void 0===n?Array.from(r):[]}function A(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const f=()=>{};class p{static isSupported(){return"undefined"!=typeof Worker}constructor(t){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"terminated",!1),(0,a.Z)(this,"worker",void 0),(0,a.Z)(this,"onMessage",void 0),(0,a.Z)(this,"onError",void 0),(0,a.Z)(this,"_loadableURL","");const{name:e,source:n,url:r}=t;(0,s.h)(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=f,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=f,this.onError=f,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||h(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){(0,s.h)(t.source&&!t.url||!t.source&&t.url);let e=c.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?l(`try {\n  importScripts('${n}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):n,c.set(t.url,e)),t.source&&(e=l(t.source),c.set(t.source,e))),(0,s.h)(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class d{constructor(t,e){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"workerThread",void 0),(0,a.Z)(this,"isRunning",void 0),(0,a.Z)(this,"result",void 0),(0,a.Z)(this,"_resolve",void 0),(0,a.Z)(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){(0,s.h)(this.isRunning),this.isRunning=!1,this._reject(t)}}class g{constructor(t){(0,a.Z)(this,"name","unnamed"),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"maxConcurrency",1),(0,a.Z)(this,"maxMobileConcurrency",1),(0,a.Z)(this,"onDebug",(()=>{})),(0,a.Z)(this,"reuseWorkers",!0),(0,a.Z)(this,"props",{}),(0,a.Z)(this,"jobQueue",[]),(0,a.Z)(this,"idleQueue",[]),(0,a.Z)(this,"count",0),(0,a.Z)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const r=new Promise((r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new d(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new p({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return u.tq?this.maxMobileConcurrency:this.maxConcurrency}}const y={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class m{static isSupported(){return p.isSupported()}static getWorkerFarm(t={}){return m._workerFarm=m._workerFarm||new m({}),m._workerFarm.setProps(t),m._workerFarm}constructor(t){(0,a.Z)(this,"props",void 0),(0,a.Z)(this,"workerPools",new Map),this.props={...y},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new g({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}async function _(t,e,n,r,i){const o=t.id,a=function(t,e={}){const n=e[t.id]||{},r=`${t.id}-worker.js`;let i=n.workerUrl;if("test"===e._workerType&&(i=`modules/${t.module}/dist/${r}`),!i){let e=t.version;"latest"===e&&(e="latest");const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${r}`}return(0,s.h)(i),i}(t,n),u=m.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n));const c=await u.startJob("process-on-worker",v.bind(null,i));c.postMessage("process",{input:e,options:n});const l=await c.result;return await l.result}async function v(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(r.error);break;case"process":const{id:i,input:o,options:s}=r;try{const n=await t(o,s);e.postMessage("done",{id:i,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:i,error:n})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}(0,a.Z)(m,"_workerFarm",void 0);var b=n(4609);const w=262144;var E=n(4959);function x(t,e){return E.jU?async function*(t,e){const n=t.getReader();let r;try{for(;;){const t=r||n.read();null!=e&&e._streamReadAhead&&(r=n.read());const{done:i,value:o}=await t;if(i)return;yield(0,b.rJ)(o)}}catch(t){n.releaseLock()}}(t,e):async function*(t,e){for await(const e of t)yield(0,b.rJ)(e)}(t)}var S=n(7927);const P="Cannot convert supplied data type";async function T(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||i)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if((0,r.zH)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(P)}(t,e);if((0,r.Lj)(t)&&(t=await(0,S.L1)(t)),(0,r.Ew)(t)){const n=t;return await(0,S.mm)(n),e.binary?await n.arrayBuffer():await n.text()}if((0,r.Os)(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<t.length;){const e=Math.min(t.length-r,n),o=t.slice(r,r+e);r+=e,yield i.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:n=w}=e;let r=0;for(;r<t.byteLength;){const e=Math.min(t.byteLength-r,n),i=new ArrayBuffer(e),o=new Uint8Array(t,r,e);new Uint8Array(i).set(o),r+=e,yield i}}(t,e);if((0,r.Lj)(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||1048576;let r=0;for(;r<t.size;){const e=r+n,i=await t.slice(r,e).arrayBuffer();r=e,yield i}}(t,e);if((0,r.Os)(t))return x(t,e);if((0,r.Ew)(t))return x(t.body,e);throw new Error("makeIterator")}(t,n)),(0,r.TW)(t)||(0,r.D0)(t))return async function(t){const e=[];for await(const n of t)e.push(n);return(0,b.JY)(...e)}(t);throw new Error(P)}var C=n(9752),M=n(6228);const I=/\.([^.]+)$/;function O(t,e=[],n,r){if(!R(t))return null;if(e&&!Array.isArray(e))return(0,i.T)(e);let o=[];e&&(o=o.concat(e)),null!=n&&n.ignoreRegisteredLoaders||o.push(...(0,M.kO)()),function(t){for(const e of t)(0,i.T)(e)}(o);const s=function(t,e,n,r){const{url:i,type:o}=(0,C.l)(t),s=i||(null==r?void 0:r.url);let a=null;return null!=n&&n.mimeType&&(a=N(e,null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&I.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,r):null}(e,s),a=a||N(e,o),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(D(e,n))return n}else if(ArrayBuffer.isView(e)){if(F(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&F(e,0,n))return n;return null}(e,t),a=a||N(e,null==n?void 0:n.fallbackMimeType),a}(t,o,n,r);if(!(s||null!=n&&n.nothrow))throw new Error(L(t));return s}function R(t){return!(t instanceof Response&&204===t.status)}function L(t){const{url:e,type:n}=(0,C.l)(t);let r="No valid loader found";return t&&(r+=` data: "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?k(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?k(t,0,e):""}(t)}", contentType: "${n}"`),e&&(r+=` url: ${e}`),r}function N(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function D(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function F(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(t,e,n,r){if(r instanceof ArrayBuffer)return(0,b.Xq)(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":return r===k(t,e,r.length);default:return!1}}(t,e,n,r)))}function k(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}async function B(t,e,n,a){(0,s.h)(!a||"object"==typeof a),!e||Array.isArray(e)||(0,i.C)(e)||(a=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:u}=(0,C.l)(t),c=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,a),l=await async function(t,e=[],n,i){if(!R(t))return null;let o=O(t,e,{...n,nothrow:!0},i);if(o)return o;if((0,r.Lj)(t)&&(o=O(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!(o||null!=n&&n.nothrow))throw new Error(L(t));return o}(t,c,n);return l?(a=function(t,e,n=null){if(n)return n;const r={fetch:(0,o.bV)(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:u,parse:B,loaders:c},n=(0,o.GR)(n,l,c,u),a),await async function(t,e,n,r){if(function(t,e="3.0.11"){(0,s.h)(t,"no worker provided");t.version}(t),e=await T(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(function(t,e){return!!m.isSupported()&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await _(t,e,n,0,B);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw(0,s.h)(!t.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(l,t,n,a)):null}async function j(t,e,n,s){Array.isArray(e)||(0,i.C)(e)||(n=e,e=void 0);const a=(0,o.bV)(n);let u=t;return"string"==typeof t&&(u=await a(t)),(0,r.Lj)(t)&&(u=await a(t)),await B(u,e,n)}},6228:(t,e,n)=>{"use strict";n.d(e,{fh:()=>s,kO:()=>a});var r=n(2033),i=n(7504);const o=()=>{const t=(0,i.rx)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function s(t){const e=o();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,r.T)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return o()}},2033:(t,e,n)=>{"use strict";n.d(e,{C:()=>i,T:()=>o});var r=n(6269);function i(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function o(t){var e,n;let o;return(0,r.h)(t,"null loader"),(0,r.h)(i(t),"invalid loader"),Array.isArray(t)&&(o=t[1],t=t[0],t={...t,options:{...t.options,...o}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}},7504:(t,e,n)=>{"use strict";n.d(e,{bV:()=>g,rx:()=>f,GR:()=>d});var r=n(4959),i=n(6255);const o={};var s=n(7927);async function a(t,e){if("string"==typeof t){t=function(t){for(const e in o)if(t.startsWith(e)){const n=o[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${t}`),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await(0,s.L1)(t)}var u=n(4942);const c=new(n(4708).Z)({id:"loaders.gl"});class l{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const h={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,u.Z)(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},A={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function f(){r.CO.loaders=r.CO.loaders||{};const{loaders:t}=r.CO;return t._state=t._state||{},t._state}const p=()=>{const t=f();return t.globalOptions=t.globalOptions||{...h},t.globalOptions};function d(t,e,n,r){return n=n||[],function(t,e){y(t,null,h,A,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};y(r,n.id,i,o,e)}}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const r={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new l),_(r,p()),_(r,e),r}(e,t,r)}function g(t,e){const n=p(),r=t||n;return"function"==typeof r.fetch?r.fetch:(0,i.Kn)(r.fetch)?t=>a(t,r):null!=e&&e.fetch?null==e?void 0:e.fetch:a}function y(t,e,n,r,o){const s=e||"Top level",a=e?`${e}.`:"";for(const u in t){const l=!e&&(0,i.Kn)(t[u]),h="baseUri"===u&&!e,A="workerUrl"===u&&e;if(!(u in n)&&!h&&!A)if(u in r)c.warn(`${s} loader option '${a}${u}' no longer supported, use '${r[u]}'`)();else if(!l){const t=m(u,o);c.warn(`${s} loader option '${a}${u}' not recognized. ${t}`)()}}}function m(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const e in i.options){if(t===e)return`Did you mean '${i.id}.${e}'?`;const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${e}'?`)}return r}function _(t,e){for(const n in e)if(n in e){const r=e[n];(0,i.Ss)(r)&&(0,i.Ss)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},9752:(t,e,n)=>{"use strict";n.d(e,{C:()=>l,l:()=>c});var r=n(6255);const i=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function s(t){const e=o.exec(t);return e?e[1]:t}function a(t){const e=i.exec(t);return e?e[1]:""}const u=/\?.*/;function c(t){if((0,r.Ew)(t)){const e=h(t.url||"");return{url:e,type:s(t.headers.get("content-type")||"")||a(e)}}return(0,r.Lj)(t)?{url:h(t.name||""),type:t.type||""}:"string"==typeof t?{url:h(t),type:a(t)}:{url:"",type:""}}function l(t){return(0,r.Ew)(t)?t.headers["content-length"]||-1:(0,r.Lj)(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function h(t){return t.replace(u,"")}},7927:(t,e,n)=>{"use strict";n.d(e,{L1:()=>o,mm:()=>s});var r=n(6255),i=n(9752);async function o(t){if((0,r.Ew)(t))return t;const e={},n=(0,i.C)(t);n>=0&&(e["content-length"]=String(n));const{url:o,type:s}=(0,i.l)(t);s&&(e["content-type"]=s);const a=await async function(t){if("string"==typeof t)return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}return t instanceof ArrayBuffer?`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return btoa(e)}(t.slice(0,5))}`:null}(t);a&&(e["x-first-bytes"]=a),"string"==typeof t&&(t=(new TextEncoder).encode(t));const u=new Response(t,{headers:e});return Object.defineProperty(u,"url",{value:o}),u}async function s(t){if(!t.ok){const e=await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=` ${await t.text()}`),e+=r,e=e.length>60?`${e.slice(60)}...`:e}catch(t){}return e}(t);throw new Error(e)}}},7718:(t,e,n)=>{"use strict";n.d(e,{VJ:()=>U});const r={name:"Draco",id:"draco",module:"draco",version:"3.0.11",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};var i=n(4942);class o{constructor(t,e){(0,i.Z)(this,"fields",void 0),(0,i.Z)(this,"metadata",void 0),function(t,e){if(!t)throw new Error("loader assertion failed.")}(Array.isArray(t)),function(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}(t),this.fields=t,this.metadata=e||new Map}compareTo(t){if(this.metadata!==t.metadata)return!1;if(this.fields.length!==t.fields.length)return!1;for(let e=0;e<this.fields.length;++e)if(!this.fields[e].compareTo(t.fields[e]))return!1;return!0}select(...t){const e=Object.create(null);for(const n of t)e[n]=!0;const n=this.fields.filter((t=>e[t.name]));return new o(n,this.metadata)}selectAt(...t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new o(e,this.metadata)}assign(t){let e,n=this.metadata;if(t instanceof o){const r=t;e=r.fields,n=s(s(new Map,this.metadata),r.metadata)}else e=t;const r=Object.create(null);for(const t of this.fields)r[t.name]=t;for(const t of e)r[t.name]=t;const i=Object.values(r);return new o(i,n)}}function s(t,e){return new Map([...t||new Map,...e||new Map])}let a,u,c,l,h,A,f,p;var d;(d=a||(a={}))[d.NONE=0]="NONE",d[d.Null=1]="Null",d[d.Int=2]="Int",d[d.Float=3]="Float",d[d.Binary=4]="Binary",d[d.Utf8=5]="Utf8",d[d.Bool=6]="Bool",d[d.Decimal=7]="Decimal",d[d.Date=8]="Date",d[d.Time=9]="Time",d[d.Timestamp=10]="Timestamp",d[d.Interval=11]="Interval",d[d.List=12]="List",d[d.Struct=13]="Struct",d[d.Union=14]="Union",d[d.FixedSizeBinary=15]="FixedSizeBinary",d[d.FixedSizeList=16]="FixedSizeList",d[d.Map=17]="Map",d[d.Dictionary=-1]="Dictionary",d[d.Int8=-2]="Int8",d[d.Int16=-3]="Int16",d[d.Int32=-4]="Int32",d[d.Int64=-5]="Int64",d[d.Uint8=-6]="Uint8",d[d.Uint16=-7]="Uint16",d[d.Uint32=-8]="Uint32",d[d.Uint64=-9]="Uint64",d[d.Float16=-10]="Float16",d[d.Float32=-11]="Float32",d[d.Float64=-12]="Float64",d[d.DateDay=-13]="DateDay",d[d.DateMillisecond=-14]="DateMillisecond",d[d.TimestampSecond=-15]="TimestampSecond",d[d.TimestampMillisecond=-16]="TimestampMillisecond",d[d.TimestampMicrosecond=-17]="TimestampMicrosecond",d[d.TimestampNanosecond=-18]="TimestampNanosecond",d[d.TimeSecond=-19]="TimeSecond",d[d.TimeMillisecond=-20]="TimeMillisecond",d[d.TimeMicrosecond=-21]="TimeMicrosecond",d[d.TimeNanosecond=-22]="TimeNanosecond",d[d.DenseUnion=-23]="DenseUnion",d[d.SparseUnion=-24]="SparseUnion",d[d.IntervalDayTime=-25]="IntervalDayTime",d[d.IntervalYearMonth=-26]="IntervalYearMonth";class g{static isNull(t){return t&&t.typeId===a.Null}static isInt(t){return t&&t.typeId===a.Int}static isFloat(t){return t&&t.typeId===a.Float}static isBinary(t){return t&&t.typeId===a.Binary}static isUtf8(t){return t&&t.typeId===a.Utf8}static isBool(t){return t&&t.typeId===a.Bool}static isDecimal(t){return t&&t.typeId===a.Decimal}static isDate(t){return t&&t.typeId===a.Date}static isTime(t){return t&&t.typeId===a.Time}static isTimestamp(t){return t&&t.typeId===a.Timestamp}static isInterval(t){return t&&t.typeId===a.Interval}static isList(t){return t&&t.typeId===a.List}static isStruct(t){return t&&t.typeId===a.Struct}static isUnion(t){return t&&t.typeId===a.Union}static isFixedSizeBinary(t){return t&&t.typeId===a.FixedSizeBinary}static isFixedSizeList(t){return t&&t.typeId===a.FixedSizeList}static isMap(t){return t&&t.typeId===a.Map}static isDictionary(t){return t&&t.typeId===a.Dictionary}get typeId(){return a.NONE}compareTo(t){return this===t}}Symbol.toStringTag,Symbol.toStringTag,u=Symbol.toStringTag;class y extends g{constructor(t,e){super(),(0,i.Z)(this,"isSigned",void 0),(0,i.Z)(this,"bitWidth",void 0),this.isSigned=t,this.bitWidth=e}get typeId(){return a.Int}get[u](){return"Int"}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}class m extends y{constructor(){super(!0,8)}}class _ extends y{constructor(){super(!0,16)}}class v extends y{constructor(){super(!0,32)}}class b extends y{constructor(){super(!1,8)}}class w extends y{constructor(){super(!1,16)}}class E extends y{constructor(){super(!1,32)}}c=Symbol.toStringTag;class x extends g{constructor(t){super(),(0,i.Z)(this,"precision",void 0),this.precision=t}get typeId(){return a.Float}get[c](){return"Float"}toString(){return`Float${this.precision}`}}class S extends x{constructor(){super(32)}}class P extends x{constructor(){super(64)}}Symbol.toStringTag,Symbol.toStringTag,l=Symbol.toStringTag,h=Symbol.toStringTag,A=Symbol.toStringTag,f=Symbol.toStringTag,p=Symbol.toStringTag;class T extends g{constructor(t,e){super(),(0,i.Z)(this,"listSize",void 0),(0,i.Z)(this,"children",void 0),this.listSize=t,this.children=[e]}get typeId(){return a.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[p](){return"FixedSizeList"}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}class C{constructor(t,e,n=!1,r=new Map){(0,i.Z)(this,"name",void 0),(0,i.Z)(this,"type",void 0),(0,i.Z)(this,"nullable",void 0),(0,i.Z)(this,"metadata",void 0),this.name=t,this.type=e,this.nullable=n,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new C(this.name,this.type,this.nullable,this.metadata)}compareTo(t){return this.name===t.name&&this.type===t.type&&this.nullable===t.nullable&&this.metadata===t.metadata}toString(){return`${this.type}${this.nullable?", nullable":""}${this.metadata?`, metadata: ${this.metadata}`:""}`}}function M(t,e,n){const r=n?I(n.metadata):void 0,i=function(t){switch(t.constructor){case Int8Array:return new m;case Uint8Array:return new b;case Int16Array:return new _;case Uint16Array:return new w;case Int32Array:return new v;case Uint32Array:return new E;case Float32Array:return new S;case Float64Array:return new P;default:throw new Error("array type not supported")}}(e.value);return new C(t,new T(e.size,new C("value",i)),!1,r)}function I(t){const e=new Map;for(const n in t)e.set(`${n}.string`,JSON.stringify(t[n]));return e}const O={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},R={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class L{constructor(t){(0,i.Z)(this,"draco",void 0),(0,i.Z)(this,"decoder",void 0),(0,i.Z)(this,"metadataQuerier",void 0),this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t,e={}){const n=new this.draco.DecoderBuffer;n.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(e);const r=this.decoder.GetEncodedGeometryType(n),i=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let t;switch(r){case this.draco.TRIANGULAR_MESH:t=this.decoder.DecodeBufferToMesh(n,i);break;case this.draco.POINT_CLOUD:t=this.decoder.DecodeBufferToPointCloud(n,i);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!t.ok()||!i.ptr){const e=`DRACO decompression failed: ${t.error_msg()}`;throw new Error(e)}const s=this._getDracoLoaderData(i,r,e),a=this._getMeshData(i,s,e),u=function(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,s=-1/0;const a=t.POSITION?t.POSITION.value:[],u=a&&a.length;for(let t=0;t<u;t+=3){const u=a[t],c=a[t+1],l=a[t+2];e=u<e?u:e,n=c<n?c:n,r=l<r?l:r,i=u>i?u:i,o=c>o?c:o,s=l>s?l:s}return[[e,n,r],[i,o,s]]}(a.attributes),c=function(t,e,n){const r=I(e.metadata),i=[],s=function(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}(e.attributes);for(const e in t){const n=M(e,t[e],s[e]);i.push(n)}if(n){const t=M("indices",n);i.push(t)}return new o(i,r)}(a.attributes,s,a.indices);return{loader:"draco",loaderData:s,header:{vertexCount:i.num_points(),boundingBox:u},...a,schema:c}}finally{this.draco.destroy(n),i&&this.draco.destroy(i)}}_getDracoLoaderData(t,e,n){const r=this._getTopLevelMetadata(t),i=this._getDracoAttributes(t,n);return{geometry_type:e,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:r,attributes:i}}_getDracoAttributes(t,e){const n={};for(let r=0;r<t.num_attributes();r++){const i=this.decoder.GetAttribute(t,r),o=this._getAttributeMetadata(t,r);n[i.unique_id()]={unique_id:i.unique_id(),attribute_type:i.attribute_type(),data_type:i.data_type(),num_components:i.num_components(),byte_offset:i.byte_offset(),byte_stride:i.byte_stride(),normalized:i.normalized(),attribute_index:r,metadata:o};const s=this._getQuantizationTransform(i,e);s&&(n[i.unique_id()].quantization_transform=s);const a=this._getOctahedronTransform(i,e);a&&(n[i.unique_id()].octahedron_transform=a)}return n}_getMeshData(t,e,n){const r=this._getMeshAttributes(e,t,n);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(n.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(t,e,n){const r={};for(const i of Object.values(t.attributes)){const t=this._deduceAttributeName(i,n);i.name=t;const{value:o,size:s}=this._getAttributeValues(e,i);r[t]={value:o,size:s,byteOffset:i.byte_offset,byteStride:i.byte_stride,normalized:i.normalized}}return r}_getTriangleListIndices(t){const e=3*t.num_faces(),n=4*e,r=this.draco._malloc(n);try{return this.decoder.GetTrianglesUInt32Array(t,n,r),new Uint32Array(this.draco.HEAPF32.buffer,r,e).slice()}finally{this.draco._free(r)}}_getTriangleStripIndices(t){const e=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,e),function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(e)}finally{this.draco.destroy(e)}}_getAttributeValues(t,e){const n=R[e.data_type],r=e.num_components,i=t.num_points()*r,o=i*n.BYTES_PER_ELEMENT,s=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}(this.draco,n);let a;const u=this.draco._malloc(o);try{const r=this.decoder.GetAttribute(t,e.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,r,s,o,u),a=new n(this.draco.HEAPF32.buffer,u,i).slice()}finally{this.draco._free(u)}return{value:a,size:r}}_deduceAttributeName(t,e){const n=t.unique_id;for(const[t,r]of Object.entries(e.extraAttributes||{}))if(r===n)return t;const r=t.attribute_type;for(const t in O)if(this.draco[t]===r)return O[t];const i=e.attributeNameEntry||"name";return t.metadata[i]?t.metadata[i].string:`CUSTOM_ATTRIBUTE_${n}`}_getTopLevelMetadata(t){const e=this.decoder.GetMetadata(t);return this._getDracoMetadata(e)}_getAttributeMetadata(t,e){const n=this.decoder.GetAttributeMetadata(t,e);return this._getDracoMetadata(n)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const e={},n=this.metadataQuerier.NumEntries(t);for(let r=0;r<n;r++){const n=this.metadataQuerier.GetEntryName(t,r);e[n]=this._getDracoMetadataField(t,n)}return e}_getDracoMetadataField(t,e){const n=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,e,n);const r=function(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}(n);return{int:this.metadataQuerier.GetIntEntry(t,e),string:this.metadataQuerier.GetStringEntry(t,e),double:this.metadataQuerier.GetDoubleEntry(t,e),intArray:r}}finally{this.draco.destroy(n)}}_disableAttributeTransforms(t){const{quantizedAttributes:e=[],octahedronAttributes:n=[]}=t,r=[...e,...n];for(const t of r)this.decoder.SkipAttributeTransform(this.draco[t])}_getQuantizationTransform(t,e){const{quantizedAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits(),range:e.range(),min_values:new Float32Array([1,2,3]).map((t=>e.min_value(t)))}}finally{this.draco.destroy(e)}}return null}_getOctahedronTransform(t,e){const{octahedronAttributes:n=[]}=e,r=t.attribute_type();if(n.map((t=>this.decoder[t])).includes(r)){const e=new this.draco.AttributeQuantizationTransform;try{if(e.InitFromAttribute(t))return{quantization_bits:e.quantization_bits()}}finally{this.draco.destroy(e)}}return null}}var N=n(6013),D=n(9125),F=n(6040);const k={};async function B(t,e=null,n={}){return e&&(t=function(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:N.jU?n.CDN?((0,F.h)(n.CDN.startsWith("http")),`${n.CDN}/${e}@3.0.11/dist/libs/${t}`):N.hJ?`../src/libs/${t}`:`modules/${e}/src/libs/${t}`:`modules/${e}/dist/libs/${t}`}(t,e,n)),k[t]=k[t]||async function(t){if(t.endsWith("wasm")){const e=await fetch(t);return await e.arrayBuffer()}if(!N.jU)return D.requireFromFile&&await D.requireFromFile(t);if(N.hJ)return importScripts(t);const e=await fetch(t);return function(t,e){if(!N.jU)return D.requireFromString&&D.requireFromString(t,e);if(N.hJ)return eval.call(N.CO,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch(e){n.text=t}return document.body.appendChild(n),null}(await e.text(),t)}(t),await k[t]}let j;const U={...r,parse:async function(t,e){const{draco:n}=await async function(t){const e=t.modules||{};return j=e.draco3d?j||e.draco3d.createDecoderModule({}).then((t=>({draco:t}))):j||async function(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.js","draco",t);break;case"wasm":default:[e,n]=await Promise.all([await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_wasm_wrapper.js","draco",t),await B("https://www.gstatic.com/draco/versioned/decoders/1.4.1/draco_decoder.wasm","draco",t)])}return e=e||globalThis.DracoDecoderModule,await function(t,e){const n={};return e&&(n.wasmBinary=e),new Promise((e=>{t({...n,onModuleLoaded:t=>e({draco:t})})}))}(e,n)}(t),await j}(e),r=new L(n);try{return r.parseSync(t,null==e?void 0:e.draco)}finally{r.destroy()}}}},8130:(t,e,n)=>{"use strict";n.d(e,{E:()=>ut});var r={};n.r(r),n.d(r,{decode:()=>D,encode:()=>F});var i={};n.r(i),n.d(i,{decode:()=>j,encode:()=>U});var o={};n.r(o),n.d(o,{decode:()=>z,encode:()=>G});var s={};n.r(s),n.d(s,{decode:()=>V,encode:()=>Z});var a=n(2378);function u(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}var c=n(4609);function l(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function h(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return n.substr(0,n.lastIndexOf("/")+1)+t}var A=n(7718),f=n(4942),p=n(9105),d=n(6269);function g(t,e){return(0,d.h)(t>=0),(0,d.h)(e>0),t+(e-1)&~(e-1)}function y(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const e=t.byteOffset,n=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,e,n)}return e.set(r,n),n+g(r.byteLength,4)}const m=["SCALAR","VEC2","VEC3","VEC4"],_=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],v=new Map(_),b={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},w={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function x(t){return m[t-1]||m[0]}function S(t){const e=v.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function P(t,e){const n=E[t.componentType],r=b[t.type],i=w[t.componentType],o=t.count*r,s=t.count*r*i;return l(s>=0&&s<=e.byteLength),{ArrayType:n,length:o,byteLength:s}}const T={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class C{constructor(t){(0,f.Z)(this,"gltf",void 0),(0,f.Z)(this,"sourceBuffers",void 0),(0,f.Z)(this,"byteLength",void 0),this.gltf=t||{json:{...T},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find((e=>e===t)),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find((e=>e===t))?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return n}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];l(n);const r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,{ArrayType:r,length:i}=P(t,e);return new r(n,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}removeObjectExtension(t,e){const n=t.extensions||{},r=n[e];return delete n[e],r}addExtension(t,e={}){return l(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return l(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((e=>e===t))||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((e=>e===t))||this.json.extensionsRequired.push(t)}removeExtension(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:e}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:e}),this.json.scenes.length-1}addNode(t){const{meshIndex:e,matrix:n}=t;this.json.nodes=this.json.nodes||[];const r={mesh:e};return n&&(r.matrix=n),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(t){const{attributes:e,indices:n,material:r,mode:i=4}=t,o={primitives:[{attributes:this._addAttributes(e),mode:i}]};if(n){const t=this._addIndices(n);o.primitives[0].indices=t}return Number.isFinite(r)&&(o.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){const n=(0,p.I)(t),r=e||(null==n?void 0:n.mimeType),i={bufferView:this.addBufferView(t),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(i),this.json.images.length-1}addBufferView(t){const e=t.byteLength;l(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=g(e,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:x(e.size),componentType:e.componentType,count:e.count,max:e.max,min:e.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const n=this.addBufferView(t);let r={min:e.min,max:e.max};r.min&&r.max||(r=this._getAccessorMinMax(t,e.size));const i={size:e.size,componentType:S(t),count:Math.round(t.length/e.size),min:r.min,max:r.max};return this.addAccessor(n,Object.assign(i,e))}addTexture(t){const{imageIndex:e}=t,n={source:e};return this.json.textures=this.json.textures||[],this.json.textures.push(n),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,e;this.gltf.buffers=[];const n=this.byteLength,r=new ArrayBuffer(n),i=new Uint8Array(r);let o=0;for(const t of this.sourceBuffers||[])o=y(t,i,o);null!==(t=this.json)&&void 0!==t&&null!==(e=t.buffers)&&void 0!==e&&e[0]?this.json.buffers[0].byteLength=n:this.json.buffers=[{byteLength:n}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}_addAttributes(t={}){const e={};for(const n in t){const r=t[n],i=this._getGltfAttributeName(n),o=this.addBinaryBuffer(r.value,r);e[i]=o}return e}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,e){const n={min:null,max:null};if(t.length<e)return n;n.min=[],n.max=[];const r=t.subarray(0,e);for(const t of r)n.min.push(t),n.max.push(t);for(let r=e;r<t.length;r+=e)for(let i=0;i<e;i++)n.min[0+i]=Math.min(n.min[0+i],t[r+i]),n.max[0+i]=Math.max(n.max[0+i],t[r+i]);return n}}const M="KHR_binary_glTF",I="KHR_draco_mesh_compression",O="KHR_lights_punctual",R="KHR_materials_unlit",L="KHR_techniques_webgl";function N(t){const{buffer:e,size:n,count:r}=function(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=function(t,e,n=!1){return t?Array.isArray(t)?new e(t):!n||t instanceof e?t:new e(t):null}(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}(t);return{value:e,size:n,byteOffset:0,count:r,type:x(n),componentType:S(e)}}async function D(t,e,n){var r;if(null==e||null===(r=e.gltf)||void 0===r||!r.decompressMeshes)return;const i=new C(t),o=[];for(const t of function*(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}(i))i.getObjectExtension(t,I)&&o.push(k(i,t,e,n));await Promise.all(o),i.removeExtension(I)}function F(t,e={}){const n=new C(t);for(const t of n.json.meshes||[])B(t),n.addRequiredExtension(I)}async function k(t,e,n,r){const i=t.getObjectExtension(e,I);if(!i)return;const o=t.getTypedArrayForBufferView(i.bufferView),s=(0,c.qv)(o.buffer,o.byteOffset),{parse:a}=r,u={...n};delete u["3d-tiles"];const l=await a(s,A.VJ,u,r),h=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=N(r);e[n]=t}}return e}(l.attributes);for(const[n,r]of Object.entries(h))if(n in e.attributes){const i=e.attributes[n],o=t.getAccessor(i);null!=o&&o.min&&null!=o&&o.max&&(r.min=o.min,r.max=o.max)}e.attributes=h,l.indices&&(e.indices=N(l.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(e)}function B(t,e,n=4,r,i){var o;if(!r.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const s=r.DracoWriter.encodeSync({attributes:t}),a=null==i||null===(o=i.parseSync)||void 0===o?void 0:o.call(i,{attributes:t}),u=r._addFauxAttributes(a.attributes),c=r.addBufferView(s);return{primitives:[{attributes:u,mode:n,extensions:{[I]:{bufferView:c,attributes:u}}}]}}async function j(t){const e=new C(t),{json:n}=e;e.removeExtension(R);for(const t of n.materials||[])t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),e.removeObjectExtension(t,R)}function U(t){const e=new C(t),{json:n}=e;if(e.materials)for(const t of n.materials||[])t.unlit&&(delete t.unlit,e.addObjectExtension(t,R,{}),e.addExtension(R))}async function z(t){const e=new C(t),{json:n}=e,r=e.getExtension(O);r&&(e.json.lights=r.lights,e.removeExtension(O));for(const t of n.nodes||[]){const n=e.getObjectExtension(t,O);n&&(t.light=n.light),e.removeObjectExtension(t,O)}}async function G(t){const e=new C(t),{json:n}=e;if(n.lights){const t=e.addExtension(O);l(!t.lights),t.lights=n.lights,delete n.lights}if(e.json.lights){for(const t of e.json.lights){const n=t.node;e.addObjectExtension(n,O,t)}delete e.json.lights}}async function V(t){const e=new C(t),{json:n}=e,r=e.getExtension(L);if(r){const t=function(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach((t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=o.decode(e.getTypedArrayForBufferView(t.bufferView))})),n.forEach((t=>{t.fragmentShader=r[t.fragmentShader],t.vertexShader=r[t.vertexShader]})),i.forEach((t=>{t.program=n[t.program]})),i}(r,e);for(const r of n.materials||[]){const n=e.getObjectExtension(r,L);n&&(r.technique=Object.assign({},n,t[n.technique]),r.technique.values=H(r.technique,e)),e.removeObjectExtension(r,L)}e.removeExtension(L)}}async function Z(t,e){}function H(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach((e=>{t.uniforms[e].value&&!(e in n)&&(n[e]=t.uniforms[e].value)})),Object.keys(n).forEach((t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))})),n}const q={KHR_draco_mesh_compression:r,KHR_materials_unlit:i,KHR_lights_punctual:o,KHR_techniques_webgl:s},W={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},X={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Y{constructor(t){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}}normalize(t,e){this.json=t.json;const n=t.json;switch(n.asset&&n.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${n.asset.version}`)}if(!e.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(n),this._convertTopLevelObjectsToArrays(n),function(t){const e=new C(t),{json:n}=e;for(const t of n.images||[]){const n=e.removeObjectExtension(t,M);n&&Object.assign(t,n)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(M)}(t),this._convertObjectIdsToArrayIndices(n),this._updateObjects(n),this._updateMaterial(n)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const e in W)this._convertTopLevelObjectToArray(t,e)}_convertTopLevelObjectToArray(t,e){const n=t[e];if(n&&!Array.isArray(n)){t[e]=[];for(const r in n){const i=n[r];i.id=i.id||r;const o=t[e].length;t[e].push(i),this.idToIndexMap[e][r]=o}}}_convertObjectIdsToArrayIndices(t){for(const e in W)this._convertIdsToIndices(t,e);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const e of t.textures)this._convertTextureIds(e);for(const e of t.meshes)this._convertMeshIds(e);for(const e of t.nodes)this._convertNodeIds(e);for(const e of t.scenes)this._convertSceneIds(e)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const e of t.primitives){const{attributes:t,indices:n,material:r}=e;for(const e in t)t[e]=this._convertIdToIndex(t[e],"accessor");n&&(e.indices=this._convertIdToIndex(n,"accessor")),r&&(e.material=this._convertIdToIndex(r,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map((t=>this._convertIdToIndex(t,"node")))),t.meshes&&(t.meshes=t.meshes.map((t=>this._convertIdToIndex(t,"mesh"))))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map((t=>this._convertIdToIndex(t,"node"))))}_convertIdsToIndices(t,e){t[e]||(console.warn(`gltf v1: json doesn't contain attribute ${e}`),t[e]=[]);for(const n of t[e])for(const t in n){const e=n[t],r=this._convertIdToIndex(e,t);n[t]=r}}_convertIdToIndex(t,e){const n=X[e];if(n in this.idToIndexMap){const r=this.idToIndexMap[n][t];if(!Number.isFinite(r))throw new Error(`gltf v1: failed to resolve ${e} with id ${t}`);return r}return t}_updateObjects(t){for(const t of this.json.buffers)delete t.type}_updateMaterial(t){for(const e of t.materials){e.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const n=e.values&&e.values.tex,r=t.textures.findIndex((t=>t.id===n));-1!==r&&(e.pbrMetallicRoughness.baseColorTexture={index:r})}}}const Q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},K={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},J={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},$={magFilter:J.TEXTURE_MAG_FILTER,minFilter:J.TEXTURE_MIN_FILTER,wrapS:J.TEXTURE_WRAP_S,wrapT:J.TEXTURE_WRAP_T},tt={[J.TEXTURE_MAG_FILTER]:J.LINEAR,[J.TEXTURE_MIN_FILTER]:J.NEAREST_MIPMAP_LINEAR,[J.TEXTURE_WRAP_S]:J.REPEAT,[J.TEXTURE_WRAP_]:J.REPEAT};class et{postProcess(t,e={}){const{json:n,buffers:r=[],images:i=[],baseUri:o=""}=t;return l(n),this.baseUri=o,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t,e={}){t.bufferViews&&(t.bufferViews=t.bufferViews.map(((t,e)=>this._resolveBufferView(t,e)))),t.images&&(t.images=t.images.map(((t,e)=>this._resolveImage(t,e)))),t.samplers&&(t.samplers=t.samplers.map(((t,e)=>this._resolveSampler(t,e)))),t.textures&&(t.textures=t.textures.map(((t,e)=>this._resolveTexture(t,e)))),t.accessors&&(t.accessors=t.accessors.map(((t,e)=>this._resolveAccessor(t,e)))),t.materials&&(t.materials=t.materials.map(((t,e)=>this._resolveMaterial(t,e)))),t.meshes&&(t.meshes=t.meshes.map(((t,e)=>this._resolveMesh(t,e)))),t.nodes&&(t.nodes=t.nodes.map(((t,e)=>this._resolveNode(t,e)))),t.skins&&(t.skins=t.skins.map(((t,e)=>this._resolveSkin(t,e)))),t.scenes&&(t.scenes=t.scenes.map(((t,e)=>this._resolveScene(t,e)))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];return n||console.warn(`glTF file error: Could not find ${t}[${e}]`),n}_resolveScene(t,e){return t.id=t.id||`scene-${e}`,t.nodes=(t.nodes||[]).map((t=>this.getNode(t))),t}_resolveNode(t,e){return t.id=t.id||`node-${e}`,t.children&&(t.children=t.children.map((t=>this.getNode(t)))),void 0!==t.mesh?t.mesh=this.getMesh(t.mesh):void 0!==t.meshes&&t.meshes.length&&(t.mesh=t.meshes.reduce(((t,e)=>{const n=this.getMesh(e);return t.id=n.id,t.primitives=t.primitives.concat(n.primitives),t}),{primitives:[]})),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||`skin-${e}`,t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||`mesh-${e}`,t.primitives&&(t.primitives=t.primitives.map((t=>{const e=(t={...t}).attributes;t.attributes={};for(const n in e)t.attributes[n]=this.getAccessor(e[n]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t}))),t}_resolveMaterial(t,e){if(t.id=t.id||`material-${e}`,t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.emissiveFactor||(t.emissiveFactor=t.emmisiveTexture?[1,1,1]:[0,0,0]),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){var n,r;if(t.id=t.id||`accessor-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,K[n]),t.components=(r=t.type,Q[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:n,byteLength:r}=P(t,t.bufferView),i=(t.bufferView.byteOffset||0)+(t.byteOffset||0)+e.byteOffset,o=e.arrayBuffer.slice(i,i+r);t.value=new n(o)}return t}_resolveTexture(t,e){return t.id=t.id||`texture-${e}`,t.sampler="sampler"in t?this.getSampler(t.sampler):tt,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||`sampler-${e}`,t.parameters={};for(const e in t){const n=this._enumSamplerParameter(e);void 0!==n&&(t.parameters[n]=t[e])}return t}_enumSamplerParameter(t){return $[t]}_resolveImage(t,e){t.id=t.id||`image-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){t.id=t.id||`bufferView-${e}`;const n=t.buffer;t.buffer=this.buffers[n];const r=this.buffers[n].arrayBuffer;let i=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(i+=t.byteOffset),t.data=new Uint8Array(r,i,t.byteLength),t}_resolveCamera(t,e){return t.id=t.id||`camera-${e}`,t.perspective,t.orthographic,t}}const nt=1735152710,rt=!0;function it(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(o),g(r,4)}function ot(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),g(r,4)}async function st(t,e,n=0,r,i){var o,s,a,c;!function(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!function(t,e=0,n={}){const r=new DataView(t),{magic:i=nt}=n,o=r.getUint32(e,!1);return o===i||o===nt}(e,n,r)&&(e=(new TextDecoder).decode(e)),"string"==typeof e)t.json=function(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(t,e=5){return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?u(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?u(t,0,e):""}(t)}"`)}}(e);else if(e instanceof ArrayBuffer){const i={};n=function(t,e,n=0,r={}){const i=new DataView(e),o=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,n+0),s=i.getUint32(n+4,rt),a=i.getUint32(n+8,rt);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:o,version:s,json:{},binChunks:[]}),n+=12,t.version){case 1:return function(t,e,n){(0,d.h)(t.header.byteLength>20);const r=e.getUint32(n+0,rt),i=e.getUint32(n+4,rt);return n+=8,(0,d.h)(0===i),it(t,e,n,r),(n+=r)+ot(t,e,n,t.header.byteLength)}(t,i,n);case 2:return function(t,e,n,r){return(0,d.h)(t.header.byteLength>20),function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,rt),o=e.getUint32(n+4,rt);switch(n+=8,o){case 1313821514:it(t,e,n,i);break;case 5130562:ot(t,e,n,i);break;case 0:r.strict||it(t,e,n,i);break;case 1:r.strict||ot(t,e,n,i)}n+=g(i,4)}}(t,e,n,{}),n+t.header.byteLength}(t,i,n);default:throw new Error(`Invalid GLB version ${t.version}. Only supports v1 and v2.`)}}(i,e,n,r.glb),l("glTF"===i.type,`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else l(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const o=t.json.images||[];t.images=new Array(o.length).fill({})}(t,e,n,r),function(t,e={}){(new Y).normalize(t,e)}(t,{normalize:null==r||null===(o=r.gltf)||void 0===o?void 0:o.normalize});const A=[];if(null!=r&&null!==(s=r.gltf)&&void 0!==s&&s.loadBuffers&&t.json.buffers&&await async function(t,e,n){for(let o=0;o<t.json.buffers.length;++o){const s=t.json.buffers[o];if(s.uri){var r,i;const{fetch:a}=n;l(a);const u=h(s.uri,e),c=await(null==n||null===(r=n.fetch)||void 0===r?void 0:r.call(n,u)),A=await(null==c||null===(i=c.arrayBuffer)||void 0===i?void 0:i.call(c));t.buffers[o]={arrayBuffer:A,byteOffset:0,byteLength:A.byteLength},delete s.uri}}}(t,r,i),null!=r&&null!==(a=r.gltf)&&void 0!==a&&a.loadImages){const e=async function(t,e,n){const r=t.json.images||[],i=[];for(let o=0;o<r.length;++o)i.push(at(t,r[o],o,e,n));return await Promise.all(i)}(t,r,i);A.push(e)}const f=async function(t,e={},n){for(const i in q){var r;const o=(null==e||null===(r=e.gltf)||void 0===r?void 0:r.excludeExtensions)||{};if(!(i in o)||o[i]){const r=q[i];await r.decode(t,e,n)}}}(t,r,i);return A.push(f),await Promise.all(A),null!=r&&null!==(c=r.gltf)&&void 0!==c&&c.postProcess?function(t,e){return(new et).postProcess(t,e)}(t,r):t}async function at(t,e,n,r,i){const{fetch:o,parse:s}=i;let u;if(e.uri){const t=h(e.uri,r),n=await o(t);u=await n.arrayBuffer()}if(Number.isFinite(e.bufferView)){const n=function(t,e,n){const r=t.bufferViews[n];l(r);const i=e[r.buffer];l(i);const o=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,o,r.byteLength)}(t.json,t.buffers,e.bufferView);u=(0,c.qv)(n.buffer,n.byteOffset,n.byteLength)}l(u,"glTF image has no data");const A=await s(u,a.S,{},i);t.images[n]=A}const ut={name:"glTF",id:"gltf",module:"gltf",version:"3.0.11",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(t,e={},n){(e={...ut.options,...e}).gltf={...ut.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await st({},t,r,e,n)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}}},2378:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e)}n.d(e,{S:()=>w});const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},o=i.global||i.self||i.window,s="object"!=typeof process||"[object process]"!==String(process)||process.browser,a="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),{_parseImageNode:u}=(a&&parseFloat(a[1]),o),c="undefined"!=typeof Image,l="undefined"!=typeof ImageBitmap,h=Boolean(u),A=!!s||h;function f(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const p=/^data:image\/svg\+xml/,d=/\.svg((\?|#).*)?$/;function g(t){return t&&(p.test(t)||d.test(t))}function y(t,e){if(g(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function m(t,e,n){const r=function(t,e){if(g(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return y(t,e)}(t,n),i=self.URL||self.webkitURL,o="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(t){r(t)}}))}(o||r,e)}finally{o&&i.revokeObjectURL(o)}}const _={};let v=!0;var b=n(9105);const w={id:"image",module:"images",name:"Images",version:"3.0.11",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:s}=n||{};let a;switch(function(t){switch(t){case"auto":case"data":return function(){if(l)return"imagebitmap";if(c)return"image";if(A)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return l||c||A;case"imagebitmap":return l;case"image":return c;case"data":return A;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(i)){case"imagebitmap":a=await async function(t,e,n){let r;r=g(n)?await m(t,e,n):y(t,n);const i=e&&e.imagebitmap;return await async function(t,e=null){if(!function(t){for(const e in t||_)return!1;return!0}(e)&&v||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),v=!1}return await createImageBitmap(t)}(r,i)}(t,e,s);break;case"image":a=await m(t,e,s);break;case"data":a=await function(t,e){const{mimeType:n}=(0,b.I)(t)||{},{_parseImageNode:i}=o;return r(i),i(t,n,e)}(t,e);break;default:r(!1)}return"data"===i&&(a=function(t){switch(f(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(a)),a},tests:[t=>Boolean((0,b.I)(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},9105:(t,e,n)=>{"use strict";n.d(e,{I:()=>o});const r=!1,i=!0;function o(t){const e=s(t);return function(t){const e=s(t);return e.byteLength>=24&&2303741511===e.getUint32(0,r)?{mimeType:"image/png",width:e.getUint32(16,r),height:e.getUint32(20,r)}:null}(e)||function(t){const e=s(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,r)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let o=2;for(;o+9<e.byteLength;){const t=e.getUint16(o,r);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(o+5,r),width:e.getUint16(o+7,r)};if(!n.has(t))return null;o+=2,o+=e.getUint16(o,r)}return null}(e)||function(t){const e=s(t);return e.byteLength>=10&&1195984440===e.getUint32(0,r)?{mimeType:"image/gif",width:e.getUint16(6,i),height:e.getUint16(8,i)}:null}(e)||function(t){const e=s(t);return e.byteLength>=14&&16973===e.getUint16(0,r)&&e.getUint32(2,i)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,i),height:e.getUint32(22,i)}:null}(e)}function s(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}},4609:(t,e,n)=>{"use strict";n.d(e,{rJ:()=>i,Xq:()=>o,JY:()=>s,qv:()=>a});var r=n(2540);function i(t){if(r.toArrayBuffer&&(t=r.toArrayBuffer(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.buffer;if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function o(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let t=0;t<r.length;++t)if(r[t]!==i[t])return!1;return!0}function s(...t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),r=new Uint8Array(n);let i=0;for(const t of e)r.set(t,i),i+=t.byteLength;return r.buffer}function a(t,e,n){const r=void 0!==n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}},6269:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}n.d(e,{h:()=>r})},4959:(t,e,n)=>{"use strict";n.d(e,{CO:()=>i,jU:()=>o});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},i=r.global||r.self||r.window||{},o="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);s&&parseFloat(s[1])},6040:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}n.d(e,{h:()=>r})},6013:(t,e,n)=>{"use strict";n.d(e,{CO:()=>i,jU:()=>o,hJ:()=>s,tq:()=>a});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document},i=r.global||r.self||r.window||{},o="object"!=typeof process||"[object process]"!==String(process)||process.browser,s="function"==typeof importScripts,a="undefined"!=typeof window&&void 0!==window.orientation,u="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);u&&parseFloat(u[1])},9757:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795}},2150:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AnimationLoop:()=>I.Z,Buffer:()=>a.Z,ClipSpace:()=>D.Z,ConeGeometry:()=>w,CubeGeometry:()=>F.Z,CylinderGeometry:()=>E,FEATURES:()=>o.h,Framebuffer:()=>c.Z,Geometry:()=>m.Z,IcoSphereGeometry:()=>T,Model:()=>O.Z,PlaneGeometry:()=>C,Program:()=>u.Z,ProgramManager:()=>L.Z,Renderbuffer:()=>l.Z,SphereGeometry:()=>M,Texture2D:()=>h.Z,Texture3D:()=>g.Z,TextureCube:()=>A.Z,Timeline:()=>N.T,Transform:()=>R.Z,TransformFeedback:()=>y.Z,TruncatedConeGeometry:()=>b,assert:()=>tt.Z,clear:()=>f.Z,cloneTextureFrom:()=>d.h,copyToTexture:()=>p.Lv,createGLContext:()=>r.s9,cssToDevicePixels:()=>r.JY,cssToDeviceRatio:()=>r.w,dirlight:()=>X,fp32:()=>Q.O,fp64:()=>z,getParameters:()=>r.ZS,gouraudLighting:()=>J.N,hasFeature:()=>s.U6,hasFeatures:()=>s.ag,instrumentGLContext:()=>r.yW,isWebGL:()=>r.UF,isWebGL2:()=>r.D0,log:()=>r.cM,lumaStats:()=>i.l,normalizeShaderModule:()=>Y.v,pbr:()=>$.b,phongLighting:()=>J.s,picking:()=>K.q,project:()=>q,readPixelsToArray:()=>p.z6,readPixelsToBuffer:()=>p.Jb,resetParameters:()=>r.kL,setParameters:()=>r.dR,uid:()=>_.hQ,withParameters:()=>r.s8});var r=n(9450),i=n(9835),o=n(6948),s=n(4211),a=n(3478),u=n(7944),c=n(3849),l=n(9830),h=n(4912),A=n(7952),f=n(6047),p=n(1953),d=n(3296),g=n(1319),y=n(1053),m=n(3982),_=n(4538);const v={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class b extends m.Z{constructor(t={}){const{id:e=(0,_.hQ)("truncated-code-geometry")}=t,{indices:n,attributes:r}=function(t){const{bottomRadius:e=0,topRadius:n=0,height:r=1,nradial:i=10,nvertical:o=10,verticalAxis:s="y",topCap:a=!1,bottomCap:u=!1}=t,c=(a?2:0)+(u?2:0),l=(i+1)*(o+1+c),h=Math.atan2(e-n,r),A=Math.sin,f=Math.cos,p=Math.PI,d=f(h),g=A(h),y=a?-2:0,m=o+(u?2:0),_=i+1,b=new Uint16Array(i*(o+c)*6),w=v[s],E=new Float32Array(3*l),x=new Float32Array(3*l),S=new Float32Array(2*l);let P=0,T=0;for(let t=y;t<=m;t++){let s,a=t/o,u=r*a;t<0?(u=0,a=1,s=e):t>o?(u=r,a=1,s=n):s=e+t/o*(n-e),-2!==t&&t!==o+2||(s=0,a=0),u-=r/2;for(let e=0;e<_;e++){const n=A(e*p*2/i),r=f(e*p*2/i);E[P+w[0]]=n*s,E[P+w[1]]=u,E[P+w[2]]=r*s,x[P+w[0]]=t<0||t>o?0:n*d,x[P+w[1]]=t<0?-1:t>o?1:g,x[P+w[2]]=t<0||t>o?0:r*d,S[T+0]=e/i,S[T+1]=a,T+=2,P+=3}}for(let t=0;t<o+c;t++)for(let e=0;e<i;e++){const n=6*(t*i+e);b[n+0]=_*(t+0)+0+e,b[n+1]=_*(t+0)+1+e,b[n+2]=_*(t+1)+1+e,b[n+3]=_*(t+0)+0+e,b[n+4]=_*(t+1)+1+e,b[n+5]=_*(t+1)+0+e}return{indices:b,attributes:{POSITION:{size:3,value:E},NORMAL:{size:3,value:x},TEXCOORD_0:{size:2,value:S}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class w extends b{constructor(t={}){const{id:e=(0,_.hQ)("cone-geometry"),radius:n=1,cap:r=!0}=t;super({...t,id:e,topRadius:0,topCap:Boolean(r),bottomCap:Boolean(r),bottomRadius:n})}}class E extends b{constructor(t={}){const{id:e=(0,_.hQ)("cylinder-geometry"),radius:n=1}=t;super({...t,id:e,bottomRadius:n,topRadius:n})}}var x=n(3855);const S=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],P=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class T extends m.Z{constructor(t={}){const{id:e=(0,_.hQ)("ico-sphere-geometry")}=t,{indices:n,attributes:r}=function(t){const{iterations:e=0}=t,n=Math.PI,r=2*n,i=[...S];let o=[...P];i.push(),o.push();const s=(()=>{const t={};return(e,n)=>{const r=(e*=3)>(n*=3)?e:n,o="".concat(e<n?e:n,"|").concat(r);if(o in t)return t[o];const s=i[e],a=i[e+1],u=i[e+2];let c=(s+i[n])/2,l=(a+i[n+1])/2,h=(u+i[n+2])/2;const A=Math.sqrt(c*c+l*l+h*h);return c/=A,l/=A,h/=A,i.push(c,l,h),t[o]=i.length/3-1}})();for(let t=0;t<e;t++){const t=[];for(let e=0;e<o.length;e+=3){const n=s(o[e+0],o[e+1]),r=s(o[e+1],o[e+2]),i=s(o[e+2],o[e+0]);t.push(i,o[e+0],n,n,o[e+1],r,r,o[e+2],i,n,r,i)}o=t}const a=new Array(i.length),u=new Array(i.length/3*2);for(let t=o.length-3;t>=0;t-=3){const e=o[t+0],s=o[t+1],c=o[t+2],l=3*e,h=3*s,A=3*c,f=2*e,p=2*s,d=2*c,g=i[l+0],y=i[l+1],m=i[l+2],_=Math.acos(m/Math.sqrt(g*g+y*y+m*m))/n,v=1-(Math.atan2(y,g)+n)/r,b=i[h+0],w=i[h+1],E=i[h+2],S=Math.acos(E/Math.sqrt(b*b+w*w+E*E))/n,P=1-(Math.atan2(w,b)+n)/r,T=i[A+0],C=i[A+1],M=i[A+2],I=Math.acos(M/Math.sqrt(T*T+C*C+M*M))/n,O=1-(Math.atan2(C,T)+n)/r,R=[T-b,C-w,M-E],L=[g-b,y-w,m-E],N=new x.Z(R).cross(L).normalize();let D;(0===v||0===P||0===O)&&(0===v||v>.5)&&(0===P||P>.5)&&(0===O||O>.5)&&(i.push(i[l+0],i[l+1],i[l+2]),D=i.length/3-1,o.push(D),u[2*D+0]=1,u[2*D+1]=_,a[3*D+0]=N.x,a[3*D+1]=N.y,a[3*D+2]=N.z,i.push(i[h+0],i[h+1],i[h+2]),D=i.length/3-1,o.push(D),u[2*D+0]=1,u[2*D+1]=S,a[3*D+0]=N.x,a[3*D+1]=N.y,a[3*D+2]=N.z,i.push(i[A+0],i[A+1],i[A+2]),D=i.length/3-1,o.push(D),u[2*D+0]=1,u[2*D+1]=I,a[3*D+0]=N.x,a[3*D+1]=N.y,a[3*D+2]=N.z),a[l+0]=a[h+0]=a[A+0]=N.x,a[l+1]=a[h+1]=a[A+1]=N.y,a[l+2]=a[h+2]=a[A+2]=N.z,u[f+0]=v,u[f+1]=_,u[p+0]=P,u[p+1]=S,u[d+0]=O,u[d+1]=I}return{indices:{size:1,value:new Uint16Array(o)},attributes:{POSITION:{size:3,value:new Float32Array(i)},NORMAL:{size:3,value:new Float32Array(a)},TEXCOORD_0:{size:2,value:new Float32Array(u)}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class C extends m.Z{constructor(t={}){const{id:e=(0,_.hQ)("plane-geometry")}=t,{indices:n,attributes:r}=function(t){const{type:e="x,y",offset:n=0,flipCull:r=!1,unpack:i=!1}=t,o=e.split(",");let s=t["".concat(o[0],"len")]||1;const a=t["".concat(o[1],"len")]||1,u=t["n".concat(o[0])]||1,c=t["n".concat(o[1])]||1,l=(u+1)*(c+1),h=new Float32Array(3*l),A=new Float32Array(3*l),f=new Float32Array(2*l);r&&(s=-s);let p=0,d=0;for(let t=0;t<=c;t++)for(let i=0;i<=u;i++){const o=i/u,l=t/c;switch(f[p+0]=r?1-o:o,f[p+1]=l,e){case"x,y":h[d+0]=s*o-.5*s,h[d+1]=a*l-.5*a,h[d+2]=n,A[d+0]=0,A[d+1]=0,A[d+2]=r?1:-1;break;case"x,z":h[d+0]=s*o-.5*s,h[d+1]=n,h[d+2]=a*l-.5*a,A[d+0]=0,A[d+1]=r?1:-1,A[d+2]=0;break;case"y,z":h[d+0]=n,h[d+1]=s*o-.5*s,h[d+2]=a*l-.5*a,A[d+0]=r?1:-1,A[d+1]=0,A[d+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}p+=2,d+=3}const g=u+1,y=new Uint16Array(u*c*6);for(let t=0;t<c;t++)for(let e=0;e<u;e++){const n=6*(t*u+e);y[n+0]=(t+0)*g+e,y[n+1]=(t+1)*g+e,y[n+2]=(t+0)*g+e+1,y[n+3]=(t+1)*g+e,y[n+4]=(t+1)*g+e+1,y[n+5]=(t+0)*g+e+1}const m={indices:{size:1,value:y},attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:A},TEXCOORD_0:{size:2,value:f}}};return i?function(t){const{indices:e,attributes:n}=t;if(!e)return t;const r=e.value.length,i={};for(const t in n){const o=n[t],{constant:s,value:a,size:u}=o;if(s||!u)continue;const c=new a.constructor(r*u);for(let t=0;t<r;++t){const n=e.value[t];for(let e=0;e<u;e++)c[t*u+e]=a[n*u+e]}i[t]={size:u,value:c}}return{attributes:Object.assign({},n,i)}}(m):m}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}class M extends m.Z{constructor(t={}){const{id:e=(0,_.hQ)("sphere-geometry")}=t,{indices:n,attributes:r}=function(t){const{nlat:e=10,nlong:n=10}=t;let{radius:r=1}=t;const i=Math.PI-0,o=2*Math.PI-0,s=(e+1)*(n+1);if("number"==typeof r){const t=r;r=(e,n,r,i,o)=>t}const a=new Float32Array(3*s),u=new Float32Array(3*s),c=new Float32Array(2*s),l=new(s>65535?Uint32Array:Uint16Array)(e*n*6);for(let t=0;t<=e;t++)for(let s=0;s<=n;s++){const l=s/n,h=t/e,A=s+t*(n+1),f=2*A,p=3*A,d=o*l,g=i*h,y=Math.sin(d),m=Math.cos(d),_=Math.sin(g),v=m*_,b=Math.cos(g),w=y*_,E=r(v,b,w,l,h);a[p+0]=E*v,a[p+1]=E*b,a[p+2]=E*w,u[p+0]=v,u[p+1]=b,u[p+2]=w,c[f+0]=l,c[f+1]=1-h}const h=n+1;for(let t=0;t<n;t++)for(let n=0;n<e;n++){const r=6*(t*e+n);l[r+0]=n*h+t,l[r+1]=n*h+t+1,l[r+2]=(n+1)*h+t,l[r+3]=(n+1)*h+t,l[r+4]=n*h+t+1,l[r+5]=(n+1)*h+t+1}return{indices:{size:1,value:l},attributes:{POSITION:{size:3,value:a},NORMAL:{size:3,value:u},TEXCOORD_0:{size:2,value:c}}}}(t);super({...t,id:e,indices:n,attributes:{...r,...t.attributes}})}}var I=n(9902),O=n(1113),R=n(3346),L=n(1731),N=n(8055),D=n(6234),F=n(1167);function k(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function B(t){return t-Math.fround(t)}function j(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=4*n+r;k(t[4*r+n],e,2*i)}return e}const U={ONE:1},z={name:"fp64",vs:"const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);\nconst vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);\nconst vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);\nconst vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);\nconst vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);\nconst vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);\nconst vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);\nconst vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);\nconst vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);\nconst vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);\n\nconst vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);\nconst vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);\nconst vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);\nconst vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);\n\nconst vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);\nconst vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);\nconst vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);\nconst vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);\n\nconst vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);\nconst vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);\nconst vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);\nconst vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);\nconst vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);\nconst vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);\nconst vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);\nconst vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);\n\nfloat nint(float d) {\n    if (d == floor(d)) return d;\n    return floor(d + 0.5);\n}\n\nvec2 nint_fp64(vec2 a) {\n    float hi = nint(a.x);\n    float lo;\n    vec2 tmp;\n    if (hi == a.x) {\n        lo = nint(a.y);\n        tmp = quickTwoSum(hi, lo);\n    } else {\n        lo = 0.0;\n        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {\n            hi -= 1.0;\n        }\n        tmp = vec2(hi, lo);\n    }\n    return tmp;\n}\n\nvec2 exp_fp64(vec2 a) {\n\n  const int k_power = 4;\n  const float k = 16.0;\n\n  const float inv_k = 1.0 / k;\n\n  if (a.x <= -88.0) return vec2(0.0, 0.0);\n  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);\n  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);\n  if (a.x == 1.0 && a.y == 0.0) return E_FP64;\n\n  float m = floor(a.x / LOG2_FP64.x + 0.5);\n  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;\n  vec2 s, t, p;\n\n  p = mul_fp64(r, r);\n  s = sum_fp64(r, p * 0.5);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);\n\n  s = sum_fp64(s, t);\n  p = mul_fp64(p, r);\n  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);\n\n\n\n\n\n\n  s = sum_fp64(s, t);\n  for (int i = 0; i < k_power; i++) {\n    s = sum_fp64(s * 2.0, mul_fp64(s, s));\n  }\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = sum_fp64(s, vec2(ONE, 0.0));\n#else\n  s = sum_fp64(s, vec2(1.0, 0.0));\n#endif\n\n  return s * pow(2.0, m);\n}\n\nvec2 log_fp64(vec2 a)\n{\n  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n  vec2 x = vec2(log(a.x), 0.0);\n  vec2 s;\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n  s = vec2(ONE, 0.0);\n#else\n  s = vec2(1.0, 0.0);\n#endif\n\n  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);\n  return x;\n}\n\nvec2 sin_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(0.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  s = a;\n  r = a;\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvec2 cos_taylor_fp64(vec2 a) {\n  vec2 r, s, t, x;\n\n  if (a.x == 0.0 && a.y == 0.0) {\n    return vec2(1.0, 0.0);\n  }\n\n  x = -mul_fp64(a, a);\n  r = x;\n  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);\n  s = sum_fp64(s, t);\n\n  r = mul_fp64(r, x);\n  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);\n  s = sum_fp64(s, t);\n\n\n\n\n\n\n  return s;\n}\n\nvoid sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {\n  if (a.x == 0.0 && a.y == 0.0) {\n    sin_t = vec2(0.0, 0.0);\n    cos_t = vec2(1.0, 0.0);\n  }\n\n  sin_t = sin_taylor_fp64(a);\n  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));\n}\n\nvec2 sin_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return sin_taylor_fp64(t);\n        } else if (j == 1) {\n            return cos_taylor_fp64(t);\n        } else if (j == -1) {\n            return -cos_taylor_fp64(t);\n        } else {\n            return -sin_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 cos_fp64(vec2 a) {\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(1.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n\n    if (k == 0) {\n        if (j == 0) {\n            return cos_taylor_fp64(t);\n        } else if (j == 1) {\n            return -sin_taylor_fp64(t);\n        } else if (j == -1) {\n            return sin_taylor_fp64(t);\n        } else {\n            return -cos_taylor_fp64(t);\n        }\n    }\n\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n    if (abs(float(abs_k) - 1.0) < 0.5) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs(float(abs_k) - 2.0) < 0.5) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs(float(abs_k) - 3.0) < 0.5) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs(float(abs_k) - 4.0) < 0.5) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#else\n    if (abs_k == 1) {\n        u = COS_TABLE_0_FP64;\n        v = SIN_TABLE_0_FP64;\n    } else if (abs_k == 2) {\n        u = COS_TABLE_1_FP64;\n        v = SIN_TABLE_1_FP64;\n    } else if (abs_k == 3) {\n        u = COS_TABLE_2_FP64;\n        v = SIN_TABLE_2_FP64;\n    } else if (abs_k == 4) {\n        u = COS_TABLE_3_FP64;\n        v = SIN_TABLE_3_FP64;\n    }\n#endif\n\n    vec2 sin_t, cos_t;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    vec2 result = vec2(0.0, 0.0);\n    if (j == 0) {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    } else if (j == 1) {\n        if (k > 0) {\n            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));\n        }\n    } else if (j == -1) {\n        if (k > 0) {\n            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        } else {\n            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n        }\n    } else {\n        if (k > 0) {\n            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));\n        } else {\n            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    return result;\n}\n\nvec2 tan_fp64(vec2 a) {\n    vec2 sin_a;\n    vec2 cos_a;\n\n    if (a.x == 0.0 && a.y == 0.0) {\n        return vec2(0.0, 0.0);\n    }\n    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));\n    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));\n\n    vec2 t;\n    float q = floor(r.x / PI_2_FP64.x + 0.5);\n    int j = int(q);\n\n\n    if (j < -2 || j > 2) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    }\n\n    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));\n\n    q = floor(t.x / PI_16_FP64.x + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return vec2(0.0 / 0.0, 0.0 / 0.0);\n    } else {\n        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));\n    }\n\n\n    vec2 u = vec2(0.0, 0.0);\n    vec2 v = vec2(0.0, 0.0);\n\n    vec2 sin_t, cos_t;\n    vec2 s, c;\n    sincos_taylor_fp64(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#else\n        if (abs_k == 1) {\n            u = COS_TABLE_0_FP64;\n            v = SIN_TABLE_0_FP64;\n        } else if (abs_k == 2) {\n            u = COS_TABLE_1_FP64;\n            v = SIN_TABLE_1_FP64;\n        } else if (abs_k == 3) {\n            u = COS_TABLE_2_FP64;\n            v = SIN_TABLE_2_FP64;\n        } else if (abs_k == 4) {\n            u = COS_TABLE_3_FP64;\n            v = SIN_TABLE_3_FP64;\n        }\n#endif\n        if (k > 0) {\n            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        } else {\n            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));\n            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return div_fp64(sin_a, cos_a);\n}\n\nvec2 radians_fp64(vec2 degree) {\n  return mul_fp64(degree, PI_180_FP64);\n}\n\nvec2 mix_fp64(vec2 a, vec2 b, float x) {\n  vec2 range = sub_fp64(b, a);\n  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));\n}\n\nvoid vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sum_fp64(a[0], b[0]);\n    out_val[1] = sum_fp64(a[1], b[1]);\n}\n\nvoid vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = sub_fp64(a[0], b[0]);\n    out_val[1] = sub_fp64(a[1], b[1]);\n}\n\nvoid vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = mul_fp64(a[0], b[0]);\n    out_val[1] = mul_fp64(a[1], b[1]);\n}\n\nvoid vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {\n    out_val[0] = div_fp64(a[0], b[0]);\n    out_val[1] = div_fp64(a[1], b[1]);\n}\n\nvoid vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {\n  vec2 range[2];\n  vec2_sub_fp64(y, x, range);\n  vec2 portion[2];\n  portion[0] = range[0] * a;\n  portion[1] = range[1] * a;\n  vec2_sum_fp64(x, portion, out_val);\n}\n\nvec2 vec2_length_fp64(vec2 x[2]) {\n  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));\n}\n\nvoid vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {\n  vec2 length = vec2_length_fp64(x);\n  vec2 length_vec2[2];\n  length_vec2[0] = length;\n  length_vec2[1] = length;\n\n  vec2_div_fp64(x, length_vec2, out_val);\n}\n\nvec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {\n  vec2 diff[2];\n  vec2_sub_fp64(x, y, diff);\n  return vec2_length_fp64(diff);\n}\n\nvec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {\n  vec2 v[2];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n\n  return sum_fp64(v[0], v[1]);\n}\nvoid vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {\n  for (int i = 0; i < 3; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvec2 vec3_length_fp64(vec2 x[3]) {\n  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),\n    mul_fp64(x[2], x[2])));\n}\n\nvec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {\n  vec2 diff[3];\n  vec3_sub_fp64(x, y, diff);\n  return vec3_length_fp64(diff);\n}\nvoid vec4_fp64(vec4 a, out vec2 out_val[4]) {\n  out_val[0].x = a[0];\n  out_val[0].y = 0.0;\n\n  out_val[1].x = a[1];\n  out_val[1].y = 0.0;\n\n  out_val[2].x = a[2];\n  out_val[2].y = 0.0;\n\n  out_val[3].x = a[3];\n  out_val[3].y = 0.0;\n}\n\nvoid vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {\n  out_val[0] = mul_fp64(a[0], b);\n  out_val[1] = mul_fp64(a[1], b);\n  out_val[2] = mul_fp64(a[2], b);\n  out_val[3] = mul_fp64(a[3], b);\n}\n\nvoid vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {\n  for (int i = 0; i < 4; i++) {\n    out_val[i] = sum_fp64(a[i], b[i]);\n  }\n}\n\nvoid vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {\n  vec2 v[4];\n\n  v[0] = mul_fp64(a[0], b[0]);\n  v[1] = mul_fp64(a[1], b[1]);\n  v[2] = mul_fp64(a[2], b[2]);\n  v[3] = mul_fp64(a[3], b[3]);\n\n  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));\n}\n\nvoid mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {\n  vec2 tmp[4];\n\n  for (int i = 0; i < 4; i++)\n  {\n    for (int j = 0; j < 4; j++)\n    {\n      tmp[j] = b[j + i * 4];\n    }\n    vec4_dot_fp64(a, tmp, out_val[i]);\n  }\n}\n",fs:null,dependencies:[{name:"fp64-arithmetic",vs:"uniform float ONE;\nvec2 split(float a) {\n  const float SPLIT = 4097.0;\n  float t = a * SPLIT;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float a_hi = t * ONE - (t - a);\n  float a_lo = a * ONE - a_hi;\n#else\n  float a_hi = t - (t - a);\n  float a_lo = a - a_hi;\n#endif\n  return vec2(a_hi, a_lo);\n}\nvec2 split2(vec2 a) {\n  vec2 b = split(a.x);\n  b.y += a.y;\n  return b;\n}\nvec2 quickTwoSum(float a, float b) {\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float sum = (a + b) * ONE;\n  float err = b - (sum - a) * ONE;\n#else\n  float sum = a + b;\n  float err = b - (sum - a);\n#endif\n  return vec2(sum, err);\n}\nvec2 twoSum(float a, float b) {\n  float s = (a + b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) + (b - v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSub(float a, float b) {\n  float s = (a - b);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float v = (s * ONE - a) * ONE;\n  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);\n#else\n  float v = s - a;\n  float err = (a - (s - v)) - (b + v);\n#endif\n  return vec2(s, err);\n}\n\nvec2 twoSqr(float a) {\n  float prod = a * a;\n  vec2 a_fp64 = split(a);\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *\n    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;\n#else\n  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;\n#endif\n  return vec2(prod, err);\n}\n\nvec2 twoProd(float a, float b) {\n  float prod = a * b;\n  vec2 a_fp64 = split(a);\n  vec2 b_fp64 = split(b);\n  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +\n    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;\n  return vec2(prod, err);\n}\n\nvec2 sum_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSum(a.x, b.x);\n  t = twoSum(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 sub_fp64(vec2 a, vec2 b) {\n  vec2 s, t;\n  s = twoSub(a.x, b.x);\n  t = twoSub(a.y, b.y);\n  s.y += t.x;\n  s = quickTwoSum(s.x, s.y);\n  s.y += t.y;\n  s = quickTwoSum(s.x, s.y);\n  return s;\n}\n\nvec2 mul_fp64(vec2 a, vec2 b) {\n  vec2 prod = twoProd(a.x, b.x);\n  prod.y += a.x * b.y;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  prod.y += a.y * b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  prod = split2(prod);\n#endif\n  prod = quickTwoSum(prod.x, prod.y);\n  return prod;\n}\n\nvec2 div_fp64(vec2 a, vec2 b) {\n  float xn = 1.0 / b.x;\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  vec2 yn = mul_fp64(a, vec2(xn, 0));\n#else\n  vec2 yn = a * xn;\n#endif\n  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;\n  vec2 prod = twoProd(xn, diff);\n  return sum_fp64(yn, prod);\n}\n\nvec2 sqrt_fp64(vec2 a) {\n  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);\n  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);\n\n  float x = 1.0 / sqrt(a.x);\n  float yn = a.x * x;\n#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)\n  vec2 yn_sqr = twoSqr(yn) * ONE;\n#else\n  vec2 yn_sqr = twoSqr(yn);\n#endif\n  float diff = sub_fp64(a, yn_sqr).x;\n  vec2 prod = twoProd(x * 0.5, diff);\n#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)\n  return sum_fp64(split(yn), prod);\n#else\n  return sum_fp64(vec2(yn, 0.0), prod);\n#endif\n}\n",fs:null,getUniforms:function(){return U},fp64ify:k,fp64LowPart:B,fp64ifyMatrix4:j}],fp64ify:k,fp64LowPart:B,fp64ifyMatrix4:j};var G=n(5451);const V=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Z={modelMatrix:V,viewMatrix:V,projectionMatrix:V,cameraPositionWorld:[0,0,0]},H="varying vec4 project_vPositionWorld;\nvarying vec3 project_vNormalWorld;\n\nvec4 project_getPosition_World() {\n  return project_vPositionWorld;\n}\n\nvec3 project_getNormal_World() {\n  return project_vNormalWorld;\n}\n",q={name:"project",getUniforms:function(t=Z,e={}){const n={};return void 0!==t.modelMatrix&&(n.modelMatrix=t.modelMatrix),void 0!==t.viewMatrix&&(n.viewMatrix=t.viewMatrix),void 0!==t.projectionMatrix&&(n.projectionMatrix=t.projectionMatrix),void 0!==t.cameraPositionWorld&&(n.cameraPositionWorld=t.cameraPositionWorld),void 0===t.projectionMatrix&&void 0===t.viewMatrix||(n.viewProjectionMatrix=new G.Z(t.projectionMatrix).multiplyRight(t.viewMatrix)),n},vs:"".concat(H,"\nuniform mat4 modelMatrix;\nuniform mat4 viewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewProjectionMatrix;\nuniform vec3 cameraPositionWorld;\n\nstruct World {\n  vec3 position;\n  vec3 normal;\n};\n\nWorld world;\n\nvoid project_setPosition(vec4 position) {\n  project_vPositionWorld = position;\n}\n\nvoid project_setNormal(vec3 normal) {\n  project_vNormalWorld = normal;\n}\n\nvoid project_setPositionAndNormal_World(vec3 position, vec3 normal) {\n  world.position = position;\n  world.normal = normal;\n}\n\nvoid project_setPositionAndNormal_Model(vec3 position, vec3 normal) {\n  world.position = (modelMatrix * vec4(position, 1.)).xyz;\n  world.normal = mat3(modelMatrix) * normal;\n}\n\nvec4 project_model_to_clipspace(vec4 position) {\n  return viewProjectionMatrix * modelMatrix * position;\n}\n\nvec4 project_model_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);\n}\n\nvec4 project_world_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_view_to_clipspace(vec3 position) {\n  return projectionMatrix * vec4(position, 1.);\n}\n\nvec4 project_to_clipspace(vec3 position) {\n  return viewProjectionMatrix * vec4(position, 1.);\n}\n"),fs:"\n".concat(H)},W={lightDirection:new Float32Array([1,1,2])},X={name:"dirlight",vs:null,fs:"uniform vec3 dirlight_uLightDirection;\nvec4 dirlight_filterColor(vec4 color) {\n  vec3 normal = project_getNormal_World();\n  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));\n  return vec4(color.rgb * d, color.a);\n}\n",getUniforms:function(t=W){const e={};return t.lightDirection&&(e.dirlight_uLightDirection=t.lightDirection),e},dependencies:[q]};var Y=n(6119),Q=n(5502),K=n(3330),J=n(7287),$=n(4080),tt=n(2525)},8055:(t,e,n)=>{"use strict";n.d(e,{T:()=>o});let r=1,i=1;class o{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const t of e)this._setChannelTime(t,this.time);const n=this.animations.values();for(const t of n){const{animation:e,channel:n}=t;e.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=i++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}},1167:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(3982),i=n(4538);const o=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),s=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),a=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),u=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),c={POSITION:{size:3,value:new Float32Array(s)},NORMAL:{size:3,value:new Float32Array(a)},TEXCOORD_0:{size:2,value:new Float32Array(u)}};class l extends r.Z{constructor(t={}){const{id:e=(0,i.hQ)("cube-geometry")}=t;super({...t,id:e,indices:{size:1,value:new Uint16Array(o)},attributes:{...c,...t.attributes}})}}},3982:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(4538),i=n(2525);const o={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class s{static get DRAW_MODE(){return o}constructor(t={}){const{id:e=(0,r.hQ)("geometry"),drawMode:n=o.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,(0,i.Z)(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),"POSITION"!==e&&"positions"!==e||n.size||(n.size=3),"indices"===e?((0,i.Z)(!this.indices),this.indices=n):this.attributes[e]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const e in t){const r=t[e],{value:i,size:o,constant:s}=r;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return(0,i.Z)(Number.isFinite(n)),n}}},9902:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(9450),i=n(7577),o=n(4211),s=n(6948),a=n(2525);class u extends i.Z{static isSupported(t,e=[]){const n=(0,r.D0)(t),i=(0,o.ag)(t,s.h.TIMER_QUERY);let u=n||i;for(const t of e)switch(t){case"queries":u=u&&n;break;case"timers":u=u&&i;break;default:(0,a.Z)(!1)}return u}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return u.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}var c=n(9835),l=n(3849);const h=(0,n(9718).jU)()&&"undefined"!=typeof document;let A=0;class f{constructor(t={}){const{onCreateContext:e=(t=>(0,r.s9)(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:o=(()=>{}),onFinalize:s=(()=>{}),onError:a,gl:u=null,glOptions:l={},debug:h=!1,createFramebuffer:f=!1,autoResizeViewport:p=!0,autoResizeDrawingBuffer:d=!0,stats:g=c.l.get("animation-loop-".concat(A++))}=t;let{useDevicePixels:y=!0}=t;"useDevicePixelRatio"in t&&(r.cM.deprecated("useDevicePixelRatio","useDevicePixels")(),y=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:o,onFinalize:s,onError:a,gl:u,glOptions:l,debug:h,createFramebuffer:f},this.gl=u,this.needsRedraw=null,this.timeline=null,this.stats=g,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:p,autoResizeDrawingBuffer:d,useDevicePixels:y}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return(0,a.Z)("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=u.isSupported(this.gl,["timers"])?new u(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return r.cM.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=h?new Promise(((t,e)=>{h&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?(0,r.yW)(this.props.gl,t):this.onCreateContext(t),!(0,r.UF)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(0,r.kL)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&(0,r.aQ)(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new l.Z(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}},1113:(t,e,n)=>{"use strict";n.d(e,{Z:()=>D});var r=n(9450),i=n(1731),o=n(4072),s=n(3478),a=n(7577);let u=null;var c=n(2525),l=n(6073),h=n(5989),A=n(1202);class f extends a.Z{static isSupported(t,e={}){return!e.constantAttributeZero||(0,r.D0)(t)||"Chrome"===function(t){if(!(0,h.Z)())return"Node";if((0,A.Z)(t))return"Electron";const e=("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(e.indexOf("Edge")>-1)return"Edge";const n=-1!==e.indexOf("MSIE "),r=-1!==e.indexOf("Trident/");return n||r?"IE":l.u9.chrome?"Chrome":l.u9.safari?"Safari":l.u9.mozInnerScreenX?"Firefox":"Unknown"}()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new f(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return f.MAX_ATTRIBUTES=f.MAX_ATTRIBUTES||t.getParameter(34921),f.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:f._setConstantFloatArray(t,e,n);break;case Int32Array:f._setConstantIntArray(t,e,n);break;case Uint32Array:f._setConstantUintArray(t,e,n);break;default:(0,c.Z)(!1)}}constructor(t,e={}){const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return f.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return(0,c.Z)(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:o,stride:s,offset:a,normalized:u,integer:l,divisor:h}=n,{gl:A,gl2:f}=this;return t=Number(t),this.bind((()=>{A.bindBuffer(34962,e.handle),l?((0,c.Z)((0,r.D0)(A)),f.vertexAttribIPointer(t,i,o,s,a)):A.vertexAttribPointer(t,i,o,u,s,a),A.enableVertexAttribArray(t),f.vertexAttribDivisor(t,h||0)})),this}enable(t,e=!0){return!e&&0===t&&!f.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new s.Z(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!u||u.byteLength<n)&&(u=new ArrayBuffer(n)),u),0,e)}(e.constructor,i);!function({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let r=n;s<i;s++)t[r++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o)}({target:t,source:n,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:(0,c.Z)(!1)}}static _setConstantIntArray(t,e,n){switch((0,c.Z)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:(0,c.Z)(!1)}}static _setConstantUintArray(t,e,n){switch((0,c.Z)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:(0,c.Z)(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return(0,c.Z)(Number.isFinite(e)),this.bind((()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(e,t);default:return this.gl.getVertexAttrib(e,t)}}))}}var p=n(7469);const d=/^(.+)__LOCATION_([0-9]+)$/,g=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class y{constructor(t,e={}){const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new f(t),(0,p.F)(this,"VertexArray","v6.0",g),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,n={}){if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new s.Z(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof s.Z&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof s.Z&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),r=n()})),r}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:u}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,r.cM.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),s;const l=this._getAttributeInfo(u||a);if(!l)return s;const h=this.accessors[a]||{},A=o.Z.resolve(l.accessor,h,n,i),{size:f,type:p}=A;return(0,c.Z)(Number.isFinite(f)&&Number.isFinite(p)),{location:a,accessor:A}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=d.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof s.Z)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof s.Z){const n=e[0],r=e[1];this.setBuffer(t,n,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof s.Z))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let t=1;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)r=this.values[t],ArrayBuffer.isView(r)&&this._setConstantAttribute(t,r)}_setConstantAttributeZero(t,e){if(f.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){f.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:i}=r,o=i>0;if(t.isInstanced=t.isInstanced||o,n instanceof s.Z){const e=n;if(o){const n=e.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(t=null,e={}){return r.cM.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}var m=n(4538),_=n(6047),v=n(7944),b=n(1053),w=n(9579),E=n(8522);function x(t,e={}){const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r==0?" ":"")),i+=x(t[o],e);const o=t.length>n?"...":"]";return"".concat(i).concat(o)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function S(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o,a,u,c="NOT PROVIDED",l=1,h=0,A=0;if(n&&(c=n.type,l=n.size,c=String(c).replace("Array",""),o=-1!==c.indexOf("nt")),e instanceof s.Z){const t=e,{data:s,changed:f}=t.getDebugData();let p;if(a=f?"*":"",u=s,A=t.byteLength,h=A/s.BYTES_PER_ELEMENT/l,n){const t=n.divisor>0;p="".concat(t?"I ":"P "," ").concat(h," (x").concat(l,"=").concat(A," bytes ").concat((0,w.km)(i,c),")")}else o=!0,p="".concat(A," bytes");return{[r]:"".concat(a).concat(x(u,{size:l,isInteger:o})),"Format ":p}}return u=e,l=e.length,c=String(e.constructor.name).replace("Array",""),o=-1!==c.indexOf("nt"),{[r]:"".concat(x(u,{size:l,isInteger:o})," (constant)"),"Format ":"".concat(l,"x").concat(c," (constant)")}}function P(t,e){const{type:n,size:r}=e,i=(0,E.jG)(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function T({header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}){(0,c.Z)(e);const i=".*Matrix",o=e._uniformSetters,s={},a=Object.keys(o).sort();let u=0;for(const e of a)e.match(".*_.*")||e.match(i)||C({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&u++;for(const e of a)e.match(i)&&C({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&u++;for(const e of a)s[e]||C({table:s,header:t,uniforms:n,uniformName:e,undefinedOnly:r})&&u++;let l=0;const h={};if(!r)for(const e in n){const r=n[e];s[e]||(l++,h[e]={Type:"NOT USED: ".concat(r),[t]:x(r)})}return{table:s,count:u,unusedTable:h,unusedCount:l}}function C({table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(t){return null!=t}(o);return!(i&&s||(t[r]={[e]:s?x(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},0))}function M(t){const{type:e,size:n}=t.accessor,r=(0,E.jG)(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const I={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function O(t,e){const{attributeMap:n=I}=e||{};return n&&n[t]||t}function R(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}(0,c.Z)(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const L=()=>{},N={};class D{constructor(t,e={}){const{id:n=(0,m.hQ)("model")}=e;(0,c.Z)((0,r.UF)(t)),this.id=n,this.gl=t,this.id=e.id||(0,m.hQ)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||i.Z.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:u,bufferMode:l,transpileToGLSL100:h}=t;this.programProps={program:e,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:u,bufferMode:l,transpileToGLSL100:h},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},(0,c.Z)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return(0,c.Z)(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return(0,c.Z)(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const r={};let i=e.indices;for(const n in e.attributes){const o=e.attributes[n],a=O(n,undefined);if("indices"===n)i=o;else if(o.constant)r[a]=o.value;else{const e=o.value,i={...o};delete i.value,r[a]=[new s.Z(t,e),i],R(n,i)}}if(i){const e=i.value||i;(0,c.Z)(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new s.Z(t,{data:e,target:34963}),n]}return r}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if((0,m.nK)(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return(0,_.Z)(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:o={},transformFeedback:s=this.transformFeedback,parameters:a={},vertexArray:u=this.vertexArray}=t;let c;this.setAttributes(o),this.updateModuleSettings(e),this.setUniforms(i),r.cM.priority>=2&&(c=this._logDrawCallStart(2));const l=this.vertexArray.getDrawParams(),{isIndexed:h=l.isIndexed,indexType:A=l.indexType,indexOffset:f=l.indexOffset,vertexArrayInstanced:p=l.isInstanced}=this.props;p&&!this.isInstanced&&r.cM.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:d,instanceCount:g}=this,{onBeforeRender:y=L,onAfterRender:m=L}=this.props;y(),this.program.setUniforms(this.uniforms);const _=this.program.draw(Object.assign(N,t,{logPriority:c,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:u,transformFeedback:s,isIndexed:h,indexType:A,isInstanced:d,instanceCount:g,offset:h?f:0}));return m(),r.cM.priority>=2&&this._logDrawCallEnd(c,u,n),_}transform(t={}){const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:i}=t;n&&this._setFeedbackBuffers(n),e&&(i=Object.assign({},i,{35977:e})),r.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:i}))}finally{r.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(t={}){return r.cM.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}(0,c.Z)(t instanceof v.Z,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new y(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof s.Z&&e.delete()}}_setAnimationProps(t){this.animated&&(0,c.Z)(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if((0,m.nK)(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new b.Z(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),r.cM.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:r.cM.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const o=function({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=S(t,t.elements,null,e));const r=t.values;for(const i in r){const o=t._getAttributeInfo(i);if(o){let s="".concat(i,": ").concat(o.name);const a=t.accessors[o.location];a&&(s="".concat(i,": ").concat(P(o.name,a))),n[s]=S(t,r[i],a,e)}}return n}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:s,unusedTable:a,unusedCount:u}=T({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:c,count:l}=T({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});l>0&&r.cM.log("MISSING UNIFORMS",Object.keys(c))(),u>0&&r.cM.log("UNUSED UNIFORMS",Object.keys(a))();const h=function(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const t=M(r);e["in ".concat(t)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const t=M(r);e["out ".concat(t)]={[n]:JSON.stringify(r.accessor)}}return e}(this.vertexArray.configuration);r.cM.table(t,o)(),r.cM.table(t,s)(),r.cM.table(t+1,h)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),r.cM.groupEnd(2,">>> DRAWING MODEL ".concat(this.id))()}}},1731:(t,e,n)=>{"use strict";n.d(e,{Z:()=>O});var r=n(5682),i=n(6119),o=n(9047);function s(t){return function(t){const e={},n={};return a({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}(u(t))}function a({modules:t,level:e,moduleMap:n,moduleDepth:r}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===r[i.name]||r[i.name]<e)&&(r[i.name]=e);for(const i of t)i.dependencies&&a({modules:i.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function u(t,e){return t.map((t=>(t instanceof i.Z||((0,o.Z)("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),(0,o.Z)(t.name,"shader module has no name"),(t=new i.Z(t)).dependencies=u(t.dependencies)),t)))}const c={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},l={};Object.keys(c).forEach((t=>{l[t]=t}));const h={};function A(t,e,n={}){const r=c[e];if((0,o.Z)(r,e),!function(t={}){const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in h)return h[e];const i=r[0],s=n.behavior||"enable",a="#extension GL_".concat(i," : ").concat(s,"\nvoid main(void) {}"),u=t.createShader(35633);t.shaderSource(u,a),t.compileShader(u);const l=t.getShaderParameter(u,35713);return t.deleteShader(u),h[e]=l,l}function f(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>function(t,e){const n=c[e];(0,o.Z)(n,e);const r=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],i="string"==typeof r?Boolean(t.getExtension(r)):r;return(0,o.Z)(!1===i||!0===i),i}(t,e)))}var p=n(6713);function d(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const g=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],y=[...g,[d("attribute"),"in $1"],[d("varying"),"out $1"]],m=[...g,[d("varying"),"in $1"]],_=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],v=[..._,[d("in"),"attribute $1"],[d("out"),"varying $1"]],b=[..._,[d("in"),"varying $1"]],w="gl_FragColor",E=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,x=/void\s+main\s*\([^)]*\)\s*\{\n?/;function S(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}const P="\n\n".concat(p.O_,"\n\n"),T={[r.H]:"vertex",[r.Y]:"fragment"};function C(t,{id:e,source:n,type:i,modules:s,defines:a={},hookFunctions:u=[],inject:c={},transpileToGLSL100:h=!1,prologue:d=!0,log:g}){(0,o.Z)("string"==typeof n,"shader source must be a string");const _=i===r.H,C=n.split("\n");let M=100,I="",O=n;0===C[0].indexOf("#version ")?(M=300,I=C[0],O=C.slice(1).join("\n")):I="#version ".concat(M);const R={};s.forEach((t=>{Object.assign(R,t.getDefines())})),Object.assign(R,a);let L=d?"".concat(I,"\n").concat(function({id:t,source:e,type:n}){return t&&"string"==typeof t&&-1===e.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(t,"_").concat(T[n],"\n\n"):""}({id:e,source:n,type:i}),"\n").concat(function({type:t}){return"\n#define SHADER_TYPE_".concat(T[t].toUpperCase(),"\n")}({type:i}),"\n").concat(function(t){switch(function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/Apple/i)||e.match(/Apple/i)?"APPLE":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return f(t,l.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),f(t,l.GLSL_DERIVATIVES)&&A(t,l.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),f(t,l.GLSL_FRAG_DATA)&&A(t,l.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),f(t,l.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(t),"\n").concat(function(t={}){let e=0,n="";for(const r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],"\n"))}return 0===e&&(n+="\n"),n}(R),"\n").concat(_?"":"precision highp float;\n\n","\n"):"".concat(I,"\n");const N=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[r,i]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(n,{signature:i})})),e}(u),D={},F={},k={};for(const t in c){const e="string"==typeof c[t]?{injection:c[t],order:0}:c[t],n=t.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const r=n[2],i=n[3];r?"decl"===i?F[t]=[e]:k[t]=[e]:D[t]=[e]}else k[t]=[e]}for(const t of s){g&&t.checkDeprecations(O,g),L+=t.getModuleSource(i,M);const e=t.injections[i];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?F:k;r[t]=r[t]||[],r[t].push(e[t])}else D[t]=D[t]||[],D[t].push(e[t])}}return L+=P,L=(0,p.ZP)(L,i,F),L+=function(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature," {\n"),i.header&&(n+="  ".concat(i.header)),e[r]){const t=e[r];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}i.footer&&(n+="  ".concat(i.footer)),n+="}\n"}return n}(N[i],D),L+=O,L=(0,p.ZP)(L,i,k),L=function(t,e,n){switch(e){case 300:return n?S(t,y):function(t){const e=(t=S(t,m)).match(E);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(w,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(x,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat(w,"\\b"),"g"),e)}return t}(t);case 100:return n?S(t,v):function(t){const e=(t=S(t,b)).match(E);if(e){const n=e[1];t=t.replace(E,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),w)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}(L,h?100:M,_),L}function M(t){return function(e){const n={};for(const r of t){const t=r.getUniforms(e,n);Object.assign(n,t)}return n}}var I=n(7944);class O{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new O(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:n="",defines:i={},inject:o={},varyings:a=[],bufferMode:u=35981,transpileToGLSL100:c=!1}=t,l=this._getModuleList(t.modules),h=this._getHash(e),A=this._getHash(n),f=l.map((t=>this._getHash(t.name))).sort(),p=a.map((t=>this._getHash(t))),d=Object.keys(i).sort(),g=Object.keys(o).sort(),y=[],m=[];for(const t of d)y.push(this._getHash(t)),y.push(this._getHash(i[t]));for(const t of g)m.push(this._getHash(t)),m.push(this._getHash(o[t]));const _="".concat(h,"/").concat(A,"D").concat(y.join("/"),"M").concat(f.join("/"),"I").concat(m.join("/"),"V").concat(p.join("/"),"H").concat(this.stateHash,"B").concat(u).concat(c?"T":"");if(!this._programCache[_]){const t=function(t,e){const{vs:n,fs:i}=e,o=s(e.modules||[]);return{gl:t,vs:C(t,Object.assign({},e,{source:n,type:r.H,modules:o})),fs:C(t,Object.assign({},e,{source:i,type:r.Y,modules:o})),getUniforms:M(o)}}(this.gl,{vs:e,fs:n,modules:l,inject:o,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[_]=new I.Z(this.gl,{hash:_,vs:t.vs,fs:t.fs,varyings:a,bufferMode:u}),this._getUniforms[_]=t.getUniforms||(t=>{}),this._useCounts[_]=0}return this._useCounts[_]++,this._programCache[_]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let t=0,i=this._defaultModules.length;t<i;++t){const i=this._defaultModules[t],o=i.name;e[r++]=i,n[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;n[s]||(e[r++]=o,n[s]=!0)}return e.length=r,e}}},3346:(t,e,n)=>{"use strict";n.d(e,{Z:()=>P});var r=n(9047);const i="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",o="#version 300 es\n".concat(i);function s(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;return e.includes(r)&&i&&o?{qualifier:r,type:i,name:o.split(";")[0]}:null}function a(t={}){const{version:e=100,input:n,inputType:s,output:a}=t;if(!n)return 300===e?o:e>300?"#version ".concat(e,"\n").concat(i):"void main() {gl_FragColor = vec4(0);}";const u=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return(0,r.Z)(!1),null}}(n,s);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(s," ").concat(n,";\nout vec4 ").concat(a,";\nvoid main() {\n  ").concat(a," = ").concat(u,";\n}"):"varying ".concat(s," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(u,";\n}")}var u=n(9450),c=n(3478),l=n(1053),h=n(2525);class A{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof c.Z?n:n.buffer:null}getData(t={}){const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&(0,h.Z)((0,u.D0)(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const t in this.feedbackMap){const r=this.feedbackMap[t];t in e&&(n[r]=t)}Object.assign(n,t.feedbackBuffers);for(const t in n){const r=n[t];if("string"==typeof r){const i=e[r],{byteLength:o,usage:s,accessor:a}=i;n[t]=this._createNewBuffer(t,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,{model:e}){const{program:n}=e;t.transformFeedback=new l.Z(this.gl,{program:n,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],(0,h.Z)(n[i]instanceof c.Z)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new c.Z(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}var f=n(1953),p=n(4912),d=n(3849),g=n(3296);function y(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}var m=n(6713);const _={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},v="transform_uSize_",b="transform_position";const w={10241:9728,10240:9728,10242:33071,10243:33071};class E{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let u=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const t=function({sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}){const r={};let i,o;e&&(({width:i,height:o}=n),r["".concat(v).concat(e)]=[i,o]);for(const e in t)({width:i,height:o}=t[e]),r["".concat(v).concat(e)]=[i,o];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,t)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],n=(0,f.z6)(e);if(!t)return n;const i=n.constructor,o=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return(0,r.Z)(!1),null}}(this.targetTextureType),s=new i(n.length*o/4);let a=0;for(let t=0;t<n.length;t+=4)for(let e=0;e<o;e++)s[a++]=n[t+e];return s}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof p.Z)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new c.Z(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;const{width:e,height:n}=i,{framebuffer:r}=t;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:e,height:n})):t.framebuffer=new d.Z(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const t in e)e[t].setParameters(w)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=(0,g.h)(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:o,targetTextureType:u,inject:c,samplerTextureMap:l}=function({vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}){let o=Object.keys(e).length,a=null;const u={};let c=t,l={};if(o>0||n){const t=c.split("\n"),A=t.slice();if(t.forEach(((t,i,c)=>{if(o>0){const n=function(t,e){const n={},i=function(t){return s(t,["attribute","in"])}(t);if(!i)return null;const{type:o,name:a}=i;if(a&&e[a]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:u}=function(t){const e="".concat("transform_uSampler_").concat(t),n="".concat(v).concat(t);return{samplerName:e,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";")}}(a),c=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return(0,r.Z)(!1),null}}(o),l="  ".concat(o," ").concat(a," = transform_getInput(").concat(i,", ").concat(s,").").concat(c,";\n");return n[i]=a,{updatedLine:e,inject:{"vs:#decl":u,"vs:#main-start":l},samplerTextureMap:n}}return null}(t,e);if(n){const{updatedLine:t,inject:e}=n;A[i]=t,l=(0,m.Lm)([l,e]),Object.assign(u,n.samplerTextureMap),o--}}n&&!a&&(a=function(t,e){const n=s(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,n))})),n){(0,h.Z)(i);const t="".concat(v).concat(n),e={"vs:#decl":"uniform vec2 ".concat(t,";\n"),"vs:#main-start":"     vec2 ".concat(b," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(b,", 0, 1.);\n")};l=(0,m.Lm)([l,e])}c=A.join("\n")}return{vs:c,targetTextureType:a,inject:l,samplerTextureMap:u}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),A=(0,m.Lm)([t.inject||{},c]);return this.targetTextureType=u,this.samplerTextureMap=l,{vs:i,fs:t._fs||a({version:y(i),input:this.targetTextureVarying,inputType:u,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[_].concat(t.modules||[]):t.modules,uniforms:o,inject:A}}}var x=n(4538),S=n(1113);class P{static isSupported(t){return(0,u.D0)(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();(0,h.Z)(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new S.Z(e,Object.assign({},t,{fs:t.fs||a({version:y(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=t.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!((0,x.nK)(t.feedbackBuffers)&&(0,x.nK)(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new A(t,e)),function(t){return!((0,x.nK)(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new E(t,e)),(0,h.Z)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=Object.assign(e,t.getDrawOptions(e));return e}}},6234:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(1113),i=n(3982);const o=[-1,-1,1,-1,-1,1,1,1];class s extends r.Z{constructor(t,e){const n=o.map((t=>-1===t?0:t));super(t,Object.assign({},e,{vs:"attribute vec2 aClipSpacePosition;\nattribute vec2 aTexCoord;\nattribute vec2 aCoordinate;\n\nvarying vec2 position;\nvarying vec2 coordinate;\nvarying vec2 uv;\n\nvoid main(void) {\n  gl_Position = vec4(aClipSpacePosition, 0., 1.);\n  position = aClipSpacePosition;\n  coordinate = aCoordinate;\n  uv = aTexCoord;\n}\n",geometry:new i.Z({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(o)},aTexCoord:{size:2,value:new Float32Array(n)},aCoordinate:{size:2,value:new Float32Array(n)}}})})),this.setVertexCount(4)}}},1307:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(4211),i=n(6948),o=n(4912),s=n(9450);class a{constructor(t,{attributes:e,material:n,pbrDebug:o,imageBasedLightingEnvironment:s,lights:a,useTangents:u}){this.gl=t,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},(0,r.U6)(t,i.h.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],s&&(this.uniforms.u_DiffuseEnvSampler=s.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=s.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=s.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),o&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(e.NORMAL,"HAS_NORMALS"),this.defineIfPresent(e.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(e.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(s,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(o,"PBR_DEBUG"),n&&this.parseMaterial(n)}defineIfPresent(t,e){t&&(this.defines[e]=1)}parseTexture(t,e,n=null){const r=t.texture&&t.texture.sampler&&t.texture.sampler.parameters||{},i=t.texture.source.image;let s,a={};i.compressed?(s=i,a={[this.gl.TEXTURE_MIN_FILTER]:i.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):s={data:i};const u=new o.Z(this.gl,{id:t.name||t.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...s});this.uniforms[e]=u,this.defineIfPresent(n,n),this.generatedTextures.push(u)}parsePbrMetallicRoughness(t){t.baseColorTexture&&this.parseTexture(t.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=t.baseColorFactor||[1,1,1,1],t.metallicRoughnessTexture&&this.parseTexture(t.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:e=1,roughnessFactor:n=1}=t;this.uniforms.u_MetallicRoughnessValues=[e,n]}parseMaterial(t){if(this.uniforms.pbr_uUnlit=Boolean(t.unlit),t.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(t.pbrMetallicRoughness),t.normalTexture){this.parseTexture(t.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:e=1}=t.normalTexture;this.uniforms.u_NormalScale=e}if(t.occlusionTexture){this.parseTexture(t.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:e=1}=t.occlusionTexture;this.uniforms.u_OcclusionStrength=e}if(t.emissiveTexture&&(this.parseTexture(t.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=t.emissiveFactor||[0,0,0]),"MASK"===t.alphaMode){const{alphaCutoff:e=.5}=t;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=e}else"BLEND"===t.alphaMode&&(s.cM.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}}},9450:(t,e,n)=>{"use strict";n.d(e,{KQ:()=>c,JD:()=>u,s9:()=>J,JY:()=>q,w:()=>H,ZS:()=>G,vd:()=>a,yW:()=>$,UF:()=>o,D0:()=>s,cM:()=>r,kL:()=>V,aQ:()=>tt,dR:()=>z,s8:()=>Z});const r=new(n(4708).Z)({id:"luma.gl"});function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function o(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function s(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function a(t){return s(t)?t:null}function u(t){return i(o(t),"Invalid WebGLRenderingContext"),t}function c(t){return i(s(t),"Requires WebGL2"),t}var l=n(9718);const h={};const A=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let e=0;e<this.attribs.length;e++){const r=new t.VertexAttrib(n);this.attribs[e]=r}this.maxAttrib=0};(A.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const f=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(h[n]=!0)}while(0!==n);for(n in h)if(h[n])return delete h[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const i=e.currentVertexArrayObject,o=i.attribs[t];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,o,s,a){const u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);const c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{l.CO.console&&l.CO.console.log&&l.CO.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()}),!0),this.reset_()};f.prototype.VERTEX_ARRAY_BINDING_OES=34229,f.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new A(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},f.prototype.createVertexArrayOES=function(){const t=new A(this);return this.vertexArrayObjects.push(t),t},f.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},f.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof A&&t.hasBeenBound&&t.ext===this)},f.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",h[1282]=!0,void(void 0!==n&&(r=n,l.CO.console&&l.CO.console.error&&l.CO.console.error(r)));var n,r;const i=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||i.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const u=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let t=0;t<=u;t++){const n=s.attribs[t],r=o?o.attribs[t]:null;if(o&&n.enabled===r.enabled||(n.enabled?i.enableVertexAttribArray.call(e,t):i.disableVertexAttribArray.call(e,t)),n.enabled){let s=!1;o&&n.buffer===r.buffer||(a!==n.buffer&&(i.bindBuffer.call(e,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==r.cached)&&i.vertexAttribPointer.call(e,t,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&i.bindBuffer.call(e,34962,this.currentArrayBuffer)};const p="OES_element_index",d="WEBGL_draw_buffers",g="WEBGL_debug_renderer_info",y=t=>s(t)?void 0:0,m={3074:t=>s(t)?void 0:36064,35723:t=>s(t)?void 0:4352,35977:y,32937:y,36795:(t,e)=>{const n=s(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(g);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(g);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:y,35071:y,37447:y,36063:(t,e)=>{if(!s(t)){const n=t.getExtension(d);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:y,35374:y,35377:y,34852:t=>{if(!s(t)){const e=t.getExtension(d);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(p)?2147483647:65535,33001:t=>t.getExtension(p)?16777216:65535,33e3:t=>16777216,37157:y,35373:y,35657:y,36183:y,37137:y,34045:y,35978:y,35979:y,35968:y,35376:y,35375:y,35659:y,37154:y,35371:y,35658:y,35076:y,35077:y,35380:y},_="ANGLE_instanced_arrays",v={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{i(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[_]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){i(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{i(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{i(!1)},deleteQuery:()=>{i(!1)},beginQuery:()=>{i(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},b={readBuffer:(t,e,n)=>{s(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=function(t,e){return{webgl2:s(t),ext:t.getExtension("ANGLE_instanced_arrays")}}(t);let a;switch(r){case 35069:a=!!i&&void 0;break;case 35070:a=i||o?void 0:0}return void 0!==a?a:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!s(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!s(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:function(t,e,n){const r=m[n],i="function"==typeof r?r(t,e,n):r;return void 0!==i?i:e(n)},hint:(t,e,n,r)=>e(n,r)};function w(t,{extension:e,target:n,target2:r}){const o=v[e];i(o);const{meta:s={}}=o,{suffix:a=""}=s,u=t.getExtension(e);for(const e of Object.keys(o)){const i="".concat(e).concat(a);let s=null;"meta"===e||"function"==typeof t[e]||(u&&"function"==typeof u[i]?s=(...t)=>u[i](...t):"function"==typeof o[e]&&(s=o[e].bind(n))),s&&(n[e]=s,r[e]=s)}}(void 0!==n.g?n.g:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new f(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&w(t,{extension:n,target:t.luma,target2:t})}(t,v),function(t,{target:e,target2:n}){Object.keys(b).forEach((r=>{if("function"==typeof b[r]){const i=t[r]?t[r].bind(t):()=>{},o=b[r].bind(null,t,i);e[r]=o,n[r]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const E={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},x=(t,e,n)=>e?t.enable(n):t.disable(n),S=(t,e,n)=>t.hint(n,e),P=(t,e,n)=>t.pixelStorei(n,e);function T(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const C={3042:x,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:x,2885:(t,e)=>t.cullFace(e),2929:x,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:x,35723:S,36006:(t,e)=>{const n=s(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:S,2849:(t,e)=>t.lineWidth(e),32823:x,32824:"polygonOffset",10752:"polygonOffset",35977:x,32938:"sampleCoverage",32939:"sampleCoverage",3089:x,3088:(t,e)=>t.scissor(...e),2960:x,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:P,3317:P,37440:P,37441:P,37443:P,3330:P,3332:P,3331:P,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:P,32878:P,3316:P,3315:P,32877:P,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=T(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=T(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=T(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=T(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=T(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function M(t,e,n){return void 0!==e[t]?e[t]:n[t]}const I={blendEquation:(t,e,n)=>t.blendEquationSeparate(M(32777,e,n),M(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(M(32969,e,n),M(32968,e,n),M(32971,e,n),M(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(M(32824,e,n),M(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(M(32938,e,n),M(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,M(2962,e,n),M(2967,e,n),M(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,M(34816,e,n),M(36003,e,n),M(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,M(2964,e,n),M(2965,e,n),M(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,M(34817,e,n),M(34818,e,n),M(34819,e,n))},O={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},R=(t,e)=>t.isEnabled(e),L={3042:R,2884:R,2929:R,3024:R,32823:R,32926:R,32928:R,3089:R,2960:R,35977:R};function N(t){for(const e in t)return!1;return!0}function D(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function F(t,e){const n=t[e].bind(t);t[e]=function(...e){const r=e[0];return r in t.state.cache||(t.state.cache[r]=n(...e)),t.state.enable?t.state.cache[r]:n(...e)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function k(t,e,n){const r=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:o}=n(t.state._updateCache,...e);return i&&r(...e),o},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class B{constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?G(t):Object.assign({},E),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){i(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];z(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in t){i(void 0!==o);const s=t[o],a=this.cache[o];D(s,a)||(n=!0,e=a,r&&!(o in r)&&(r[o]=a),this.cache[o]=s)}return{valueChanged:n,oldValue:e}}}function j(t,e={}){const{enable:r=!0,copyState:o}=e;if(i(void 0!==o),!t.state){const e=void 0!==n.g?n.g:window,{polyfillContext:r}=e;r&&r(t),t.state=new B(t,{copyState:o}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const e in O)k(t,e,O[e]);F(t,"getParameter"),F(t,"isEnabled")}return t.state.enable=r,t}function U(t){i(t.state),t.state.pop()}function z(t,e){if(i(o(t),"setParameters requires a WebGL context"),N(e))return;const n={};for(const r in e){const i=Number(r),o=C[r];o&&("string"==typeof o?n[o]=!0:o(t,e[r],i))}const r=t.state&&t.state.cache;if(r)for(const i in n)(0,I[i])(t,e,r)}function G(t,e){if("number"==typeof(e=e||E)){const n=e,r=L[n];return r?r(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const e of n){const n=L[e];r[e]=n?n(t,Number(e)):t.getParameter(Number(e))}return r}function V(t){z(t,E)}function Z(t,e,n){if(N(e))return n(t);const{nocatch:r=!0}=e;let i;if(function(t){t.state||j(t,{copyState:!1}),t.state.push()}(t),z(t,e),r)i=n(t),U(t);else try{i=n(t)}finally{U(t)}return i}function H(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function q(t,e,n=!0){return function(t,e,n,r,i){const o=W(t[0],e,n);let s=X(t[1],e,r,i),a=W(t[0]+1,e,n);const u=a===n-1?a:a-1;let c;return a=X(t[1]+1,e,r,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===r-1?a:a-1,{x:o,y:s,width:Math.max(u-o+1,1),height:Math.max(c-s+1,1)}}(e,H(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function W(t,e,n){return Math.min(Math.round(t*e),n-1)}function X(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Y=(0,l.jU)(),Q=Y&&"undefined"!=typeof document,K={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function J(t={}){i(Y,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},K,t);const{width:e,height:n}=t;function o(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let a;t.onError=o;const{canvas:u}=t;return a=function(t,e){const{onError:n}=e;let r=null;const i=t=>r=t.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}(function({canvas:t,width:e=800,height:n=600,onError:r}){let i;return"string"==typeof t?(Q&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(t,"' before page was loaded")),i=document.getElementById(t)):t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?"".concat(e,"px"):"100%",i.style.height=Number.isFinite(n)?"".concat(n,"px"):"100%",document.body.insertBefore(i,document.body.firstChild)),i}({canvas:u,width:e,height:n,onError:o}),t),a?(a=$(a,t),function(t){const e=s(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info");return{vendor:r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",o=t.debug?" debug":"";r.info(1,"".concat(e).concat(o," context ").concat(i))()}(a),a):null}function $(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},K,e);const{manageState:n,debug:i}=e;return n&&j(t,{copyState:!1,log:(...t)=>r.log(1,...t)()}),Y&&i&&(l.CO.makeDebugContext?(t=l.CO.makeDebugContext(t,e),r.level=Math.max(r.level,1)):r.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function tt(t,e={}){if(t.canvas)return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;i&&o||(r.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,o=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==o||s.devicePixelRatio!==e){let n=e;const s=Math.floor(i*n),a=Math.floor(o*n);t.canvas.width=s,t.canvas.height=a,t.drawingBufferWidth===s&&t.drawingBufferHeight===a||(r.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/o),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(o*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:o,devicePixelRatio:e})}}(t,function(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}},5682:(t,e,n)=>{"use strict";n.d(e,{H:()=>r,Y:()=>i});const r="vs",i="fs"},6713:(t,e,n)=>{"use strict";n.d(e,{O_:()=>s,Lm:()=>h,ZP:()=>l});var r=n(5682),i=n(9047);const o={[r.H]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[r.Y]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},s="__LUMA_INJECT_DECLARATIONS__",a=/void\s+main\s*\([^)]*\)\s*\{\n?/,u=/}\n?[^{}]*$/,c=[];function l(t,e,n,i=!1){const l=e===r.H;for(const e in n){const r=n[e];r.sort(((t,e)=>t.order-e.order)),c.length=r.length;for(let t=0,e=r.length;t<e;++t)c[t]=r[t].injection;const i="".concat(c.join("\n"),"\n");switch(e){case"vs:#decl":l&&(t=t.replace(s,i));break;case"vs:#main-start":l&&(t=t.replace(a,(t=>t+i)));break;case"vs:#main-end":l&&(t=t.replace(u,(t=>i+t)));break;case"fs:#decl":l||(t=t.replace(s,i));break;case"fs:#main-start":l||(t=t.replace(a,(t=>t+i)));break;case"fs:#main-end":l||(t=t.replace(u,(t=>i+t)));break;default:t=t.replace(e,(t=>t+i))}}return t=t.replace(s,""),i&&(t=t.replace(/\}\s*$/,(t=>t+o[e]))),t}function h(t){const e={};return(0,i.Z)(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}},6119:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a,v:()=>u});var r=n(9047);const i={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function o(t){let e=s(t);return"object"===e?t?"type"in t?Object.assign({},t,i[t.type]):"value"in t?(e=s(t.value),Object.assign({type:e},t,i[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},i[e])}function s(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class a{constructor({name:t,vs:e,fs:n,dependencies:i=[],uniforms:s,getUniforms:a,deprecations:u=[],defines:c={},inject:l={},vertexShader:h,fragmentShader:A}){(0,r.Z)("string"==typeof t),this.name=t,this.vs=e||h,this.fs=n||A,this.getModuleUniforms=a,this.dependencies=i,this.deprecations=this._parseDeprecationDefinitions(u),this.defines=c,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);"string"==typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}(l),s&&(this.uniforms=function(t){const e={};for(const n in t){const r=o(t[n]);e[n]=r}return e}(s))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:(0,r.Z)(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{switch(t.type){case"function":t.regex=new RegExp("\\b".concat(t.old,"\\("));break;default:t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))}})),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const i in n){const o=n[i];i in t&&!o.private?(o.validate&&(0,r.Z)(o.validate(t[i],o),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=o.value}return e}}function u(t){if(!t.normalized&&(t.normalized=!0,t.uniforms&&!t.getUniforms)){const e=new a(t);t.getUniforms=e.getUniforms.bind(e)}return t}},5502:(t,e,n)=>{"use strict";n.d(e,{O:()=>r});const r={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null}},7024:(t,e,n)=>{"use strict";n.d(e,{H:()=>s});const r="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",i={lightSources:{}};function o({color:t=[0,0,0],intensity:e=1}={}){return t.map((t=>t*e/255))}const s={name:"lights",vs:r,fs:r,getUniforms:function t(e=i){if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:r}=e.lightSources||{};return t||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=t?o(t):[0,0,0],e.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=o(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=e.length,n.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=o(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}}},4080:(t,e,n)=>{"use strict";n.d(e,{b:()=>r});const r={name:"pbr",vs:"uniform mat4 u_MVPMatrix;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_NormalMatrix;\n\nvarying vec3 pbr_vPosition;\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n# ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n# else\nvarying vec3 pbr_vNormal;\n# endif\n#endif\n\nvoid pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)\n{\n  vec4 pos = u_ModelMatrix * position;\n  pbr_vPosition = vec3(pos.xyz) / pos.w;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\n  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;\n  pbr_vTBN = mat3(tangentW, bitangentW, normalW);\n#else\n  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));\n#endif\n#endif\n\n#ifdef HAS_UV\n  pbr_vUV = uv;\n#else\n  pbr_vUV = vec2(0.,0.);\n#endif\n}\n",fs:"#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)\n# error PBR fragment shader: Texture LOD is not available\n#endif\n\n#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)\n# error PBR fragment shader: Derivatives are not available\n#endif\n\n\n#if (__VERSION__ < 300)\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)\n#else\n  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)\n#endif\n\nprecision highp float;\n\nuniform bool pbr_uUnlit;\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\nuniform vec2 u_ScaleIBLAmbient;\n#endif\n\n#ifdef HAS_BASECOLORMAP\nuniform sampler2D u_BaseColorSampler;\n#endif\n#ifdef HAS_NORMALMAP\nuniform sampler2D u_NormalSampler;\nuniform float u_NormalScale;\n#endif\n#ifdef HAS_EMISSIVEMAP\nuniform sampler2D u_EmissiveSampler;\nuniform vec3 u_EmissiveFactor;\n#endif\n#ifdef HAS_METALROUGHNESSMAP\nuniform sampler2D u_MetallicRoughnessSampler;\n#endif\n#ifdef HAS_OCCLUSIONMAP\nuniform sampler2D u_OcclusionSampler;\nuniform float u_OcclusionStrength;\n#endif\n\n#ifdef ALPHA_CUTOFF\nuniform float u_AlphaCutoff;\n#endif\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n#ifdef PBR_DEBUG\nuniform vec4 u_ScaleDiffBaseMR;\nuniform vec4 u_ScaleFGDSpec;\n#endif\n\nvarying vec3 pbr_vPosition;\n\nvarying vec2 pbr_vUV;\n\n#ifdef HAS_NORMALS\n#ifdef HAS_TANGENTS\nvarying mat3 pbr_vTBN;\n#else\nvarying vec3 pbr_vNormal;\n#endif\n#endif\n\n\nstruct PBRInfo\n{\n  float NdotL;\n  float NdotV;\n  float NdotH;\n  float LdotH;\n  float VdotH;\n  float perceptualRoughness;\n  float metalness;\n  vec3 reflectance0;\n  vec3 reflectance90;\n  float alphaRoughness;\n  vec3 diffuseColor;\n  vec3 specularColor;\n  vec3 n;\n  vec3 v;\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n#ifdef MANUAL_SRGB\n#ifdef SRGB_FAST_APPROXIMATION\n  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n#else\n  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n#endif\n  return vec4(linOut,srgbIn.w);;\n#else\n  return srgbIn;\n#endif\n}\n\nvec3 getNormal()\n{\n#ifndef HAS_TANGENTS\n  vec3 pos_dx = dFdx(pbr_vPosition);\n  vec3 pos_dy = dFdy(pbr_vPosition);\n  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));\n  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));\n  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n#ifdef HAS_NORMALS\n  vec3 ng = normalize(pbr_vNormal);\n#else\n  vec3 ng = cross(pos_dx, pos_dy);\n#endif\n\n  t = normalize(t - ng * dot(ng, t));\n  vec3 b = normalize(cross(ng, t));\n  mat3 tbn = mat3(t, b, ng);\n#else\n  mat3 tbn = pbr_vTBN;\n#endif\n\n#ifdef HAS_NORMALMAP\n  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;\n  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n#else\n  vec3 n = normalize(tbn[2].xyz);\n#endif\n\n  return n;\n}\n\n\n#ifdef USE_IBL\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n  float mipCount = 9.0;\n  float lod = (pbrInputs.perceptualRoughness * mipCount);\n  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,\n    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n  diffuse *= u_ScaleIBLAmbient.x;\n  specular *= u_ScaleIBLAmbient.y;\n\n  return diffuse + specular;\n}\n#endif\n\n\nvec3 diffuse(PBRInfo pbrInputs)\n{\n  return pbrInputs.diffuseColor / M_PI;\n}\n\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n  return pbrInputs.reflectance0 +\n    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *\n    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n\n\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n  float NdotL = pbrInputs.NdotL;\n  float NdotV = pbrInputs.NdotV;\n  float r = pbrInputs.alphaRoughness;\n\n  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n  return attenuationL * attenuationV;\n}\n\n\n\n\n\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n  return roughnessSq / (M_PI * f * f);\n}\n\nvoid PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {\n  pbrInputs.NdotL = 1.0;\n  pbrInputs.NdotH = 0.0;\n  pbrInputs.LdotH = 0.0;\n  pbrInputs.VdotH = 1.0;\n}\n\nvoid PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {\n  vec3 n = pbrInputs.n;\n  vec3 v = pbrInputs.v;\n  vec3 l = normalize(lightDirection);\n  vec3 h = normalize(l+v);\n\n  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);\n  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);\n  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);\n  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);\n}\n\nvoid PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {\n  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);\n  PBRInfo_setDirectionalLight(pbrInputs, light_direction);\n}\n\nvec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {\n  vec3 F = specularReflection(pbrInputs);\n  float G = geometricOcclusion(pbrInputs);\n  float D = microfacetDistribution(pbrInputs);\n  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);\n  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);\n}\n\nvec4 pbr_filterColor(vec4 colorUnused)\n{\n#ifdef HAS_BASECOLORMAP\n  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;\n#else\n  vec4 baseColor = u_BaseColorFactor;\n#endif\n\n#ifdef ALPHA_CUTOFF\n  if (baseColor.a < u_AlphaCutoff) {\n    discard;\n  }\n#endif\n\n  vec3 color = vec3(0, 0, 0);\n\n  if(pbr_uUnlit){\n    color.rgb = baseColor.rgb;\n  }\n  else{\n\n\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\n#ifdef HAS_METALROUGHNESSMAP\n\n    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n#endif\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n\n\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();\n    vec3 v = normalize(u_Camera - pbr_vPosition);\n\n    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);\n    vec3 reflection = -normalize(reflect(v, n));\n\n    PBRInfo pbrInputs = PBRInfo(\n      0.0,\n      NdotV,\n      0.0,\n      0.0,\n      0.0,\n      perceptualRoughness,\n      metallic,\n      specularEnvironmentR0,\n      specularEnvironmentR90,\n      alphaRoughness,\n      diffuseColor,\n      specularColor,\n      n,\n      v\n    );\n\n#ifdef USE_LIGHTS\n    PBRInfo_setAmbientLight(pbrInputs);\n    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {\n      if (i < lighting_uDirectionalLightCount) {\n        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);\n        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);\n      }\n    }\n    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {\n      if (i < lighting_uPointLightCount) {\n        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);\n        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));\n        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);\n      }\n    }\n#endif\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n#ifdef HAS_OCCLUSIONMAP\n    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n#endif\n\n#ifdef HAS_EMISSIVEMAP\n    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;\n    color += emissive;\n#endif\n\n#ifdef PBR_DEBUG\n\n\n\n\n\n    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n#endif\n\n  }\n\n  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);\n}\n",defines:{LIGHTING_FRAGMENT:1},dependencies:[n(7024).H]}},7287:(t,e,n)=>{"use strict";n.d(e,{N:()=>a,s:()=>u});var r=n(7024);const i="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",o={};function s(t=o){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const a={name:"gouraud-lighting",dependencies:[r.H],vs:i,defines:{LIGHTING_VERTEX:1},getUniforms:s},u={name:"phong-lighting",dependencies:[r.H],fs:i,defines:{LIGHTING_FRAGMENT:1},getUniforms:s}},3330:(t,e,n)=>{"use strict";n.d(e,{q:()=>i});const r={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},i={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(t=r){const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}}},9047:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,{Z:()=>r})},4072:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(9335),i=n(2525),o=n(2610);const s={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},a={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class u{static getBytesPerElement(t){return(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return(0,i.Z)(t.size),(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new u(...[s,...t])}constructor(...t){t.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return u.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return u.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=(0,o.k)("Accessor",t,a)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}},3478:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(7577),i=n(4072),o=n(9335),s=n(9450),a=n(2610),u=n(2525);const c={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},l={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:c},h={removedProps:c};class A extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=(0,a.k)("Buffer",t,l),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=(0,a.k)("Buffer",t,h))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new i.Z(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,i=t.byteLength||t.length;(0,u.Z)(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?((0,s.KQ)(this.gl),this.gl.bufferSubData(this.target,n,e,r,i)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:n=0,size:r}){const{gl:i}=this;return(0,s.KQ)(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}={}){(0,s.KQ)(this.gl);const i=(0,o.vN)(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(e),c=n;let l,h;t?(h=t.length,l=h-c):(l=Math.min(a,r||a),h=c+l);const A=Math.min(a,l);return r=r||A,(0,u.Z)(r<=A),t=t||new i(h),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):((0,u.Z)(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,n=t.byteLength+e){(0,u.Z)(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=(0,o.O)(t);return(0,u.Z)(s),this.setAccessor(new i.Z(this.accessor,{type:s})),this}_setByteLength(t,e=this.usage){(0,u.Z)(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/(0,o.vN)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new i.Z(this.accessor,{type:(0,o.O)(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return s.cM.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return s.cM.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return s.cM.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return s.cM.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new i.Z(this.accessor,t),this}}},6047:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s,$:()=>a});var r=n(9450),i=n(2525);const o="clear: bad arguments";function s(t,{framebuffer:e=null,color:n=null,depth:s=null,stencil:a=null}={}){const u={};e&&(u.framebuffer=e);let c=0;n&&(c|=16384,!0!==n&&(u.clearColor=n)),s&&(c|=256,!0!==s&&(u.clearDepth=s)),a&&(c|=1024,!0!==s&&(u.clearStencil=s)),(0,i.Z)(0!==c,o),(0,r.s8)(t,u,(()=>{t.clear(c)}))}function a(t,{framebuffer:e=null,buffer:n=6144,drawBuffer:s=0,value:a=[0,0,0,0]}={}){(0,r.KQ)(t),(0,r.s8)(t,{framebuffer:e},(()=>{switch(n){case 6144:switch(a.constructor){case Int32Array:t.clearBufferiv(n,s,a);break;case Uint32Array:t.clearBufferuiv(n,s,a);break;case Float32Array:default:t.clearBufferfv(n,s,a)}break;case 6145:t.clearBufferfv(6145,0,[a]);break;case 6146:t.clearBufferiv(6146,0,[a]);break;case 34041:const[e,r]=a;t.clearBufferfi(34041,0,e,r);break;default:(0,i.Z)(!1,o)}}))}},1953:(t,e,n)=>{"use strict";n.d(e,{Km:()=>f,Lv:()=>p,z6:()=>h,Jb:()=>A});var r=n(3478),i=n(3849),o=n(5008),s=n(9450),a=n(9335),u=n(2525);function c(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,u.Z)(!1),0}}var l=n(3296);function h(t,e={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:l,sourceHeight:h,sourceType:A}=e;const{framebuffer:f,deleteFramebuffer:p}=d(t);(0,u.Z)(f);const{gl:g,handle:y,attachments:m}=f;l=l||f.width,h=h||f.height,36064===o&&null===y&&(o=1028),(0,u.Z)(m[o]),A=A||m[o].type,s=function(t,e,n,r,i){if(t)return t;e=e||5121;return new((0,a.vN)(e,{clamped:!1}))(r*i*c(n))}(s,A,i,l,h),A=A||(0,a.O)(s);const _=g.bindFramebuffer(36160,y);return g.readPixels(n,r,l,h,i,A,s),g.bindFramebuffer(36160,_||null),p&&f.delete(),s}function A(t,{sourceX:e=0,sourceY:n=0,sourceFormat:i=6408,target:o=null,targetByteOffset:a=0,sourceWidth:l,sourceHeight:h,sourceType:A}){const{framebuffer:f,deleteFramebuffer:p}=d(t);(0,u.Z)(f),l=l||f.width,h=h||f.height;const g=(0,s.KQ)(f.gl);if(A=A||(o?o.type:5121),!o){const t=c(i),e=function(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return(0,u.Z)(!1),0}}(A),n=a+l*h*t*e;o=new r.Z(g,{byteLength:n,accessor:{type:A,size:t}})}return o.bind({target:35051}),(0,s.s8)(g,{framebuffer:f},(()=>{g.readPixels(e,n,l,h,i,A,a)})),o.unbind({target:35051}),p&&f.delete(),o}function f(t,{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=h(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>n;)({data:r,width:i,height:o}=(0,a.KS)({data:r,width:i,height:o}));(0,a.c$)({data:r,width:i,height:o});const s=document.createElement("canvas");s.width=i,s.height=o;const u=s.getContext("2d"),c=u.createImageData(i,o);return c.data.set(r),u.putImageData(c,0,0),s.toDataURL()}function p(t,e,n={}){const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:a=0,targetInternalFormat:c=6408}=n;let{targetX:l,targetY:h,targetZ:A,width:f,height:p}=n;const{framebuffer:g,deleteFramebuffer:y}=d(t);(0,u.Z)(g);const{gl:m,handle:_}=g,v=void 0!==l||void 0!==h||void 0!==A;l=l||0,h=h||0,A=A||0;const b=m.bindFramebuffer(36160,_);(0,u.Z)(e);let w=null;if(e instanceof o.Z&&(w=e,f=Number.isFinite(f)?f:w.width,p=Number.isFinite(p)?p:w.height,w.bind(0),e=w.target),v)switch(e){case 3553:case 34067:m.copyTexSubImage2D(e,a,l,h,r,i,f,p);break;case 35866:case 32879:(0,s.KQ)(m).copyTexSubImage3D(e,a,l,h,A,r,i,f,p)}else m.copyTexImage2D(e,a,c,r,i,f,p,0);return w&&w.unbind(),m.bindFramebuffer(36160,b||null),y&&g.delete(),w}function d(t){return t instanceof i.Z?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:(0,l.Y)(t),deleteFramebuffer:!0}}},3849:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(9450),i=n(7577),o=n(4912),s=n(9830),a=n(6047),u=n(1953),c=n(4211),l=n(9579),h=n(2525);const A="Multiple render targets not supported";class f extends i.Z{static isSupported(t,e={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new f(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if((0,h.Z)(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,n)for(const r in n){const i=n[r];(Array.isArray(i)?i[0]:i).resize({width:t,height:e})}else n=this._createDefaultAttachments(r,i,o,t,e);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(t={}){let{width:e,height:n}=t;if(null===this.handle)return(0,h.Z)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&r.cM.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const t in this.attachments)this.attachments[t].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t,{clearAttachments:e=!1,resizeAttachments:n=!0}={}){const r={};e&&Object.keys(this.attachments).forEach((t=>{r[t]=null})),Object.assign(r,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const t in r){(0,h.Z)(void 0!==t,"Misspelled framebuffer binding point?");const e=Number(t),i=r[e];let o=i;if(o)if(o instanceof s.Z)this._attachRenderbuffer({attachment:e,renderbuffer:o});else if(Array.isArray(i)){const[t,n=0,r=0]=i;o=t,this._attachTexture({attachment:e,texture:t,layer:n,level:r})}else this._attachTexture({attachment:e,texture:o,layer:0,level:0});else this._unattach(e);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(f.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(t={}){const{color:e,depth:n,stencil:r,drawBuffers:i=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&(0,a.Z)(this.gl,{color:e,depth:n,stencil:r}),i.forEach(((t,e)=>{(0,a.$)(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(t={}){return r.cM.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return r.cM.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return r.cM.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return r.cM.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return r.cM.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return r.cM.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:n=0,width:i,height:o}){const s=(0,r.KQ)(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===e&&0===n&&void 0===i&&void 0===o?s.invalidateFramebuffer(36008,t):s.invalidateFramebuffer(36008,t,e,n,i,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=(0,l.km)(this.gl,r)),r}getAttachmentParameters(t=36064,e,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n)r[e?(0,l.km)(this.gl,i):i]=this.getAttachmentParameter(t,i,e);return r}getParameters(t=!0){const e=Object.keys(this.attachments),n={};for(const r of e){const e=Number(r);n[t?(0,l.km)(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open((0,u.Km)(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>r.cM.level||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=(0,u.Km)(this,{targetMaxHeight:100});return r.cM.image({logLevel:t,message:e,image:n},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,i){let a=null;return t&&(a=a||{},a[36064]=new o.Z(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new s.Z(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new s.Z(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:i}),this.ownResources.push(a[36096])):n&&(0,h.Z)(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof s.Z?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:n}=this;n.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:n,level:i}){const{gl:o}=this;switch(o.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:(0,r.KQ)(o).framebufferTextureLayer(36160,t,e.target,i,n);break;case 34067:const s=function(t){return t<34069?t+34069:t}(n);o.framebufferTexture2D(36160,t,s,e.handle,i);break;case 3553:o.framebufferTexture2D(36160,t,3553,e.handle,i);break;default:(0,h.Z)(!1,"Illegal texture type")}o.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=(0,r.vd)(this.gl);e?e.readBuffer(t):(0,h.Z)(36064===t||1029===t,A),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=(0,r.KQ)(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):(0,h.Z)(1===t.length&&(36064===t[0]||1029===t[0]),A)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=(0,c.N$)(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}f.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303]},7944:(t,e,n)=>{"use strict";n.d(e,{Z:()=>j});var r=n(7577),i=n(5008),o=n(3849),s=n(9450),a=n(9830),u=n(2525);const c={5126:E.bind(null,"uniform1fv",d,1,x),35664:E.bind(null,"uniform2fv",d,2,x),35665:E.bind(null,"uniform3fv",d,3,x),35666:E.bind(null,"uniform4fv",d,4,x),5124:E.bind(null,"uniform1iv",g,1,x),35667:E.bind(null,"uniform2iv",g,2,x),35668:E.bind(null,"uniform3iv",g,3,x),35669:E.bind(null,"uniform4iv",g,4,x),35670:E.bind(null,"uniform1iv",g,1,x),35671:E.bind(null,"uniform2iv",g,2,x),35672:E.bind(null,"uniform3iv",g,3,x),35673:E.bind(null,"uniform4iv",g,4,x),35674:E.bind(null,"uniformMatrix2fv",d,4,S),35675:E.bind(null,"uniformMatrix3fv",d,9,S),35676:E.bind(null,"uniformMatrix4fv",d,16,S),35678:w,35680:w,5125:E.bind(null,"uniform1uiv",y,1,x),36294:E.bind(null,"uniform2uiv",y,2,x),36295:E.bind(null,"uniform3uiv",y,3,x),36296:E.bind(null,"uniform4uiv",y,4,x),35685:E.bind(null,"uniformMatrix2x3fv",d,6,S),35686:E.bind(null,"uniformMatrix2x4fv",d,8,S),35687:E.bind(null,"uniformMatrix3x2fv",d,6,S),35688:E.bind(null,"uniformMatrix3x4fv",d,12,S),35689:E.bind(null,"uniformMatrix4x2fv",d,8,S),35690:E.bind(null,"uniformMatrix4x3fv",d,12,S),35678:w,35680:w,35679:w,35682:w,36289:w,36292:w,36293:w,36298:w,36299:w,36300:w,36303:w,36306:w,36307:w,36308:w,36311:w},l={},h={},A={},f=[0];function p(t,e,n,r){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(f[0]=t,t=f);const i=t.length;if(i%e&&s.cM.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let e=0;e<i;e++)o[e]=t[e];return o}function d(t,e){return p(t,e,Float32Array,l)}function g(t,e){return p(t,e,Int32Array,h)}function y(t,e){return p(t,e,Uint32Array,A)}function m(t,e,n){const r=c[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function _(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function v(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof i.Z||t instanceof a.Z||t instanceof o.Z&&Boolean(t.texture)}function b(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let t=0,e=n.length;t<e;++t)r[t]=n[t]}else t[e]=n.slice();else t[e]=n}function w(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function E(t,e,n,r){let i=null,o=null;return(s,a,c)=>{const l=e(c,n),h=l.length;let A=!1;if(null===i)i=new Float32Array(h),o=h,A=!0;else{(0,u.Z)(o===h,"Uniform length cannot change.");for(let t=0;t<h;++t)if(l[t]!==i[t]){A=!0;break}}return A&&(r(s,t,a,l),i.set(l)),A}}function x(t,e,n,r){t[e](n,r)}function S(t,e,n,r){t[e](n,!1,r)}function P(t,e="unnamed"){const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function T(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+="".concat(i,"\n"),t[r+1])){const e=t[r+1],i=e.split(":",3),o=i[0],s=parseInt(i[1],10)||0,a=e.substring(i.join(":").length+1).trim();n+=C("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function C(t,e){let n="";for(let t=0;t<e;++t)n+=" ";return"".concat(n).concat(t)}var M=n(4538);class I extends r.Z{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return(0,u.Z)(!1),"unknown"}}constructor(t,e){(0,s.JD)(t),(0,u.Z)("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:P(e.source,null)||e.id||(0,M.hQ)("unnamed ".concat(I.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=P(t,null);e&&(this.id=(0,M.hQ)(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(I.getTypeName(this.shaderType),":").concat(this.id)}getName(){return P(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:r}=function(t,e,n,r){const i=t.split(/\r?\n/),o={},s={},a=r||P(e)||"(unnamed)",u="".concat(function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let e=0;e<i.length;e++){const n=i[e];if(n.length<=1)continue;const r=n.split(":"),a=r[0],c=parseInt(r[2],10);if(isNaN(c))throw new Error("GLSL compilation error in ".concat(u,": ").concat(t));"WARNING"!==a?o[c]=n:s[c]=n}const c=function(t,e=1,n=": "){const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(((t,r)=>{const o=String(r+e),s=o.length;return C(o,i-s)+n+t}))}(e);return{shaderName:u,errors:T(o,c),warnings:T(s,c)}}(t,this.source,this.shaderType,this.id);throw s.cM.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),s.cM.warn("GLSL compilation warnings in ".concat(e,"\n").concat(r))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class O extends I{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class R extends I{constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}var L=n(4072),N=n(8522);class D{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getActiveAttrib(t.handle,r),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!(0,s.D0)(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,r){const{type:i,components:o}=(0,N.hJ)(n),s={type:i,size:r*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new L.Z(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:i,components:o}=(0,N.hJ)(n),s={location:t,name:e,accessor:new L.Z({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}var F=n(9579);const k=35981,B=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class j extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",B),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:n,fs:r,varyings:i,bufferMode:o=k}=t;return this.hash=e||"",this.vs="string"==typeof n?new O(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof r?new R(this.gl,{id:"".concat(t.id,"-fs"),source:r}):r,(0,u.Z)(this.vs instanceof O),(0,u.Z)(this.fs instanceof R),this.uniforms={},this._textureUniforms={},i&&i.length>0&&((0,s.KQ)(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new D(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:a=!1,indexType:c=5123,instanceCount:l=0,isInstanced:h=l>0,vertexArray:A=null,transformFeedback:f,framebuffer:p,parameters:d={},uniforms:g,samplers:y}){if((g||y)&&(s.cM.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),s.cM.priority>=t){const r=p?p.id:"default",i="mode=".concat((0,F.km)(this.gl,e)," verts=").concat(n," ")+"instances=".concat(l," indexType=").concat((0,F.km)(this.gl,c)," ")+"isInstanced=".concat(h," isIndexed=").concat(a," ")+"Framebuffer=".concat(r);s.cM.log(t,i)()}return(0,u.Z)(A),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||h&&0===l||(A.bindForDraw(n,l,(()=>{if(void 0!==p&&(d=Object.assign({},d,{framebuffer:p})),f){const t=(0,N.$Z)(e);f.begin(t)}this._bindTextures(),(0,s.s8)(this.gl,d,(()=>{a&&h?this.gl2.drawElementsInstanced(e,n,c,r,l):a&&(0,s.D0)(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(e,i,o,n,c,r):a?this.gl.drawElements(e,n,c,r):h?this.gl2.drawArraysInstanced(e,r,n,l):this.gl.drawArrays(e,r,n)})),f&&f.end()})),0))}setUniforms(t={}){s.cM.priority>=2&&function(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!v(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let t=n,s=!1;if(t instanceof o.Z&&(t=t.texture),t instanceof i.Z)if(s=this.uniforms[e]!==n,s){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:i}=r;n.bind(i),t=i,this._textureUniforms[e]=n}else t=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(t)||s)&&b(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const t of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new O({handle:t});break;case 35632:n.fs=new R({handle:t})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=(0,M.hQ)(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),s.cM.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),s.cM.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||s.cM.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=_(n.name);let i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=m(t,i,n),n.size>1)for(let e=0;e<n.size;e++)i=t.getUniformLocation(this.handle,"".concat(r,"[").concat(e,"]")),this._uniformSetters["".concat(r,"[").concat(e,"]")]=m(t,i,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}},9830:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(7577);const i="EXT_color_buffer_float",o={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:i,bpp:2},33327:{gl2:i,bpp:4},34842:{gl2:i,bpp:8},33326:{gl2:i,bpp:4},33328:{gl2:i,bpp:8},34836:{gl2:i,bpp:16},35898:{gl2:i,bpp:4}};var s=n(9450),a=n(2525);class u extends r.Z{static isSupported(t,{format:e}={format:null}){return!e||function(t,e,n){const r=n[e];if(!r)return!1;const i=(0,s.D0)(t)&&r.gl2||r.gl1;return"string"==typeof i?t.getExtension(i):i}(t,e,o)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:n=1,samples:r=0}){return(0,a.Z)(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&(0,s.D0)(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,e,n):this.gl.renderbufferStorage(36161,t,e,n),this.format=t,this.width=e,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*o[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}},7577:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(9450),i=n(9835),o=n(9579),s=n(4538),a=n(2525),u=n(7469);const c="Resource subclass must define virtual methods";class l{constructor(t,e={}){(0,r.JD)(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||(0,s.hQ)(this.constructor.name),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(t=this.handle){if("function"!=typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){t=(0,o.sF)(this.gl,t),(0,a.Z)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return t?r:e}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=(0,r.D0)(this.gl),a={},u=e||Object.keys(i);for(const e of u){const r=i[e];if(r&&(!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))){const i=n?(0,o.km)(this.gl,e):e;a[i]=this.getParameter(e,t),n&&"GLenum"===r.type&&(a[i]=(0,o.km)(this.gl,a[i]))}}return a}setParameter(t,e){t=(0,o.sF)(this.gl,t),(0,a.Z)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=(0,o.sF)(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return(0,u.F)(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(c)}_deleteHandle(){throw new Error(c)}_bindHandle(t){throw new Error(c)}_getOptsFromHandle(){throw new Error(c)}_getParameter(t,e){throw new Error(c)}_setParameter(t,e){throw new Error(c)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=i.l.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this.constructor.name;i.l.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const n=i.l.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get("".concat(e," Memory")).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=i.l.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get("".concat(t," Memory")).subtractCount(this.byteLength),this.byteLength=0}}},4912:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(9450),i=n(5008),o=n(2525);class s extends i.Z{static isSupported(t,e){return i.Z.isSupported(t,e)}constructor(t,e={}){var n;(0,r.JD)(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,(0,o.Z)("string"==typeof n),n=""+n,new Promise(((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),r.crossOrigin="anonymous",r.src=n}catch(t){e(t)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}},1319:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(9450),i=n(5008),o=n(3889),s=n(3478);class a extends i.Z{static isSupported(t){return(0,r.D0)(t)}constructor(t,e={}){(0,r.KQ)(t),super(t,e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1})),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:n,height:i,depth:a=1,border:u=0,format:c,type:l=5121,offset:h=0,data:A,parameters:f={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,f,(()=>{ArrayBuffer.isView(A)&&this.gl.texImage3D(this.target,t,e,n,i,a,u,c,l,A),A instanceof s.Z&&(this.gl.bindBuffer(35052,A.handle),this.gl.texImage3D(this.target,t,e,n,i,a,u,c,l,h))})),A&&A.byteLength)this._trackAllocatedMemory(A.byteLength,"Texture");else{const t=o.C[this.dataFormat]||4,e=o.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}},7952:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(9450),i=n(5008);const o=[34069,34070,34071,34072,34073,34074];class s extends i.Z{constructor(t,e={}){(0,r.JD)(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage({face:t,data:e,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:n,data:i,border:s=0,format:a=6408,type:u=5121}){const{gl:c}=this,l=n||i,h=await Promise.all(o.map((t=>{const e=l[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),o.forEach(((n,i)=>{h[i].length>1&&!1!==this.opts.mipmaps&&r.cM.warn("".concat(this.id," has mipmap and multiple LODs."))(),h[i].forEach(((r,i)=>{t&&e?c.texImage2D(n,i,a,t,e,s,a,u,r):c.texImage2D(n,i,a,a,u,r)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:u=5121}=t,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,a,n,r,s,a,u,l):c.texImage2D(e,0,a,a,u,l),this}}s.FACES=o},3889:(t,e,n)=>{"use strict";n.d(e,{ae:()=>i,C:()=>o,pH:()=>s,br:()=>a,KR:()=>u});var r=n(9450);const i={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},o={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},s={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function a(t,e){const n=i[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const o=(0,r.D0)(t)&&n.gl2||n.gl1;return"string"==typeof o?t.getExtension(o):o}function u(t,e){const n=i[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}},5008:(t,e,n)=>{"use strict";n.d(e,{Z:()=>A});var r=n(9450),i=n(9718),o=n(7577),s=n(3478),a=n(3889),u=n(4538),c=n(2525);const l=[9729,9728],h=i.CO.WebGLBuffer||function(){};class A extends o.Z{static isSupported(t,e={}){const{format:n,linearFiltering:r}=e;let i=!0;return n&&(i=i&&(0,a.br)(t,n),i=i&&(!r||(0,a.KR)(t,n))),i}constructor(t,e){const{id:n=(0,u.hQ)("texture"),handle:r,target:i}=e;super(t,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:o=6408,border:s=0,recreate:a=!1,parameters:u={},pixelStore:c={},textureUnit:l}=t;e||(e=i);let{width:h,height:A,dataFormat:f,type:p,compressed:d=!1,mipmaps:g=!0}=t;const{depth:y=0}=t;return({width:h,height:A,compressed:d,dataFormat:f,type:p}=this._deduceParameters({format:o,type:p,dataFormat:f,compressed:d,data:e,width:h,height:A})),this.width=h,this.height=A,this.depth=y,this.format=o,this.type=p,this.dataFormat=f,this.border=s,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(r.cM.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(u)),this.mipmaps=g,this.setImageData({data:e,width:h,height:A,depth:y,format:o,type:p,dataFormat:f,border:s,mipmaps:g,parameters:c,compressed:d}),g&&this.generateMipmap(),this.setParameters(u),a&&(this.data=e),n&&(this._video={video:e,parameters:u,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:n=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(t={}){return this._isNPOT()?(r.cM.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:o=this.format,border:s=this.border,offset:u=0,parameters:l={}}=t;let{data:h=null,type:A=this.type,width:f=this.width,height:p=this.height,dataFormat:d=this.dataFormat,compressed:g=!1}=t;h||(h=n),({type:A,dataFormat:d,compressed:g,width:f,height:p}=this._deduceParameters({format:o,type:A,dataFormat:d,compressed:g,data:h,width:f,height:p}));const{gl:y}=this;y.bindTexture(this.target,this.handle);let m,_=null;if(({data:h,dataType:_}=this._getDataType({data:h,compressed:g})),(0,r.s8)(this.gl,l,(()=>{switch(_){case"null":y.texImage2D(e,i,o,f,p,s,d,A,h);break;case"typed-array":y.texImage2D(e,i,o,f,p,s,d,A,h,u);break;case"buffer":m=(0,r.KQ)(y),m.bindBuffer(35052,h.handle||h),m.texImage2D(e,i,o,f,p,s,d,A,u),m.bindBuffer(35052,null);break;case"browser-object":(0,r.D0)(y)?y.texImage2D(e,i,o,f,p,s,d,A,h):y.texImage2D(e,i,o,d,A,h);break;case"compressed":for(const[t,n]of h.entries())y.compressedTexImage2D(e,t,n.format,n.width,n.height,s,n.data);break;default:(0,c.Z)(!1,"Unknown image data type")}})),h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const t=a.C[this.dataFormat]||4,e=a.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:i=0,y:o=0,width:a=this.width,height:u=this.height,level:l=0,format:A=this.format,type:f=this.type,dataFormat:p=this.dataFormat,compressed:d=!1,offset:g=0,border:y=this.border,parameters:m={}}){if(({type:f,dataFormat:p,compressed:d,width:a,height:u}=this._deduceParameters({format:A,type:f,dataFormat:p,compressed:d,data:n,width:a,height:u})),(0,c.Z)(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,a=t.shape[0],u=t.shape[1]}n instanceof s.Z&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,m,(()=>{if(d)this.gl.compressedTexSubImage2D(t,l,i,o,a,u,A,n);else if(null===n)this.gl.texSubImage2D(t,l,i,o,a,u,p,f,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(t,l,i,o,a,u,p,f,n,g);else if(n instanceof h){const e=(0,r.KQ)(this.gl);e.bindBuffer(35052,n),e.texSubImage2D(t,l,i,o,a,u,p,f,g),e.bindBuffer(35052,null)}else(0,r.D0)(this.gl)?(0,r.KQ)(this.gl).texSubImage2D(t,l,i,o,a,u,p,f,n):this.gl.texSubImage2D(t,l,i,o,p,f,n)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return r.cM.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof s.Z?{data:t.handle,dataType:"buffer"}:t instanceof h?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:i,dataFormat:o,type:s,compressed:u}=t;const c=a.ae[e];return o=o||c&&c.dataFormat,s=s||c&&c.types[0],u=u||c&&c.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:u,width:r,height:i,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},(0,c.Z)(r,"Could not deduced texture size"),(0,c.Z)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),(0,c.Z)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:(0,c.Z)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!((0,r.D0)(this.gl)||!this.width||!this.height||(0,u.wt)(this.width)&&(0,u.wt)(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===l.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}},1053:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(9450),i=n(7577),o=n(3478),s=n(4538);class a extends i.Z{static isSupported(t){return(0,r.D0)(t)}constructor(t,e={}){(0,r.KQ)(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,(0,s.nK)(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:o,byteOffset:s}=this._getBufferParams(e);return n<0?(this.unused[t]=i,r.cM.warn((()=>"".concat(this.id," unused varying buffer ").concat(t)))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,s,o),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof o.Z==0?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,n=0,r){const i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}},4211:(t,e,n)=>{"use strict";n.d(e,{U6:()=>s,ag:()=>a,N$:()=>u});var r=n(6948),i=n(9450),o=n(2525);function s(t,e){return a(t,e)}function a(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>c(t,e)))}function u(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in r.Z)void 0===t.luma.caps[e]&&(t.luma.caps[e]=c(t,e));return t.luma.caps}function c(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=r.Z[e];let s;(0,o.Z)(n,e);const a=(0,i.D0)(t)&&n[1]||n[0];if("function"==typeof a)s=a(t);else if(Array.isArray(a)){s=!0;for(const e of a)s=s&&Boolean(t.getExtension(e))}else"string"==typeof a?s=Boolean(t.getExtension(a)):"boolean"==typeof a?s=a:(0,o.Z)(!1);return s}(t,e)),t.luma.caps[e]||i.cM.log(2,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}},6948:(t,e,n)=>{"use strict";n.d(e,{h:()=>o,Z:()=>s});var r=n(3849),i=n(4912);const o={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"},s={[o.WEBGL2]:[!1,!0],[o.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[o.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[o.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[o.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[o.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[o.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[o.FLOAT_BLEND]:["EXT_float_blend"],[o.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[o.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[o.TEXTURE_FLOAT]:["OES_texture_float",!0],[o.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[o.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[o.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[o.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[o.COLOR_ATTACHMENT_RGBA32F]:[function(t){const e=new i.Z(t,{format:6408,type:5126,dataFormat:6408}),n=new r.Z(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),o=n.getStatus();return e.delete(),n.delete(),36053===o},"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[o.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[o.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[o.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[o.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]}},9835:(t,e,n)=>{"use strict";n.d(e,{l:()=>a});var r=n(9450),i=n(8295),o=n(9718);const s="8.5.6",a=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new i.Z({id:t})),this.stats.get(t)}};if(o.CO.luma&&o.CO.luma.VERSION!==s)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(o.CO.luma.VERSION," vs ").concat(s));o.CO.luma||((0,o.jU)()&&r.cM.log(1,"luma.gl ".concat(s," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),o.CO.luma=o.CO.luma||{VERSION:s,version:s,log:r.cM,stats:a,globals:{modules:{},nodeIO:{}}}),o.CO.luma},2525:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,{Z:()=>r})},2610:(t,e,n)=>{"use strict";n.d(e,{k:()=>i});var r=n(9450);function i(t,e,n){const{removedProps:i={},deprecatedProps:o={},replacedProps:s={}}=n;for(const n in i)if(n in e){const e=i[n]?"".concat(t,".").concat(i[n]):"N/A";r.cM.removed("".concat(t,".").concat(n),e)()}for(const n in o)if(n in e){const e=o[n];r.cM.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(e))()}let a=null;for(const n in s)if(n in e){const i=s[n];r.cM.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(i))(),a=a||Object.assign({},e),a[i]=e[n],delete a[n]}return a||e}},7469:(t,e,n)=>{"use strict";n.d(e,{F:()=>i});var r=n(9450);function i(t,e,n,i){const o="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach((t=>{s.methodName||(s[t]=()=>{throw r.cM.removed("Calling removed method ".concat(e,".").concat(t,": "),o)(),new Error(t)})}))}},4538:(t,e,n)=>{"use strict";n.d(e,{hQ:()=>o,wt:()=>s,nK:()=>a});var r=n(2525);const i={};function o(t="id"){i[t]=i[t]||1;const e=i[t]++;return"".concat(t,"-").concat(e)}function s(t){return(0,r.Z)("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function a(t){let e=!0;for(const n in t){e=!1;break}return e}},8522:(t,e,n)=>{"use strict";n.d(e,{$Z:()=>u,hJ:()=>c,jG:()=>l});var r=n(2525);const i=5126,o=5124,s=5125,a={[i]:[i,1,"float"],35664:[i,2,"vec2"],35665:[i,3,"vec3"],35666:[i,4,"vec4"],[o]:[o,1,"int"],35667:[o,2,"ivec2"],35668:[o,3,"ivec3"],35669:[o,4,"ivec4"],[s]:[s,1,"uint"],36294:[s,2,"uvec2"],36295:[s,3,"uvec3"],36296:[s,4,"uvec4"],35670:[i,1,"bool"],35671:[i,2,"bvec2"],35672:[i,3,"bvec3"],35673:[i,4,"bvec4"],35674:[i,8,"mat2"],35685:[i,8,"mat2x3"],35686:[i,8,"mat2x4"],35675:[i,12,"mat3"],35687:[i,12,"mat3x2"],35688:[i,12,"mat3x4"],35676:[i,16,"mat4"],35689:[i,16,"mat4x2"],35690:[i,16,"mat4x3"]};function u(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return(0,r.Z)(!1),0}}function c(t){const e=a[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function l(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=i}for(const n in a){const[r,i,o]=a[n];if(r===t&&i===e)return{glType:n,name:o}}return null}},9579:(t,e,n)=>{"use strict";n.d(e,{sF:()=>i,km:()=>o});var r=n(2525);function i(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return(0,r.Z)(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function o(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}},3296:(t,e,n)=>{"use strict";n.d(e,{h:()=>u,Y:()=>c});var r=n(4912),i=n(7952),o=n(1319),s=n(3849),a=n(2525);function u(t,e){(0,a.Z)(t instanceof r.Z||t instanceof i.Z||t instanceof o.Z);const n=t.constructor,{gl:s,width:u,height:c,format:l,type:h,dataFormat:A,border:f,mipmaps:p}=t;return new n(s,Object.assign({width:u,height:c,format:l,type:h,dataFormat:A,border:f,mipmaps:p},e))}function c(t,e){const{gl:n,width:r,height:i,id:o}=t;return new s.Z(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:r,height:i,attachments:{36064:t}}))}},9335:(t,e,n)=>{"use strict";function r(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function i(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o({data:t,width:e,height:n,bytesPerPixel:r=4,temp:i}){const o=e*r;i=i||new Uint8Array(o);for(let e=0;e<n/2;++e){const r=e*o,s=(n-e-1)*o;i.set(t.subarray(r,r+o)),t.copyWithin(r,s,s+o),t.set(i,s)}}function s({data:t,width:e,height:n}){const r=Math.round(e/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let n=0;n<i;n++)for(let i=0;i<r;i++)for(let s=0;s<4;s++)o[4*(n*r+i)+s]=t[4*(2*n*e+2*i)+s];return{data:o,width:r,height:i}}n.d(e,{O:()=>r,vN:()=>i,c$:()=>o,KS:()=>s})},9296:t=>{"use strict";t.exports=n,t.exports.default=n;var e=1e20;function n(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(t,e,n,r,o,s){for(var a=0;a<e;a++)i(t,a,e,n,r,o,s);for(var u=0;u<n;u++)i(t,u*e,1,e,r,o,s)}function i(t,n,r,i,o,s,a){var u,c,l,h;for(s[0]=0,a[0]=-e,a[1]=e,u=0;u<i;u++)o[u]=t[n+u*r];for(u=1,c=0,l=0;u<i;u++){do{h=s[c],l=(o[u]-o[h]+u*u-h*h)/(u-h)/2}while(l<=a[c]&&--c>-1);s[++c]=u,a[c]=l,a[c+1]=e}for(u=0,c=0;u<i;u++){for(;a[c+1]<u;)c++;h=s[c],t[n+u*r]=o[h]+(u-h)*(u-h)}}n.prototype._draw=function(t,n){var i,o,s,a,u,c,l,h,A,f=this.ctx.measureText(t),p=f.width,d=2*this.buffer;n&&this.useMetrics?(u=Math.floor(f.actualBoundingBoxAscent),h=this.buffer+Math.ceil(f.actualBoundingBoxAscent),c=this.buffer,l=this.buffer,i=(o=Math.min(this.size,Math.ceil(f.actualBoundingBoxRight-f.actualBoundingBoxLeft)))+d,s=(a=Math.min(this.size-c,Math.ceil(f.actualBoundingBoxAscent+f.actualBoundingBoxDescent)))+d,this.ctx.textBaseline="alphabetic"):(i=o=this.size,s=a=this.size,u=19*this.fontSize/24,c=l=0,h=this.middle,this.ctx.textBaseline="middle"),o&&a&&(this.ctx.clearRect(l,c,o,a),this.ctx.fillText(t,this.buffer,h),A=this.ctx.getImageData(l,c,o,a));var g=new Uint8ClampedArray(i*s);return function(t,n,r,i,o,s,a){s.fill(e,0,n*r),a.fill(0,0,n*r);for(var u=(n-i)/2,c=0;c<o;c++)for(var l=0;l<i;l++){var h=(c+u)*n+l+u,A=t.data[4*(c*i+l)+3]/255;if(1===A)s[h]=0,a[h]=e;else if(0===A)s[h]=e,a[h]=0;else{var f=Math.max(0,.5-A),p=Math.max(0,A-.5);s[h]=f*f,a[h]=p*p}}}(A,i,s,o,a,this.gridOuter,this.gridInner),r(this.gridOuter,i,s,this.f,this.v,this.z),r(this.gridInner,i,s,this.f,this.v,this.z),function(t,e,n,r,i,o,s){for(var a=0;a<e*n;a++){var u=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(u/o+s))}}(g,i,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:g,metrics:{width:o,height:a,sdfWidth:i,sdfHeight:s,top:u,left:0,advance:p}}},n.prototype.draw=function(t){return this._draw(t,!1).data},n.prototype.drawWithMetrics=function(t){return this._draw(t,!0)}},6357:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var r=n(4034),i=n(394);class o extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return(0,i.Z)(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:(0,r.kJ)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r.vc)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+(0,r.Bw)(this[n],t);return`${t.printTypes?this.constructor.name:""}[${e}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,r.fS)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(r.vc.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}},1e3:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(6357),i=n(6281),o=n(4034),s=n(394);class a extends r.Z{get ELEMENTS(){return(0,s.Z)(!1),0}get RANK(){return(0,s.Z)(!1),0}toString(){let t="[";if(o.vc.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+e]}`}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=` ${this[e]}`}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=(0,i.u5)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}},9521:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var r=n(6357),i=n(6281),o=n(394);class s extends r.Z{get ELEMENTS(){return(0,o.Z)(!1),0}copy(t){return(0,o.Z)(!1),this}get x(){return this[0]}set x(t){this[0]=(0,i.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.u5)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return(0,i.u5)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return(0,i.u5)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,i.u5)(this[t])}setComponent(t,e){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}},540:(t,e,n)=>{"use strict";n.d(e,{Z:()=>f});var r=n(1e3),i=n(6281),o=n(1031),s=n(5600),a=n(1437),u=n(7160);const c=Object.freeze([1,0,0,0,1,0,0,0,1]),l=Object.freeze([0,0,0,0,0,0,0,0,0]),h=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),A={};class f extends r.Z{static get IDENTITY(){return A.IDENTITY=A.IDENTITY||Object.freeze(new f(c)),A.IDENTITY}static get ZERO(){return A.ZERO=A.ZERO||Object.freeze(new f(l)),A.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return h}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,n,r,i,o,s,a,u){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this.check()}setRowMajor(t,e,n,r,i,o,s,a,u){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=u,this.check()}determinant(){return s.GH(this)}identity(){return this.copy(c)}fromQuaternion(t){return s.en(this,t),this.check()}transpose(){return s.p4(this,this),this.check()}invert(){return s.U_(this,this),this.check()}multiplyLeft(t){return s.Jp(this,t,this),this.check()}multiplyRight(t){return s.Jp(this,this,t),this.check()}rotate(t){return s.U1(this,this,t),this.check()}scale(t){return Array.isArray(t)?s.bA(this,this,t):s.bA(this,this,[t,t,t]),this.check()}translate(t){return s.Iu(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=a.kK(e||[-0,-0],t,this);break;case 3:e=u.kK(e||[-0,-0,-0],t,this);break;case 4:e=(0,o._x)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,i.IL)(e,t.length),e}transformVector(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return(0,i.x9)("Matrix3.transformVector"),this.transform(t,e)}}},5451:(t,e,n)=>{"use strict";n.d(e,{Z:()=>p});var r=n(6281),i=n(1e3),o=n(1031),s=n(5975),a=n(1437),u=n(7160),c=n(8333);const l=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),h=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),A=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),f={};class p extends i.Z{static get IDENTITY(){return f.IDENTITY=f.IDENTITY||Object.freeze(new p(l)),f.IDENTITY}static get ZERO(){return f.ZERO=f.ZERO||Object.freeze(new p(h)),f.ZERO}get INDICES(){return A}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,u,c,l,h,A,f,p,d){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=h,this[12]=A,this[13]=f,this[14]=p,this[15]=d,this.check()}setRowMajor(t,e,n,r,i,o,s,a,u,c,l,h,A,f,p,d){return this[0]=t,this[1]=i,this[2]=u,this[3]=A,this[4]=e,this[5]=o,this[6]=c,this[7]=f,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=h,this[15]=d,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(l)}fromQuaternion(t){return s.en(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:i,far:o}){return o===1/0?p._computeInfinitePerspectiveOffCenter(this,t,e,n,r,i):s.oy(this,t,e,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),e=e||[0,0,0],n=n||[0,1,0],s.zB(this,t,e,n),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:i=.1,far:o=500}){return s.M5(this,t,e,n,r,i,o),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const o=t/2,s=n*Math.tan(o),a=s*e;return(new p).ortho({left:-a,right:a,bottom:-s,top:s,near:r,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return s.G3(this,t,n,r,i),this.check()}determinant(){return s.GH(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return s.p4(this,this),this.check()}invert(){return s.U_(this,this),this.check()}multiplyLeft(t){return s.Jp(this,t,this),this.check()}multiplyRight(t){return s.Jp(this,this,t),this.check()}rotateX(t){return s.lM(this,this,t),this.check()}rotateY(t){return s.uD(this,this,t),this.check()}rotateZ(t){return s.jI(this,this,t),this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return s.U1(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?s.bA(this,this,t):s.bA(this,this,[t,t,t]),this.check()}translate(t){return s.Iu(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=c.fF(e||[-0,-0,-0,-0],t,this),(0,r.IL)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=a.fF(e||[-0,-0],t,this);break;case 3:e=u.fF(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=(0,o.pb)(e||[-0,-0],t,this);break;case 3:e=(0,o.pL)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return(0,r.x9)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return(0,r.x9)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return(0,r.x9)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}},4782:(t,e,n)=>{"use strict";n.d(e,{Z:()=>S});var r=n(6357),i=n(6281),o=n(394),s=n(9685),a=n(5600),u=n(7160),c=n(8333);function l(){var t=new s.WT(4);return s.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function h(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function A(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+s*a+i*c-o*u,t[1]=i*l+s*u+o*a-r*c,t[2]=o*l+s*c+r*u-i*a,t[3]=s*l-r*a-i*u-o*c,t}c.d9,c.al,c.JG,c.t8;var f,p,d,g=c.IH,y=c.bA,m=c.AK,_=c.t7,v=c.kE,b=c.we,w=c.Fv,E=(c.I6,c.fS,f=u.Ue(),p=u.al(1,0,0),d=u.al(0,1,0),function(t,e,n){var r=u.AK(e,n);return r<-.999999?(u.kC(f,p,e),u.Zh(f)<1e-6&&u.kC(f,d,e),u.Fv(f,f),h(t,f,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(u.kC(f,e,n),t[0]=f[0],t[1]=f[1],t[2]=f[2],t[3]=1+r,w(t,t))});l(),l(),a.Ue();const x=[0,0,0,1];class S extends r.Z{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromMatrix3(t){return function(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}}(this,t),this.check()}identity(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}fromAxisRotation(t,e){return h(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=(0,i.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.u5)(t)}get z(){return this[2]}set z(t){this[2]=(0,i.u5)(t)}get w(){return this[3]}set w(t){this[3]=(0,i.u5)(t)}len(){return v(this)}lengthSquared(){return b(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return m(this,t)}rotationTo(t,e){return E(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return g(this,this,t),this.check()}calculateW(){var t,e,n,r;return t=this,e=this[0],n=this[1],r=this[2],t[0]=e,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-e*e-n*n-r*r)),this.check()}conjugate(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return _(this,t,e,n),this.check()}multiplyRight(t,e){return(0,o.Z)(!e),A(this,this,t),this.check()}multiplyLeft(t,e){return(0,o.Z)(!e),A(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-r*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u-o*a,t[1]=i*u+s*a,t[2]=o*u+r*a,t[3]=s*u-i*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=o*u+s*a,t[3]=s*u-o*a}(this,this,t),this.check()}scale(t){return y(this,this,t),this.check()}slerp(t,e,n){switch(arguments.length){case 1:({start:t=x,target:e,ratio:n}=arguments[0]);break;case 2:[e,n]=arguments,t=this}return r=this,o=e,a=n,f=(i=t)[0],p=i[1],d=i[2],g=i[3],y=o[0],m=o[1],_=o[2],v=o[3],(c=f*y+p*m+d*_+g*v)<0&&(c=-c,y=-y,m=-m,_=-_,v=-v),1-c>s.Ib?(u=Math.acos(c),l=Math.sin(u),h=Math.sin((1-a)*u)/l,A=Math.sin(a*u)/l):(h=1-a,A=a),r[0]=h*f+A*y,r[1]=h*p+A*m,r[2]=h*d+A*_,r[3]=h*g+A*v,this.check();var r,i,o,a,u,c,l,h,A,f,p,d,g,y,m,_,v}transformVector4(t,e=t){return c.VC(e,t,this),(0,i.IL)(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}},7858:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(4034),i=n(3855),o=n(7160);const s=1e-6;class a{constructor({phi:t=0,theta:e=0,radius:n=1,bearing:r,pitch:i,altitude:o,radiusScale:s=6371e3}={}){this.phi=t,this.theta=e,this.radius=n||o||1,this.radiusScale=s||1,void 0!==r&&(this.bearing=r),void 0!==i&&(this.pitch=i),this.check()}toString(){return this.formatString(r.vc)}formatString({printTypes:t=!1}){const e=r.Bw;return`${t?"Spherical":""}[rho:${e(this.radius)},theta:${e(this.theta)},phi:${e(this.phi)}]`}equals(t){return(0,r.fS)(this.radius,t.radius)&&(0,r.fS)(this.theta,t.theta)&&(0,r.fS)(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-(0,r.RW)(this.phi)}set bearing(t){this.phi=Math.PI-(0,r.uR)(t)}get pitch(){return(0,r.RW)(this.theta)}set pitch(t){this.theta=(0,r.uR)(t)}get longitude(){return(0,r.RW)(this.phi)}get latitude(){return(0,r.RW)(this.theta)}get lng(){return(0,r.RW)(this.phi)}get lat(){return(0,r.RW)(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this.check()}clone(){return(new a).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,e,n]){this.radius=1+n/this.radiusScale,this.phi=(0,r.uR)(e),this.theta=(0,r.uR)(t)}fromVector3(t){return this.radius=o.kE(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos((0,r.uZ)(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new i.Z(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(s,Math.min(Math.PI-s,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}},7069:(t,e,n)=>{"use strict";n.d(e,{Z:()=>u});var r=n(9521),i=n(4034),o=n(6281),s=n(1437),a=n(1031);class u extends r.Z{constructor(t=0,e=0){super(2),(0,i.kJ)(t)&&1===arguments.length?this.copy(t):(i.vc.debug&&((0,o.u5)(t),(0,o.u5)(e)),this[0]=t,this[1]=e)}set(t,e){return this[0]=t,this[1]=e,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return i.vc.debug&&((0,o.u5)(t.x),(0,o.u5)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.fF(this,this,t),this.check()}transformAsVector(t){return(0,a.pb)(this,this,t),this.check()}transformByMatrix3(t){return s.kK(this,this,t),this.check()}transformByMatrix2x3(t){return s.iu(this,this,t),this.check()}transformByMatrix2(t){return s.c(this,this,t),this.check()}}},3855:(t,e,n)=>{"use strict";n.d(e,{Z:()=>l});var r=n(9521),i=n(4034),o=n(6281),s=n(7160),a=n(1031);const u=[0,0,0],c={};class l extends r.Z{static get ZERO(){return c.ZERO=c.ZERO||Object.freeze(new l(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,i.kJ)(t)?this.copy(t):(i.vc.debug&&((0,o.u5)(t),(0,o.u5)(e),(0,o.u5)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return i.vc.debug&&((0,o.u5)(t.x),(0,o.u5)(t.y),(0,o.u5)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,o.u5)(t)}angle(t){return s.EU(this,t)}cross(t){return s.kC(this,this,t),this.check()}rotateX({radians:t,origin:e=u}){return s.lM(this,this,e,t),this.check()}rotateY({radians:t,origin:e=u}){return s.uD(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=u}){return s.jI(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return s.fF(this,this,t),this.check()}transformAsVector(t){return(0,a.pL)(this,this,t),this.check()}transformByMatrix3(t){return s.kK(this,this,t),this.check()}transformByMatrix2(t){return(0,a.eQ)(this,this,t),this.check()}transformByQuaternion(t){return s.VC(this,this,t),this.check()}}},394:(t,e,n)=>{"use strict";function r(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}n.d(e,{Z:()=>r})},4034:(t,e,n)=>{"use strict";n.d(e,{vc:()=>s,jQ:()=>a,Bw:()=>u,kJ:()=>c,d9:()=>l,Yr:()=>A,Ux:()=>f,uR:()=>p,RW:()=>d,O$:()=>g,mC:()=>y,OR:()=>m,ZR:()=>_,Kh:()=>v,z4:()=>b,uZ:()=>w,t7:()=>E,fS:()=>x,I6:()=>S,BJ:()=>P});var r=n(394);const i=1/Math.PI*180,o=1/180*Math.PI,s={};function a(t={}){for(const e in t)(0,r.Z)(e in s),s[e]=t[e];return s}function u(t,{precision:e=s.precision||4}={}){return t=function(t){return Math.round(t/s.EPSILON)*s.EPSILON}(t),`${parseFloat(t.toPrecision(e))}`}function c(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function l(t){return t.clone?t.clone():new Array(...t)}function h(t,e,n){if(c(t)){n=n||((r=t).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var r;return e(t)}function A(t){return p(t)}function f(t){return d(t)}function p(t,e){return h(t,(t=>t*o),e)}function d(t,e){return h(t,(t=>t*i),e)}function g(t){return h(t,(t=>Math.sin(t)))}function y(t){return h(t,(t=>Math.cos(t)))}function m(t){return h(t,(t=>Math.tan(t)))}function _(t){return h(t,(t=>Math.asin(t)))}function v(t){return h(t,(t=>Math.acos(t)))}function b(t){return h(t,(t=>Math.atan(t)))}function w(t,e,n){return h(t,(t=>Math.max(e,Math.min(n,t))))}function E(t,e,n){return c(t)?t.map(((t,r)=>E(t,e[r],n))):n*e+(1-n)*t}function x(t,e,n){const r=s.EPSILON;n&&(s.EPSILON=n);try{if(t===e)return!0;if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!x(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{s.EPSILON=r}}function S(t,e){if(t===e)return!0;if(t&&"object"==typeof t&&e&&"object"==typeof e){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(c(t)&&c(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!S(t[n],e[n]))return!1;return!0}return!1}function P(t,e){const n=s.EPSILON;let r;s.EPSILON=t;try{r=e()}finally{s.EPSILON=n}return r}s.EPSILON=1e-12,s.debug=!1,s.precision=4,s.printTypes=!1,s.printDegrees=!1,s.printRowMajor=!0},1031:(t,e,n)=>{"use strict";function r(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function i(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function o(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function s(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function a(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}n.d(e,{pb:()=>r,pL:()=>i,eQ:()=>o,G7:()=>s,_x:()=>a})},9057:(t,e,n)=>{"use strict";n.d(e,{Z:()=>r});const r={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},6281:(t,e,n)=>{"use strict";n.d(e,{u5:()=>i,IL:()=>o,x9:()=>a});var r=n(4034);function i(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${t}`);return t}function o(t,e,n=""){if(r.vc.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}const s={};function a(t,e){s[t]||(s[t]=!0,console.warn(`${t} has been removed in version ${e}, see upgrade guide for more information`))}},5215:(t,e,n)=>{"use strict";n.d(e,{wG:()=>r,WZ:()=>B,GU:()=>Z,dj:()=>F,ct:()=>V,OT:()=>s,ap:()=>o,Ny:()=>i});const r={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function i(t,e,n={}){return function(t,e={}){return Math.sign(o(t,e))}(t,n)!==e&&(function(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let e=0;e<s;++e){const r=n+e*i,s=n+(o-1-e)*i;for(let e=0;e<i;++e){const n=t[r+e];t[r+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function o(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let e=n,s=r-i;e<r;e+=i)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}function s(t,e,n,r){n=n||2;const i=e&&e.length,o=i?e[0]*n:t.length;let s=a(t,0,o,n,!0,r&&r[0]);const l=[];if(!s||s.next===s.prev)return l;let h,A,f,g,y,_,v;if(i&&(s=function(t,e,n,r,i){const o=[];let s,c,l,h,A;for(s=0,c=e.length;s<c;s++)l=e[s]*r,h=s<c-1?e[s+1]*r:t.length,A=a(t,l,h,r,!1,i&&i[s+1]),A===A.next&&(A.steiner=!0),o.push(m(A));for(o.sort(p),s=0;s<o.length;s++)d(o[s],n),n=u(n,n.next);return n}(t,e,s,n,r)),t.length>80*n){g=A=t[0],y=f=t[1];for(let e=n;e<o;e+=n)_=t[e],v=t[e+1],_<g&&(g=_),v<y&&(y=v),_>A&&(A=_),v>f&&(f=v);h=Math.max(A-g,f-y),h=0!==h?1/h:0}return c(s,l,n,g,y,h),l}function a(t,e,n,r,i,s){let a,u;if(void 0===s&&(s=o(t,{start:e,end:n,size:r})),i===s<0)for(a=e;a<n;a+=r)u=C(a,t[a],t[a+1],u);else for(a=n-r;a>=e;a-=r)u=C(a,t[a],t[a+1],u);return u&&w(u,u.next)&&(M(u),u=u.next),u}function u(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!w(r,r.next)&&0!==b(r.prev,r,r.next))r=r.next;else{if(M(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function c(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=y(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,u,c=1;do{for(i=t,t=null,u=null,r=0;i;){for(r++,s=i,o=0,n=0;n<c&&(o++,s=s.nextZ,s);n++);for(a=c;o>0||a>0&&s;)0!==o&&(0===a||!s||i.z<=s.z)?(e=i,i=i.nextZ,o--):(e=s,s=s.nextZ,a--),u?u.nextZ=e:t=e,e.prevZ=u,u=e;i=s}u.nextZ=null,c*=2}while(r>1)}(i)}(t,r,i,o);let a,p,d=t;for(;t.prev!==t.next;)if(a=t.prev,p=t.next,o?h(t,r,i,o):l(t))e.push(a.i/n),e.push(t.i/n),e.push(p.i/n),M(t),t=p.next,d=p.next;else if((t=p)===d){s?1===s?c(t=A(u(t),e,n),e,n,r,i,o,2):2===s&&f(t,e,n,r,i,o):c(u(t),e,n,r,i,o,1);break}}function l(t){const e=t.prev,n=t,r=t.next;if(b(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(_(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&b(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function h(t,e,n,r){const i=t.prev,o=t,s=t.next;if(b(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=y(a,u,e,n,r),A=y(c,l,e,n,r);let f=t.prevZ,p=t.nextZ;for(;f&&f.z>=h&&p&&p.z<=A;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&b(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=A;){if(p!==t.prev&&p!==t.next&&_(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&b(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function A(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!w(i,o)&&E(i,r,r.next,o)&&P(i,o)&&P(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),M(r),M(r.next),r=t=o),r=r.next}while(r!==t);return u(r)}function f(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&v(s,t)){let a=T(s,t);return s=u(s,s.next),a=u(a,a.next),c(s,e,n,r,i,o),void c(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function p(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,u=o.x,c=o.y;let l,h=1/0;n=o;do{r>=n.x&&n.x>=u&&r!==n.x&&_(i<c?r:s,i,u,c,i<c?s:r,i,n.x,n.y)&&(l=Math.abs(i-n.y)/(r-n.x),P(n,t)&&(l<h||l===h&&(n.x>o.x||n.x===o.x&&g(o,n)))&&(o=n,h=l)),n=n.next}while(n!==a);return o}(t,e)){const n=T(e,t);u(e,e.next),u(n,n.next)}}function g(t,e){return b(t.prev,t,e.prev)<0&&b(e.next,t,t.next)<0}function y(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function m(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function _(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(P(t,e)&&P(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(b(t.prev,t,e.prev)||b(t,e.prev,e))||w(t,e)&&b(t.prev,t,t.next)>0&&b(e.prev,e,e.next)>0)}function b(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function w(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,r){const i=S(b(t,e,n)),o=S(b(t,e,r)),s=S(b(n,r,t)),a=S(b(n,r,e));return i!==o&&s!==a||!(0!==i||!x(t,n,e))||!(0!==o||!x(t,r,e))||!(0!==s||!x(n,t,r))||!(0!==a||!x(n,e,r))}function x(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function S(t){return t>0?1:t<0?-1:0}function P(t,e){return b(t.prev,t,t.next)<0?b(t,e,t.next)>=0&&b(t,t.prev,e)>=0:b(t,e,t.prev)<0||b(t,t.next,e)<0}function T(t,e){const n=new I(t.i,t.x,t.y),r=new I(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function C(t,e,n,r){const i=new I(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function I(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function O(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)i[n]=(1&s)===n?r[s]:o*(e[n]-t[n])+t[n];return i}function R(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function L(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function N(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function D(t,e,n,r,i=[]){const o=r+e*n;for(let e=0;e<n;e++)i[e]=t[o+e];return i}function F(t,e={}){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e,u=(a-s)/n;let c=[];const l=[c],h=D(t,0,n,s);let A,f;const p=U(h,i,o,[]),d=[];L(c,h);for(let e=1;e<u;e++){for(A=D(t,e,n,s,A),f=R(A,p);f;){O(h,A,f,p,d);const t=R(d,p);t&&(O(h,d,t,p,d),f=t),L(c,d),N(h,d),z(p,i,f),r&&c.length>n&&(c=[],l.push(c),L(c,h)),f=R(A,p)}L(c,A),N(h,A)}return r?l:l[0]}function k(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function B(t,e,n={}){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n,a=[],u=[{pos:t,types:s&&new Array(t.length/r).fill(1),holes:e||[]}],c=[[],[]];let l=[];for(;u.length;){const{pos:t,types:e,holes:n}=u.shift();G(t,r,n[0]||t.length,c),l=U(c[0],i,o,l);const h=R(c[1],l);if(h){let i=j(t,e,r,0,n[0]||t.length,l,h);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};u.push(o,a);for(let u=0;u<n.length;u++)i=j(t,e,r,n[u],n[u+1]||t.length,l,h),i[0]&&(o.holes.push(o.pos.length),o.pos=k(o.pos,i[0].pos),s&&(o.types=k(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=k(a.pos,i[1].pos),s&&(a.types=k(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function j(t,e,n,r,i,o,s){const a=(i-r)/n,u=[],c=[],l=[],h=[],A=[];let f,p,d;const g=D(t,a-1,n,r);let y=Math.sign(8&s?g[1]-o[3]:g[0]-o[2]),m=e&&e[a-1],_=0,v=0;for(let i=0;i<a;i++)f=D(t,i,n,r,f),p=Math.sign(8&s?f[1]-o[3]:f[0]-o[2]),d=e&&e[r/n+i],p&&y&&y!==p&&(O(g,f,s,o,A),L(u,A)&&l.push(m),L(c,A)&&h.push(m)),p<=0?(L(u,f)&&l.push(d),_-=p):l.length&&(l[l.length-1]=0),p>=0?(L(c,f)&&h.push(d),v+=p):h.length&&(h[h.length-1]=0),N(g,f),y=p,m=d;return[_?{pos:u,types:e&&l}:null,v?{pos:c,types:e&&h}:null]}function U(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function z(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function G(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let r=0;r<n;r+=e){const e=t[r],n=t[r+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function V(t,e={}){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e,s=t.slice(r,i);W(s,n,0,i-r);const a=F(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)X(t,n);return a}function Z(t,e,n={}){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n;e=e||[];const s=[],a=[];let u=0,c=0;for(let i=0;i<=e.length;i++){const o=e[i]||t.length,l=c,h=H(t,r,u,o);for(let e=h;e<o;e++)s[c++]=t[e];for(let e=u;e<h;e++)s[c++]=t[e];W(s,r,l,c),q(s,r,l,c,n.maxLatitude),u=o,a[i]=c}a.pop();const l=B(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const t of l)X(t.positions,r);return l}function H(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function q(t,e,n,r,i=85.051129){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=D(t,0,e,n);r[0]+=360*Math.round((s-o)/360),L(t,r),r[1]=Math.sign(r[1])*i,L(t,r),r[0]=o,L(t,r)}}function W(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function X(t,e){let n;const r=t.length/e;for(let i=0;i<r&&(n=t[i*e],(n+180)%360==0);i++);const i=360*-Math.round(n/360);if(0!==i)for(let n=0;n<r;n++)t[n*e]+=i}},7013:(t,e,n)=>{"use strict";n.d(e,{DW:()=>N,eG:()=>w,Lu:()=>P,Xg:()=>I,if:()=>B,sj:()=>T,zX:()=>R,ro:()=>b,up:()=>j,Bf:()=>v,c7:()=>S,wl:()=>x,lf:()=>E,w5:()=>m,QA:()=>D,CT:()=>M,sO:()=>y,es:()=>_,aW:()=>C,EO:()=>g});var r=n(8333);function i(t,e){const n=r.fF([],e,t);return r.bA(n,n,1/n[3]),n}function o(t,e){const n=t%e;return n<0?e+n:n}const s=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var a=n(5975),u=n(1437),c=n(7160);function l(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const h=Math.PI,A=h/4,f=h/180,p=180/h,d=512;function g(t){return Math.pow(2,t)}function y(t){return s(t)}function m([t,e]){l(Number.isFinite(t)),l(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=e*f;return[d*(t*f+h)/(2*h),d*(h+Math.log(Math.tan(A+.5*n)))/(2*h)]}function _([t,e]){const n=t/d*(2*h)-h,r=2*(Math.atan(Math.exp(e/d*(2*h)-h))-A);return[n*p,r*p]}function v({latitude:t}){l(Number.isFinite(t));return y(4003e4*Math.cos(t*f))-9}function b({latitude:t,longitude:e,highPrecision:n=!1}){l(Number.isFinite(t)&&Number.isFinite(e));const r={},i=Math.cos(t*f),o=512/360,s=o/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[o,s,a],r.degreesPerUnit=[.703125,1/s,1/a],n){const e=f*Math.tan(t*f)/i,n=o*e/2,u=12790407194604047e-21*e,c=u/s*a;r.unitsPerDegree2=[0,n,u],r.unitsPerMeter2=[c,0,c]}return r}function w(t,e){const[n,r,i]=t,[o,s,a]=e,{unitsPerMeter:u,unitsPerMeter2:c}=b({longitude:n,latitude:r,highPrecision:!0}),l=m(t);l[0]+=o*(u[0]+c[0]*s),l[1]+=s*(u[1]+c[1]*s);const h=_(l),A=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],A]:h}function E({height:t,pitch:e,bearing:n,altitude:r,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a.Iu(s,s,[0,0,-r]),a.lM(s,s,-e*f),a.jI(s,s,n*f),i/=t,a.bA(s,s,[i,i,i]),o&&a.Iu(s,s,c.tk([],o)),s}function x({width:t,height:e,fovy:n=P(1.5),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=P(r));const a=.5*n*f,u=T(n),c=i*f,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:t/e,focalDistance:u,near:o,far:(Math.sin(c)*l+u)*s}}function S({width:t,height:e,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:u,aspect:c,near:l,far:h}=x({width:t,height:e,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s});return a.G3([],u,c,l,h)}function P(t){return 2*Math.atan(.5/t)*p}function T(t){return.5/Math.tan(.5*t*f)}function C(t,e){const[n,r,o=0]=t;return l(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),i(e,[n,r,o,1])}function M(t,e,n=0){const[r,o,s]=t;if(l(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(s))return i(e,[r,o,s,1]);const a=i(e,[r,o,0,1]),c=i(e,[r,o,1,1]),h=a[2],A=c[2],f=h===A?0:((n||0)-h)/(A-h);return u.t7([],a,c,f)}function I({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:a=[0,0]}){const[[u,c],[h,A]]=n;Number.isFinite(o)?o={top:o,bottom:o,left:o,right:o}:l(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const f=new N({width:t,height:e,longitude:0,latitude:0,zoom:0}),p=f.project([u,A]),d=f.project([h,c]),g=[Math.max(Math.abs(d[0]-p[0]),r),Math.max(Math.abs(d[1]-p[1]),r)],y=[t-o.left-o.right-2*Math.abs(a[0]),e-o.top-o.bottom-2*Math.abs(a[1])];l(y[0]>0&&y[1]>0);const m=y[0]/g[0],_=y[1]/g[1],v=(o.right-o.left)/2/m,b=(o.bottom-o.top)/2/_,w=[(d[0]+p[0])/2+v,(d[1]+p[1])/2+b],E=f.unproject(w),x=Math.min(i,f.zoom+s(Math.abs(Math.min(m,_))));return l(Number.isFinite(x)),{longitude:E[0],latitude:E[1],zoom:x}}const O=Math.PI/180;function R(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),a=i([n,r],o);let u,c;return(t.fovy?.5*t.fovy*O:Math.atan(.5/t.altitude))>(90-t.pitch)*O-.01?(u=L(t,0,e),c=L(t,n,e)):(u=i([0,0],o),c=i([n,0],o)),[s,a,c,u]}function L(t,e,n){const{pixelUnprojectionMatrix:r}=t,o=i(r,[e,0,1,1]),s=i(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(s[2]-o[2]),c=_(u.t7([],o,s,a));return c[2]=n,c}class N{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:a=null,fovy:u=null,position:l=null,nearZMultiplier:h=.02,farZMultiplier:A=1.01}={width:1,height:1}){t=t||1,e=e||1,null===u&&null===a?u=P(a=1.5):null===u?u=P(a):null===a&&(a=T(u));const f=g(i);a=Math.max(.75,a);const p=b({longitude:r,latitude:n}),d=m([r,n]);d[2]=0,l&&c.IH(d,d,c.dC([],l,p.unitsPerMeter)),this.projectionMatrix=S({width:t,height:e,pitch:o,fovy:u,nearZMultiplier:h,farZMultiplier:A}),this.viewMatrix=E({height:e,scale:f,center:d,pitch:o,bearing:s,altitude:a}),this.width=t,this.height=e,this.scale=f,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=a,this.fovy=u,this.center=d,this.meterOffset=l||[0,0,0],this.distanceScales=p,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.Jp(i,i,n),a.Jp(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.bA(o,o,[t/2,-e/2,1]),a.Iu(o,o,[1,-1,0]),a.Jp(o,o,i);const s=a.U_([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(t){return t instanceof N&&t.width===this.width&&t.height===this.height&&a.fS(t.projectionMatrix,this.projectionMatrix)&&a.fS(t.viewMatrix,this.viewMatrix)}project(t,{topLeft:e=!0}={}){const n=C(this.projectPosition(t),this.pixelProjectionMatrix),[r,i]=n,o=e?i:this.height-i;return 2===t.length?[r,o]:[r,o,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=M([r,s,o],this.pixelUnprojectionMatrix,a),[c,l,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,h]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=m(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=_(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return m(t)}unprojectFlat(t){return _(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=M(e,this.pixelUnprojectionMatrix),r=m(t),i=u.IH([],r,u.tk([],n));return _(u.IH([],this.center,i))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=I(Object.assign({width:n,height:r,bounds:t},e));return new N({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),r=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[r,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return R(this,t.z||0)}}function D({width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:a=0,bearing:u=0}){(n<-180||n>180)&&(n=o(n+180,360)-180),(u<-180||u>180)&&(u=o(u+180,360)-180);const c=s(e/512);if(i<=c)i=c,r=0;else{const t=e/2/Math.pow(2,i),n=_([0,t])[1];if(r<n)r=n;else{const e=_([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:a,bearing:u}}const F=["longitude","latitude","zoom"],k={curve:1.414,speed:1.2};function B(t,e,n,r={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:c,u1:l,S:h,rho:A,rho2:f,r0:p}=U(t,e,r);if(l<.01){for(const r of F){const o=t[r],s=e[r];i[r]=(d=n)*s+(1-d)*o}return i}var d;const g=n*h,m=Math.cosh(p)/Math.cosh(p+A*g),v=c*((Math.cosh(p)*Math.tanh(p+A*g)-Math.sinh(p))/f)/l,b=o+y(1/m),w=u.bA([],a,v);u.IH(w,w,s);const E=_(w);return i.longitude=E[0],i.latitude=E[1],i.zoom=b,i}function j(t,e,n={}){n=Object.assign({},k,n);const{screenSpeed:r,speed:i,maxDuration:o}=n,{S:s,rho:a}=U(t,e,n),u=1e3*s;let c;return c=Number.isFinite(r)?u/(r/a):u/i,Number.isFinite(o)&&c>o?0:c}function U(t,e,n){const r=(n=Object.assign({},k,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],s=g(i),a=e.zoom,c=[e.longitude,e.latitude],l=g(a-i),h=m(o),A=m(c),f=u.lu([],A,h),p=Math.max(t.width,t.height),d=p/l,y=u.kE(f)*s,_=Math.max(y,.01),v=r*r,b=(d*d-p*p+v*v*_*_)/(2*p*v*_),w=(d*d-p*p-v*v*_*_)/(2*d*v*_),E=Math.log(Math.sqrt(b*b+1)-b),x=Math.log(Math.sqrt(w*w+1)-w);return{startZoom:i,startCenterXY:h,uDelta:f,w0:p,u1:y,S:(x-E)/r,rho:r,rho2:v,r0:E,r1:x}}},7359:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"GeoJsonEditMode",{enumerable:!0,get:function(){return o.GeoJsonEditMode}}),Object.defineProperty(e,"ModifyMode",{enumerable:!0,get:function(){return s.ModifyMode}}),Object.defineProperty(e,"ResizeCircleMode",{enumerable:!0,get:function(){return a.ResizeCircleMode}}),Object.defineProperty(e,"TranslateMode",{enumerable:!0,get:function(){return u.TranslateMode}}),Object.defineProperty(e,"ScaleMode",{enumerable:!0,get:function(){return c.ScaleMode}}),Object.defineProperty(e,"RotateMode",{enumerable:!0,get:function(){return l.RotateMode}}),Object.defineProperty(e,"DuplicateMode",{enumerable:!0,get:function(){return h.DuplicateMode}}),Object.defineProperty(e,"ExtendLineStringMode",{enumerable:!0,get:function(){return A.ExtendLineStringMode}}),Object.defineProperty(e,"SplitPolygonMode",{enumerable:!0,get:function(){return f.SplitPolygonMode}}),Object.defineProperty(e,"ExtrudeMode",{enumerable:!0,get:function(){return p.ExtrudeMode}}),Object.defineProperty(e,"ElevationMode",{enumerable:!0,get:function(){return d.ElevationMode}}),Object.defineProperty(e,"TransformMode",{enumerable:!0,get:function(){return g.TransformMode}}),Object.defineProperty(e,"DrawPointMode",{enumerable:!0,get:function(){return y.DrawPointMode}}),Object.defineProperty(e,"DrawLineStringMode",{enumerable:!0,get:function(){return m.DrawLineStringMode}}),Object.defineProperty(e,"DrawPolygonMode",{enumerable:!0,get:function(){return _.DrawPolygonMode}}),Object.defineProperty(e,"DrawRectangleMode",{enumerable:!0,get:function(){return v.DrawRectangleMode}}),Object.defineProperty(e,"DrawSquareFromCenterMode",{enumerable:!0,get:function(){return b.DrawSquareFromCenterMode}}),Object.defineProperty(e,"DrawCircleByDiameterMode",{enumerable:!0,get:function(){return w.DrawCircleByDiameterMode}}),Object.defineProperty(e,"DrawCircleFromCenterMode",{enumerable:!0,get:function(){return E.DrawCircleFromCenterMode}}),Object.defineProperty(e,"DrawEllipseByBoundingBoxMode",{enumerable:!0,get:function(){return x.DrawEllipseByBoundingBoxMode}}),Object.defineProperty(e,"DrawEllipseUsingThreePointsMode",{enumerable:!0,get:function(){return S.DrawEllipseUsingThreePointsMode}}),Object.defineProperty(e,"DrawRectangleUsingThreePointsMode",{enumerable:!0,get:function(){return P.DrawRectangleUsingThreePointsMode}}),Object.defineProperty(e,"Draw90DegreePolygonMode",{enumerable:!0,get:function(){return T.Draw90DegreePolygonMode}}),Object.defineProperty(e,"DrawPolygonByDraggingMode",{enumerable:!0,get:function(){return C.DrawPolygonByDraggingMode}}),Object.defineProperty(e,"ImmutableFeatureCollection",{enumerable:!0,get:function(){return M.ImmutableFeatureCollection}}),Object.defineProperty(e,"ViewMode",{enumerable:!0,get:function(){return I.ViewMode}}),Object.defineProperty(e,"MeasureDistanceMode",{enumerable:!0,get:function(){return O.MeasureDistanceMode}}),Object.defineProperty(e,"MeasureAreaMode",{enumerable:!0,get:function(){return R.MeasureAreaMode}}),Object.defineProperty(e,"MeasureAngleMode",{enumerable:!0,get:function(){return L.MeasureAngleMode}}),Object.defineProperty(e,"CompositeMode",{enumerable:!0,get:function(){return N.CompositeMode}}),Object.defineProperty(e,"SnappableMode",{enumerable:!0,get:function(){return D.SnappableMode}}),Object.defineProperty(e,"_memoize",{enumerable:!0,get:function(){return F.default}}),e.utils=void 0;var i,o=n(2254),s=n(7366),a=n(7339),u=n(6166),c=n(5892),l=n(83),h=n(2511),A=n(4546),f=n(6548),p=n(6601),d=n(1370),g=n(4061),y=n(5521),m=n(2116),_=n(5282),v=n(8725),b=n(3704),w=n(5790),E=n(6950),x=n(3199),S=n(5184),P=n(9050),T=n(1400),C=n(3039),M=n(6302),I=n(5279),O=n(63),R=n(244),L=n(9857),N=n(8874),D=n(3816),F=(i=n(3916))&&i.__esModule?i:{default:i},k=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=B();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}(n(875));function B(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return B=function(){return t},t}e.utils=k},8874:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?u(t):e}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.CompositeMode=void 0;var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,r,A=(e=f,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function f(t){var e,n,r,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),i=void 0,(r="_modes")in(n=u(e=A.call(this)))?Object.defineProperty(n,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[r]=i,e._modes=t,e}return n=f,(r=[{key:"_coalesce",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;r<this._modes.length&&(e=t(this._modes[r]),!(n?n(e):e));r++);return e}},{key:"handleClick",value:function(t,e){this._coalesce((function(n){return n.handleClick(t,e)}))}},{key:"handlePointerMove",value:function(t,e){return this._coalesce((function(n){return n.handlePointerMove(t,e)}))}},{key:"handleStartDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStartDragging(t,e)}))}},{key:"handleStopDragging",value:function(t,e){return this._coalesce((function(n){return n.handleStopDragging(t,e)}))}},{key:"handleDragging",value:function(t,e){return this._coalesce((function(n){return n.handleDragging(t,e)}))}},{key:"getGuides",value:function(t){var e,n,r=[],s=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=i(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}(this._modes);try{for(s.s();!(e=s.n()).done;){var a=e.value;r.push.apply(r,function(t){if(Array.isArray(t))return o(t)}(n=a.getGuides(t).features)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||i(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}}catch(t){s.e(t)}finally{s.f()}return{type:"FeatureCollection",features:r}}}])&&s(n.prototype,r),f}(n(2254).GeoJsonEditMode);e.CompositeMode=A},1400:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Draw90DegreePolygonMode=void 0;var r=c(n(3737)),i=c(n(1208)),o=c(n(3663)),s=c(n(1013)),a=n(4102),u=n(875);function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||A(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e,n){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function y(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(f,t);var e,n,c,l=(e=f,function(){var t,n=_(e);if(m()){var r=_(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return y(this,t)});function f(){return p(this,f),l.apply(this,arguments)}return n=f,(c=[{key:"createTentativeFeature",value:function(t){var e,n,r,i=this.getClickSequence(),o=t.lastPointerMoveEvent.mapCoords;if(1===i.length)e=o;else{var s=i[i.length-2],a=i[i.length-1];e=(n=(0,u.generatePointsParallelToLinePoints)(s,a,o),r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(n,r)||A(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0]}return i.length<3?{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(h(i),[e])}}:{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(h(i),[e,i[0]])]}}}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]};if(0===this.getClickSequence().length||!t.lastPointerMoveEvent)return e;var n=this.createTentativeFeature(t);return e.features.push(n),e.features=e.features.concat((0,u.getEditHandlesForGeometry)(n.geometry,-1)),e.features=e.features.slice(0,-1),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),g(_(f.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"handleClick",value:function(t,e){var n=t.picks,r=this.getTentativeGuide(e);this.addClickSequence(t);var i=this.getClickSequence();if(r){if(3===i.length&&"LineString"===r.geometry.type){var o=r.geometry;i[i.length-1]=o.coordinates[o.coordinates.length-1]}else if(i.length>3&&"Polygon"===r.geometry.type){var s=r.geometry;i[i.length-1]=s.coordinates[0][s.coordinates[0].length-2];var a=(0,u.getPickedEditHandle)(n);if(a&&Array.isArray(a.properties.positionIndexes)&&(0===a.properties.positionIndexes[1]||a.properties.positionIndexes[1]===s.coordinates[0].length-3)){var c={type:"Polygon",coordinates:this.finalizedCoordinates(h(s.coordinates[0]))};this.resetClickSequence();var l=this.getAddFeatureOrBooleanPolygonAction(c,e);l&&e.onEdit(l)}}var A={screenCoords:[-1,-1],mapCoords:t.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:function(){},sourceEvent:null};this.handlePointerMove(A,e)}}},{key:"finalizedCoordinates",value:function(t){var e=[[].concat(h(t.slice(0,-2)),[t[0]])],n=this.getIntermediatePoint(h(t));if(n)e=[[].concat(h(t.slice(0,-2)),[n,t[0]])];else{var r=h(t);r.splice(-3,1),(n=this.getIntermediatePoint(h(r)))&&(e=[[].concat(h(t.slice(0,-3)),[n,t[0]])])}return e}},{key:"getIntermediatePoint",value:function(t){var e;if(t.length>4){var n=h(t),u=n[0],c=n[1],l=(0,i.default)(u,c),A=t[t.length-3],f=t[t.length-4],p=(0,i.default)(A,f),d={first:[],second:[]};[1,2,3].forEach((function(t){var e=l+90*t;d.first.push(e>180?e-360:e);var n=p+90*t;d.second.push(n>180?n-360:n)}));var g=(0,s.default)((0,a.point)(u),(0,a.point)(A));[0,1,2].forEach((function(t){var n=(0,a.lineString)([u,(0,r.default)(u,g,d.first[t]).geometry.coordinates]);[0,1,2].forEach((function(t){var i=(0,a.lineString)([A,(0,r.default)(A,g,d.second[t]).geometry.coordinates]),s=(0,o.default)(n,i);s&&s.features.length&&(e=s.features[0].geometry.coordinates)}))}))}return e}}])&&d(n.prototype,c),f}(n(2254).GeoJsonEditMode);e.Draw90DegreePolygonMode=b},5790:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleByDiameterMode=void 0;var r=s(n(265)),i=s(n(1013)),o=n(2254);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,s,a=(e=p,function(){var t,n=A(e);if(h()){var r=A(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function p(){return u(this,p),a.apply(this,arguments)}return n=p,(s=[{key:"getTwoClickPolygon",value:function(t,e,n){var s=(n||{}).steps,a=void 0===s?64:s,u={steps:a};a<4&&(console.warn("Minimum steps to draw a circle is 4 "),u.steps=4);var c=(0,o.getIntermediatePosition)(t,e),l=Math.max((0,i.default)(t,c),.001),h=(0,r.default)(c,l,u);return h.properties=h.properties||{},h.properties.shape="Circle",h}}])&&c(n.prototype,s),p}(n(3124).TwoClickPolygonMode);e.DrawCircleByDiameterMode=p},6950:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawCircleFromCenterMode=void 0;var r=o(n(265)),i=o(n(1013));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(f,t);var e,n,o,s=(e=f,function(){var t,n=h(e);if(l()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function f(){return a(this,f),s.apply(this,arguments)}return n=f,(o=[{key:"getTwoClickPolygon",value:function(t,e,n){var o=(n||{}).steps,s=void 0===o?64:o,a={steps:s};s<4&&(console.warn("Minimum steps to draw a circle is 4 "),a.steps=4);var u=Math.max((0,i.default)(t,e),.001),c=(0,r.default)(t,u,a);return c.properties=c.properties||{},c.properties.shape="Circle",c}}])&&u(n.prototype,o),f}(n(3124).TwoClickPolygonMode);e.DrawCircleFromCenterMode=f},3199:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseByBoundingBoxMode=void 0;var r=u(n(3652)),i=u(n(1013)),o=u(n(1211)),s=n(4102),a=n(2254);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,n,u,c=(e=g,function(){var t,n=p(e);if(f()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function g(){return l(this,g),c.apply(this,arguments)}return n=g,(u=[{key:"getTwoClickPolygon",value:function(t,e,n){var u=Math.min(t[0],e[0]),c=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),A=(0,r.default)([u,c,l,h]).geometry.coordinates[0],f=(0,a.getIntermediatePosition)(t,e),p=Math.max((0,i.default)((0,s.point)(A[0]),(0,s.point)(A[1])),.001),d=Math.max((0,i.default)((0,s.point)(A[0]),(0,s.point)(A[3])),.001);return(0,o.default)(f,p,d)}}])&&h(n.prototype,u),g}(n(3124).TwoClickPolygonMode);e.DrawEllipseByBoundingBoxMode=g},5184:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawEllipseUsingThreePointsMode=void 0;var r=u(n(1013)),i=u(n(1211)),o=u(n(1208)),s=n(4102),a=n(2254);function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(g,t);var e,n,u,c=(e=g,function(){var t,n=p(e);if(f()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function g(){return l(this,g),c.apply(this,arguments)}return n=g,(u=[{key:"getThreeClickPolygon",value:function(t,e,n,u){var c=(0,a.getIntermediatePosition)(t,e),l=Math.max((0,r.default)(c,(0,s.point)(n)),.001),h=Math.max((0,r.default)(t,e),.001)/2,A={angle:(0,o.default)(t,e)};return(0,i.default)(c,l,h,A)}}])&&h(n.prototype,u),g}(n(1658).ThreeClickPolygonMode);e.DrawEllipseUsingThreePointsMode=g},2116:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawLineStringMode=void 0;var r=n(875);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e){return(A=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A(t,e)}(f,t);var e,n,i,s=(e=f,function(){var t,n=h(e);if(l()){var r=h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return c(this,t)});function f(){return a(this,f),s.apply(this,arguments)}return n=f,(i=[{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>1&&i&&Array.isArray(i.properties.positionIndexes)&&i.properties.positionIndexes[0]===a.length-1){var u={type:"LineString",coordinates:o(a)};this.resetClickSequence();var c=this.getAddFeatureAction(u,e.data);c&&e.onEdit(c)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>1){var r={type:"LineString",coordinates:o(n)};this.resetClickSequence();var i=this.getAddFeatureAction(r,e.data);i&&e.onEdit(i)}}}},{key:"getGuides",value:function(t){var e,n,r=t.lastPointerMoveEvent,i=this.getClickSequence(),s=r?[r.mapCoords]:[],a={type:"FeatureCollection",features:[]};i.length>0&&(n={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(i),s)}}),n&&a.features.push(n);var u=i.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=a.features).push.apply(e,o(u)),a}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&u(n.prototype,i),f}(n(2254).GeoJsonEditMode);e.DrawLineStringMode=f},5521:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(A,t);var e,n,r,h=(e=A,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function A(){return i(this,A),h.apply(this,arguments)}return n=A,(r=[{key:"createTentativeFeature",value:function(t){var e=t.lastPointerMoveEvent;return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:(e?[e.mapCoords]:[])[0]}}}},{key:"handleClick",value:function(t,e){var n={type:"Point",coordinates:t.mapCoords};e.onEdit(this.getAddFeatureAction(n,e.data))}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(c(A.prototype),"handlePointerMove",this).call(this,t,e)}}])&&o(n.prototype,r),A}(n(2254).GeoJsonEditMode);e.DrawPointMode=h},3039:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonByDraggingMode=void 0;var r,i=(r=n(3096))&&r.__esModule?r:{default:r},o=n(875);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(g,t);var e,n,r,s=(e=g,function(){var t,n=f(e);if(A()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function g(){var t;u(this,g);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return d(h(t=s.call.apply(s,[this].concat(n))),"handleDraggingThrottled",null),t}return n=g,(r=[{key:"handleClick",value:function(t,e){}},{key:"handleStartDragging",value:function(t,e){t.cancelPan(),e.modeConfig&&e.modeConfig.throttleMs?this.handleDraggingThrottled=(0,i.default)(this.handleDraggingAux,e.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}},{key:"handleStopDragging",value:function(t,e){this.addClickSequence(t);var n,r=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),r.length>2){var i={type:"Polygon",coordinates:[[].concat((n=r,function(t){if(Array.isArray(t))return a(t)}(n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[r[0]])]};this.resetClickSequence();var o=this.getAddFeatureOrBooleanPolygonAction(i,e);o&&e.onEdit(o)}}},{key:"handleDraggingAux",value:function(t,e){var n=t.picks;(0,o.getPickedEditHandle)(n)||this.addClickSequence(t)}},{key:"handleDragging",value:function(t,e){this.handleDraggingThrottled&&this.handleDraggingThrottled(t,e)}}])&&c(n.prototype,r),g}(n(5282).DrawPolygonMode);e.DrawPolygonByDraggingMode=g},5282:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPolygonMode=void 0;var r=n(875);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(p,t);var e,n,i,s=(e=p,function(){var t,n=A(e);if(h()){var r=A(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function p(){return a(this,p),s.apply(this,arguments)}return n=p,(i=[{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length||2===r.length?e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(o(r),i)}}:r.length>2&&(e={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(o(r),i,[r[0]])]}}),e}},{key:"getGuides",value:function(t){var e,n=this.getClickSequence(),r={type:"FeatureCollection",features:[]},i=this.createTentativeFeature(t);i&&r.features.push(i);var s=n.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=r.features).push.apply(e,o(s)),r}},{key:"handleClick",value:function(t,e){var n=t.picks,i=(0,r.getPickedEditHandle)(n),s=!1;i||(this.addClickSequence(t),s=!0);var a=this.getClickSequence();if(a.length>2&&i&&Array.isArray(i.properties.positionIndexes)&&(0===i.properties.positionIndexes[0]||i.properties.positionIndexes[0]===a.length-1)){var u={type:"Polygon",coordinates:[[].concat(o(a),[a[0]])]};this.resetClickSequence();var c=this.getAddFeatureOrBooleanPolygonAction(u,e);c&&e.onEdit(c)}else s&&e.onEdit({updatedData:e.data,editType:"addTentativePosition",editContext:{position:t.mapCoords}})}},{key:"handleKeyUp",value:function(t,e){if("Enter"===t.key){var n=this.getClickSequence();if(n.length>2){var r={type:"Polygon",coordinates:[[].concat(o(n),[n[0]])]};this.resetClickSequence();var i=this.getAddFeatureOrBooleanPolygonAction(r,e);i&&e.onEdit(i)}}}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),c(A(p.prototype),"handlePointerMove",this).call(this,t,e)}}])&&u(n.prototype,i),p}(n(2254).GeoJsonEditMode);e.DrawPolygonMode=p},8725:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleMode=void 0;var r,i=(r=n(3652))&&r.__esModule?r:{default:r};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(A,t);var e,n,r,o=(e=A,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function A(){return s(this,A),o.apply(this,arguments)}return n=A,(r=[{key:"getTwoClickPolygon",value:function(t,e,n){var r=(0,i.default)([t[0],t[1],e[0],e[1]]);return r.properties=r.properties||{},r.properties.shape="Rectangle",r}}])&&a(n.prototype,r),A}(n(3124).TwoClickPolygonMode);e.DrawRectangleMode=A},9050:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawRectangleUsingThreePointsMode=void 0;var r=n(875);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(f,t);var e,n,i,A=(e=f,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function f(){return s(this,f),A.apply(this,arguments)}return n=f,(i=[{key:"getThreeClickPolygon",value:function(t,e,n,i){var s,a,u=(s=(0,r.generatePointsParallelToLinePoints)(t,e,n),a=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(s,a)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(s,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[t,e,u[0],u[1],t]]}}}}])&&a(n.prototype,i),f}(n(1658).ThreeClickPolygonMode);e.DrawRectangleUsingThreePointsMode=A},3704:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawSquareFromCenterMode=void 0;var r=a(n(3652)),i=a(n(1013)),o=a(n(5913)),s=n(4102);function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(d,t);var e,n,a,u=(e=d,function(){var t,n=f(e);if(A()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function d(){return c(this,d),u.apply(this,arguments)}return n=d,(a=[{key:"getTwoClickPolygon",value:function(t,e,n){var a=[e[0],t[1]],u=[t[0],e[1]],c=(0,i.default)((0,s.point)(a),(0,s.point)(t)),l=(0,i.default)((0,s.point)(u),(0,s.point)(t)),h=c<=l?c:l,A=c<=l?a:u,f=(0,s.lineString)([A,e]),p=(0,o.default)(f,h).geometry.coordinates,d=t[0]>p[0]?t[0]+Math.abs(t[0]-p[0]):t[0]-Math.abs(t[0]-p[0]),g=t[1]>p[1]?t[1]+Math.abs(t[1]-p[1]):t[1]-Math.abs(t[1]-p[1]),y=(0,r.default)([d,g,p[0],p[1]]);return y.properties=y.properties||{},y.properties.shape="Square",y}}])&&l(n.prototype,a),d}(n(3124).TwoClickPolygonMode);e.DrawSquareFromCenterMode=d},2511:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DuplicateMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(A,t);var e,n,r,h=(e=A,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function A(){return i(this,A),h.apply(this,arguments)}return n=A,(r=[{key:"handleStartDragging",value:function(t,e){s(c(A.prototype),"handleStartDragging",this).call(this,t,e),this._geometryBeforeTranslate&&e.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,e.data))}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("copy"):t.onUpdateCursor(null)}}])&&o(n.prototype,r),A}(n(6166).TranslateMode);e.DuplicateMode=h},1370:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ElevationMode=void 0;var r=n(875);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t){var e=t.pointerDownScreenCoords,n=t.screenCoords;return 10*(e[1]-n[1])}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(d,t);var e,n,i,f,p=(e=d,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function d(){return o(this,d),p.apply(this,arguments)}return n=d,f=[{key:"calculateElevationChangeWithViewport",value:function(t,e){var n=e.pointerDownScreenCoords,r=e.screenCoords;return 156543.03392*Math.cos(t.latitude*Math.PI/180)/Math.pow(2,t.zoom)*(n[1]-r[1])/2}}],(i=[{key:"makeElevatedEvent",value:function(t,e,n){var r=n.modeConfig||{},i=r.minElevation,o=void 0===i?0:i,s=r.maxElevation,a=void 0===s?2e4:s,u=r.calculateElevationChange,c=void 0===u?A:u;if(!t.pointerDownScreenCoords)return t;var l=3===e.length?e[2]:0;return l+=c({pointerDownScreenCoords:t.pointerDownScreenCoords,screenCoords:t.screenCoords}),l=Math.min(l,a),l=Math.max(l,o),Object.assign({},t,{mapCoords:[e[0],e[1],l]})}},{key:"handlePointerMove",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.pointerDownPicks),i=n?n.geometry.coordinates:t.mapCoords;a(l(d.prototype),"handlePointerMove",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"handleStopDragging",value:function(t,e){var n=(0,r.getPickedEditHandle)(t.picks),i=n?n.geometry.coordinates:t.mapCoords;a(l(d.prototype),"handleStopDragging",this).call(this,this.makeElevatedEvent(t,i,e),e)}},{key:"getCursor",value:function(t){var e=a(l(d.prototype),"getCursor",this).call(this,t);return"cell"===e&&(e="ns-resize"),e}}])&&s(n.prototype,i),f&&s(n,f),d}(n(7366).ModifyMode);e.ElevationMode=f},4546:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendLineStringMode=void 0;var r=n(2254),i=n(6302);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(A,t);var e,n,r,o=(e=A,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function A(){return s(this,A),o.apply(this,arguments)}return n=A,(r=[{key:"getSingleSelectedLineString",value:function(t){var e=this.getSelectedGeometry(t);return e&&"LineString"===e.type?e:null}},{key:"handleClick",value:function(t,e){var n=e.selectedIndexes,r=this.getSingleSelectedLineString(e);if(r){var o=[r.coordinates.length],s=e.modeConfig;s&&s.drawAtFront&&(o=[0]);var a=n[0],u=new i.ImmutableFeatureCollection(e.data).addPosition(a,o,t.mapCoords).getObject();e.onEdit({updatedData:u,editType:"addPosition",editContext:{featureIndexes:[a],positionIndexes:o,position:t.mapCoords}})}else console.warn("ExtendLineStringMode only supported for single LineString selection")}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=this.getSingleSelectedLineString(t);if(!n)return e;var r,i=t.lastPointerMoveEvent&&t.lastPointerMoveEvent.mapCoords,o=t.modeConfig;return r=o&&o.drawAtFront?n.coordinates[0]:n.coordinates[n.coordinates.length-1],e.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r,i]}}),e}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}}])&&a(n.prototype,r),A}(r.GeoJsonEditMode);e.ExtendLineStringMode=A},6601:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ExtrudeMode=void 0;var r,i=(r=n(1208))&&r.__esModule?r:{default:r},o=n(875),s=n(7366),a=n(6302);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(u,t);var e,n,r,s=(e=u,function(){var t,n=m(e);if(y()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return d(this,t)});function u(){var t;f(this,u);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return v(g(t=s.call.apply(s,[this].concat(n))),"isPointAdded",!1),t}return n=u,(r=[{key:"handleDragging",value:function(t,e){var n=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n){var r=n.properties.featureIndex,i=n.properties.positionIndexes,s=this.coordinatesSize(i,r,e.data);i=this.isPointAdded?this.nextPositionIndexes(i,s):i;var u=this.getPointForPositionIndexes(this.prevPositionIndexes(i,s),r,e.data),c=this.getPointForPositionIndexes(i,r,e.data);if(u&&c){var h=l((0,o.generatePointsParallelToLinePoints)(u,c,t.mapCoords),2),A=h[0],f=h[1],p=new a.ImmutableFeatureCollection(e.data).replacePosition(r,this.prevPositionIndexes(i,s),f).replacePosition(r,i,A).getObject();e.onEdit({updatedData:p,editType:"extruding",editContext:{featureIndexes:[r],positionIndexes:this.nextPositionIndexes(i,s),position:A}}),t.cancelPan()}}}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var i=r.properties,s=i.positionIndexes,u=i.featureIndex,c=this.coordinatesSize(s,u,e.data),l=this.getPointForPositionIndexes(this.prevPositionIndexes(s,c),u,e.data),h=this.getPointForPositionIndexes(s,u,e.data);if(l&&h){var A=new a.ImmutableFeatureCollection(e.data);this.isOrthogonal(s,u,c,e.data)||(A=A.addPosition(u,s,h)),this.isOrthogonal(this.prevPositionIndexes(s,c),u,c,e.data)||(A=A.addPosition(u,s,l),this.isPointAdded=!0),e.onEdit({updatedData:A.getObject(),editType:"startExtruding",editContext:{featureIndexes:[u],positionIndexes:s,position:l}})}}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,o.getPickedEditHandle)(t.pointerDownPicks);if(n.length&&r){var i=r.properties.featureIndex,s=r.properties.positionIndexes,u=this.coordinatesSize(s,i,e.data);s=this.isPointAdded?this.nextPositionIndexes(s,u):s;var c=this.getPointForPositionIndexes(this.prevPositionIndexes(s,u),i,e.data),h=this.getPointForPositionIndexes(s,i,e.data);if(c&&h){var A=l((0,o.generatePointsParallelToLinePoints)(c,h,t.mapCoords),2),f=A[0],p=A[1],d=new a.ImmutableFeatureCollection(e.data).replacePosition(i,this.prevPositionIndexes(s,u),p).replacePosition(i,s,f).getObject();e.onEdit({updatedData:d,editType:"extruded",editContext:{featureIndexes:[i],positionIndexes:s,position:f}})}}this.isPointAdded=!1}},{key:"coordinatesSize",value:function(t,e,n){var r=n.features,i=0;if(Array.isArray(t)){var o=r[e].geometry.coordinates;if(3===t.length){var s=l(t,2),a=s[0],u=s[1];o.length&&o[a].length&&(i=o[a][u].length)}else{var c=l(t,1)[0];o.length&&o[c].length&&(i=o[c].length)}}return i}},{key:"getBearing",value:function(t,e){var n=(0,i.default)(t,e);return n<0?Math.floor(360+n):Math.floor(n)}},{key:"isOrthogonal",value:function(t,e,n,r){if(!Array.isArray(t))return!1;t[t.length-1]===n-1&&(t[t.length-1]=0);var i=this.getPointForPositionIndexes(this.prevPositionIndexes(t,n),e,r),o=this.getPointForPositionIndexes(this.nextPositionIndexes(t,n),e,r),s=this.getPointForPositionIndexes(t,e,r),a=this.getBearing(s,i),u=this.getBearing(s,o);return[89,90,91,269,270,271].includes(Math.abs(a-u))}},{key:"nextPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=c(t);return n.length&&(n[n.length-1]=n[n.length-1]===e-1?0:n[n.length-1]+1),n}},{key:"prevPositionIndexes",value:function(t,e){if(!Array.isArray(t))return[];var n=c(t);return n.length&&(n[n.length-1]=0===n[n.length-1]?e-2:n[n.length-1]-1),n}},{key:"getPointForPositionIndexes",value:function(t,e,n){var r,i=n.features;if(Array.isArray(t)){var o=i[e].geometry.coordinates;if(3===t.length){var s=l(t,3),a=s[0],u=s[1],c=s[2];o.length&&o[a].length&&(r=o[a][u][c])}else{var h=l(t,2),A=h[0],f=h[1];o.length&&o[A].length&&(r=o[A][f])}}return r}}])&&p(n.prototype,r),u}(s.ModifyMode);e.ExtrudeMode=b},2254:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIntermediatePosition=function(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]},e.GeoJsonEditMode=void 0;var r=c(n(1959)),i=c(n(8727)),o=c(n(4170)),s=c(n(1138)),a=n(875),u=n(6302);function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||h(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){if(t){if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(t,e):void 0}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var p={type:"FeatureCollection",features:[]},d=[],g=function(){function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=[],(e="_clickSequence")in this?Object.defineProperty(this,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[e]=n}var e,n;return e=t,(n=[{key:"getGuides",value:function(t){return p}},{key:"getTooltips",value:function(t){return d}},{key:"getSelectedFeature",value:function(t){return 1===t.selectedIndexes.length?t.data.features[t.selectedIndexes[0]]:null}},{key:"getSelectedGeometry",value:function(t){var e=this.getSelectedFeature(t);return e?e.geometry:null}},{key:"getSelectedFeaturesAsFeatureCollection",value:function(t){var e=t.data.features;return{type:"FeatureCollection",features:t.selectedIndexes.map((function(t){return e[t]}))}}},{key:"getClickSequence",value:function(){return this._clickSequence}},{key:"addClickSequence",value:function(t){var e=t.mapCoords;this._clickSequence.push(e)}},{key:"resetClickSequence",value:function(){this._clickSequence=[]}},{key:"getTentativeGuide",value:function(t){return this.getGuides(t).features.find((function(t){return t.properties&&"tentative"===t.properties.guideType}))}},{key:"isSelectionPicked",value:function(t,e){if(!t.length)return!1;var n=(0,a.getNonGuidePicks)(t).map((function(t){return t.index})),r=(0,a.getPickedEditHandles)(t).map((function(t){return t.properties.featureIndex})),i=new Set([].concat(l(n),l(r)));return e.selectedIndexes.some((function(t){return i.has(t)}))}},{key:"rewindPolygon",value:function(t){var e=t.geometry;return"Polygon"===e.type||"MultiPolygon"===e.type?(0,s.default)(t):t}},{key:"getAddFeatureAction",value:function(t,e){var n=t,r="Feature"===n.type?n:{type:"Feature",properties:{},geometry:n},i=this.rewindPolygon(r),o=new u.ImmutableFeatureCollection(e).addFeature(i).getObject();return{updatedData:o,editType:"addFeature",editContext:{featureIndexes:[o.features.length-1]}}}},{key:"getAddManyFeaturesAction",value:function(t,e){var n,r=t.features,i=new u.ImmutableFeatureCollection(e),o=i.getObject().features.length,s=[],a=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=h(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(r);try{for(a.s();!(n=a.n()).done;){var c=n.value,l=c.properties,A=c.geometry;i=i.addFeature({type:"Feature",properties:l,geometry:A}),s.push(o+s.length)}}catch(t){a.e(t)}finally{a.f()}return{updatedData:i.getObject(),editType:"addFeature",editContext:{featureIndexes:s}}}},{key:"getAddFeatureOrBooleanPolygonAction",value:function(t,e){var n=t,s=this.getSelectedFeature(e),a=e.modeConfig;if(a&&a.booleanOperation){if(!s||"Polygon"!==s.geometry.type&&"MultiPolygon"!==s.geometry.type)return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;var c,l="Feature"===n.type?n:{type:"Feature",geometry:n};if("union"===a.booleanOperation)c=(0,r.default)(s,l);else if("difference"===a.booleanOperation)c=(0,i.default)(s,l);else{if("intersection"!==a.booleanOperation)return console.warn("Invalid booleanOperation ".concat(a.booleanOperation)),null;c=(0,o.default)(s,l)}if(!c)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;var h=e.selectedIndexes[0];return{updatedData:new u.ImmutableFeatureCollection(e.data).replaceGeometry(h,c.geometry).getObject(),editType:"unionGeometry",editContext:{featureIndexes:[h]}}}return this.getAddFeatureAction(t,e.data)}},{key:"createTentativeFeature",value:function(t){return null}},{key:"handleClick",value:function(t,e){}},{key:"handlePointerMove",value:function(t,e){var n=this.createTentativeFeature(e);n&&e.onEdit({updatedData:e.data,editType:"updateTentativeFeature",editContext:{feature:n}})}},{key:"handleStartDragging",value:function(t,e){}},{key:"handleStopDragging",value:function(t,e){}},{key:"handleDragging",value:function(t,e){}},{key:"handleKeyUp",value:function(t,e){"Escape"===t.key&&(this.resetClickSequence(),e.onEdit({updatedData:e.data,editType:"cancelFeature",editContext:{}}))}}])&&f(e.prototype,n),t}();e.GeoJsonEditMode=g},6302:(t,e)=>{"use strict";function n(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(e,"__esModule",{value:!0}),e.ImmutableFeatureCollection=void 0;var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"featureCollection",void 0),this.featureCollection=e}var e,r;return e=t,(r=[{key:"getObject",value:function(){return this.featureCollection}},{key:"replacePosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry,i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:l(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"removePosition",value:function(t,e){var n=this.featureCollection.features[t].geometry;if("Point"===n.type)throw Error("Can't remove a position from a Point or there'd be nothing left");if("MultiPoint"===n.type&&n.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if("LineString"===n.type&&n.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if("Polygon"===n.type&&n.coordinates[0].length<5&&Array.isArray(e)&&0===e[0])throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if("MultiLineString"===n.type&&1===n.coordinates.length&&n.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if("MultiPolygon"===n.type&&1===n.coordinates.length&&n.coordinates[0][0].length<5&&Array.isArray(e)&&0===e[0]&&0===e[1])throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");var r="Polygon"===n.type||"MultiPolygon"===n.type,i=o({},n,{coordinates:h(n.coordinates,e,r)});return function(t){switch(t.type){case"Polygon":!function(t){for(var e=t.coordinates,n=1;n<e.length;n++)f(e,n)&&n--}(t);break;case"MultiLineString":!function(t){for(var e=0;e<t.coordinates.length;e++)1===t.coordinates[e].length&&(t.coordinates.splice(e,1),e--)}(t);break;case"MultiPolygon":!function(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e];n[0].length<=3&&(t.coordinates.splice(e,1),e--);for(var r=1;r<n.length;r++)f(n,r)&&r--}}(t)}}(i),this.replaceGeometry(t,i)}},{key:"addPosition",value:function(t,e,n){var r=this.featureCollection.features[t].geometry;if("Point"===r.type)throw new Error("Unable to add a position to a Point feature");var i="Polygon"===r.type||"MultiPolygon"===r.type,s=o({},r,{coordinates:A(r.coordinates,e,n,i)});return this.replaceGeometry(t,s)}},{key:"replaceGeometry",value:function(e,r){var i=o({},this.featureCollection.features[e],{geometry:r});return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features.slice(0,e)),[i],n(this.featureCollection.features.slice(e+1)))}))}},{key:"addFeature",value:function(t){return this.addFeatures([t])}},{key:"addFeatures",value:function(e){return new t(o({},this.featureCollection,{features:[].concat(n(this.featureCollection.features),n(e))}))}},{key:"deleteFeature",value:function(t){return this.deleteFeatures([t])}},{key:"deleteFeatures",value:function(e){var r=n(this.featureCollection.features);e.sort();for(var i=e.length-1;i>=0;i--){var s=e[i];s>=0&&s<r.length&&r.splice(s,1)}return new t(o({},this.featureCollection,{features:r}))}}])&&s(e.prototype,r),t}();function c(t,e){if(2===t.length&&3===e.length){var n=e[2];return[t[0],t[1],n]}return t}function l(t,e,r,i){if(!e)return t;if(0===e.length)return c(r,t);if(1===e.length){var o=[].concat(n(t.slice(0,e[0])),[c(r,t[e[0]])],n(t.slice(e[0]+1)));return!i||0!==e[0]&&e[0]!==t.length-1||(o[0]=c(r,t[0]),o[t.length-1]=c(r,t[0])),o}return[].concat(n(t.slice(0,e[0])),[l(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function h(t,e,r){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");if(1===e.length){var i=[].concat(n(t.slice(0,e[0])),n(t.slice(e[0]+1)));return!r||0!==e[0]&&e[0]!==t.length-1||(0===e[0]?i[i.length-1]=i[0]:e[0]===t.length-1&&(i[0]=i[i.length-1])),i}return[].concat(n(t.slice(0,e[0])),[h(t[e[0]],e.slice(1,e.length),r)],n(t.slice(e[0]+1)))}function A(t,e,r,i){if(!e)return t;if(0===e.length)throw Error("Must specify the index of the position to remove");return 1===e.length?[].concat(n(t.slice(0,e[0])),[r],n(t.slice(e[0]))):[].concat(n(t.slice(0,e[0])),[A(t[e[0]],e.slice(1,e.length),r,i)],n(t.slice(e[0]+1)))}function f(t,e){return t[e].length<=3&&(t.splice(e,1),!0)}e.ImmutableFeatureCollection=u},9857:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAngleMode=void 0;var r=a(n(1208)),i=a(n(8230)),o=a(n(3916)),s=n(2254);function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?f(t):e}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=[],_=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(u,t);var e,n,s,a=(e=u,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function u(){var t;l(this,u);for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return y(f(t=a.call.apply(a,[this].concat(n))),"_getTooltips",(0,o.default)((function(t){var e=t.modeConfig,n=t.vertex,o=t.point1,s=t.point2,a=m;if(n&&o&&s){var u,c=e||{},l=c.formatTooltip,h=c.measurementCallback,A=(0,r.default)(n,o),f=(0,r.default)(n,s),p=Math.abs(A-f);p>180&&(p=360-p),u=l?l(p):"".concat(parseFloat(p).toFixed(2)," ").concat("deg"),h&&h(p),a=[{position:(0,i.default)({type:"FeatureCollection",features:[o,s].map((function(t){return{type:"Feature",geometry:{type:"Point",coordinates:t}}}))}).geometry.coordinates,text:u}]}return a}))),t}return n=u,(s=[{key:"handleClick",value:function(t,e){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(t)}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getPoints",value:function(t){var e,n=this.getClickSequence(),r=function(t){if(Array.isArray(t))return c(t)}(e=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return n.length<3&&t.lastPointerMoveEvent&&r.push(t.lastPointerMoveEvent.mapCoords),r}},{key:"getGuides",value:function(t){var e={type:"FeatureCollection",features:[]},n=e.features,r=this.getPoints(t);return r.length>2?n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0],r[2]]}}):r.length>1&&n.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[1],r[0]]}}),e}},{key:"getTooltips",value:function(t){var e=this.getPoints(t);return this._getTooltips({modeConfig:t.modeConfig,vertex:e[0],point1:e[1],point2:e[2]})}}])&&h(n.prototype,s),u}(s.GeoJsonEditMode);e.MeasureAngleMode=_},244:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureAreaMode=void 0;var r=s(n(1070)),i=s(n(6338)),o=n(5282);function s(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A(t,e,n){return(A="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=[],m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(a,t);var e,n,o,s=(e=a,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function a(){return l(this,a),s.apply(this,arguments)}return n=a,(o=[{key:"handleClick",value:function(t,e){var n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onEdit:function(){}});A(d(a.prototype),"handleClick",this).call(this,t,n)}},{key:"getTooltips",value:function(t){var e=this.getTentativeGuide(t);if(e&&"Polygon"===e.geometry.type){var n,o=t.modeConfig||{},s=o.formatTooltip,a=o.measurementCallback,u=(0,i.default)(e),c=(0,r.default)(e);return n=s?s(c):"".concat(parseFloat(c).toFixed(2)," ").concat("sq. m"),a&&a(c),[{position:u.geometry.coordinates,text:n}]}return y}}])&&h(n.prototype,o),a}(o.DrawPolygonMode);e.MeasureAreaMode=m},63:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MeasureDistanceMode=void 0;var r,i=(r=n(1013))&&r.__esModule?r:{default:r},o=n(875);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?A(t):e}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(u,t);var e,n,r,s=(e=u,function(){var t,n=p(e);if(f()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function u(){var t;c(this,u);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(A(t=s.call.apply(s,[this].concat(n))),"_isMeasuringSessionFinished",!1),g(A(t),"_currentTooltips",[]),g(A(t),"_currentDistance",0),g(A(t),"_calculateDistanceForTooltip",(function(t){var e=t.positionA,n=t.positionB,r=t.modeConfig||{},o=r.turfOptions,s=r.measurementCallback,a=(0,i.default)(e,n,o);return s&&s(a),a})),t}return n=u,(r=[{key:"_formatTooltip",value:function(t,e){var n=e||{},r=n.formatTooltip,i=n.turfOptions,o=i&&i.units||"kilometers";return r?r(t):"".concat(parseFloat(t).toFixed(2)," ").concat(o)}},{key:"handleClick",value:function(t,e){var n=e.modeConfig,r=e.data,i=e.onEdit;this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);var s=t.picks,a=(0,o.getPickedEditHandle)(s),u=!1;a||(this.addClickSequence(t),u=!0);var c=this.getClickSequence();c.length>1&&a&&Array.isArray(a.properties.positionIndexes)&&a.properties.positionIndexes[0]===c.length-1?this._isMeasuringSessionFinished=!0:u&&(c.length>1&&(this._currentDistance+=this._calculateDistanceForTooltip({positionA:c[c.length-2],positionB:c[c.length-1],modeConfig:n}),this._currentTooltips.push({position:t.mapCoords,text:this._formatTooltip(this._currentDistance,n)})),i({updatedData:r,editType:"addTentativePosition",editContext:{position:t.mapCoords}}))}},{key:"handleKeyUp",value:function(t,e){if(!this._isMeasuringSessionFinished){t.stopPropagation();var n=t.key,r=this.getClickSequence().length;switch(n){case"Escape":this._isMeasuringSessionFinished=!0,1===r&&(this.resetClickSequence(),this._currentTooltips=[]),e.onUpdateCursor("cell");break;case"Enter":this.handleClick(e.lastPointerMoveEvent,e),this._isMeasuringSessionFinished=!0}}}},{key:"getGuides",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n&&!this._isMeasuringSessionFinished?[n.mapCoords]:[],o={type:"FeatureCollection",features:[]};r.length>0&&o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(a(r),i)}});var s=r.map((function(t,e){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[e]},geometry:{type:"Point",coordinates:t}}}));return(e=o.features).push.apply(e,a(s)),o}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"getTooltips",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence();if(r.length>0&&e&&!this._isMeasuringSessionFinished){var i=this._calculateDistanceForTooltip({positionA:r[r.length-1],positionB:e.mapCoords,modeConfig:t.modeConfig});return[].concat(a(this._currentTooltips),[{position:e.mapCoords,text:this._formatTooltip(this._currentDistance+i,n)}])}return this._currentTooltips}}])&&l(n.prototype,r),u}(n(2254).GeoJsonEditMode);e.MeasureDistanceMode=y},7366:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ModifyMode=void 0;var r=n(4102),i=n(875),o=n(2254),s=n(6302);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(l,t);var e,n,o,a=(e=l,function(){var t,n=d(e);if(p()){var r=d(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function l(){return h(this,l),a.apply(this,arguments)}return n=l,(o=[{key:"getGuides",value:function(t){var e,n=this,o=[],s=t.data,a=t.lastPointerMoveEvent,l=s.features,h=a&&a.picks,A=a&&a.mapCoords,f=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=c(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}(t.selectedIndexes);try{for(f.s();!(e=f.n()).done;){var p=e.value;if(p<l.length){var d=l[p].geometry;o.push.apply(o,u((0,i.getEditHandlesForGeometry)(d,p)))}else console.warn("selectedFeatureIndexes out of range ".concat(p))}}catch(t){f.e(t)}finally{f.f()}if(h&&h.length&&A){var g=!(0,i.getPickedExistingEditHandle)(h)&&h.find((function(t){return!t.isGuide}));if(g&&!g.object.geometry.type.includes("Point")&&t.selectedIndexes.includes(g.index)){var y=null,m=[],_=(0,r.point)(A);if((0,i.recursivelyTraverseNestedArrays)(g.object.geometry.coordinates,[],(function(e,i){var o=(0,r.lineString)(e),s=n.getNearestPoint(o,_,t.modeConfig&&t.modeConfig.viewport);(!y||s.properties.dist<y.properties.dist)&&(y=s,m=i)})),y){var v=y,b=v.geometry.coordinates,w=v.properties.index;o.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:g.index,positionIndexes:[].concat(u(m),[w+1])},geometry:{type:"Point",coordinates:b}})}}}return{type:"FeatureCollection",features:o}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,i.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,i.nearestPointOnLine)(t,e,n)}},{key:"handleClick",value:function(t,e){var n=(0,i.getPickedExistingEditHandle)(t.picks),r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n){var o,a=n.properties,u=a.featureIndex,c=a.positionIndexes;try{o=new s.ImmutableFeatureCollection(e.data).removePosition(u,c).getObject()}catch(t){}o&&e.onEdit({updatedData:o,editType:"removePosition",editContext:{featureIndexes:[u],positionIndexes:c,position:n.geometry.coordinates}})}else if(r){var l=r.properties,h=l.featureIndex,A=l.positionIndexes,f=new s.ImmutableFeatureCollection(e.data).addPosition(h,A,r.geometry.coordinates).getObject();f&&e.onEdit({updatedData:f,editType:"addPosition",editContext:{featureIndexes:[h],positionIndexes:A,position:r.geometry.coordinates}})}}},{key:"handleDragging",value:function(t,e){var n=(0,i.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,o=new s.ImmutableFeatureCollection(e.data).replacePosition(r.featureIndex,r.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:o,editType:"movePosition",editContext:{featureIndexes:[r.featureIndex],positionIndexes:r.positionIndexes,position:t.mapCoords}})}}},{key:"handlePointerMove",value:function(t,e){var n=this.getCursor(t);e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedIntermediateEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=new s.ImmutableFeatureCollection(e.data).addPosition(o.featureIndex,o.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:a,editType:"addPosition",editContext:{featureIndexes:[o.featureIndex],positionIndexes:o.positionIndexes,position:t.mapCoords}})}}},{key:"handleStopDragging",value:function(t,e){var n=e.selectedIndexes,r=(0,i.getPickedEditHandle)(t.picks);if(n.length&&r){var o=r.properties,a=new s.ImmutableFeatureCollection(e.data).replacePosition(o.featureIndex,o.positionIndexes,t.mapCoords).getObject();e.onEdit({updatedData:a,editType:"finishMovePosition",editContext:{featureIndexes:[o.featureIndex],positionIndexes:o.positionIndexes,position:t.mapCoords}})}}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,i.getPickedEditHandles)(e).length?"cell":null}}])&&A(n.prototype,o),l}(o.GeoJsonEditMode);e.ModifyMode=y},7339:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ResizeCircleMode=void 0;var r=h(n(3807)),i=n(4102),o=h(n(265)),s=h(n(1013)),a=h(n(8230)),u=n(875),c=n(2254),l=n(6302);function h(t){return t&&t.__esModule?t:{default:t}}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?y(t):e}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(A,t);var e,n,c,h=(e=A,function(){var t,n=_(e);if(m()){var r=_(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function A(){var t;p(this,A);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return b(y(t=h.call.apply(h,[this].concat(n))),"_selectedEditHandle",void 0),b(y(t),"_isResizing",!1),t}return n=A,(c=[{key:"getGuides",value:function(t){var e,n=this,r=[],o=t.selectedIndexes,s=t.lastPointerMoveEvent,a=s&&s.picks,c=s&&s.mapCoords;if(a&&a.length&&c&&1===o.length&&!this._isResizing){var l=a.find((function(t){return!t.isGuide}));if(l&&l.object.properties.shape&&l.object.properties.shape.includes("Circle")&&t.selectedIndexes.includes(l.index)){var h=null,A=[],p=(0,i.point)(c);if((0,u.recursivelyTraverseNestedArrays)(l.object.geometry.coordinates,[],(function(e,r){var o=(0,i.lineString)(e),s=n.getNearestPoint(o,p,t.modeConfig&&t.modeConfig.viewport);(!h||s.properties.dist<h.properties.dist)&&(h=s,A=r)})),h){var d=h,g=d.geometry.coordinates,y=d.properties.index;r.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:l.index,positionIndexes:[].concat((e=A,function(t){if(Array.isArray(t))return f(t)}(e)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[y+1])},geometry:{type:"Point",coordinates:g}})}}}return{type:"FeatureCollection",features:r}}},{key:"getNearestPoint",value:function(t,e,n){if(t.geometry.coordinates.some((function(t){return t.length>2}))){if(n)return(0,u.nearestPointOnProjectedLine)(t,e,n);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,r.default)(t,e)}},{key:"handleDragging",value:function(t,e){var n=(0,u.getPickedEditHandle)(t.pointerDownPicks);if(n){t.cancelPan();var r=n.properties,i=this.getSelectedFeature(e),c=(0,a.default)(i).geometry.coordinates,h=Object.entries(i.geometry.coordinates[0]).length-1,A=Math.max((0,s.default)(c,t.mapCoords),.001),f={}.steps,p={steps:void 0===f?h:f},d=(0,o.default)(c,A,p).geometry,g=new l.ImmutableFeatureCollection(e.data).replaceGeometry(r.featureIndex,d).getObject();e.onEdit({updatedData:g,editType:"unionGeometry",editContext:{featureIndexes:[r.featureIndex]}})}}},{key:"handlePointerMove",value:function(t,e){if(!this._isResizing){var n=(0,u.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"intermediate"===n.properties.editHandleType?n:null}var r=this.getCursor(t);e.onUpdateCursor(r)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isResizing=!0)}},{key:"handleStopDragging",value:function(t,e){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}},{key:"getCursor",value:function(t){var e=t&&t.picks||[];return(0,u.getPickedEditHandles)(e).length?"cell":null}}])&&d(n.prototype,c),A}(c.GeoJsonEditMode);e.ResizeCircleMode=w},83:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RotateMode=void 0;var r=g(n(9705)),i=g(n(6338)),o=g(n(1208)),s=g(n(3652)),a=g(n(1013)),u=n(1540),c=n(611),l=n(4102),h=g(n(67)),A=g(n(7383)),f=n(875),p=n(2254),d=n(6302);function g(t){return t&&t.__esModule?t:{default:t}}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(P,t);var e,n,g,y=(e=P,function(){var t,n=E(e);if(w()){var r=E(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return v(this,t)});function P(){var t;m(this,P);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return S(b(t=y.call.apply(y,[this].concat(n))),"_selectedEditHandle",void 0),S(b(t),"_geometryBeingRotated",void 0),S(b(t),"_isRotating",!1),S(b(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,c.getGeom)(e[0]).type})),S(b(t),"getIsRotating",(function(){return t._isRotating})),t}return n=P,(g=[{key:"getGuides",value:function(t){var e=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,l.featureCollection)([(0,i.default)(e)]);var n=(0,s.default)((0,r.default)(e)),o=null,c=null,h=0;(0,u.coordEach)(n,(function(t){if(o){var e=(0,p.getIntermediatePosition)(t,o);(!c||e[1]>c[1])&&(c=e);var n=(0,a.default)(t,o);h=Math.max(h,n)}o=t}));var f=c&&[c[0],c[1]+h/1e3],d=(0,l.lineString)([c,f]),g=(0,l.point)(f,{guideType:"editHandle",editHandleType:"rotate"});return(0,l.featureCollection)([(0,A.default)(n),g,d])}},{key:"handleDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotating",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){if(!this._isRotating){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"rotate"===n.properties.editHandleType?n:null}this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._isRotating){var n=this.getRotateAction(t.pointerDownMapCoords,t.mapCoords,"rotated",e);n&&e.onEdit(n),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}},{key:"updateCursor",value:function(t){this._selectedEditHandle?t.onUpdateCursor("crosshair"):t.onUpdateCursor(null)}},{key:"getRotateAction",value:function(t,e,n,r){if(!this._geometryBeingRotated)return null;for(var s=(0,i.default)(this._geometryBeingRotated),a=function(t,e,n){var r=(0,o.default)(t,e);return(0,o.default)(t,n)-r}(s,t,e),u=(0,h.default)(this._geometryBeingRotated,a,{pivot:s}),c=new d.ImmutableFeatureCollection(r.data),l=r.selectedIndexes,A=0;A<l.length;A++){var f=l[A],p=u.features[A];c=c.replaceGeometry(f,p.geometry)}return{updatedData:c.getObject(),editType:n,editContext:{featureIndexes:l}}}}])&&_(n.prototype,g),P}(p.GeoJsonEditMode);e.RotateMode=P},5892:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScaleMode=void 0;var r=g(n(9705)),i=g(n(6338)),o=g(n(1208)),s=g(n(3652)),a=n(4102),u=g(n(7383)),c=n(1540),l=g(n(1013)),h=g(n(7517)),A=n(611),f=n(875),p=n(2254),d=n(6302);function g(t){return t&&t.__esModule?t:{default:t}}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?w(t):e}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(g,t);var e,n,l,p=(e=g,function(){var t,n=x(e);if(E()){var r=x(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b(this,t)});function g(){var t;_(this,g);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return P(w(t=p.call.apply(p,[this].concat(n))),"_geometryBeingScaled",void 0),P(w(t),"_selectedEditHandle",void 0),P(w(t),"_cornerGuidePoints",void 0),P(w(t),"_cursor",void 0),P(w(t),"_isScaling",!1),P(w(t),"_isSinglePointGeometrySelected",(function(t){var e=(t||{}).features;return!(!Array.isArray(e)||1!==e.length)&&"Point"===(0,A.getGeom)(e[0]).type})),P(w(t),"_getOppositeScaleHandle",(function(e){var n=e&&e.properties&&Array.isArray(e.properties.positionIndexes)&&e.properties.positionIndexes[0];if("number"!=typeof n)return null;var r=t._cornerGuidePoints.length,i=(n+r/2)%r;return t._cornerGuidePoints.find((function(t){return!!Array.isArray(t.properties.positionIndexes)&&t.properties.positionIndexes[0]===i}))})),P(w(t),"_getUpdatedData",(function(t,e){for(var n=new d.ImmutableFeatureCollection(t.data),r=t.selectedIndexes,i=0;i<r.length;i++){var o=r[i],s=e.features[i];n=n.replaceGeometry(o,s.geometry)}return n.getObject()})),P(w(t),"isEditHandleSelected",(function(){return Boolean(t._selectedEditHandle)})),P(w(t),"getScaleAction",(function(e,n,r,i){if(!t._selectedEditHandle)return null;var o=t._getOppositeScaleHandle(t._selectedEditHandle),s=(0,A.getCoord)(o),a=C(s,e,n),u=(0,h.default)(t._geometryBeingScaled,a,{origin:s});return{updatedData:t._getUpdatedData(i,u),editType:r,editContext:{featureIndexes:i.selectedIndexes}}})),P(w(t),"updateCursor",(function(e){if(t._selectedEditHandle){t._cursor&&e.onUpdateCursor(t._cursor);var n=t.getSelectedFeaturesAsFeatureCollection(e),r=(0,i.default)(n),s=(0,o.default)(r,t._selectedEditHandle),a=s<0?s+180:s;a>=0&&a<=90||a>=180&&a<=270?(t._cursor="nesw-resize",e.onUpdateCursor("nesw-resize")):(t._cursor="nwse-resize",e.onUpdateCursor("nwse-resize"))}else e.onUpdateCursor(null),t._cursor=null})),t}return n=g,(l=[{key:"handlePointerMove",value:function(t,e){if(!this._isScaling){var n=(0,f.getPickedEditHandle)(t.picks);this._selectedEditHandle=n&&"scale"===n.properties.editHandleType?n:null,n&&this.updateCursor(e)}}},{key:"handleStartDragging",value:function(t,e){this._selectedEditHandle&&(this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleDragging",value:function(t,e){if(this._isScaling){e.onUpdateCursor(this._cursor);var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaling",e);n&&e.onEdit(n),t.cancelPan()}}},{key:"handleStopDragging",value:function(t,e){if(this._isScaling){var n=this.getScaleAction(t.pointerDownMapCoords,t.mapCoords,"scaled",e);n&&e.onEdit(n),e.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}},{key:"getGuides",value:function(t){this._cornerGuidePoints=[];var e=this.getSelectedFeaturesAsFeatureCollection(t);if(this._isSinglePointGeometrySelected(e))return{type:"FeatureCollection",features:[]};var n=(0,s.default)((0,r.default)(e));n.properties.mode="scale";var i,o=[];return(0,c.coordEach)(n,(function(t,e){if(e<4){var n=(0,a.point)(t,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[e]});o.push(n)}})),this._cornerGuidePoints=o,(0,a.featureCollection)([(0,u.default)(n)].concat(function(t){if(Array.isArray(t))return m(t)}(i=this._cornerGuidePoints)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}])&&v(n.prototype,l),g}(p.GeoJsonEditMode);function C(t,e,n){var r=(0,l.default)(t,e);return(0,l.default)(t,n)/r}e.ScaleMode=T},3816:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SnappableMode=void 0;var r=n(875);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(g,t);var e,n,i,a=(e=g,function(){var t,n=f(e);if(A()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function g(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),d(h(e=a.call(this)),"_handler",void 0),e._handler=t,e}return n=g,(i=[{key:"_getSnappedMouseEvent",value:function(t,e,n){return Object.assign(t,{mapCoords:n.geometry.coordinates,pointerDownMapCoords:e&&e.geometry.coordinates})}},{key:"_getPickedSnapTarget",value:function(t){return(0,r.getPickedEditHandles)(t).find((function(t){return"snap-target"===t.properties.editHandleType}))}},{key:"_getPickedSnapSource",value:function(t){return(0,r.getPickedSnapSourceEditHandle)(t)}},{key:"_getUpdatedSnapSourceHandle",value:function(t,e){var n=t.properties,r=n.featureIndex,i=n.positionIndexes;if(!Array.isArray(i))return t;var o=e.features[r];return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{geometry:{type:"Point",coordinates:i.reduce((function(t,e){return t[e]}),o.geometry.coordinates)}})}},{key:"_getSnapTargets",value:function(t){var e=(t.modeConfig||{}).additionalSnapTargets;return e=e||[],[].concat(o(t.data.features),o(e))}},{key:"_getSnapTargetHandles",value:function(t){for(var e=[],n=this._getSnapTargets(t),i=0;i<n.length;i++)if(!t.selectedIndexes.includes(i)){var s=n[i].geometry;e.push.apply(e,o((0,r.getEditHandlesForGeometry)(s,i,"snap-target")))}return e}},{key:"getGuides",value:function(t){var e=t.modeConfig,n=t.lastPointerMoveEvent,i=(e||{}).enableSnapping,a={type:"FeatureCollection",features:o(this._handler.getGuides(t).features)};if(!i)return a;var u,c=n&&this._getPickedSnapSource(n.pointerDownPicks);if(c)return(u=a.features).push.apply(u,o(this._getSnapTargetHandles(t)).concat([this._getUpdatedSnapSourceHandle(c,t.data)])),a;var l,h=t.data.features,A=function(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=s(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){a=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}(t.selectedIndexes);try{for(A.s();!(l=A.n()).done;){var f=l.value;if(f<h.length){var p,d=h[f].geometry;(p=a.features).push.apply(p,o((0,r.getEditHandlesForGeometry)(d,f,"snap-source")))}}}catch(t){A.e(t)}finally{A.f()}return a}},{key:"_getSnapAwareEvent",value:function(t,e){var n=this._getPickedSnapSource(e.lastPointerMoveEvent.pointerDownPicks),r=this._getPickedSnapTarget(t.picks);return n&&r?this._getSnappedMouseEvent(t,n,r):t}},{key:"handleStartDragging",value:function(t,e){this._handler.handleStartDragging(t,e)}},{key:"handleStopDragging",value:function(t,e){this._handler.handleStopDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handleDragging",value:function(t,e){this._handler.handleDragging(this._getSnapAwareEvent(t,e),e)}},{key:"handlePointerMove",value:function(t,e){this._handler.handlePointerMove(this._getSnapAwareEvent(t,e),e)}}])&&c(n.prototype,i),g}(n(2254).GeoJsonEditMode);e.SnappableMode=g},6548:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SplitPolygonMode=void 0;var r=g(n(8147)),i=g(n(8727)),o=g(n(5419)),s=g(n(3663)),a=n(4102),u=g(n(1208)),c=g(n(1013)),l=g(n(3737)),h=g(n(7383)),A=g(n(3807)),f=n(875),p=n(2254),d=n(6302);function g(t){return t&&t.__esModule?t:{default:t}}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(t){if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function w(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(y,t);var e,n,p,g=(e=y,function(){var t,n=x(e);if(E()){var r=x(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return w(this,t)});function y(){return v(this,y),g.apply(this,arguments)}return n=y,(p=[{key:"calculateMapCoords",value:function(t,e,n){var r=n.modeConfig;if(!r||!r.lock90Degree||!t.length)return e;if(1===t.length){var i=t[0],o=this.getSelectedGeometry(n),s=(0,h.default)(o),p="FeatureCollection"===s.type?s.features:[s],d=Number.MAX_SAFE_INTEGER,g=null;if(p.forEach((function(t){var e=(0,A.default)(t,i),n=(0,c.default)(e,i);d>n&&(d=n,g=e)})),g){var y=(0,u.default)(i,g),_=(0,c.default)(i,e,{units:"meters"});return(0,l.default)(i,_,y,{units:"meters"}).geometry.coordinates}return e}var v,b,w=t[t.length-1],E=(v=(0,f.generatePointsParallelToLinePoints)(t[t.length-2],w,e),b=1,function(t){if(Array.isArray(t))return t}(v)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(v,b)||m(v,b)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return(0,A.default)((0,a.lineString)([w,E]),e).geometry.coordinates}},{key:"getGuides",value:function(t){var e=this.getClickSequence(),n={type:"FeatureCollection",features:[]};if(0===e.length||!t.lastPointerMoveEvent)return n;var r,i=t.lastPointerMoveEvent.mapCoords;return n.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat((r=e,function(t){if(Array.isArray(t))return _(t)}(r)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(r)||m(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[this.calculateMapCoords(e,i,t)])}}),n}},{key:"handleClick",value:function(t,e){var n=this.getTentativeGuide(e),i=this.getSelectedGeometry(e);if(i){var o=this.getClickSequence();n&&"LineString"===n.geometry.type?o.push(n.geometry.coordinates[n.geometry.coordinates.length-1]):this.addClickSequence(t);var a={type:"Point",coordinates:o[o.length-1]},u=(0,r.default)(a,i);if(o.length>1&&n&&!u){if(this.resetClickSequence(),0===(0,s.default)(n,i).features.length)return;var c=this.splitPolygon(n,e);c&&e.onEdit(c)}}else console.warn("A polygon must be selected for splitting")}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell")}},{key:"splitPolygon",value:function(t,e){var n=this.getSelectedGeometry(e),r=e.selectedIndexes[0],s=e.modeConfig||{},a=s.gap,u=void 0===a?.1:a,c=s.units,l=void 0===c?"centimeters":c;0===u&&(u=.1,l="centimeters");var h=(0,o.default)(t,u,{units:l}),A=(0,i.default)(n,h);if(!A)return console.warn("Canceling edit. Split Polygon erased"),null;var f,p=A.geometry,g=p.type,y=p.coordinates;return f="Polygon"===g?y.map((function(t){return[t]})):y.reduce((function(t,e){return e.forEach((function(e){t.push([e])})),t}),[]),{updatedData:new d.ImmutableFeatureCollection(e.data).replaceGeometry(r,{type:"MultiPolygon",coordinates:f}).getObject(),editType:"split",editContext:{featureIndexes:[r]}}}}])&&b(n.prototype,p),y}(p.GeoJsonEditMode);e.SplitPolygonMode=P},1658:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ThreeClickPolygonMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(A,t);var e,n,r,h=(e=A,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function A(){return i(this,A),h.apply(this,arguments)}return n=A,(r=[{key:"handleClick",value:function(t,e){this.addClickSequence(t);var n=this.getClickSequence(),r=this.getTentativeGuide(e);if(n.length>2&&r&&"Polygon"===r.geometry.type){var i=this.getAddFeatureOrBooleanPolygonAction(r.geometry,e);this.resetClickSequence(),i&&e.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=e.mapCoords;if(1===r.length)i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[r[0],o]}});else{var s=this.getThreeClickPolygon(r[0],r[1],o,n);s&&i.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:s.geometry})}return i}},{key:"getThreeClickPolygon",value:function(t,e,n,r){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(c(A.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 2===r.length&&(e=this.getThreeClickPolygon(r[0],r[1],i[0],t.modeConfig)),e}}])&&o(n.prototype,r),A}(n(2254).GeoJsonEditMode);e.ThreeClickPolygonMode=h},4061:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransformMode=void 0;var r=n(4102),i=n(6166),o=n(5892),s=n(83);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function A(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(y,t);var e,n,a,g=(e=y,function(){var t,n=p(e);if(f()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function y(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),g.call(this,[new i.TranslateMode,new o.ScaleMode,new s.RotateMode])}return n=y,(a=[{key:"handlePointerMove",value:function(t,e){var n=null;h(p(y.prototype),"handlePointerMove",this).call(this,t,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{onUpdateCursor:function(t){n=t||n}})),e.onUpdateCursor(n)}},{key:"handleStartDragging",value:function(t,e){var n=null,r=null,s=[];this._modes.forEach((function(t){t instanceof i.TranslateMode?r=t:(t instanceof o.ScaleMode&&(n=t),s.push(t))})),n instanceof o.ScaleMode&&!n.isEditHandleSelected()&&s.push(r),s.filter(Boolean).forEach((function(n){return n.handleStartDragging(t,e)}))}},{key:"getGuides",value:function(t){var e=h(p(y.prototype),"getGuides",this).call(this,t),n=(this._modes||[]).find((function(t){return t instanceof s.RotateMode}));if(n instanceof s.RotateMode){var i=e.features.filter((function(t){var e=t.properties||{},r=e.editHandleType,i=[e.mode];return n.getIsRotating()&&i.push(r),!i.includes("scale")}));e=(0,r.featureCollection)(i)}return e}}])&&l(n.prototype,a),y}(n(8874).CompositeMode);e.TransformMode=g},6166:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TranslateMode=void 0;var r=c(n(1208)),i=c(n(1013)),o=c(n(2418)),s=n(4102),a=n(2254),u=n(6302);function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(l,t);var e,n,a,c=(e=l,function(){var t,n=g(e);if(d()){var r=g(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return f(this,t)});function l(){var t;h(this,l);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(p(t=c.call.apply(c,[this].concat(n))),"_geometryBeforeTranslate",void 0),m(p(t),"_isTranslatable",void 0),t}return n=l,(a=[{key:"handleDragging",value:function(t,e){if(this._isTranslatable){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translating",e);n&&e.onEdit(n)}t.cancelPan()}}},{key:"handlePointerMove",value:function(t,e){this._isTranslatable=this.isSelectionPicked(t.pointerDownPicks||t.picks,e),this.updateCursor(e)}},{key:"handleStartDragging",value:function(t,e){this._isTranslatable&&(this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(e))}},{key:"handleStopDragging",value:function(t,e){if(this._geometryBeforeTranslate){var n=this.getTranslateAction(t.pointerDownMapCoords,t.mapCoords,"translated",e);n&&e.onEdit(n),this._geometryBeforeTranslate=null}}},{key:"updateCursor",value:function(t){this._isTranslatable?t.onUpdateCursor("move"):t.onUpdateCursor(null)}},{key:"getTranslateAction",value:function(t,e,n,a){if(!this._geometryBeforeTranslate)return null;for(var c=(0,s.point)(t),l=(0,s.point)(e),h=(0,i.default)(c,l),A=(0,r.default)(c,l),f=(0,o.default)(this._geometryBeforeTranslate,h,A),p=new u.ImmutableFeatureCollection(a.data),d=a.selectedIndexes,g=0;g<d.length;g++){var y=d[g],m=f.features[g];p=p.replaceGeometry(y,m.geometry)}return{updatedData:p.getObject(),editType:n,editContext:{featureIndexes:d}}}}])&&A(n.prototype,a),l}(a.GeoJsonEditMode);e.TranslateMode=_},3124:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.TwoClickPolygonMode=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(A,t);var e,n,r,h=(e=A,function(){var t,n=c(e);if(u()){var r=c(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return a(this,t)});function A(){return i(this,A),h.apply(this,arguments)}return n=A,(r=[{key:"handleClick",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw||(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"handleStartDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),t.cancelPan())}},{key:"handleStopDragging",value:function(t,e){e.modeConfig&&e.modeConfig.dragToDraw&&(this.addClickSequence(t),this.checkAndFinishPolygon(e))}},{key:"checkAndFinishPolygon",value:function(t){var e=this.getClickSequence(),n=this.getTentativeGuide(t);if(e.length>1&&n&&"Polygon"===n.geometry.type){var r={type:"Feature",properties:{shape:n.properties.shape},geometry:{type:"Polygon",coordinates:n.geometry.coordinates}},i=this.getAddFeatureOrBooleanPolygonAction(r,t);this.resetClickSequence(),i&&t.onEdit(i)}}},{key:"getGuides",value:function(t){var e=t.lastPointerMoveEvent,n=t.modeConfig,r=this.getClickSequence(),i={type:"FeatureCollection",features:[]};if(0===r.length)return i;var o=r[0],s=e.mapCoords,a=this.getTwoClickPolygon(o,s,n);return a&&i.features.push({type:"Feature",properties:{shape:a.properties&&a.properties.shape,guideType:"tentative"},geometry:a.geometry}),i}},{key:"getTwoClickPolygon",value:function(t,e,n){return null}},{key:"handlePointerMove",value:function(t,e){e.onUpdateCursor("cell"),s(c(A.prototype),"handlePointerMove",this).call(this,t,e)}},{key:"createTentativeFeature",value:function(t){var e,n=t.lastPointerMoveEvent,r=this.getClickSequence(),i=n?[n.mapCoords]:[];return 1===r.length&&(e=this.getTwoClickPolygon(r[0],i[0],t.modeConfig)),e}}])&&o(n.prototype,r),A}(n(2254).GeoJsonEditMode);e.TwoClickPolygonMode=h},5279:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ViewMode=void 0;var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(r,t);var e,n=(e=r,function(){var t,n=a(e);if(s()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function r(){return i(this,r),n.apply(this,arguments)}return r}(n(2254).GeoJsonEditMode);e.ViewMode=c},3916:(t,e)=>{"use strict";function n(t,e){if(t===e)return!0;if(Array.isArray(t)){var n=t.length;if(!e||e.length!==n)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,r={};return function(i){for(var o in i)if(!n(i[o],r[o])){e=t(i),r=i;break}return e}}},875:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(A(n),[i]),r)){r(e,n);break}return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var s={type:"LineString",coordinates:[t,e]},u=(0,a.point)(n),c=(0,o.default)(u,s),l=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?l-90:l-270,A=(0,r.default)(e,c,h),f=(0,r.default)(t,c,h);return[A.geometry.coordinates,f.geometry.coordinates]},e.distance2d=d,e.mix=g,e.nearestPointOnProjectedLine=function(t,e,n){var r=new c.default(n),i=t.geometry.coordinates.map((function(t){var e=h(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=h(r.project(e.geometry.coordinates),2),s=o[0],a=o[1],u=1/0,l={};i.forEach((function(t,e){var n=h(t,2),r=n[0],o=n[1];if(0!==e){var c=h(i[e-1],2),A=c[0],f=c[1],p=f-o,d=r-A,g=A*o-r*f,y=p*p+d*d,m=Math.abs(p*s+d*a+g)/Math.sqrt(y);m<u&&(u=m,l={index:e,x0:(d*(d*s-p*a)-p*g)/y,y0:(p*(-d*s+p*a)-d*g)/y})}}));var A=l,f=A.index,p=A.x0,y=A.y0,m=h(i[f-1],3),_=m[0],v=m[1],b=m[2],w=void 0===b?0:b,E=h(i[f],3),x=E[0],S=E[1],P=E[2],T=void 0===P?0:P,C=d(_,v,x,S),M=g(w,T,d(_,v,p,y)/C);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([p,y,M])},properties:{dist:u,index:f-1}}},e.nearestPointOnLine=function(t,e,n){var r,i,o;n&&(o=new c.default(n));var l=(0,a.point)([1/0,1/0],{dist:1/0});return!(null===(r=t.geometry)||void 0===r?void 0:r.coordinates.length)||(null===(i=t.geometry)||void 0===i?void 0:i.coordinates.length)<2||(0,s.flattenEach)(t,(function(t){var n,r,i,s,c,h,A,f=(0,u.getCoords)(t),p=(0,u.getCoords)(e);if(f.length>1&&p.length){var d,g;o?(d=f.map((function(t){return o.project(t)})),g=o.project(p)):(d=f,g=p);for(var y=1;y<d.length;y++){if(d[y][0]!==d[y-1][0]){var m=(d[y][1]-d[y-1][1])/(d[y][0]-d[y-1][0]),_=d[y][1]-m*d[y][0];A=Math.abs(m*g[0]+_-g[1])/Math.sqrt(m*m+1)}else A=Math.abs(g[0]-d[y][0]);var v=Math.pow(d[y][1]-d[y-1][1],2)+Math.pow(d[y][0]-d[y-1][0],2),b=Math.pow(d[y][1]-g[1],2)+Math.pow(d[y][0]-g[0],2),w=Math.pow(d[y-1][1]-g[1],2)+Math.pow(d[y-1][0]-g[0],2),E=Math.pow(A,2),x=b-E+w-E;x>v&&(A=Math.sqrt(Math.min(b,w))),(null==n||n>A)&&(x>v?w<b?(r=0,i=1):(i=0,r=1):(r=Math.sqrt(w-E)/Math.sqrt(v),i=Math.sqrt(b-E)/Math.sqrt(v)),n=A,h=y)}var S=d[h-1][0]-d[h][0],P=d[h-1][1]-d[h][1];s=d[h-1][0]-S*r,c=d[h-1][1]-P*r}var T={x:s,y:c,idx:h-1,to:r,from:i};if(o){var C=o.unproject([T.x,T.y]);T={x:C[0],y:C[1],idx:h-1,to:r,from:i}}l=(0,a.point)([T.x,T.y],{dist:Math.abs(T.from-T.to),index:T.idx})})),l},e.getPickedEditHandle=function(t){var e=y(t);return e.length?e[0]:null},e.getPickedSnapSourceEditHandle=function(t){return y(t).find((function(t){return"snap-source"===t.properties.editHandleType}))},e.getNonGuidePicks=function(t){return t&&t.filter((function(t){return!t.isGuide}))},e.getPickedExistingEditHandle=function(t){return y(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"existing"===e.editHandleType}))},e.getPickedIntermediateEditHandle=function(t){return y(t).find((function(t){var e=t.properties;return e.featureIndex>=0&&"intermediate"===e.editHandleType}))},e.getPickedEditHandles=y,e.getEditHandlesForGeometry=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"existing",r=[];switch(t.type){case"Point":r=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:e},geometry:{type:"Point",coordinates:t.coordinates}}];break;case"MultiPoint":case"LineString":r=r.concat(m(t.coordinates,[],e,n));break;case"Polygon":case"MultiLineString":for(var i=0;i<t.coordinates.length;i++)r=r.concat(m(t.coordinates[i],[i],e,n)),"Polygon"===t.type&&(r=r.slice(0,-1));break;case"MultiPolygon":for(var o=0;o<t.coordinates.length;o++)for(var s=0;s<t.coordinates[o].length;s++)r=(r=r.concat(m(t.coordinates[o][s],[o,s],e,n))).slice(0,-1);break;default:throw Error("Unhandled geometry type: ".concat(t.type))}return r};var r=l(n(3737)),i=l(n(1208)),o=l(n(3892)),s=n(1540),a=n(4102),u=n(611),c=l(n(4235));function l(t){return t&&t.__esModule?t:{default:t}}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function g(t,e,n){return e*n+t*(1-n)}function y(t){return t&&t.filter((function(t){return t.isGuide&&"editHandle"===t.object.properties.guideType})).map((function(t){return t.object}))||[]}function m(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"existing",i=[],o=0;o<t.length;o++){var s=t[o];i.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[].concat(A(e),[o]),featureIndex:n,editHandleType:r},geometry:{type:"Point",coordinates:s}})}return i}},9900:(t,e,n)=>{"use strict";Object.defineProperty(e,"nk",{enumerable:!0,get:function(){return r.default}});n(1399);var r=i(n(2444));i(n(2465)),i(n(1845)),i(n(7964)),i(n(6734)),i(n(647)),i(n(6949)),n(9545);function i(t){return t&&t.__esModule?t:{default:t}}},2444:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=n(9119),o=n(7359),s=(r=n(6759))&&r.__esModule?r:{default:r};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e,n){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function h(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=[0,0,0,153],y=[0,0,0,144],m=[0,0,0,255],_=[0,0,144,144],v=[144,144,144,255],b=[144,144,144,144],w=[192,0,0,255],E=[0,0,0,128],x=[124,0,192,255],S=[255,255,255,255],P=o.DrawPolygonMode;function T(t){return t&&"function"==typeof t?function(e){return t(function(t){return t.__source?t.__source.object:t.sourceFeature?t.sourceFeature.feature:t}(e))}:t}function C(t){switch(t.properties.editHandleType){case"existing":return w;case"snap-source":return x;case"intermediate":default:return E}}var M={mode:P,onEdit:function(){},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:1,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",lineJointRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:function(t,e,n){return e?m:g},getFillColor:function(t,e,n){return e?_:y},getRadius:function(t){return t&&t.properties&&t.properties.radius||t&&t.properties&&t.properties.size||1},getLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},getTentativeLineColor:function(t){return v},getTentativeFillColor:function(t){return b},getTentativeLineWidth:function(t){return t&&t.properties&&t.properties.lineWidth||3},editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:C,getEditHandlePointOutlineColor:function(t){return S},getEditHandlePointRadius:function(t){switch(t.properties.editHandleType){case"existing":return 5;case"snap":return 7;case"intermediate":default:return 3}},editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,getEditHandleIcon:function(t){return t.properties.editHandleType},getEditHandleIconSize:10,getEditHandleIconColor:C,getEditHandleIconAngle:0,billboard:!0},I={view:o.ViewMode,modify:o.ModifyMode,translate:new o.SnappableMode(new o.TranslateMode),transform:new o.SnappableMode(new o.TransformMode),scale:o.ScaleMode,rotate:o.RotateMode,duplicate:o.DuplicateMode,split:o.SplitPolygonMode,extrude:o.ExtrudeMode,elevation:o.ElevationMode,drawPoint:o.DrawPointMode,drawLineString:o.DrawLineStringMode,drawPolygon:o.DrawPolygonMode,drawRectangle:o.DrawRectangleMode,drawSquareFromCenter:o.DrawSquareFromCenterMode,drawCircleFromCenter:o.DrawCircleFromCenterMode,drawCircleByBoundingBox:o.DrawCircleByDiameterMode,drawEllipseByBoundingBox:o.DrawEllipseByBoundingBoxMode,drawRectangleUsing3Points:o.DrawRectangleUsingThreePointsMode,drawEllipseUsing3Points:o.DrawEllipseUsingThreePointsMode,draw90DegreePolygon:o.Draw90DegreePolygonMode,drawPolygonByDragging:o.DrawPolygonByDraggingMode},O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(s,t);var e,n,r,o=(e=s,function(){var t,n=f(e);if(A()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function s(){return u(this,s),o.apply(this,arguments)}return n=s,(r=[{key:"renderLayers",value:function(){var t=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{"line-strings":{billboard:this.props.billboard},"polygons-stroke":{billboard:this.props.billboard}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}}),e=[new i.GeoJsonLayer(t)];return e.concat(this.createGuidesLayers(),this.createTooltipsLayers())}},{key:"initializeState",value:function(){l(f(s.prototype),"initializeState",this).call(this),this.setState({selectedFeatures:[],editHandles:[]})}},{key:"shouldUpdateState",value:function(t){return l(f(s.prototype),"shouldUpdateState",this).call(this,t)||t.changeFlags.stateChanged}},{key:"updateState",value:function(t){var e,n=t.props,r=t.oldProps,i=t.changeFlags;l(f(s.prototype),"updateState",this).call(this,{oldProps:r,props:n,changeFlags:i}),!i.propsOrDataChanged||0!==Object.keys(r).length&&n.mode===r.mode||("function"==typeof n.mode?e=new(0,n.mode):"string"==typeof n.mode?(e=I[n.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):e=n.mode,e||(console.warn("No mode configured for ".concat(String(n.mode))),e=new P),e!==this.state.mode&&this.setState({mode:e,cursor:null}));var o=[];Array.isArray(n.selectedFeatureIndexes)&&(o=n.selectedFeatureIndexes.map((function(t){return n.data.features[t]}))),this.setState({selectedFeatures:o})}},{key:"getModeProps",value:function(t){var e=this;return{modeConfig:t.modeConfig,data:t.data,selectedIndexes:t.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:function(n){e.setNeedsUpdate(),t.onEdit(n)},onUpdateCursor:function(t){e.setState({cursor:t})}}}},{key:"selectionAwareAccessor",value:function(t){var e=this;return"function"!=typeof t?t:function(n){return t(n,e.isFeatureSelected(n),e.props.mode)}}},{key:"isFeatureSelected",value:function(t){if(!this.props.data||!this.props.selectedFeatureIndexes)return!1;if(!this.props.selectedFeatureIndexes.length)return!1;var e=this.props.data.features.indexOf(t);return this.props.selectedFeatureIndexes.includes(e)}},{key:"getPickingInfo",value:function(t){var e=t.info;return t.sourceLayer.id.endsWith("guides")&&(e.isGuide=!0),e}},{key:"createGuidesLayers",value:function(){var t,e=this.getActiveMode().getGuides(this.getModeProps(this.props));return e&&e.features.length?(t="icon"===this.props.editHandleType?{type:i.IconLayer,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeScale:this.props.editHandleIconSizeScale,getIcon:T(this.props.getEditHandleIcon),getSize:T(this.props.getEditHandleIconSize),getColor:T(this.props.getEditHandleIconColor),getAngle:T(this.props.getEditHandleIconAngle)}:{type:i.ScatterplotLayer,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:T(this.props.getEditHandlePointRadius),getFillColor:T(this.props.getEditHandlePointColor),getLineColor:T(this.props.getEditHandlePointOutlineColor)},[new i.GeoJsonLayer(this.getSubLayerProps({id:"guides",data:e,fp64:this.props.fp64,_subLayerProps:{points:t},lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:T(this.props.getTentativeLineColor),getLineWidth:T(this.props.getTentativeLineWidth),getFillColor:T(this.props.getTentativeFillColor)}))]):[]}},{key:"createTooltipsLayers",value:function(){var t=this.getActiveMode().getTooltips(this.getModeProps(this.props));return[new i.TextLayer(this.getSubLayerProps({id:"tooltips",data:t}))]}},{key:"onLayerClick",value:function(t){this.getActiveMode().handleClick(t,this.getModeProps(this.props))}},{key:"onLayerKeyUp",value:function(t){this.getActiveMode().handleKeyUp(t,this.getModeProps(this.props))}},{key:"onStartDragging",value:function(t){this.getActiveMode().handleStartDragging(t,this.getModeProps(this.props))}},{key:"onDragging",value:function(t){this.getActiveMode().handleDragging(t,this.getModeProps(this.props))}},{key:"onStopDragging",value:function(t){this.getActiveMode().handleStopDragging(t,this.getModeProps(this.props))}},{key:"onPointerMove",value:function(t){this.setState({lastPointerMoveEvent:t}),this.getActiveMode().handlePointerMove(t,this.getModeProps(this.props))}},{key:"getCursor",value:function(t){var e=t.isDragging,n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}},{key:"getActiveMode",value:function(){return this.state.mode}}])&&c(n.prototype,r),s}(s.default);e.default=O,d(O,"layerName","EditableGeoJsonLayer"),d(O,"defaultProps",M)},2465:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(8215),i=n(7359),o=n(9947),s=u(n(2444)),a=u(n(6759));function u(t){return t&&t.__esModule?t:{default:t}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=y(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function d(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=i.ViewMode,E={type:"FeatureCollection",features:[]},x=v({mode:w},s.default.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:1,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:function(t){return t.hexIds},getEditedCluster:function(t,e){return e?v({},e,{hexIds:t}):{hexIds:t}},resolution:9}),S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(u,t);var e,n,i,a=(e=u,function(){var t,n=y(e);if(g()){var r=y(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return d(this,t)});function u(){return A(this,u),a.apply(this,arguments)}return n=u,(i=[{key:"initializeState",value:function(){p(y(u.prototype),"initializeState",this).call(this),this.setState({tentativeHexagonIDs:[]})}},{key:"getDerivedHexagonIDs",value:function(t){return(0,o.polyfill)(t,this.props.resolution,!0)}},{key:"getDerivedHexagonID",value:function(t){return(0,o.geoToH3)(t[1],t[0],this.props.resolution)}},{key:"renderLayers",value:function(){var t=this;return[new s.default(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:E,selectedFeatureIndexes:[],onEdit:function(e){var n=e.editType,r=e.editContext;switch(n){case"updateTentativeFeature":if("Polygon"===r.feature.geometry.type){var i=r.feature.geometry.coordinates,o=t.getDerivedHexagonIDs(i);t.setState({tentativeHexagonIDs:o})}else if("Point"===r.feature.geometry.type){var s=r.feature.geometry.coordinates,a=t.getDerivedHexagonID(s);t.setState({tentativeHexagonIDs:[a]})}break;case"addFeature":var u=l(t.props.data),c=t.props.modeConfig;if(c&&c.booleanOperation)if(1!==t.props.selectedIndexes.length)console.warn("booleanOperation only supported for single cluster selection");else{var h,A=new Set(t.getSelectedHexIDs()),f=new Set(t.state.tentativeHexagonIDs);switch(c.booleanOperation){case"union":default:h=l(new Set([].concat(l(A),l(f))));break;case"intersection":h=l(A).filter((function(t){return f.has(t)}));break;case"difference":h=l(A).filter((function(t){return!f.has(t)}))}var p=t.props.selectedIndexes[0],d=t.props.data[p];u[p]=t.props.getEditedCluster(h,d)}else u.push(t.props.getEditedCluster(t.state.tentativeHexagonIDs,null));t.setState({tentativeHexagonIDs:[]}),t.props.onEdit({updatedData:u})}}})),new r.H3ClusterLayer(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new r.H3ClusterLayer(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:function(t){return t.hexIds}}))]}},{key:"getSelectedHexIDs",value:function(){var t=this,e=[];return this.props.selectedIndexes.forEach((function(n){var r=t.props.data[n],i=t.props.getHexagons(r);e=e.concat(i)})),e}},{key:"getCursor",value:function(t){var e=t.isDragging,n=this.state.cursor;return n||(n=e?"grabbing":"grab"),n}}])&&f(n.prototype,i),u}(a.default);e.default=S,b(S,"layerName","EditableH3ClusterLayer"),b(S,"defaultProps",x)},6759:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(2860);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,s=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=["anyclick","pointermove","panstart","panmove","panend","keyup"],y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,t);var e,n,r,i=(e=o,function(){var t,n=f(e);if(A()){var r=f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return h(this,t)});function o(){return c(this,o),i.apply(this,arguments)}return n=o,(r=[{key:"onLayerClick",value:function(t){}},{key:"onStartDragging",value:function(t){}},{key:"onStopDragging",value:function(t){}},{key:"onDragging",value:function(t){}},{key:"onPointerMove",value:function(t){}},{key:"onLayerKeyUp",value:function(t){}},{key:"initializeState",value:function(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}},{key:"finalizeState",value:function(){this._removeEventHandlers()}},{key:"_addEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(g);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.on(i,n,{priority:100})}}catch(t){r.e(t)}finally{r.f()}}},{key:"_removeEventHandlers",value:function(){var t,e=this.context.deck.eventManager,n=this.state._editableLayerState.eventHandler,r=a(g);try{for(r.s();!(t=r.n()).done;){var i=t.value;e.off(i,n)}}catch(t){r.e(t)}finally{r.f()}}},{key:"_forwardEventToCurrentLayer",value:function(t){var e=this.getCurrentLayer(),n=e["_on".concat(t.type)].bind(e);n?n(t):console.warn("no handler for mjolnir.js event ".concat(t.type))}},{key:"_onanyclick",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.getPicks(n);this.onLayerClick({mapCoords:r,screenCoords:n,picks:i,sourceEvent:e})}},{key:"_onkeyup",value:function(t){var e=t.srcEvent;this.onLayerKeyUp(e)}},{key:"_onpanstart",value:function(t){var e=this.getScreenCoords(t.srcEvent),n=this.getMapCoords(e),r=this.getPicks(e);this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:e,pointerDownMapCoords:n,pointerDownPicks:r})}),this.onStartDragging({picks:r,screenCoords:e,mapCoords:n,pointerDownScreenCoords:e,pointerDownMapCoords:n,cancelPan:t.stopImmediatePropagation,sourceEvent:t.srcEvent})}},{key:"_onpanmove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,u=this.getPicks(n);this.onDragging({screenCoords:n,mapCoords:r,picks:u,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e,cancelPan:t.stopImmediatePropagation})}},{key:"_onpanend",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,a=i.pointerDownScreenCoords,u=i.pointerDownMapCoords,c=this.getPicks(n);this.onStopDragging({picks:c,screenCoords:n,mapCoords:r,pointerDownPicks:o,pointerDownScreenCoords:a,pointerDownMapCoords:u,sourceEvent:e}),this.setState({_editableLayerState:s({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}},{key:"_onpointermove",value:function(t){var e=t.srcEvent,n=this.getScreenCoords(e),r=this.getMapCoords(n),i=this.state._editableLayerState,o=i.pointerDownPicks,s=i.pointerDownScreenCoords,a=i.pointerDownMapCoords,u=this.getPicks(n);this.onPointerMove({screenCoords:n,mapCoords:r,picks:u,pointerDownPicks:o,pointerDownScreenCoords:s,pointerDownMapCoords:a,sourceEvent:e})}},{key:"getPicks",value:function(t){return this.context.deck.pickMultipleObjects({x:t[0],y:t[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}},{key:"getScreenCoords",value:function(t){return[t.clientX-this.context.gl.canvas.getBoundingClientRect().left,t.clientY-this.context.gl.canvas.getBoundingClientRect().top]}},{key:"getMapCoords",value:function(t){return this.context.viewport.unproject([t[0],t[1]])}}])&&l(n.prototype,r),o}(r.CompositeLayer);e.default=y,d(y,"layerName","EditableLayer")},7964:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(2860),i=n(9119);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(A,t);var e,n,r,o=(e=A,function(){var t,n=l(e);if(c()){var r=l(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return u(this,t)});function A(){return s(this,A),o.apply(this,arguments)}return n=A,(r=[{key:"renderLayers",value:function(){return[new i.ScatterplotLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-ScatterplotLayer"),data:this.props.data})),new i.LineLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-LineLayer"),data:this.props.data,pickable:!1,getSourcePosition:function(t){var e=t.position;return[e[0],e[1],0]},getTargetPosition:function(t){var e=t.position;return[e[0],e[1],e[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}))]}}])&&a(n.prototype,r),A}(r.CompositeLayer);e.default=f,A(f,"layerName","ElevatedEditHandleLayer"),A(f,"defaultProps",{})},6949:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(2860),i=n(9119);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(s,t);var e,n,r,o=(e=s,function(){var t,n=A(e);if(h()){var r=A(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return l(this,t)});function s(){return u(this,s),o.apply(this,arguments)}return n=s,(r=[{key:"renderLayers",value:function(){var t=this.props,e=t.id,n=t.getFillColor,r=t.getStrokeColor,o=t.getInnerRadius,s=t.updateTriggers;return[new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-full"),data:this.props.data,getLineColor:r,updateTriggers:a({},s,{getStrokeColor:s.getStrokeColor})})),new i.ScatterplotLayer(a({},this.props,{id:"".concat(e,"-inner"),data:this.props.data,getFillColor:n,getRadius:o,pickable:!1,updateTriggers:a({},s,{getFillColor:s.getFillColor,getRadius:s.getInnerRadius})}))]}}])&&c(n.prototype,r),s}(r.CompositeLayer);e.default=d,p(d,"layerName","JunctionScatterplotLayer"),p(d,"defaultProps",a({},i.ScatterplotLayer.defaultProps,{getFillColor:function(t){return[0,0,0,255]},getStrokeColor:function(t){return[255,255,255,255]},getInnerRadius:function(t){return 1}}))},6484:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(r,t);var e,n=(e=r,function(){var t,n=a(e);if(s()){var r=a(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i(this,r),n.call(this,Object.assign({},t,{attributes:l(t)}))}return r}(n(2150).Geometry);function l(t){for(var e=t.length,n=void 0===e?1:e,r=t.headSize,i=void 0===r?.2:r,o=t.tailWidth,s=void 0===o?.05:o,a=t.tailStart,u=void 0===a?.05:a,c=[.5,1,0,.5-i/2,1-i,0,.5+i/2,1-i,0,.5-s/2,u,0,.5+s/2,1-i,0,.5+s/2,u,0,.5-s/2,u,0,.5-s/2,1-i,0,.5+s/2,1-i,0],l=new Array(c.length),h=0;h<c.length/3;h++){var A=3*h;l[A+0]=(c[A+0]-.5)*n,l[A+1]=(c[A+1]-.5)*n,l[A+2]=0}return{positions:new Float32Array(l),normals:new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]),texCoords:new Float32Array(c)}}e.default=c},9762:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e,n=t.data,o=t.getPath,l=void 0===o?function(t){return t.path}:o,h=t.getDirection,A=void 0===h?function(t){return t.direction}:h,f=t.getColor,p=void 0===f?function(t){return a}:f,d=t.getMarkerPercentages,g=void 0===d?function(t){return[.5]}:d,y=t.projectFlat,m=[],_=i(n);try{for(_.s();!(e=_.n()).done;){var v,b=e.value,w=l(b),E=A(b)||u,x=p(b),S=w.map((function(t){return new r.Vector2(t)})),P=S.slice(0).reverse(),T=s(S),C=i(g(b,{lineLength:T}));try{for(C.s();!(v=C.n()).done;){var M=v.value;if(E.forward){var I=c({path:S,percentage:M,lineLength:T,color:x,object:b,projectFlat:y});m.push(I)}if(E.backward){var O=c({path:P,percentage:M,lineLength:T,color:x,object:b,projectFlat:y});m.push(O)}}}catch(t){C.e(t)}finally{C.f()}}}catch(t){_.e(t)}finally{_.f()}return m};var r=n(9811);function i(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,s=!0,a=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return s=t.done,t},e:function(t){a=!0,i=t},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw i}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t){for(var e=0,n=0;n<t.length-1;n++)e+=t[n].distance(t[n+1]);return e}var a=[0,0,0,255],u={forward:!0,backward:!1};function c(t){var e=t.path,n=t.percentage,i=t.lineLength,o=t.color,s=t.object,a=t.projectFlat,u=i*n,c=0,l=0,h=0;for(h=0;h<e.length-1&&!((c+=e[h].distance(e[h+1]))>u);h++)l=c;var A=u-l,f=e[h+1].clone().subtract(e[h]).normalize().clone().multiply(new r.Vector2(A,A)).add(e[h]),p=180*new r.Vector2(a(e[h+1])).subtract(a(e[h])).verticalAngle()/Math.PI;return{position:[f.x,f.y,0],angle:p,color:o,object:s}}},647:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(2860),i=n(9119),o=n(1956),s=l(n(6734)),a=l(n(6484)),u=l(n(9762)),c=n(1666);function l(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function g(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=o.SimpleMeshLayer,w={mesh:new a.default({headSize:.2,tailWidth:.05})},E=Object.assign({},s.default.defaultProps,{MarkerLayer:b,markerLayerProps:w,sizeScale:100,fp64:!1,hightlightIndex:-1,highlightPoint:null,getPath:function(t){return t.path},getColor:function(t){return t.color},getMarkerColor:function(t){return[0,0,0,255]},getDirection:function(t){return t.direction},getMarkerPercentages:function(t,e){return e.lineLength>.1?[.25,.5,.75]:[.5]}}),x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(h,t);var e,n,o,l=(e=h,function(){var t,n=m(e);if(y()){var r=m(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)});function h(){return p(this,h),l.apply(this,arguments)}return n=h,(o=[{key:"initializeState",value:function(){this.state={markers:[],mesh:new a.default({headSize:.2,tailWidth:.05}),closestPoint:null}}},{key:"projectFlat",value:function(t,e,n,i){if(n===r.COORDINATE_SYSTEM.METER_OFFSETS){var o=A(e.metersToLngLatDelta(t),2),s=o[0],a=o[1],u=A(i,2),c=u[0],l=u[1];return e.projectFlat([c+s,a+l])}if(n===r.COORDINATE_SYSTEM.LNGLAT_OFFSETS){var h=A(t,2),f=h[0],p=h[1],d=A(i,2),g=d[0],y=d[1];return e.projectFlat([g+f,p+y])}return e.projectFlat(t)}},{key:"updateState",value:function(t){var e=this,n=t.props,r=t.oldProps,i=t.changeFlags;if(i.dataChanged||i.updateTriggersChanged){var o=this.props,s=o.data,a=o.getPath,c=o.getDirection,l=o.getMarkerColor,h=o.getMarkerPercentages,A=o.coordinateSystem,f=o.coordinateOrigin,p=this.context.viewport;this.state.markers=(0,u.default)({data:s,getPath:a,getDirection:c,getColor:l,getMarkerPercentages:h,projectFlat:function(t){return e.projectFlat(t,p,A,f)}}),this._recalculateClosestPoint()}i.propsChanged&&n.point!==r.point&&this._recalculateClosestPoint()}},{key:"_recalculateClosestPoint",value:function(){var t=this.props,e=t.highlightPoint,n=t.highlightIndex;if(e&&n>=0){var r=this.props.data[n],i=this.props.getPath(r),o=(0,c.getClosestPointOnPolyline)({points:i,p:e}).point;this.state.closestPoints=[{position:o}]}else this.state.closestPoints=[]}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.path||e.object})}},{key:"renderLayers",value:function(){return[new s.default(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:function(t){return[0,-t.angle,0]},getColor:function(t){return t.color},sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new i.ScatterplotLayer({id:"".concat(this.props.id,"-highlight"),data:this.state.closestPoints,fp64:this.props.fp64})]}}])&&d(n.prototype,o),h}(r.CompositeLayer);e.default=x,v(x,"layerName","PathMarkerLayer"),v(x,"defaultProps",E)},1666:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getClosestPointOnLine=i,e.getClosestPointOnPolyline=function(t){var e=t.p,n=t.points;e=new r.Vector3(e);for(var o=null,s=1/0,a=-1,u=0;u<n.length-1;++u){var c=i({p:e,p1:n[u],p2:n[u+1]}),l=e.distanceSquared(c);l<s&&(s=l,o=c,a=u)}return{point:o,index:a,p1:n[a],p2:n[a+1],distanceSquared:s,distance:Math.sqrt(s)}};var r=n(9811);function i(t){var e=t.p,n=t.p1,i=t.p2,o=t.clampToLine,s=void 0===o||o,a=new r.Vector3(i).subtract(n),u=new r.Vector3(e).subtract(n),c=a.dot(u);return s&&(c=(0,r.clamp)(c,0,1)),a.lerp(c)}},6734:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(9119),i=a(n(9757)),o=n(2150),s=a(n(7673));function a(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=p(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function A(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){var e=t.source,n=t.code,r=void 0===n?"":n;return e.replace(/}[^{}]*$/,r.concat("\n}\n"))}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(u,t);var e,n,r,a=(e=u,function(){var t,n=p(e);if(f()){var r=p(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return A(this,t)});function u(){return c(this,u),a.apply(this,arguments)}return n=u,(r=[{key:"getShaders",value:function(){var t=h(p(u.prototype),"getShaders",this).call(this);return Object.assign({},t,{modules:t.modules.concat([s.default]),vs:y({source:t.vs,code:"  outline_setUV(gl_Position);\n  outline_setZLevel(instanceZLevel);\n"}),fs:y({source:t.fs,code:"  gl_FragColor = outline_filterColor(gl_FragColor);\n"})})}},{key:"initializeState",value:function(t){h(p(u.prototype),"initializeState",this).call(this,t),this.setState({outlineFramebuffer:new o.Framebuffer(t.gl),dummyTexture:new o.Texture2D(t.gl)}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:i.default.UNSIGNED_BYTE,update:this.calculateZLevels,accessor:"getZLevel"}})}},{key:"draw",value:function(t){t.moduleParameters,t.parameters;var e=t.uniforms,n=(t.context,this.props),r=n.rounded,o=n.miterLimit,s=n.widthScale,a=n.widthMinPixels,u=n.widthMaxPixels,c=n.dashJustified;e=Object.assign({},e,{jointType:Number(r),alignMode:Number(c),widthScale:s,miterLimit:o,widthMinPixels:a,widthMaxPixels:u});var l=this.state,h=l.outlineFramebuffer,A=l.dummyTexture;h.resize(),h.clear({color:!0,depth:!0}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:A}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:0,widthScale:1.3*this.props.widthScale}),parameters:{depthTest:!1,blendEquation:i.default.MAX},framebuffer:h}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:h}),this.state.model.draw({uniforms:Object.assign({},e,{jointType:Number(r),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}},{key:"calculateZLevels",value:function(t){var e=this.props.getZLevel,n=this.state.pathTesselator;t.value=n._updateAttribute({target:t.value,size:1,getValue:function(t,n){return[e(t,n)||0]}})}}])&&l(n.prototype,r),u}(r.PathLayer);e.default=m,g(m,"layerName","PathOutlineLayer"),g(m,"defaultProps",{getZLevel:{type:"accessor",value:0}})},1845:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.SELECTION_TYPE=void 0;var r,i=n(2860),o=n(9119),s=n(4102),a=h(n(5419)),u=h(n(8727)),c=n(7359),l=h(n(2444));function h(t){return t&&t.__esModule?t:{default:t}}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||y(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||y(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function w(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function E(t){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var P={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};e.SELECTION_TYPE=P;var T=(S(r={},P.RECTANGLE,c.DrawRectangleMode),S(r,P.POLYGON,c.DrawPolygonMode),r),C=S({},P.RECTANGLE,{dragToDraw:!0}),M={selectionType:P.RECTANGLE,layerIds:[],onSelect:function(){}},I={type:"FeatureCollection",features:[]},O="selection-blocker",R=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"],L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(h,t);var e,n,r,i=(e=h,function(){var t,n=E(e);if(w()){var r=E(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return b(this,t)});function h(){return _(this,h),i.apply(this,arguments)}return n=h,(r=[{key:"_selectRectangleObjects",value:function(t){var e=this.props,n=e.layerIds,r=e.onSelect,i=g(this.context.viewport.project(t[0][0]),2),o=i[0],s=i[1],a=g(this.context.viewport.project(t[0][2]),2),u=a[0],c=a[1];r({pickingInfos:this.context.deck.pickObjects({x:Math.min(o,u),y:Math.min(s,c),width:Math.abs(u-o),height:Math.abs(c-s),layerIds:n})})}},{key:"_selectPolygonObjects",value:function(t){var e,n=this,r=this.props,i=r.layerIds,o=r.onSelect,c=t[0].map((function(t){return n.context.viewport.project(t)})),l=c.map((function(t){return t[0]})),h=c.map((function(t){return t[1]})),A=Math.min.apply(Math,d(l)),f=Math.min.apply(Math,d(h)),p=Math.max.apply(Math,d(l)),g=Math.max.apply(Math,d(h)),y=(0,s.polygon)(t),m=(0,a.default)(y,50);try{e=(0,u.default)(m,y)}catch(t){return void console.log("turfDifference() error",t)}this.setState({pendingPolygonSelection:{bigPolygon:e}});var _="".concat(this.props.id,"-").concat(O);setTimeout((function(){var t=n.context.deck.pickObjects({x:A,y:f,width:p-A,height:g-f,layerIds:[_].concat(d(i))});o({pickingInfos:t.filter((function(t){return t.layer.id!==n.props.id}))})}),250)}},{key:"renderLayers",value:function(){var t=this,e=this.state.pendingPolygonSelection,n=T[this.props.selectionType]||c.ViewMode,r=C[this.props.selectionType],i={};R.forEach((function(e){void 0!==t.props[e]&&(i[e]=t.props[e])}));var s=[new l.default(this.getSubLayerProps(p({id:"selection-geojson",pickable:!0,mode:n,modeConfig:r,selectedFeatureIndexes:[],data:I,onEdit:function(e){var n=e.updatedData;if("addFeature"===e.editType){var r=n.features[0].geometry.coordinates;t.props.selectionType===P.RECTANGLE?t._selectRectangleObjects(r):t.props.selectionType===P.POLYGON&&t._selectPolygonObjects(r)}}},i)))];if(e){var a=e.bigPolygon;s.push(new o.PolygonLayer(this.getSubLayerProps({id:O,pickable:!0,stroked:!1,opacity:1,data:[a],getLineColor:function(t){return[0,0,0,1]},getFillColor:function(t){return[0,0,0,1]},getPolygon:function(t){return t.geometry.coordinates}})))}return s}},{key:"shouldUpdateState",value:function(t){var e=t.changeFlags,n=e.stateChanged,r=e.propsOrDataChanged;return n||r}}])&&v(n.prototype,r),h}(i.CompositeLayer);e.default=L,S(L,"layerName","SelectionLayer"),S(L,"defaultProps",M)},7673:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null},r={name:"outline",vs:"attribute float instanceZLevel;\nvarying float outline_vzLevel;\nvarying vec4 outline_vPosition;\n\n// Set the z level for the outline shadowmap rendering\nvoid outline_setZLevel(float zLevel) {\n  outline_vzLevel = zLevel;\n}\n\n// Store an adjusted position for texture2DProj\nvoid outline_setUV(vec4 position) {\n  // mat4(\n  //   0.5, 0.0, 0.0, 0.0,\n  //   0.0, 0.5, 0.0, 0.0,\n  //   0.0, 0.0, 0.5, 0.0,\n  //   0.5, 0.5, 0.5, 1.0\n  // ) * position;\n  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);\n}\n",fs:"uniform bool outline_uEnabled;\nuniform bool outline_uRenderOutlines;\nuniform sampler2D outline_uShadowmap;\n\nvarying float outline_vzLevel;\n// varying vec2 outline_vUV;\nvarying vec4 outline_vPosition;\n\nconst float OUTLINE_Z_LEVEL_ERROR = 0.01;\n\n// Return a darker color in shadowmap\nvec4 outline_filterShadowColor(vec4 color) {\n  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);\n}\n\n// Return a darker color if in shadowmap\nvec4 outline_filterDarkenColor(vec4 color) {\n  if (outline_uEnabled) {\n    float maxZLevel;\n    if (outline_vPosition.q > 0.0) {\n      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;\n    } else {\n      discard;\n    }\n    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {\n      vec4(color.rgb * 0.5, color.a);\n    } else {\n      discard;\n    }\n  }\n  return color;\n}\n\n// if enabled and rendering outlines - Render depth to shadowmap\n// if enabled and rendering colors - Return a darker color if in shadowmap\n// if disabled, just return color\nvec4 outline_filterColor(vec4 color) {\n  if (outline_uEnabled) {\n    return outline_uRenderOutlines ?\n      outline_filterShadowColor(color) :\n      outline_filterDarkenColor(color);\n  }\n  return color;\n}\n",getUniforms:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,e=t.outlineEnabled,r=t.outlineRenderShadowmap,i=t.outlineShadowmap,o={};return void 0!==e&&(o.outline_uEnabled=e),void 0!==r&&(o.outline_uRenderOutlines=r),void 0!==i&&(o.outline_uShadowmap=i),o}};e.default=r},1399:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_ARROWS=e.DEFAULT_ARROWS=e.ArrowStyles=void 0,e.ArrowStyles={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3},e.DEFAULT_ARROWS=1,e.MAX_ARROWS=3},9545:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toDeckColor=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[255,0,0,255];return Array.isArray(t)?[255*t[0],255*t[1],255*t[2],255*t[3]]:e},e.recursivelyTraverseNestedArrays=function t(e,n,r){if(!Array.isArray(e[0]))return!0;for(var i=0;i<e.length;i++)if(t(e[i],[].concat(function(t){if(Array.isArray(t))return h(t)}(o=n)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(o)||l(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[i]),r)){r(e,n);break}var o;return!1},e.generatePointsParallelToLinePoints=function(t,e,n){var a={type:"LineString",coordinates:[t,e]},u=(0,s.point)(n),c=(0,o.default)(u,a),l=(0,i.default)(t,e),h=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0])<0?l-90:l-270,A=(0,r.default)(e,c,h),f=(0,r.default)(t,c,h);return[A.geometry.coordinates,f.geometry.coordinates]},e.distance2d=A,e.mix=f,e.nearestPointOnProjectedLine=function(t,e,n){var r=new a.default(n),i=t.geometry.coordinates.map((function(t){var e=c(t,3),n=e[0],i=e[1],o=e[2],s=void 0===o?0:o;return r.project([n,i,s])})),o=c(r.project(e.geometry.coordinates),2),s=o[0],u=o[1],l=1/0,h={};i.forEach((function(t,e){var n=c(t,2),r=n[0],o=n[1];if(0!==e){var a=c(i[e-1],2),A=a[0],f=a[1],p=f-o,d=r-A,g=A*o-r*f,y=p*p+d*d,m=Math.abs(p*s+d*u+g)/Math.sqrt(y);m<l&&(l=m,h={index:e,x0:(d*(d*s-p*u)-p*g)/y,y0:(p*(-d*s+p*u)-d*g)/y})}}));var p=h,d=p.index,g=p.x0,y=p.y0,m=c(i[d-1],3),_=m[0],v=m[1],b=m[2],w=void 0===b?0:b,E=c(i[d],3),x=E[0],S=E[1],P=E[2],T=void 0===P?0:P,C=A(_,v,x,S),M=f(w,T,A(_,v,g,y)/C);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([g,y,M])},properties:{dist:l,index:d-1}}};var r=u(n(3737)),i=u(n(1208)),o=u(n(3892)),s=n(4102),a=u(n(4235));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function A(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function f(t,e,n){return e*n+t*(1-n)}},8295:(t,e,n)=>{"use strict";function r(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}n.d(e,{Z:()=>o});class i{constructor(t,e){this.name=t,this.type=e,this.sampleSize=1,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=r(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(r()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class o{constructor({id:t,stats:e}){this.id=t,this.stats={},this._initializeStats(e),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(t=[]){t.forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof i?t:new i(e,n)),this.stats[e]}}},5913:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1208)),o=r(n(3737)),s=r(n(1013)),a=n(4102),u=n(611);e.default=function(t,e,n){void 0===n&&(n={});for(var r=u.getGeom(t).coordinates,c=0,l=0;l<r.length&&!(e>=c&&l===r.length-1);l++){if(c>=e){var h=e-c;if(h){var A=i.default(r[l],r[l-1])-180;return o.default(r[l],h,A,n)}return a.point(r[l])}c+=s.default(r[l],r[l+1],n)}return a.point(r[r.length-1])}},1070:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540),i=6378137;function o(t){var e=0;if(t&&t.length>0){e+=Math.abs(s(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(s(t[n]))}return e}function s(t){var e,n,r,o,s,u,c=0,l=t.length;if(l>2){for(u=0;u<l;u++)u===l-2?(r=l-2,o=l-1,s=0):u===l-1?(r=l-1,o=0,s=1):(r=u,o=u+1,s=u+2),e=t[r],n=t[o],c+=(a(t[s][0])-a(e[0]))*Math.sin(a(n[1]));c=c*i*i/2}return c}function a(t){return t*Math.PI/180}e.default=function(t){return r.geomReduce(t,(function(t,e){return t+function(t){var e,n=0;switch(t.type){case"Polygon":return o(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)n+=o(t.coordinates[e]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}},3652:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=Number(t[0]),i=Number(t[1]),o=Number(t[2]),s=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,i],u=[n,s],c=[o,s],l=[o,i];return r.polygon([[a,l,c,u,a]],e.properties,{bbox:t,id:e.id})}},9705:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540);function i(t){var e=[1/0,1/0,-1/0,-1/0];return r.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}i.default=i,e.default=i},1208:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function t(e,n,o){if(void 0===o&&(o={}),!0===o.final)return function(e,n){var r=t(n,e);return(r+180)%360}(e,n);var s=i.getCoord(e),a=i.getCoord(n),u=r.degreesToRadians(s[0]),c=r.degreesToRadians(a[0]),l=r.degreesToRadians(s[1]),h=r.degreesToRadians(a[1]),A=Math.sin(c-u)*Math.cos(h),f=Math.cos(l)*Math.sin(h)-Math.sin(l)*Math.cos(h)*Math.cos(c-u);return r.radiansToDegrees(Math.atan2(A,f))}},3809:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611);e.default=function(t){for(var e,n,i=r.getCoords(t),o=0,s=1;s<i.length;)e=n||i[0],o+=((n=i[s])[0]-e[0])*(n[1]+e[1]),s++;return o>0}},8147:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611);function i(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],u=e[o][0],c=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+c*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!n;a>t[1]!=c>t[1]&&t[0]<(u-s)*(t[1]-a)/(c-a)+s&&(r=!r)}return r}e.default=function(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var o=r.getCoord(t),s=r.getGeom(e),a=s.type,u=e.bbox,c=s.coordinates;if(u&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(o,u))return!1;"Polygon"===a&&(c=[c]);for(var l=!1,h=0;h<c.length&&!l;h++)if(i(o,c[h][0],n.ignoreBoundary)){for(var A=!1,f=1;f<c[h].length&&!A;)i(o,c[h][f],!n.ignoreBoundary)&&(A=!0),f++;A||(l=!0)}return l}},5419:(t,e,n)=>{"use strict";var r=n(8230),i=n(675),o=n(1540),s=n(1688),a=n(4102);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c=u(r);function l(t,e,n){var r=(n=n||{}).units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var s=[];switch(t.type){case"GeometryCollection":return o.geomEach(t,(function(t){var n=h(t,e,r,i);n&&s.push(n)})),a.featureCollection(s);case"FeatureCollection":return o.featureEach(t,(function(t){var n=h(t,e,r,i);n&&o.featureEach(n,(function(t){t&&s.push(t)}))})),a.featureCollection(s)}return h(t,e,r,i)}function h(t,e,n,r){var u=t.properties||{},l="Feature"===t.type?t.geometry:t;if("GeometryCollection"===l.type){var d=[];return o.geomEach(t,(function(t){var i=h(t,e,n,r);i&&d.push(i)})),a.featureCollection(d)}var g=function(t){var e=c.default(t).geometry.coordinates,n=[-e[0],-e[1]];return s.geoAzimuthalEquidistant().rotate(n).scale(a.earthRadius)}(l),y={type:l.type,coordinates:f(l.coordinates,g)},m=(new i.GeoJSONReader).read(y),_=a.radiansToLength(a.lengthToRadians(e,n),"meters"),v=i.BufferOp.bufferOp(m,_,r);if(!A((v=(new i.GeoJSONWriter).write(v)).coordinates)){var b={type:v.type,coordinates:p(v.coordinates,g)};return a.feature(b,u)}}function A(t){return Array.isArray(t[0])?A(t[0]):isNaN(t[0])}function f(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return f(t,e)}))}function p(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return p(t,e)}))}t.exports=l,t.exports.default=l},8230:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(9705)),o=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=i.default(t),r=(n[0]+n[2])/2,s=(n[1]+n[3])/2;return o.point([r,s],e.properties,e)}},6338:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1540),i=n(4102);e.default=function(t,e){void 0===e&&(e={});var n=0,o=0,s=0;return r.coordEach(t,(function(t){n+=t[0],o+=t[1],s++}),!0),i.point([n/s,o/s],e.properties)}},265:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(3737)),o=n(4102);e.default=function(t,e,n){void 0===n&&(n={});for(var r=n.steps||64,s=n.properties?n.properties:!Array.isArray(t)&&"Feature"===t.type&&t.properties?t.properties:{},a=[],u=0;u<r;u++)a.push(i.default(t,e,-360*u/r,n).geometry.coordinates);return a.push(a[0]),o.polygon([a],s)}},6565:(t,e)=>{"use strict";function n(t){var e={type:"Feature"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}})),e.properties=r(t.properties),e.geometry=i(t.geometry),e}function r(t){var e={};return t?(Object.keys(t).forEach((function(n){var i=t[n];"object"==typeof i?null===i?e[n]=null:Array.isArray(i)?e[n]=i.map((function(t){return t})):e[n]=r(i):e[n]=i})),e):e}function i(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?(e.geometries=t.geometries.map((function(t){return i(t)})),e):(e.coordinates=o(t.coordinates),e)}function o(t){var e=t;return"object"!=typeof e[0]?e.slice():e.map((function(t){return o(t)}))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return n(t);case"FeatureCollection":return function(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach((function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}})),e.features=t.features.map((function(t){return n(t)})),e}(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return i(t);default:throw new Error("unknown GeoJSON type")}}},3737:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n,o){void 0===o&&(o={});var s=i.getCoord(t),a=r.degreesToRadians(s[0]),u=r.degreesToRadians(s[1]),c=r.degreesToRadians(n),l=r.lengthToRadians(e,o.units),h=Math.asin(Math.sin(u)*Math.cos(l)+Math.cos(u)*Math.sin(l)*Math.cos(c)),A=a+Math.atan2(Math.sin(c)*Math.sin(l)*Math.cos(u),Math.cos(l)-Math.sin(u)*Math.sin(h)),f=r.radiansToDegrees(A),p=r.radiansToDegrees(h);return r.point([f,p],o.properties)}},8727:(t,e,n)=>{"use strict";var r=n(2676),i=n(4102),o=n(611);function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var a=s(r);function u(t,e){var n=o.getGeom(t),r=o.getGeom(e),s=t.properties||{},u=a.default.difference(n.coordinates,r.coordinates);return 0===u.length?null:1===u.length?i.polygon(u[0],s):i.multiPolygon(u,s)}t.exports=u,t.exports.default=u},1013:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(611),i=n(4102);e.default=function(t,e,n){void 0===n&&(n={});var o=r.getCoord(t),s=r.getCoord(e),a=i.degreesToRadians(s[1]-o[1]),u=i.degreesToRadians(s[0]-o[0]),c=i.degreesToRadians(o[1]),l=i.degreesToRadians(s[1]),h=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(c)*Math.cos(l);return i.radiansToLength(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),n.units)}},1211:(t,e,n)=>{"use strict";var r=n(4102),i=n(2054),o=n(67),s=n(611);function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u=a(i),c=a(o);function l(t,e,n,i){var o=(i=i||{}).steps||64,a=i.units||"kilometers",l=i.angle||0,A=i.pivot||t,f=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!r.isObject(i))throw new Error("options must be an object");if(!r.isNumber(o))throw new Error("steps must be a number");if(!r.isNumber(l))throw new Error("angle must be a number");var p=s.getCoord(t);if("degrees"===a)var d=r.degreesToRadians(l);else e=u.default(t,e,90,{units:a}),n=u.default(t,n,0,{units:a}),e=s.getCoord(e)[0]-p[0],n=s.getCoord(n)[1]-p[1];for(var g=[],y=0;y<o;y+=1){var m=-360*y/o,_=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(h(m),2)),v=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(h(m),2));if(m<-90&&m>=-270&&(_=-_),m<-180&&m>=-360&&(v=-v),"degrees"===a){var b=_*Math.cos(d)+v*Math.sin(d),w=v*Math.cos(d)-_*Math.sin(d);_=b,v=w}g.push([_+p[0],v+p[1]])}return g.push(g[0]),"degrees"===a?r.polygon([g],f):c.default(r.polygon([g],f),l,{pivot:A})}function h(t){var e=t*Math.PI/180;return Math.tan(e)}t.exports=l,t.exports.default=l},4102:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function r(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!f(t[0])||!f(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,r)}function i(t,e,r){void 0===r&&(r={});for(var i=0,o=t;i<o.length;i++){var s=o[i];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,r)}function o(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:t},e,r)}function c(t,e,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:t},e,r)}function l(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t*r}function h(t,n){void 0===n&&(n="kilometers");var r=e.factors[n];if(!r)throw new Error(n+" units is invalid");return t/r}function A(t){return t%(2*Math.PI)*180/Math.PI}function f(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return r(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return i(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},e.point=r,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.polygon=i,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=u,e.multiPolygon=c,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=l,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return A(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=A,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return l(h(t,e),n)},e.convertArea=function(t,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("area must be a positive number");var i=e.areaFactors[n];if(!i)throw new Error("invalid original units");var o=e.areaFactors[r];if(!o)throw new Error("invalid final units");return t/i*o},e.isNumber=f,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!f(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},4170:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102),o=n(611),s=r(n(2676));e.default=function(t,e,n){void 0===n&&(n={});var r=o.getGeom(t),a=o.getGeom(e),u=s.default.intersection(r.coordinates,a.coordinates);return 0===u.length?null:1===u.length?i.polygon(u[0],n.properties):i.multiPolygon(u,n.properties)}},611:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&r.isNumber(e[0])&&r.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},3663:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4102),o=n(611),s=r(n(4590)),a=n(1540),u=r(n(1787));function c(t,e){var n=o.getCoords(t),r=o.getCoords(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==r.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var s=n[0][0],a=n[0][1],u=n[1][0],c=n[1][1],l=r[0][0],h=r[0][1],A=r[1][0],f=r[1][1],p=(f-h)*(u-s)-(A-l)*(c-a);if(0===p)return null;var d=((A-l)*(a-h)-(f-h)*(s-l))/p,g=((u-s)*(a-h)-(c-a)*(s-l))/p;if(d>=0&&d<=1&&g>=0&&g<=1){var y=s+d*(u-s),m=a+d*(c-a);return i.point([y,m])}return null}e.default=function(t,e){var n={},r=[];if("LineString"===t.type&&(t=i.feature(t)),"LineString"===e.type&&(e=i.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var l=c(t,e);return l&&r.push(l),i.featureCollection(r)}var h=u.default();return h.load(s.default(e)),a.featureEach(s.default(t),(function(t){a.featureEach(h.search(t),(function(e){var i=c(t,e);if(i){var s=o.getCoords(i).join(",");n[s]||(n[s]=!0,r.push(i))}}))})),i.featureCollection(r)}},4590:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611),o=n(1540);e.default=function(t){if(!t)throw new Error("geojson is required");var e=[];return o.flattenEach(t,(function(t){!function(t,e){var n=[],o=t.geometry;if(null!==o){switch(o.type){case"Polygon":n=i.getCoords(o);break;case"LineString":n=[i.getCoords(o)]}n.forEach((function(n){(function(t,e){var n=[];return t.reduce((function(t,i){var o,s,a,u,c,l,h=r.lineString([t,i],e);return h.bbox=(s=i,a=(o=t)[0],u=o[1],[a<(c=s[0])?a:c,u<(l=s[1])?u:l,a>c?a:c,u>l?u:l]),n.push(h),i})),n})(n,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),r.featureCollection(e)}},1540:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102);function i(t,e,n){if(null!==t)for(var r,o,s,a,u,c,l,h,A=0,f=0,p=t.type,d="FeatureCollection"===p,g="Feature"===p,y=d?t.features.length:1,m=0;m<y;m++){u=(h=!!(l=d?t.features[m].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var _=0;_<u;_++){var v=0,b=0;if(null!==(a=h?l.geometries[_]:l)){c=a.coordinates;var w=a.type;switch(A=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(c,f,m,v,b))return!1;f++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(!1===e(c[r],f,m,v,b))return!1;f++,"MultiPoint"===w&&v++}"LineString"===w&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(o=0;o<c[r].length-A;o++){if(!1===e(c[r][o],f,m,v,b))return!1;f++}"MultiLineString"===w&&v++,"Polygon"===w&&b++}"Polygon"===w&&v++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(b=0,o=0;o<c[r].length;o++){for(s=0;s<c[r][o].length-A;s++){if(!1===e(c[r][o][s],f,m,v,b))return!1;f++}b++}v++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(!1===i(a.geometries[r],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,r,i,o,s,a,u,c,l,h,A=0,f="FeatureCollection"===t.type,p="Feature"===t.type,d=f?t.features.length:1;for(n=0;n<d;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,c=f?t.features[n].properties:p?t.properties:{},l=f?t.features[n].bbox:p?t.bbox:void 0,h=f?t.features[n].id:p?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,i=0;i<s;i++)if(null!==(o=u?a.geometries[i]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,A,c,l,h))return!1;break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(!1===e(o.geometries[r],A,c,l,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,A,c,l,h))return!1;A++}}function u(t,e){a(t,(function(t,n,i,o,s){var a,u=null===t?null:t.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==e(r.feature(t,i,{bbox:o,id:s}),n,0)&&void 0}switch(u){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var c=0;c<t.coordinates.length;c++){var l={type:a,coordinates:t.coordinates[c]};if(!1===e(r.feature(l,i),n,c))return!1}}))}function c(t,e){u(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var u,c=0,l=0,h=0;return!1!==i(t,(function(i,a,A,f,p){if(void 0===u||n>c||f>l||p>h)return u=i,c=n,l=f,h=p,void(s=0);var d=r.lineString([u,i],t.properties);if(!1===e(d,n,o,p,s))return!1;s++,u=i}))&&void 0}}}))}function l(t,e){if(!t)throw new Error("geojson is required");u(t,(function(t,n,i){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,i,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(r.lineString(s[a],t.properties),n,i,a))return!1}}}))}e.coordAll=function(t){var e=[];return i(t,(function(t){e.push(t)})),e},e.coordEach=i,e.coordReduce=function(t,e,n,r){var o=n;return i(t,(function(t,r,i,s,a){o=0===r&&void 0===n?t:e(o,t,r,i,s,a)}),r),o},e.featureEach=s,e.featureReduce=function(t,e,n){var r=n;return s(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.findPoint=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":u=u||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return r.point(c,u,e);case"MultiPoint":return o<0&&(o=c.length+o),r.point(c[o],u,e);case"LineString":return a<0&&(a=c.length+a),r.point(c[a],u,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),r.point(c[s][a],u,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a),r.point(c[o][a],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a),r.point(c[o][s][a],u,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!r.isObject(e))throw new Error("options is invalid");var n,i=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,u=e.properties;switch(t.type){case"FeatureCollection":i<0&&(i=t.features.length+i),u=u||t.features[i].properties,n=t.features[i].geometry;break;case"Feature":u=u||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),r.lineString([c[a],c[a+1]],u,e);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),r.lineString([c[s][a],c[s][a+1]],u,e);case"MultiLineString":return o<0&&(o=c.length+o),a<0&&(a=c[o].length+a-1),r.lineString([c[o][a],c[o][a+1]],u,e);case"MultiPolygon":return o<0&&(o=c.length+o),s<0&&(s=c[o].length+s),a<0&&(a=c[o][s].length-a-1),r.lineString([c[o][s][a],c[o][s][a+1]],u,e)}throw new Error("geojson is invalid")},e.flattenEach=u,e.flattenReduce=function(t,e,n){var r=n;return u(t,(function(t,i,o){r=0===i&&0===o&&void 0===n?t:e(r,t,i,o)})),r},e.geomEach=a,e.geomReduce=function(t,e,n){var r=n;return a(t,(function(t,i,o,s,a){r=0===i&&void 0===n?t:e(r,t,i,o,s,a)})),r},e.lineEach=l,e.lineReduce=function(t,e,n){var r=n;return l(t,(function(t,i,o,s){r=0===i&&void 0===n?t:e(r,t,i,o,s)})),r},e.propEach=o,e.propReduce=function(t,e,n){var r=n;return o(t,(function(t,i){r=0===i&&void 0===n?t:e(r,t,i)})),r},e.segmentEach=c,e.segmentReduce=function(t,e,n){var r=n,i=!1;return c(t,(function(t,o,s,a,u){r=!1===i&&void 0===n?t:e(r,t,o,s,a,u),i=!0})),r}},3807:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1208)),o=r(n(1013)),s=r(n(3737)),a=r(n(3663)),u=n(1540),c=n(4102),l=n(611);e.default=function(t,e,n){void 0===n&&(n={});var r=c.point([1/0,1/0],{dist:1/0}),h=0;return u.flattenEach(t,(function(t){for(var u=l.getCoords(t),A=0;A<u.length-1;A++){var f=c.point(u[A]);f.properties.dist=o.default(e,f,n);var p=c.point(u[A+1]);p.properties.dist=o.default(e,p,n);var d=o.default(f,p,n),g=Math.max(f.properties.dist,p.properties.dist),y=i.default(f,p),m=s.default(e,g,y+90,n),_=s.default(e,g,y-90,n),v=a.default(c.lineString([m.geometry.coordinates,_.geometry.coordinates]),c.lineString([f.geometry.coordinates,p.geometry.coordinates])),b=null;v.features.length>0&&((b=v.features[0]).properties.dist=o.default(e,b,n),b.properties.location=h+o.default(f,b,n)),f.properties.dist<r.properties.dist&&((r=f).properties.index=A,r.properties.location=h),p.properties.dist<r.properties.dist&&((r=p).properties.index=A+1,r.properties.location=h+d),b&&b.properties.dist<r.properties.dist&&((r=b).properties.index=A),h+=d}})),r}},3892:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(1013)),o=n(4102),s=n(611),a=n(1540),u=r(n(6213));function c(t,e){return t[0]*e[0]+t[1]*e[1]}function l(t,e,n){return"planar"===n.method?u.default(t,e,n):i.default(t,e,n)}e.default=function(t,e,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=o.point(t):"Point"===t.type?t=o.feature(t):s.featureOf(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=o.lineString(e):"LineString"===e.type?e=o.feature(e):s.featureOf(e,"LineString","line");var r=1/0,i=t.geometry.coordinates;return a.segmentEach(e,(function(t){var e=t.geometry.coordinates[0],o=t.geometry.coordinates[1],s=function(t,e,n,r){var i=[n[0]-e[0],n[1]-e[1]],o=c([t[0]-e[0],t[1]-e[1]],i);if(o<=0)return l(t,e,{method:r.method,units:"degrees"});var s=c(i,i);if(s<=o)return l(t,n,{method:r.method,units:"degrees"});var a=o/s;return l(t,[e[0]+a*i[0],e[1]+a*i[1]],{method:r.method,units:"degrees"})}(i,e,o,n);s<r&&(r=s)})),o.convertLength(r,"degrees",n.units)}},7383:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);function o(t,e){return void 0===e&&(e={}),a(i.getGeom(t).coordinates,e.properties?e.properties:"Feature"===t.type?t.properties:{})}function s(t,e){void 0===e&&(e={});var n=i.getGeom(t).coordinates,o=e.properties?e.properties:"Feature"===t.type?t.properties:{},s=[];return n.forEach((function(t){s.push(a(t,o))})),r.featureCollection(s)}function a(t,e){return t.length>1?r.multiLineString(t,e):r.lineString(t[0],e)}e.default=function(t,e){void 0===e&&(e={});var n=i.getGeom(t);switch(e.properties||"Feature"!==t.type||(e.properties=t.properties),n.type){case"Polygon":return o(n,e);case"MultiPolygon":return s(n,e);default:throw new Error("invalid poly")}},e.polygonToLine=o,e.multiPolygonToLine=s,e.coordsToLine=a},1138:(t,e,n)=>{"use strict";var r=n(6565),i=n(3809),o=n(1540),s=n(611),a=n(4102);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c=u(r),l=u(i);function h(t,e){if(e=e||{},!a.isObject(e))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof r)throw new Error("<mutate> must be a boolean");!1===r&&(t=c.default(t));var i=[];switch(t.type){case"GeometryCollection":return o.geomEach(t,(function(t){A(t,n)})),t;case"FeatureCollection":return o.featureEach(t,(function(t){o.featureEach(A(t,n),(function(t){i.push(t)}))})),a.featureCollection(i)}return A(t,n)}function A(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return o.geomEach(t,(function(t){A(t,e)})),t;case"LineString":return f(s.getCoords(t),e),t;case"Polygon":return p(s.getCoords(t),e),t;case"MultiLineString":return s.getCoords(t).forEach((function(t){f(t,e)})),t;case"MultiPolygon":return s.getCoords(t).forEach((function(t){p(t,e)})),t;case"Point":case"MultiPoint":return t}}function f(t,e){l.default(t)===e&&t.reverse()}function p(t,e){l.default(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)l.default(t[n])===e&&t[n].reverse()}t.exports=h,t.exports.default=h},6912:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);function o(t,e){var n=r.degreesToRadians(t[1]),i=r.degreesToRadians(e[1]),o=r.degreesToRadians(e[0]-t[0]);o>Math.PI&&(o-=2*Math.PI),o<-Math.PI&&(o+=2*Math.PI);var s=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),a=Math.atan2(o,s);return(r.radiansToDegrees(a)+360)%360}e.default=function(t,e,n){var r;return void 0===n&&(n={}),(r=n.final?o(i.getCoord(e),i.getCoord(t)):o(i.getCoord(t),i.getCoord(e)))>180?-(360-r):r}},2054:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n,o){void 0===o&&(o={});var s=e<0,a=r.convertLength(Math.abs(e),o.units,"meters");s&&(a=-Math.abs(a));var u=i.getCoord(t),c=function(t,e,n,i){var o=e/(i=void 0===i?r.earthRadius:Number(i)),s=t[0]*Math.PI/180,a=r.degreesToRadians(t[1]),u=r.degreesToRadians(n),c=o*Math.cos(u),l=a+c;Math.abs(l)>Math.PI/2&&(l=l>0?Math.PI-l:-Math.PI-l);var h=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),A=Math.abs(h)>1e-11?c/h:Math.cos(a);return[(180*(s+o*Math.sin(u)/A)/Math.PI+540)%360-180,180*l/Math.PI]}(u,a,n);return c[0]+=c[0]-u[0]>180?-360:u[0]-c[0]>180?360:0,r.point(c,o.properties)}},6213:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(4102),i=n(611);e.default=function(t,e,n){void 0===n&&(n={});var o=i.getCoord(t),s=i.getCoord(e);s[0]+=s[0]-o[0]>180?-360:o[0]-s[0]>180?360:0;var a=function(t,e,n){var i=n=void 0===n?r.earthRadius:Number(n),o=t[1]*Math.PI/180,s=e[1]*Math.PI/180,a=s-o,u=Math.abs(e[0]-t[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var c=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),l=Math.abs(c)>1e-11?a/c:Math.cos(o);return Math.sqrt(a*a+l*l*u*u)*i}(o,s);return r.convertLength(a,"meters",n.units)}},67:(t,e,n)=>{"use strict";var r=n(6338),i=n(6912),o=n(6213),s=n(2054),a=n(6565),u=n(1540),c=n(611),l=n(4102);function h(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var A=h(r),f=h(i),p=h(o),d=h(s),g=h(a);function y(t,e,n){if(n=n||{},!l.isObject(n))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("angle is required");return 0===e||(r||(r=A.default(t)),!1!==i&&void 0!==i||(t=g.default(t)),u.coordEach(t,(function(t){var n=f.default(r,t)+e,i=p.default(r,t),o=c.getCoords(d.default(r,i,n));t[0]=o[0],t[1]=o[1]}))),t}t.exports=y,t.exports.default=y},7517:(t,e,n)=>{"use strict";var r=n(6565),i=n(8230),o=n(6338),s=n(9705),a=n(6912),u=n(6213),c=n(2054),l=n(1540),h=n(4102),A=n(611);function f(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var p=f(r),d=f(i),g=f(o),y=f(s),m=f(a),_=f(u),v=f(c);function b(t,e,n){if(n=n||{},!h.isObject(n))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!t)throw new Error("geojson required");if("number"!=typeof e||0===e)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==i&&(t=p.default(t)),"FeatureCollection"!==t.type||o?w(t,e,r):(l.featureEach(t,(function(n,i){t.features[i]=w(n,e,r)})),t)}function w(t,e,n){var r="Point"===A.getType(t);return n=function(t,e){if(null==e&&(e="centroid"),Array.isArray(e)||"object"==typeof e)return A.getCoord(e);var n=t.bbox?t.bbox:y.default(t),r=n[0],i=n[1],o=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return h.point([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return h.point([o,i]);case"nw":case"northwest":case"westnorth":case"topleft":return h.point([r,s]);case"ne":case"northeast":case"eastnorth":case"topright":return h.point([o,s]);case"center":return d.default(t);case void 0:case null:case"centroid":return g.default(t);default:throw new Error("invalid origin")}}(t,n),1===e||r||l.coordEach(t,(function(t){var r=_.default(n,t),i=m.default(n,t),o=r*e,s=A.getCoords(v.default(n,o,i));t[0]=s[0],t[1]=s[1],3===t.length&&(t[2]*=e)})),t}t.exports=b,t.exports.default=b},2418:(t,e,n)=>{"use strict";var r=n(1540),i=n(4102),o=n(611),s=n(6565),a=n(2054);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c=u(s),l=u(a);function h(t,e,n,s){if(s=s||{},!i.isObject(s))throw new Error("options is invalid");var a=s.units,u=s.zTranslation,h=s.mutate;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");if(u&&"number"!=typeof u&&isNaN(u))throw new Error("zTranslation is not a number");if(u=void 0!==u?u:0,0===e&&0===u)return t;if(null==n||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n+=180),!1!==h&&void 0!==h||(t=c.default(t)),r.coordEach(t,(function(t){var r=o.getCoords(l.default(t,e,n,{units:a}));t[0]=r[0],t[1]=r[1],u&&3===t.length&&(t[2]+=u)})),t}t.exports=h,t.exports.default=h},1959:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(n(2676)),o=n(611),s=n(4102);e.default=function(t,e,n){void 0===n&&(n={});var r=o.getGeom(t),a=o.getGeom(e),u=i.default.union(r.coordinates,a.coordinates);return 0===u.length?null:1===u.length?s.polygon(u[0],n.properties):s.multiPolygon(u,n.properties)}},5107:(t,e,n)=>{(e=n(3645)(!1)).push([t.id,'\n\n\n.picker {\n  position: relative !important;\n}\n\n.btn-picker {\n  padding: 3px 6px;\n  color: #333;\n  background-color: #fff;\n  border: 1px solid #ddd;\n\n}\n\n.btn-picker.active {\n  color: #333;\n  background-color: #e6e6e6;\n  background-image: none;\n  border-color: #adadad;\n}\n\n.picker-widget-ctrl {\n  font: 12px/20px "Helvetica Neue", Arial, sans-serif;\n}\n\n\n\n.picker-widget-ctrl-group {\n  position: absolute;\n  pointer-events: none;\n  z-index: 2;\n  opacity: 0.5;\n  transition: opacity 0.2s ease-out;\n}\n\n.picker-widget-ctrl-group:hover {\n  opacity: 1;\n  transition: opacity 0.1s ease-in;\n}\n\n.picker-widget-ctrl {\n  background: transparent;\n  padding: 0px;\n  pointer-events: all;\n  cursor: auto;\n}\n\n.picker-widget-ctrl-top-left { top: 10px; left: 10px; }\n.picker-widget-ctrl-top-right { top: 10px; right: 10px; }\n.picker-widget-ctrl-bottom-left { bottom: 10px; left: 10px; }\n.picker-widget-ctrl-bottom-right { bottom: 10px; right: 10px; }\n\n.legend ul {\n  padding: 0;\n  margin-bottom: 0;\n}\n\n.legend li {\n  list-style-type: none;\n  margin: 0 0 8px 0;\n  display: flex;\n  vertical-align: middle;\n}\n',""]),t.exports=e},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n,r,i,o=t[1]||"",s=t[3];if(!s)return o;if(e&&"function"==typeof btoa){var a=(n=s,r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),"/*# ".concat(i," */")),u=s.sources.map((function(t){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(t," */")}));return[o].concat(u).concat([a]).join("\n")}return[o].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<t.length;a++){var u=[].concat(t[a]);r&&i[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),e.push(u))}},e}},1688:(t,e,n)=>{"use strict";function r(){return new i}function i(){this.reset()}n.r(e),n.d(e,{geoAlbers:()=>vr,geoAlbersUsa:()=>br,geoArea:()=>X,geoAzimuthalEqualArea:()=>Sr,geoAzimuthalEqualAreaRaw:()=>xr,geoAzimuthalEquidistant:()=>Tr,geoAzimuthalEquidistantRaw:()=>Pr,geoBounds:()=>Ut,geoCentroid:()=>te,geoCircle:()=>he,geoClipExtent:()=>xe,geoConicConformal:()=>Lr,geoConicConformalRaw:()=>Rr,geoConicEqualArea:()=>_r,geoConicEqualAreaRaw:()=>mr,geoConicEquidistant:()=>kr,geoConicEquidistantRaw:()=>Fr,geoContains:()=>We,geoDistance:()=>Be,geoEquirectangular:()=>Dr,geoEquirectangularRaw:()=>Nr,geoGnomonic:()=>jr,geoGnomonicRaw:()=>Br,geoGraticule:()=>Qe,geoGraticule10:()=>Ke,geoIdentity:()=>zr,geoInterpolate:()=>Je,geoLength:()=>De,geoMercator:()=>Mr,geoMercatorRaw:()=>Cr,geoNaturalEarth1:()=>Vr,geoNaturalEarth1Raw:()=>Gr,geoOrthographic:()=>Hr,geoOrthographicRaw:()=>Zr,geoPath:()=>er,geoProjection:()=>dr,geoProjectionMutator:()=>gr,geoRotation:()=>ue,geoStereographic:()=>Wr,geoStereographicRaw:()=>qr,geoStream:()=>D,geoTransform:()=>ar,geoTransverseMercator:()=>Yr,geoTransverseMercatorRaw:()=>Xr}),i.prototype={constructor:i,reset:function(){this.s=this.t=0},add:function(t){s(o,t,this.t),s(this,o.s,this.s),this.s?this.t+=o.t:this.s=o.t},valueOf:function(){return this.s}};var o=new i;function s(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var a=1e-6,u=Math.PI,c=u/2,l=u/4,h=2*u,A=180/u,f=u/180,p=Math.abs,d=Math.atan,g=Math.atan2,y=Math.cos,m=Math.ceil,_=Math.exp,v=(Math.floor,Math.log),b=Math.pow,w=Math.sin,E=Math.sign||function(t){return t>0?1:t<0?-1:0},x=Math.sqrt,S=Math.tan;function P(t){return t>1?0:t<-1?u:Math.acos(t)}function T(t){return t>1?c:t<-1?-c:Math.asin(t)}function C(t){return(t=w(t/2))*t}function M(){}function I(t,e){t&&R.hasOwnProperty(t.type)&&R[t.type](t,e)}var O={Feature:function(t,e){I(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)I(n[r].geometry,e)}},R={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){L(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)L(n[r],e,0)},Polygon:function(t,e){N(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)N(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)I(n[r],e)}};function L(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function N(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)L(t[n],e,1);e.polygonEnd()}function D(t,e){t&&O.hasOwnProperty(t.type)?O[t.type](t,e):I(t,e)}var F,k,B,j,U,z=r(),G=r(),V={point:M,lineStart:M,lineEnd:M,polygonStart:function(){z.reset(),V.lineStart=Z,V.lineEnd=H},polygonEnd:function(){var t=+z;G.add(t<0?h+t:t),this.lineStart=this.lineEnd=this.point=M},sphere:function(){G.add(h)}};function Z(){V.point=q}function H(){W(F,k)}function q(t,e){V.point=W,F=t,k=e,B=t*=f,j=y(e=(e*=f)/2+l),U=w(e)}function W(t,e){var n=(t*=f)-B,r=n>=0?1:-1,i=r*n,o=y(e=(e*=f)/2+l),s=w(e),a=U*s,u=j*o+a*y(i),c=a*r*w(i);z.add(g(c,u)),B=t,j=o,U=s}function X(t){return G.reset(),D(t,V),2*G}function Y(t){return[g(t[1],t[0]),T(t[2])]}function Q(t){var e=t[0],n=t[1],r=y(n);return[r*y(e),r*w(e),w(n)]}function K(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function J(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function $(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function tt(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function et(t){var e=x(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var nt,rt,it,ot,st,at,ut,ct,lt,ht,At,ft,pt,dt,gt,yt,mt,_t,vt,bt,wt,Et,xt,St,Pt,Tt,Ct=r(),Mt={point:It,lineStart:Rt,lineEnd:Lt,polygonStart:function(){Mt.point=Nt,Mt.lineStart=Dt,Mt.lineEnd=Ft,Ct.reset(),V.polygonStart()},polygonEnd:function(){V.polygonEnd(),Mt.point=It,Mt.lineStart=Rt,Mt.lineEnd=Lt,z<0?(nt=-(it=180),rt=-(ot=90)):Ct>a?ot=90:Ct<-a&&(rt=-90),ht[0]=nt,ht[1]=it}};function It(t,e){lt.push(ht=[nt=t,it=t]),e<rt&&(rt=e),e>ot&&(ot=e)}function Ot(t,e){var n=Q([t*f,e*f]);if(ct){var r=J(ct,n),i=J([r[1],-r[0],0],r);et(i),i=Y(i);var o,s=t-st,a=s>0?1:-1,u=i[0]*A*a,c=p(s)>180;c^(a*st<u&&u<a*t)?(o=i[1]*A)>ot&&(ot=o):c^(a*st<(u=(u+360)%360-180)&&u<a*t)?(o=-i[1]*A)<rt&&(rt=o):(e<rt&&(rt=e),e>ot&&(ot=e)),c?t<st?kt(nt,t)>kt(nt,it)&&(it=t):kt(t,it)>kt(nt,it)&&(nt=t):it>=nt?(t<nt&&(nt=t),t>it&&(it=t)):t>st?kt(nt,t)>kt(nt,it)&&(it=t):kt(t,it)>kt(nt,it)&&(nt=t)}else lt.push(ht=[nt=t,it=t]);e<rt&&(rt=e),e>ot&&(ot=e),ct=n,st=t}function Rt(){Mt.point=Ot}function Lt(){ht[0]=nt,ht[1]=it,Mt.point=It,ct=null}function Nt(t,e){if(ct){var n=t-st;Ct.add(p(n)>180?n+(n>0?360:-360):n)}else at=t,ut=e;V.point(t,e),Ot(t,e)}function Dt(){V.lineStart()}function Ft(){Nt(at,ut),V.lineEnd(),p(Ct)>a&&(nt=-(it=180)),ht[0]=nt,ht[1]=it,ct=null}function kt(t,e){return(e-=t)<0?e+360:e}function Bt(t,e){return t[0]-e[0]}function jt(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function Ut(t){var e,n,r,i,o,s,a;if(ot=it=-(nt=rt=1/0),lt=[],D(t,Mt),n=lt.length){for(lt.sort(Bt),e=1,o=[r=lt[0]];e<n;++e)jt(r,(i=lt[e])[0])||jt(r,i[1])?(kt(r[0],i[1])>kt(r[0],r[1])&&(r[1]=i[1]),kt(i[0],r[1])>kt(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(a=kt(r[1],i[0]))>s&&(s=a,nt=i[0],it=r[1])}return lt=ht=null,nt===1/0||rt===1/0?[[NaN,NaN],[NaN,NaN]]:[[nt,rt],[it,ot]]}var zt,Gt,Vt={sphere:M,point:Zt,lineStart:qt,lineEnd:Yt,polygonStart:function(){Vt.lineStart=Qt,Vt.lineEnd=Kt},polygonEnd:function(){Vt.lineStart=qt,Vt.lineEnd=Yt}};function Zt(t,e){t*=f;var n=y(e*=f);Ht(n*y(t),n*w(t),w(e))}function Ht(t,e,n){++At,pt+=(t-pt)/At,dt+=(e-dt)/At,gt+=(n-gt)/At}function qt(){Vt.point=Wt}function Wt(t,e){t*=f;var n=y(e*=f);St=n*y(t),Pt=n*w(t),Tt=w(e),Vt.point=Xt,Ht(St,Pt,Tt)}function Xt(t,e){t*=f;var n=y(e*=f),r=n*y(t),i=n*w(t),o=w(e),s=g(x((s=Pt*o-Tt*i)*s+(s=Tt*r-St*o)*s+(s=St*i-Pt*r)*s),St*r+Pt*i+Tt*o);ft+=s,yt+=s*(St+(St=r)),mt+=s*(Pt+(Pt=i)),_t+=s*(Tt+(Tt=o)),Ht(St,Pt,Tt)}function Yt(){Vt.point=Zt}function Qt(){Vt.point=Jt}function Kt(){$t(Et,xt),Vt.point=Zt}function Jt(t,e){Et=t,xt=e,t*=f,e*=f,Vt.point=$t;var n=y(e);St=n*y(t),Pt=n*w(t),Tt=w(e),Ht(St,Pt,Tt)}function $t(t,e){t*=f;var n=y(e*=f),r=n*y(t),i=n*w(t),o=w(e),s=Pt*o-Tt*i,a=Tt*r-St*o,u=St*i-Pt*r,c=x(s*s+a*a+u*u),l=T(c),h=c&&-l/c;vt+=h*s,bt+=h*a,wt+=h*u,ft+=l,yt+=l*(St+(St=r)),mt+=l*(Pt+(Pt=i)),_t+=l*(Tt+(Tt=o)),Ht(St,Pt,Tt)}function te(t){At=ft=pt=dt=gt=yt=mt=_t=vt=bt=wt=0,D(t,Vt);var e=vt,n=bt,r=wt,i=e*e+n*n+r*r;return i<1e-12&&(e=yt,n=mt,r=_t,ft<a&&(e=pt,n=dt,r=gt),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[g(n,e)*A,T(r/x(i))*A]}function ee(t){return function(){return t}}function ne(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function re(t,e){return[t>u?t-h:t<-u?t+h:t,e]}function ie(t,e,n){return(t%=h)?e||n?ne(se(t),ae(e,n)):se(t):e||n?ae(e,n):re}function oe(t){return function(e,n){return[(e+=t)>u?e-h:e<-u?e+h:e,n]}}function se(t){var e=oe(t);return e.invert=oe(-t),e}function ae(t,e){var n=y(t),r=w(t),i=y(e),o=w(e);function s(t,e){var s=y(e),a=y(t)*s,u=w(t)*s,c=w(e),l=c*n+a*r;return[g(u*i-l*o,a*n-c*r),T(l*i+u*o)]}return s.invert=function(t,e){var s=y(e),a=y(t)*s,u=w(t)*s,c=w(e),l=c*i-u*o;return[g(u*i+c*o,a*n+l*r),T(l*n-a*r)]},s}function ue(t){function e(e){return(e=t(e[0]*f,e[1]*f))[0]*=A,e[1]*=A,e}return t=ie(t[0]*f,t[1]*f,t.length>2?t[2]*f:0),e.invert=function(e){return(e=t.invert(e[0]*f,e[1]*f))[0]*=A,e[1]*=A,e},e}function ce(t,e,n,r,i,o){if(n){var s=y(e),a=w(e),u=r*n;null==i?(i=e+r*h,o=e-u/2):(i=le(s,i),o=le(s,o),(r>0?i<o:i>o)&&(i+=r*h));for(var c,l=i;r>0?l>o:l<o;l-=u)c=Y([s,-a*y(l),-a*w(l)]),t.point(c[0],c[1])}}function le(t,e){(e=Q(e))[0]-=t,et(e);var n=P(-e[1]);return((-e[2]<0?-n:n)+h-a)%h}function he(){var t,e,n=ee([0,0]),r=ee(90),i=ee(6),o={point:function(n,r){t.push(n=e(n,r)),n[0]*=A,n[1]*=A}};function s(){var s=n.apply(this,arguments),a=r.apply(this,arguments)*f,u=i.apply(this,arguments)*f;return t=[],e=ie(-s[0]*f,-s[1]*f,0).invert,ce(o,a,u,1),s={type:"Polygon",coordinates:[t]},t=e=null,s}return s.center=function(t){return arguments.length?(n="function"==typeof t?t:ee([+t[0],+t[1]]),s):n},s.radius=function(t){return arguments.length?(r="function"==typeof t?t:ee(+t),s):r},s.precision=function(t){return arguments.length?(i="function"==typeof t?t:ee(+t),s):i},s}function Ae(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:M,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function fe(t,e){return p(t[0]-e[0])<a&&p(t[1]-e[1])<a}function pe(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function de(t,e,n,r,i){var o,s,a=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(fe(r,s)){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else a.push(n=new pe(r,t,null,!0)),u.push(n.o=new pe(r,null,n,!1)),a.push(n=new pe(s,t,null,!1)),u.push(n.o=new pe(s,null,n,!0))}})),a.length){for(u.sort(e),ge(a),ge(u),o=0,s=u.length;o<s;++o)u[o].e=n=!n;for(var c,l,h=a[0];;){for(var A=h,f=!0;A.v;)if((A=A.n)===h)return;c=A.z,i.lineStart();do{if(A.v=A.o.v=!0,A.e){if(f)for(o=0,s=c.length;o<s;++o)i.point((l=c[o])[0],l[1]);else r(A.x,A.n.x,1,i);A=A.n}else{if(f)for(c=A.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(A.x,A.p.x,-1,i);A=A.p}c=(A=A.o).z,f=!f}while(!A.v);i.lineEnd()}}}function ge(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function ye(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}re.invert=re,1===(zt=ye).length&&(Gt=zt,zt=function(t,e){return ye(Gt(t),e)});var me=Array.prototype;function _e(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--s]=r[e];return n}function ve(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}me.slice,me.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var be=1e9,we=-be;function Ee(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,u){var l=0,h=0;if(null==i||(l=s(i,a))!==(h=s(o,a))||c(i,o)<0^a>0)do{u.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+a+4)%4)!==h);else u.point(o[0],o[1])}function s(r,i){return p(r[0]-t)<a?i>0?0:3:p(r[0]-n)<a?i>0?2:1:p(r[1]-e)<a?i>0?1:0:i>0?3:2}function u(t,e){return c(t.x,e.x)}function c(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var a,c,l,h,A,f,p,d,g,y,m,_=s,v=Ae(),b={point:w,lineStart:function(){b.point=E,c&&c.push(l=[]),y=!0,g=!1,p=d=NaN},lineEnd:function(){a&&(E(h,A),f&&g&&v.rejoin(),a.push(v.result())),b.point=w,g&&_.lineEnd()},polygonStart:function(){_=v,a=[],c=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],u=1,l=a.length,h=a[0],A=h[0],f=h[1];u<l;++u)o=A,s=f,A=(h=a[u])[0],f=h[1],s<=r?f>r&&(A-o)*(r-s)>(f-s)*(t-o)&&++e:f<=r&&(A-o)*(r-s)<(f-s)*(t-o)&&--e;return e}(),n=m&&e,i=(a=_e(a)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&de(a,u,e,o,s),s.polygonEnd()),_=s,a=c=l=null}};function w(t,e){i(t,e)&&_.point(t,e)}function E(o,s){var a=i(o,s);if(c&&l.push([o,s]),y)h=o,A=s,f=a,y=!1,a&&(_.lineStart(),_.point(o,s));else if(a&&g)_.point(o,s);else{var u=[p=Math.max(we,Math.min(be,p)),d=Math.max(we,Math.min(be,d))],v=[o=Math.max(we,Math.min(be,o)),s=Math.max(we,Math.min(be,s))];!function(t,e,n,r,i,o){var s,a=t[0],u=t[1],c=0,l=1,h=e[0]-a,A=e[1]-u;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<l&&(l=s)}else if(h>0){if(s>l)return;s>c&&(c=s)}if(s=i-a,h||!(s<0)){if(s/=h,h<0){if(s>l)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<l&&(l=s)}if(s=r-u,A||!(s>0)){if(s/=A,A<0){if(s<c)return;s<l&&(l=s)}else if(A>0){if(s>l)return;s>c&&(c=s)}if(s=o-u,A||!(s<0)){if(s/=A,A<0){if(s>l)return;s>c&&(c=s)}else if(A>0){if(s<c)return;s<l&&(l=s)}return c>0&&(t[0]=a+c*h,t[1]=u+c*A),l<1&&(e[0]=a+l*h,e[1]=u+l*A),!0}}}}}(u,v,t,e,n,r)?a&&(_.lineStart(),_.point(o,s),m=!1):(g||(_.lineStart(),_.point(u[0],u[1])),_.point(v[0],v[1]),a||_.lineEnd(),m=!1)}p=o,d=s,g=a}return b}}function xe(){var t,e,n,r=0,i=0,o=960,s=500;return n={stream:function(n){return t&&e===n?t:t=Ee(r,i,o,s)(e=n)},extent:function(a){return arguments.length?(r=+a[0][0],i=+a[0][1],o=+a[1][0],s=+a[1][1],t=e=null,n):[[r,i],[o,s]]}}}var Se=r();function Pe(t,e){var n=e[0],r=e[1],i=[w(n),-y(n),0],o=0,s=0;Se.reset();for(var c=0,A=t.length;c<A;++c)if(p=(f=t[c]).length)for(var f,p,d=f[p-1],m=d[0],_=d[1]/2+l,v=w(_),b=y(_),E=0;E<p;++E,m=S,v=C,b=M,d=x){var x=f[E],S=x[0],P=x[1]/2+l,C=w(P),M=y(P),I=S-m,O=I>=0?1:-1,R=O*I,L=R>u,N=v*C;if(Se.add(g(N*O*w(R),b*M+N*y(R))),o+=L?I+O*h:I,L^m>=n^S>=n){var D=J(Q(d),Q(x));et(D);var F=J(i,D);et(F);var k=(L^I>=0?-1:1)*T(F[2]);(r>k||r===k&&(D[0]||D[1]))&&(s+=L^I>=0?1:-1)}}return(o<-a||o<a&&Se<-a)^1&s}var Te,Ce,Me,Ie=r(),Oe={sphere:M,point:M,lineStart:function(){Oe.point=Le,Oe.lineEnd=Re},lineEnd:M,polygonStart:M,polygonEnd:M};function Re(){Oe.point=Oe.lineEnd=M}function Le(t,e){Te=t*=f,Ce=w(e*=f),Me=y(e),Oe.point=Ne}function Ne(t,e){t*=f;var n=w(e*=f),r=y(e),i=p(t-Te),o=y(i),s=r*w(i),a=Me*n-Ce*r*o,u=Ce*n+Me*r*o;Ie.add(g(x(s*s+a*a),u)),Te=t,Ce=n,Me=r}function De(t){return Ie.reset(),D(t,Oe),+Ie}var Fe=[null,null],ke={type:"LineString",coordinates:Fe};function Be(t,e){return Fe[0]=t,Fe[1]=e,De(ke)}var je={Feature:function(t,e){return ze(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(ze(n[r].geometry,e))return!0;return!1}},Ue={Sphere:function(){return!0},Point:function(t,e){return Ge(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ge(n[r],e))return!0;return!1},LineString:function(t,e){return Ve(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ve(n[r],e))return!0;return!1},Polygon:function(t,e){return Ze(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Ze(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(ze(n[r],e))return!0;return!1}};function ze(t,e){return!(!t||!Ue.hasOwnProperty(t.type))&&Ue[t.type](t,e)}function Ge(t,e){return 0===Be(t,e)}function Ve(t,e){var n=Be(t[0],t[1]);return Be(t[0],e)+Be(e,t[1])<=n+a}function Ze(t,e){return!!Pe(t.map(He),qe(e))}function He(t){return(t=t.map(qe)).pop(),t}function qe(t){return[t[0]*f,t[1]*f]}function We(t,e){return(t&&je.hasOwnProperty(t.type)?je[t.type]:ze)(t,e)}function Xe(t,e,n){var r=ve(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Ye(t,e,n){var r=ve(t,e-a,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Qe(){var t,e,n,r,i,o,s,u,c,l,h,A,f=10,d=f,g=90,y=360,_=2.5;function v(){return{type:"MultiLineString",coordinates:b()}}function b(){return ve(m(r/g)*g,n,g).map(h).concat(ve(m(u/y)*y,s,y).map(A)).concat(ve(m(e/f)*f,t,f).filter((function(t){return p(t%g)>a})).map(c)).concat(ve(m(o/d)*d,i,d).filter((function(t){return p(t%y)>a})).map(l))}return v.lines=function(){return b().map((function(t){return{type:"LineString",coordinates:t}}))},v.outline=function(){return{type:"Polygon",coordinates:[h(r).concat(A(s).slice(1),h(n).reverse().slice(1),A(u).reverse().slice(1))]}},v.extent=function(t){return arguments.length?v.extentMajor(t).extentMinor(t):v.extentMinor()},v.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],u=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),u>s&&(t=u,u=s,s=t),v.precision(_)):[[r,u],[n,s]]},v.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),v.precision(_)):[[e,o],[t,i]]},v.step=function(t){return arguments.length?v.stepMajor(t).stepMinor(t):v.stepMinor()},v.stepMajor=function(t){return arguments.length?(g=+t[0],y=+t[1],v):[g,y]},v.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],v):[f,d]},v.precision=function(a){return arguments.length?(_=+a,c=Xe(o,i,90),l=Ye(e,t,_),h=Xe(u,s,90),A=Ye(r,n,_),v):_},v.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function Ke(){return Qe()()}function Je(t,e){var n=t[0]*f,r=t[1]*f,i=e[0]*f,o=e[1]*f,s=y(r),a=w(r),u=y(o),c=w(o),l=s*y(n),h=s*w(n),p=u*y(i),d=u*w(i),m=2*T(x(C(o-r)+s*u*C(i-n))),_=w(m),v=m?function(t){var e=w(t*=m)/_,n=w(m-t)/_,r=n*l+e*p,i=n*h+e*d,o=n*a+e*c;return[g(i,r)*A,g(o,x(r*r+i*i))*A]}:function(){return[n*A,r*A]};return v.distance=m,v}function $e(t){return t}var tn,en,nn,rn,on=r(),sn=r(),an={point:M,lineStart:M,lineEnd:M,polygonStart:function(){an.lineStart=un,an.lineEnd=hn},polygonEnd:function(){an.lineStart=an.lineEnd=an.point=M,on.add(p(sn)),sn.reset()},result:function(){var t=on/2;return on.reset(),t}};function un(){an.point=cn}function cn(t,e){an.point=ln,tn=nn=t,en=rn=e}function ln(t,e){sn.add(rn*t-nn*e),nn=t,rn=e}function hn(){ln(tn,en)}const An=an;var fn=1/0,pn=fn,dn=-fn,gn=dn;const yn={point:function(t,e){t<fn&&(fn=t),t>dn&&(dn=t),e<pn&&(pn=e),e>gn&&(gn=e)},lineStart:M,lineEnd:M,polygonStart:M,polygonEnd:M,result:function(){var t=[[fn,pn],[dn,gn]];return dn=gn=-(pn=fn=1/0),t}};var mn,_n,vn,bn,wn=0,En=0,xn=0,Sn=0,Pn=0,Tn=0,Cn=0,Mn=0,In=0,On={point:Rn,lineStart:Ln,lineEnd:Fn,polygonStart:function(){On.lineStart=kn,On.lineEnd=Bn},polygonEnd:function(){On.point=Rn,On.lineStart=Ln,On.lineEnd=Fn},result:function(){var t=In?[Cn/In,Mn/In]:Tn?[Sn/Tn,Pn/Tn]:xn?[wn/xn,En/xn]:[NaN,NaN];return wn=En=xn=Sn=Pn=Tn=Cn=Mn=In=0,t}};function Rn(t,e){wn+=t,En+=e,++xn}function Ln(){On.point=Nn}function Nn(t,e){On.point=Dn,Rn(vn=t,bn=e)}function Dn(t,e){var n=t-vn,r=e-bn,i=x(n*n+r*r);Sn+=i*(vn+t)/2,Pn+=i*(bn+e)/2,Tn+=i,Rn(vn=t,bn=e)}function Fn(){On.point=Rn}function kn(){On.point=jn}function Bn(){Un(mn,_n)}function jn(t,e){On.point=Un,Rn(mn=vn=t,_n=bn=e)}function Un(t,e){var n=t-vn,r=e-bn,i=x(n*n+r*r);Sn+=i*(vn+t)/2,Pn+=i*(bn+e)/2,Tn+=i,Cn+=(i=bn*t-vn*e)*(vn+t),Mn+=i*(bn+e),In+=3*i,Rn(vn=t,bn=e)}const zn=On;function Gn(t){this._context=t}Gn.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,h)}},result:M};var Vn,Zn,Hn,qn,Wn,Xn=r(),Yn={point:M,lineStart:function(){Yn.point=Qn},lineEnd:function(){Vn&&Kn(Zn,Hn),Yn.point=M},polygonStart:function(){Vn=!0},polygonEnd:function(){Vn=null},result:function(){var t=+Xn;return Xn.reset(),t}};function Qn(t,e){Yn.point=Kn,Zn=qn=t,Hn=Wn=e}function Kn(t,e){qn-=t,Wn-=e,Xn.add(x(qn*qn+Wn*Wn)),qn=t,Wn=e}const Jn=Yn;function $n(){this._string=[]}function tr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function er(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),D(t,n(r))),r.result()}return o.area=function(t){return D(t,n(An)),An.result()},o.measure=function(t){return D(t,n(Jn)),Jn.result()},o.bounds=function(t){return D(t,n(yn)),yn.result()},o.centroid=function(t){return D(t,n(zn)),zn.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,$e):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new $n):new Gn(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)}function nr(t,e,n,r){return function(i,o){var s,a,u,c=e(o),l=i.invert(r[0],r[1]),h=Ae(),A=e(h),f=!1,p={point:d,lineStart:y,lineEnd:m,polygonStart:function(){p.point=_,p.lineStart=v,p.lineEnd=b,a=[],s=[]},polygonEnd:function(){p.point=d,p.lineStart=y,p.lineEnd=m,a=_e(a);var t=Pe(s,l);a.length?(f||(o.polygonStart(),f=!0),de(a,ir,t,n,o)):t&&(f||(o.polygonStart(),f=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function d(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function g(t,e){var n=i(t,e);c.point(n[0],n[1])}function y(){p.point=g,c.lineStart()}function m(){p.point=d,c.lineEnd()}function _(t,e){u.push([t,e]);var n=i(t,e);A.point(n[0],n[1])}function v(){A.lineStart(),u=[]}function b(){_(u[0][0],u[0][1]),A.lineEnd();var t,e,n,r,i=A.clean(),c=h.result(),l=c.length;if(u.pop(),s.push(u),u=null,l)if(1&i){if((e=(n=c[0]).length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),t=0;t<e;++t)o.point((r=n[t])[0],r[1]);o.lineEnd()}}else l>1&&2&i&&c.push(c.pop().concat(c.shift())),a.push(c.filter(rr))}return p}}function rr(t){return t.length>1}function ir(t,e){return((t=t.x)[0]<0?t[1]-c-a:c-t[1])-((e=e.x)[0]<0?e[1]-c-a:c-e[1])}$n.prototype={_radius:4.5,_circle:tr(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=tr(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};const or=nr((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var l=o>0?u:-u,h=p(o-n);p(h-u)<a?(t.point(n,r=(r+s)/2>0?c:-c),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),t.point(o,r),e=0):i!==l&&h>=u&&(p(n-i)<a&&(n-=i*a),p(o-l)<a&&(o-=l*a),r=function(t,e,n,r){var i,o,s=w(t-n);return p(s)>a?d((w(e)*(o=y(r))*w(n)-w(r)*(i=y(e))*w(t))/(i*o*s)):(e+r)/2}(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(l,r),e=0),t.point(n=o,r=s),i=l},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*c,r.point(-u,i),r.point(0,i),r.point(u,i),r.point(u,0),r.point(u,-i),r.point(0,-i),r.point(-u,-i),r.point(-u,0),r.point(-u,i);else if(p(t[0]-e[0])>a){var o=t[0]<e[0]?u:-u;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-u,-c]);function sr(t,e){var n=y(t),r=n>0,i=p(n)>a;function o(t,e){return y(t)*y(e)>n}function s(t,e,r){var i=[1,0,0],o=J(Q(t),Q(e)),s=K(o,o),c=o[0],l=s-c*c;if(!l)return!r&&t;var h=n*s/l,A=-n*c/l,f=J(i,o),d=tt(i,h);$(d,tt(o,A));var g=f,y=K(d,g),m=K(g,g),_=y*y-m*(K(d,d)-1);if(!(_<0)){var v=x(_),b=tt(g,(-y-v)/m);if($(b,d),b=Y(b),!r)return b;var w,E=t[0],S=e[0],P=t[1],T=e[1];S<E&&(w=E,E=S,S=w);var C=S-E,M=p(C-u)<a;if(!M&&T<P&&(w=P,P=T,T=w),M||C<a?M?P+T>0^b[1]<(p(b[0]-E)<a?P:T):P<=b[1]&&b[1]<=T:C>u^(E<=b[0]&&b[0]<=S)){var I=tt(g,(-y+v)/m);return $(I,d),[b,Y(I)]}}}function c(e,n){var i=r?t:u-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return nr(o,(function(t){var e,n,l,h,A;return{lineStart:function(){h=l=!1,A=1},point:function(f,p){var d,g=[f,p],y=o(f,p),m=r?y?0:c(f,p):y?c(f+(f<0?u:-u),p):0;if(!e&&(h=l=y)&&t.lineStart(),y!==l&&(!(d=s(e,g))||fe(e,d)||fe(g,d))&&(g[0]+=a,g[1]+=a,y=o(g[0],g[1])),y!==l)A=0,y?(t.lineStart(),d=s(g,e),t.point(d[0],d[1])):(d=s(e,g),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(i&&e&&r^y){var _;m&n||!(_=s(g,e,!0))||(A=0,r?(t.lineStart(),t.point(_[0][0],_[0][1]),t.point(_[1][0],_[1][1]),t.lineEnd()):(t.point(_[1][0],_[1][1]),t.lineEnd(),t.lineStart(),t.point(_[0][0],_[0][1])))}!y||e&&fe(e,g)||t.point(g[0],g[1]),e=g,l=y,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return A|(h&&l)<<1}}}),(function(n,r,i,o){ce(o,t,e,i,n,r)}),r?[0,-t]:[-u,t-u])}function ar(t){return{stream:ur(t)}}function ur(t){return function(e){var n=new cr;for(var r in t)n[r]=t[r];return n.stream=e,n}}function cr(){}function lr(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),D(n,t.stream(yn));var s=yn.result(),a=Math.min(r/(s[1][0]-s[0][0]),i/(s[1][1]-s[0][1])),u=+e[0][0]+(r-a*(s[1][0]+s[0][0]))/2,c=+e[0][1]+(i-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([u,c])}function hr(t,e,n){return lr(t,[[0,0],e],n)}cr.prototype={constructor:cr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Ar=y(30*f);function fr(t,e){return+e?function(t,e){function n(r,i,o,s,u,c,l,h,A,f,d,y,m,_){var v=l-r,b=h-i,w=v*v+b*b;if(w>4*e&&m--){var E=s+f,S=u+d,P=c+y,C=x(E*E+S*S+P*P),M=T(P/=C),I=p(p(P)-1)<a||p(o-A)<a?(o+A)/2:g(S,E),O=t(I,M),R=O[0],L=O[1],N=R-r,D=L-i,F=b*N-v*D;(F*F/w>e||p((v*N+b*D)/w-.5)>.3||s*f+u*d+c*y<Ar)&&(n(r,i,o,s,u,c,R,L,I,E/=C,S/=C,P,m,_),_.point(R,L),n(R,L,I,E,S,P,l,h,A,f,d,y,m,_))}}return function(e){var r,i,o,s,a,u,c,l,h,A,f,p,d={point:g,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),d.lineStart=v},polygonEnd:function(){e.polygonEnd(),d.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,d.point=m,e.lineStart()}function m(r,i){var o=Q([r,i]),s=t(r,i);n(l,h,c,A,f,p,l=s[0],h=s[1],c=r,A=o[0],f=o[1],p=o[2],16,e),e.point(l,h)}function _(){d.point=g,e.lineEnd()}function v(){y(),d.point=b,d.lineEnd=w}function b(t,e){m(r=t,e),i=l,o=h,s=A,a=f,u=p,d.point=m}function w(){n(l,h,c,A,f,p,i,o,r,s,a,u,16,e),d.lineEnd=_,_()}return d}}(t,e):function(t){return ur({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var pr=ur({point:function(t,e){this.stream.point(t*f,e*f)}});function dr(t){return gr((function(){return t}))()}function gr(t){var e,n,r,i,o,s,a,u,c,l,h=150,p=480,d=250,g=0,y=0,m=0,_=0,v=0,b=null,w=or,E=null,S=$e,P=.5,T=fr(I,P);function C(t){return[(t=o(t[0]*f,t[1]*f))[0]*h+n,r-t[1]*h]}function M(t){return(t=o.invert((t[0]-n)/h,(r-t[1])/h))&&[t[0]*A,t[1]*A]}function I(t,i){return[(t=e(t,i))[0]*h+n,r-t[1]*h]}function O(){o=ne(i=ie(m,_,v),e);var t=e(g,y);return n=p-t[0]*h,r=d+t[1]*h,R()}function R(){return c=l=null,C}return C.stream=function(t){return c&&l===t?c:c=pr(w(i,T(S(l=t))))},C.clipAngle=function(t){return arguments.length?(w=+t?sr(b=t*f,6*f):(b=null,or),R()):b*A},C.clipExtent=function(t){return arguments.length?(S=null==t?(E=s=a=u=null,$e):Ee(E=+t[0][0],s=+t[0][1],a=+t[1][0],u=+t[1][1]),R()):null==E?null:[[E,s],[a,u]]},C.scale=function(t){return arguments.length?(h=+t,O()):h},C.translate=function(t){return arguments.length?(p=+t[0],d=+t[1],O()):[p,d]},C.center=function(t){return arguments.length?(g=t[0]%360*f,y=t[1]%360*f,O()):[g*A,y*A]},C.rotate=function(t){return arguments.length?(m=t[0]%360*f,_=t[1]%360*f,v=t.length>2?t[2]%360*f:0,O()):[m*A,_*A,v*A]},C.precision=function(t){return arguments.length?(T=fr(I,P=t*t),R()):x(P)},C.fitExtent=function(t,e){return lr(C,t,e)},C.fitSize=function(t,e){return hr(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&M,O()}}function yr(t){var e=0,n=u/3,r=gr(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*f,n=t[1]*f):[e*A,n*A]},i}function mr(t,e){var n=w(t),r=(n+w(e))/2;if(p(r)<a)return function(t){var e=y(t);function n(t,n){return[t*e,w(n)/e]}return n.invert=function(t,n){return[t/e,T(n*e)]},n}(t);var i=1+n*(2*r-n),o=x(i)/r;function s(t,e){var n=x(i-2*r*w(e))/r;return[n*w(t*=r),o-n*y(t)]}return s.invert=function(t,e){var n=o-e;return[g(t,p(n))/r*E(n),T((i-(t*t+n*n)*r*r)/(2*r))]},s}function _r(){return yr(mr).scale(155.424).center([0,33.6442])}function vr(){return _r().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function br(){var t,e,n,r,i,o,s=vr(),u=_r().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=_r().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){o=[t,e]}};function h(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function A(){return t=e=null,h}return h.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:s).invert(t)},h.stream=function(n){return t&&e===n?t:(r=[s.stream(e=n),u.stream(n),c.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},h.precision=function(t){return arguments.length?(s.precision(t),u.precision(t),c.precision(t),A()):s.precision()},h.scale=function(t){return arguments.length?(s.scale(t),u.scale(.35*t),c.scale(t),h.translate(s.translate())):s.scale()},h.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],h=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,h-.238*e],[o+.455*e,h+.238*e]]).stream(l),r=u.translate([o-.307*e,h+.201*e]).clipExtent([[o-.425*e+a,h+.12*e+a],[o-.214*e-a,h+.234*e-a]]).stream(l),i=c.translate([o-.205*e,h+.212*e]).clipExtent([[o-.214*e+a,h+.166*e+a],[o-.115*e-a,h+.234*e-a]]).stream(l),A()},h.fitExtent=function(t,e){return lr(h,t,e)},h.fitSize=function(t,e){return hr(h,t,e)},h.scale(1070)}function wr(t){return function(e,n){var r=y(e),i=y(n),o=t(r*i);return[o*i*w(e),o*w(n)]}}function Er(t){return function(e,n){var r=x(e*e+n*n),i=t(r),o=w(i),s=y(i);return[g(e*o,r*s),T(r&&n*o/r)]}}var xr=wr((function(t){return x(2/(1+t))}));function Sr(){return dr(xr).scale(124.75).clipAngle(179.999)}xr.invert=Er((function(t){return 2*T(t/2)}));var Pr=wr((function(t){return(t=P(t))&&t/w(t)}));function Tr(){return dr(Pr).scale(79.4188).clipAngle(179.999)}function Cr(t,e){return[t,v(S((c+e)/2))]}function Mr(){return Ir(Cr).scale(961/h)}function Ir(t){var e,n,r,i=dr(t),o=i.center,s=i.scale,a=i.translate,c=i.clipExtent,l=null;function h(){var o=u*s(),a=i(ue(i.rotate()).invert([0,0]));return c(null==l?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===Cr?[[Math.max(a[0]-o,l),e],[Math.min(a[0]+o,n),r]]:[[l,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),h()):s()},i.translate=function(t){return arguments.length?(a(t),h()):a()},i.center=function(t){return arguments.length?(o(t),h()):o()},i.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),h()):null==l?null:[[l,e],[n,r]]},h()}function Or(t){return S((c+t)/2)}function Rr(t,e){var n=y(t),r=t===e?w(t):v(n/y(e))/v(Or(e)/Or(t)),i=n*b(Or(t),r)/r;if(!r)return Cr;function o(t,e){i>0?e<-c+a&&(e=-c+a):e>c-a&&(e=c-a);var n=i/b(Or(e),r);return[n*w(r*t),i-n*y(r*t)]}return o.invert=function(t,e){var n=i-e,o=E(r)*x(t*t+n*n);return[g(t,p(n))/r*E(n),2*d(b(i/o,1/r))-c]},o}function Lr(){return yr(Rr).scale(109.5).parallels([30,30])}function Nr(t,e){return[t,e]}function Dr(){return dr(Nr).scale(152.63)}function Fr(t,e){var n=y(t),r=t===e?w(t):(n-y(e))/(e-t),i=n/r+t;if(p(r)<a)return Nr;function o(t,e){var n=i-e,o=r*t;return[n*w(o),i-n*y(o)]}return o.invert=function(t,e){var n=i-e;return[g(t,p(n))/r*E(n),i-E(r)*x(t*t+n*n)]},o}function kr(){return yr(Fr).scale(131.154).center([0,13.9389])}function Br(t,e){var n=y(e),r=y(t)*n;return[n*w(t)/r,w(e)/r]}function jr(){return dr(Br).scale(144.049).clipAngle(60)}function Ur(t,e,n,r){return 1===t&&1===e&&0===n&&0===r?$e:ur({point:function(i,o){this.stream.point(i*t+n,o*e+r)}})}function zr(){var t,e,n,r,i,o,s=1,a=0,u=0,c=1,l=1,h=$e,A=null,f=$e;function p(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=h(f(i=t))},clipExtent:function(r){return arguments.length?(f=null==r?(A=t=e=n=null,$e):Ee(A=+r[0][0],t=+r[0][1],e=+r[1][0],n=+r[1][1]),p()):null==A?null:[[A,t],[e,n]]},scale:function(t){return arguments.length?(h=Ur((s=+t)*c,s*l,a,u),p()):s},translate:function(t){return arguments.length?(h=Ur(s*c,s*l,a=+t[0],u=+t[1]),p()):[a,u]},reflectX:function(t){return arguments.length?(h=Ur(s*(c=t?-1:1),s*l,a,u),p()):c<0},reflectY:function(t){return arguments.length?(h=Ur(s*c,s*(l=t?-1:1),a,u),p()):l<0},fitExtent:function(t,e){return lr(o,t,e)},fitSize:function(t,e){return hr(o,t,e)}}}function Gr(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Vr(){return dr(Gr).scale(175.295)}function Zr(t,e){return[y(e)*w(t),w(e)]}function Hr(){return dr(Zr).scale(249.5).clipAngle(90.000001)}function qr(t,e){var n=y(e),r=1+y(t)*n;return[n*w(t)/r,w(e)/r]}function Wr(){return dr(qr).scale(250).clipAngle(142)}function Xr(t,e){return[v(S((c+e)/2)),-t]}function Yr(){var t=Ir(Xr),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}Pr.invert=Er((function(t){return t})),Cr.invert=function(t,e){return[t,2*d(_(e))-c]},Nr.invert=Nr,Br.invert=Er(d),Gr.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(p(n)>a&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},Zr.invert=Er(T),qr.invert=Er((function(t){return 2*d(t)})),Xr.invert=function(t,e){return[-e,2*d(_(t))-c]}},9187:t=>{"use strict";function e(t,e,o){o=o||2;var s,a,u,h,A,p,d,g=e&&e.length,y=g?e[0]*o:t.length,m=n(t,0,y,o,!0),_=[];if(!m||m.next===m.prev)return _;if(g&&(m=function(t,e,i,o){var s,a,u,h=[];for(s=0,a=e.length;s<a;s++)(u=n(t,e[s]*o,s<a-1?e[s+1]*o:t.length,o,!1))===u.next&&(u.steiner=!0),h.push(f(u));for(h.sort(c),s=0;s<h.length;s++)i=r(i=l(h[s],i),i.next);return i}(t,e,m,o)),t.length>80*o){s=u=t[0],a=h=t[1];for(var v=o;v<y;v+=o)(A=t[v])<s&&(s=A),(p=t[v+1])<a&&(a=p),A>u&&(u=A),p>h&&(h=p);d=0!==(d=Math.max(u-s,h-a))?1/d:0}return i(m,_,o,s,a,d),_}function n(t,e,n,r,i){var o,s;if(i===P(t,e,n,r)>0)for(o=e;o<n;o+=r)s=E(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=E(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(x(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(x(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,c,l,h,f){if(t){!f&&h&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=A(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,u,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ);e++);for(u=c;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(t,c,l,h);for(var p,d,g=t;t.prev!==t.next;)if(p=t.prev,d=t.next,h?s(t,c,l,h):o(t))e.push(p.i/n),e.push(t.i/n),e.push(d.i/n),x(t),t=d.next,g=d.next;else if((t=d)===g){f?1===f?i(t=a(r(t),e,n),e,n,c,l,h,2):2===f&&u(t,e,n,c,l,h):i(r(t),e,n,c,l,h,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(g(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(p(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&g(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){var i=t.prev,o=t,s=t.next;if(g(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=A(a,u,e,n,r),f=A(c,l,e,n,r),d=t.prevZ,y=t.nextZ;d&&d.z>=h&&y&&y.z<=f;){if(d!==t.prev&&d!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;y&&y.z<=f;){if(y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&g(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(t,e,n){var i=t;do{var o=i.prev,s=i.next.next;!y(o,s)&&m(o,i,i.next,s)&&b(o,s)&&b(s,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(s.i/n),x(i),x(i.next),i=t=s),i=i.next}while(i!==t);return r(i)}function u(t,e,n,o,s,a){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&d(u,c)){var l=w(u,c);return u=r(u,u.next),l=r(l,l.next),i(u,e,n,o,s,a),void i(l,e,n,o,s,a)}c=c.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var u,c=n,l=n.x,A=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&p(o<A?i:s,o,l,A,o<A?s:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),b(r,t)&&(u<f||u===f&&(r.x>n.x||r.x===n.x&&h(n,r)))&&(n=r,f=u)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var i=w(n,t),o=r(n,n.next);return r(i,i.next),e===n?o:e}function h(t,e){return g(t.prev,t,e.prev)<0&&g(e.next,t,t.next)<0}function A(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function d(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&m(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(g(t.prev,t,e.prev)||g(t,e.prev,e))||y(t,e)&&g(t.prev,t,t.next)>0&&g(e.prev,e,e.next)>0)}function g(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function m(t,e,n,r){var i=v(g(t,e,n)),o=v(g(t,e,r)),s=v(g(n,r,t)),a=v(g(n,r,e));return i!==o&&s!==a||!(0!==i||!_(t,n,e))||!(0!==o||!_(t,r,e))||!(0!==s||!_(n,t,r))||!(0!==a||!_(n,e,r))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function v(t){return t>0?1:t<0?-1:0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function w(t,e){var n=new S(t.i,t.x,t.y),r=new S(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function E(t,e,n,r){var i=new S(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function x(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function S(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function P(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(P(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var c=e[a]*n,l=a<u-1?e[a+1]*n:t.length;s-=Math.abs(P(t,c,l,n))}var h=0;for(a=0;a<r.length;a+=3){var A=r[a]*n,f=r[a+1]*n,p=r[a+2]*n;h+=Math.abs((t[A]-t[p])*(t[f+1]-t[A+1])-(t[A]-t[f])*(t[p+1]-t[A+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},1787:(t,e,n)=>{var r=n(2582),i=n(4102),o=n(1540),s=n(9705).default,a=o.featureEach,u=(o.coordEach,i.polygon,i.featureCollection);function c(t){var e=new r(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),r.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),r.prototype.remove.call(this,t,e)},e.clear=function(){return r.prototype.clear.call(this)},e.search=function(t){var e=r.prototype.search.call(this,this.toBBox(t));return u(e)},e.collides=function(t){return r.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=r.prototype.all.call(this);return u(t)},e.toJSON=function(){return r.prototype.toJSON.call(this)},e.fromJSON=function(t){return r.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=c,t.exports.default=c},9685:(t,e,n)=>{"use strict";n.d(e,{Ib:()=>r,WT:()=>i});var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},5600:(t,e,n)=>{"use strict";n.d(e,{Ue:()=>i,p4:()=>o,U_:()=>s,GH:()=>a,Jp:()=>u,Iu:()=>c,U1:()=>l,bA:()=>h,en:()=>A});var r=n(9685);function i(){var t=new r.WT(9);return r.WT!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function o(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function s(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=l*s-a*c,A=-l*o+a*u,f=c*o-s*u,p=n*h+r*A+i*f;return p?(p=1/p,t[0]=h*p,t[1]=(-l*r+i*c)*p,t[2]=(a*r-i*s)*p,t[3]=A*p,t[4]=(l*n-i*u)*p,t[5]=(-a*n+i*o)*p,t[6]=f*p,t[7]=(-c*n+r*u)*p,t[8]=(s*n-r*o)*p,t):null}function a(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8];return e*(c*o-s*u)+n*(-c*i+s*a)+r*(u*i-o*a)}function u(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],A=n[0],f=n[1],p=n[2],d=n[3],g=n[4],y=n[5],m=n[6],_=n[7],v=n[8];return t[0]=A*r+f*s+p*c,t[1]=A*i+f*a+p*l,t[2]=A*o+f*u+p*h,t[3]=d*r+g*s+y*c,t[4]=d*i+g*a+y*l,t[5]=d*o+g*u+y*h,t[6]=m*r+_*s+v*c,t[7]=m*i+_*a+v*l,t[8]=m*o+_*u+v*h,t}function c(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],A=n[0],f=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=A*r+f*s+c,t[7]=A*i+f*a+l,t[8]=A*o+f*u+h,t}function l(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],A=Math.sin(n),f=Math.cos(n);return t[0]=f*r+A*s,t[1]=f*i+A*a,t[2]=f*o+A*u,t[3]=f*s-A*r,t[4]=f*a-A*i,t[5]=f*u-A*o,t[6]=c,t[7]=l,t[8]=h,t}function h(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function A(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,h=r*a,A=i*s,f=i*a,p=i*u,d=o*s,g=o*a,y=o*u;return t[0]=1-h-p,t[3]=l-y,t[6]=A+g,t[1]=l+y,t[4]=1-c-p,t[7]=f-d,t[2]=A-g,t[5]=f+d,t[8]=1-c-h,t}},5975:(t,e,n)=>{"use strict";n.d(e,{p4:()=>i,U_:()=>o,GH:()=>s,Jp:()=>a,Iu:()=>u,bA:()=>c,U1:()=>l,lM:()=>h,uD:()=>A,jI:()=>f,Q$:()=>p,en:()=>d,oy:()=>g,G3:()=>y,M5:()=>m,zB:()=>_,fS:()=>v});var r=n(9685);function i(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function o(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],h=e[9],A=e[10],f=e[11],p=e[12],d=e[13],g=e[14],y=e[15],m=n*a-r*s,_=n*u-i*s,v=n*c-o*s,b=r*u-i*a,w=r*c-o*a,E=i*c-o*u,x=l*d-h*p,S=l*g-A*p,P=l*y-f*p,T=h*g-A*d,C=h*y-f*d,M=A*y-f*g,I=m*M-_*C+v*T+b*P-w*S+E*x;return I?(I=1/I,t[0]=(a*M-u*C+c*T)*I,t[1]=(i*C-r*M-o*T)*I,t[2]=(d*E-g*w+y*b)*I,t[3]=(A*w-h*E-f*b)*I,t[4]=(u*P-s*M-c*S)*I,t[5]=(n*M-i*P+o*S)*I,t[6]=(g*v-p*E-y*_)*I,t[7]=(l*E-A*v+f*_)*I,t[8]=(s*C-a*P+c*x)*I,t[9]=(r*P-n*C-o*x)*I,t[10]=(p*w-d*v+y*m)*I,t[11]=(h*v-l*w-f*m)*I,t[12]=(a*S-s*T-u*x)*I,t[13]=(n*T-r*S+i*x)*I,t[14]=(d*_-p*b-g*m)*I,t[15]=(l*b-h*_+A*m)*I,t):null}function s(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],h=t[10],A=t[11],f=t[12],p=t[13],d=t[14],g=t[15];return(e*s-n*o)*(h*g-A*d)-(e*a-r*o)*(l*g-A*p)+(e*u-i*o)*(l*d-h*p)+(n*a-r*s)*(c*g-A*f)-(n*u-i*s)*(c*d-h*f)+(r*u-i*a)*(c*p-l*f)}function a(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],A=e[9],f=e[10],p=e[11],d=e[12],g=e[13],y=e[14],m=e[15],_=n[0],v=n[1],b=n[2],w=n[3];return t[0]=_*r+v*a+b*h+w*d,t[1]=_*i+v*u+b*A+w*g,t[2]=_*o+v*c+b*f+w*y,t[3]=_*s+v*l+b*p+w*m,_=n[4],v=n[5],b=n[6],w=n[7],t[4]=_*r+v*a+b*h+w*d,t[5]=_*i+v*u+b*A+w*g,t[6]=_*o+v*c+b*f+w*y,t[7]=_*s+v*l+b*p+w*m,_=n[8],v=n[9],b=n[10],w=n[11],t[8]=_*r+v*a+b*h+w*d,t[9]=_*i+v*u+b*A+w*g,t[10]=_*o+v*c+b*f+w*y,t[11]=_*s+v*l+b*p+w*m,_=n[12],v=n[13],b=n[14],w=n[15],t[12]=_*r+v*a+b*h+w*d,t[13]=_*i+v*u+b*A+w*g,t[14]=_*o+v*c+b*f+w*y,t[15]=_*s+v*l+b*p+w*m,t}function u(t,e,n){var r,i,o,s,a,u,c,l,h,A,f,p,d=n[0],g=n[1],y=n[2];return e===t?(t[12]=e[0]*d+e[4]*g+e[8]*y+e[12],t[13]=e[1]*d+e[5]*g+e[9]*y+e[13],t[14]=e[2]*d+e[6]*g+e[10]*y+e[14],t[15]=e[3]*d+e[7]*g+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],h=e[8],A=e[9],f=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=h,t[9]=A,t[10]=f,t[11]=p,t[12]=r*d+a*g+h*y+e[12],t[13]=i*d+u*g+A*y+e[13],t[14]=o*d+c*g+f*y+e[14],t[15]=s*d+l*g+p*y+e[15]),t}function c(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,i){var o,s,a,u,c,l,h,A,f,p,d,g,y,m,_,v,b,w,E,x,S,P,T,C,M=i[0],I=i[1],O=i[2],R=Math.hypot(M,I,O);return R<r.Ib?null:(M*=R=1/R,I*=R,O*=R,o=Math.sin(n),a=1-(s=Math.cos(n)),u=e[0],c=e[1],l=e[2],h=e[3],A=e[4],f=e[5],p=e[6],d=e[7],g=e[8],y=e[9],m=e[10],_=e[11],v=M*M*a+s,b=I*M*a+O*o,w=O*M*a-I*o,E=M*I*a-O*o,x=I*I*a+s,S=O*I*a+M*o,P=M*O*a+I*o,T=I*O*a-M*o,C=O*O*a+s,t[0]=u*v+A*b+g*w,t[1]=c*v+f*b+y*w,t[2]=l*v+p*b+m*w,t[3]=h*v+d*b+_*w,t[4]=u*E+A*x+g*S,t[5]=c*E+f*x+y*S,t[6]=l*E+p*x+m*S,t[7]=h*E+d*x+_*S,t[8]=u*P+A*T+g*C,t[9]=c*P+f*T+y*C,t[10]=l*P+p*T+m*C,t[11]=h*P+d*T+_*C,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function h(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],h=e[10],A=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=s*i+l*r,t[6]=a*i+h*r,t[7]=u*i+A*r,t[8]=c*i-o*r,t[9]=l*i-s*r,t[10]=h*i-a*r,t[11]=A*i-u*r,t}function A(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],h=e[10],A=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=s*i-l*r,t[2]=a*i-h*r,t[3]=u*i-A*r,t[8]=o*r+c*i,t[9]=s*r+l*i,t[10]=a*r+h*i,t[11]=u*r+A*i,t}function f(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],h=e[6],A=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=s*i+l*r,t[2]=a*i+h*r,t[3]=u*i+A*r,t[4]=c*i-o*r,t[5]=l*i-s*r,t[6]=h*i-a*r,t[7]=A*i-u*r,t}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(u,c,l),t}function d(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,h=r*a,A=i*s,f=i*a,p=i*u,d=o*s,g=o*a,y=o*u;return t[0]=1-h-p,t[1]=l+y,t[2]=A-g,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=f+d,t[7]=0,t[8]=A+g,t[9]=f-d,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,e,n,r,i,o,s){var a=1/(n-e),u=1/(i-r),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}function y(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function m(t,e,n,r,i,o,s){var a=1/(e-n),u=1/(r-i),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(s+o)*c,t[15]=1,t}function _(t,e,n,i){var o,s,a,u,c,l,h,A,f,p,d=e[0],g=e[1],y=e[2],m=i[0],_=i[1],v=i[2],b=n[0],w=n[1],E=n[2];return Math.abs(d-b)<r.Ib&&Math.abs(g-w)<r.Ib&&Math.abs(y-E)<r.Ib?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(h=d-b,A=g-w,f=y-E,o=_*(f*=p=1/Math.hypot(h,A,f))-v*(A*=p),s=v*(h*=p)-m*f,a=m*A-_*h,(p=Math.hypot(o,s,a))?(o*=p=1/p,s*=p,a*=p):(o=0,s=0,a=0),u=A*a-f*s,c=f*o-h*a,l=h*s-A*o,(p=Math.hypot(u,c,l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),t[0]=o,t[1]=u,t[2]=h,t[3]=0,t[4]=s,t[5]=c,t[6]=A,t[7]=0,t[8]=a,t[9]=l,t[10]=f,t[11]=0,t[12]=-(o*d+s*g+a*y),t[13]=-(u*d+c*g+l*y),t[14]=-(h*d+A*g+f*y),t[15]=1,t)}function v(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],h=t[8],A=t[9],f=t[10],p=t[11],d=t[12],g=t[13],y=t[14],m=t[15],_=e[0],v=e[1],b=e[2],w=e[3],E=e[4],x=e[5],S=e[6],P=e[7],T=e[8],C=e[9],M=e[10],I=e[11],O=e[12],R=e[13],L=e[14],N=e[15];return Math.abs(n-_)<=r.Ib*Math.max(1,Math.abs(n),Math.abs(_))&&Math.abs(i-v)<=r.Ib*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-b)<=r.Ib*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-w)<=r.Ib*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-E)<=r.Ib*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-x)<=r.Ib*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-S)<=r.Ib*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(l-P)<=r.Ib*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(h-T)<=r.Ib*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(A-C)<=r.Ib*Math.max(1,Math.abs(A),Math.abs(C))&&Math.abs(f-M)<=r.Ib*Math.max(1,Math.abs(f),Math.abs(M))&&Math.abs(p-I)<=r.Ib*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(d-O)<=r.Ib*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-R)<=r.Ib*Math.max(1,Math.abs(g),Math.abs(R))&&Math.abs(y-L)<=r.Ib*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(m-N)<=r.Ib*Math.max(1,Math.abs(m),Math.abs(N))}},1437:(t,e,n)=>{"use strict";n.d(e,{IH:()=>i,bA:()=>o,kE:()=>s,tk:()=>a,t7:()=>u,c:()=>c,iu:()=>l,kK:()=>h,fF:()=>A,lu:()=>p});var r=n(9685);function i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function s(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function a(t,e){return t[0]=-e[0],t[1]=-e[1],t}function u(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function c(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function l(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function h(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function A(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var f,p=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};f=new r.WT(2),r.WT!=Float32Array&&(f[0]=0,f[1]=0)},7160:(t,e,n)=>{"use strict";n.d(e,{Ue:()=>i,kE:()=>o,al:()=>s,IH:()=>a,tk:()=>u,Fv:()=>c,AK:()=>l,kC:()=>h,t7:()=>A,fF:()=>f,kK:()=>p,VC:()=>d,lM:()=>g,uD:()=>y,jI:()=>m,EU:()=>_,lu:()=>v,dC:()=>b,Zh:()=>w,x9:()=>E});var r=n(9685);function i(){var t=new r.WT(3);return r.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function s(t,e,n){var i=new r.WT(3);return i[0]=t,i[1]=e,i[2]=n,i}function a(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function u(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function c(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function l(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function h(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}function A(t,e,n,r){var i=e[0],o=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t}function f(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function p(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function d(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],c=e[2],l=i*c-o*u,h=o*a-r*c,A=r*u-i*a,f=i*A-o*h,p=o*l-r*A,d=r*h-i*l,g=2*s;return l*=g,h*=g,A*=g,f*=2,p*=2,d*=2,t[0]=a+l+f,t[1]=u+h+p,t[2]=c+A+d,t}function g(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function y(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function m(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function _(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),c=u&&l(t,e)/u;return Math.acos(Math.min(Math.max(c,-1),1))}var v=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},b=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},w=o,E=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r};i()},8333:(t,e,n)=>{"use strict";n.d(e,{d9:()=>o,al:()=>s,JG:()=>a,t8:()=>u,IH:()=>c,bA:()=>l,kE:()=>h,we:()=>A,Fv:()=>f,AK:()=>p,t7:()=>d,fF:()=>g,VC:()=>y,I6:()=>m,fS:()=>_});var r,i=n(9685);function o(t){var e=new i.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,n,r){var o=new i.WT(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function u(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function l(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function A(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function f(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function p(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function d(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function g(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function y(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*o-u*i,h=c*i+u*r-s*o,A=c*o+s*i-a*r,f=-s*r-a*i-u*o;return t[0]=l*c+f*-s+h*-u-A*-a,t[1]=h*c+f*-a+A*-s-l*-u,t[2]=A*c+f*-u+l*-a-h*-s,t[3]=e[3],t}function m(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function _(t,e){var n=t[0],r=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-a)<=i.Ib*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-u)<=i.Ib*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(o-c)<=i.Ib*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-l)<=i.Ib*Math.max(1,Math.abs(s),Math.abs(l))}r=new i.WT(4),i.WT!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0)},9947:(t,e,n)=>{"use strict";n.r(e),n.d(e,{UNITS:()=>p,h3IndexToSplitLong:()=>y,splitLongToh3Index:()=>_,h3IsValid:()=>L,h3IsPentagon:()=>N,h3IsResClassIII:()=>D,h3GetBaseCell:()=>F,h3GetFaces:()=>k,h3GetResolution:()=>B,geoToH3:()=>j,h3ToGeo:()=>U,h3ToGeoBoundary:()=>z,h3ToParent:()=>G,h3ToChildren:()=>V,h3ToCenterChild:()=>Z,kRing:()=>H,kRingDistances:()=>q,hexRing:()=>W,polyfill:()=>X,h3SetToMultiPolygon:()=>Y,compact:()=>Q,uncompact:()=>K,h3IndexesAreNeighbors:()=>J,getH3UnidirectionalEdge:()=>$,getOriginH3IndexFromUnidirectionalEdge:()=>tt,getDestinationH3IndexFromUnidirectionalEdge:()=>et,h3UnidirectionalEdgeIsValid:()=>nt,getH3IndexesFromUnidirectionalEdge:()=>rt,getH3UnidirectionalEdgesFromHexagon:()=>it,getH3UnidirectionalEdgeBoundary:()=>ot,h3Distance:()=>st,h3Line:()=>at,experimentalH3ToLocalIj:()=>ut,experimentalLocalIjToH3:()=>ct,pointDist:()=>lt,cellArea:()=>ht,exactEdgeLength:()=>At,hexArea:()=>ft,edgeLength:()=>pt,numHexagons:()=>dt,getRes0Indexes:()=>gt,getPentagonIndexes:()=>yt,degsToRads:()=>mt,radsToDegs:()=>_t});var r=function(t){var e,n=void 0!==(t=t||{})?t:{},r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);var i,o=[],s="";document.currentScript&&(s=document.currentScript.src),s=0!==s.indexOf("blob:")?s.substr(0,s.lastIndexOf("/")+1):"",i=function(t,e,n){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){if(200==r.status||0==r.status&&r.response)e(r.response);else{var i=X(t);i?e(i.buffer):n()}},r.onerror=n,r.send(null)};var a=n.print||console.log.bind(console),u=n.printErr||console.warn.bind(console);for(e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);r=null,n.arguments&&(o=n.arguments);var c=0,l=function(){return c},h=!1;function A(t){var e=n["_"+t];return e||at("Assertion failed: "+("Cannot call unknown function "+t+", make sure it is exported")),e}function f(t,e,n,r,i){var o={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);!function(t,e,n){!function(t,e,n,r){if(!(r>0))return 0;for(var i=n+r-1,o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s>=55296&&s<=57343&&(s=65536+((1023&s)<<10)|1023&t.charCodeAt(++o)),s<=127){if(n>=i)break;e[n++]=s}else if(s<=2047){if(n+1>=i)break;e[n++]=192|s>>6,e[n++]=128|63&s}else if(s<=65535){if(n+2>=i)break;e[n++]=224|s>>12,e[n++]=128|s>>6&63,e[n++]=128|63&s}else{if(n+3>=i)break;e[n++]=240|s>>18,e[n++]=128|s>>12&63,e[n++]=128|s>>6&63,e[n++]=128|63&s}}e[n]=0}(t,g,e,n)}(t,e=$(n),n)}return e},array:function(t){var e=$(t.length);return function(t,e){d.set(t,e)}(t,e),e}},s=A(t),a=[],u=0;if(r)for(var c=0;c<r.length;c++){var l=o[n[c]];l?(0===u&&(u=et()),a[c]=l(r[c])):a[c]=r[c]}var h=s.apply(null,a);return h=function(t){return"string"===e?w(t):"boolean"===e?Boolean(t):t}(h),0!==u&&tt(u),h}var p,d,g,y,m,_,v,b="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function w(t,e){return t?function(t,e,n){for(var r=e+n,i=e;t[i]&&!(i>=r);)++i;if(i-e>16&&t.subarray&&b)return b.decode(t.subarray(e,i));for(var o="";e<i;){var s=t[e++];if(128&s){var a=63&t[e++];if(192!=(224&s)){var u=63&t[e++];if((s=224==(240&s)?(15&s)<<12|a<<6|u:(7&s)<<18|a<<12|u<<6|63&t[e++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}(g,t,e):""}function E(t,e){return t%e>0&&(t+=e-t%e),t}function x(t){p=t,n.HEAP8=d=new Int8Array(t),n.HEAP16=y=new Int16Array(t),n.HEAP32=m=new Int32Array(t),n.HEAPU8=g=new Uint8Array(t),n.HEAPU16=new Uint16Array(t),n.HEAPU32=new Uint32Array(t),n.HEAPF32=_=new Float32Array(t),n.HEAPF64=v=new Float64Array(t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var S=n.TOTAL_MEMORY||33554432;function P(t){for(;t.length>0;){var e=t.shift();if("function"!=typeof e){var r=e.func;"number"==typeof r?void 0===e.arg?n.dynCall_v(r):n.dynCall_vi(r,e.arg):r(void 0===e.arg?null:e.arg)}else e()}}S=(p=n.buffer?n.buffer:new ArrayBuffer(S)).byteLength,x(p),m[6004]=5266928;var T=[],C=[],M=[],I=[],O=Math.abs,R=Math.ceil,L=Math.floor,N=Math.min,D=0,F=null,k=null;n.preloadedImages={},n.preloadedAudios={};var B,j,U=null,z="data:application/octet-stream;base64,";function G(t){return String.prototype.startsWith?t.startsWith(z):0===t.indexOf(z)}function V(t){return t.replace(/\b__Z[\w\d_]+/g,(function(t){return t==t?t:t+" ["+t+"]"}))}function Z(){var t=new Error;if(!t.stack){try{throw new Error(0)}catch(e){t=e}if(!t.stack)return"(no stack trace available)"}return t.stack.toString()}function H(){return d.length}function q(t){try{var e=new ArrayBuffer(t);if(e.byteLength!=t)return;return new Int8Array(e).set(d),J(e),x(e),1}catch(t){}}U="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var W="function"==typeof atob?atob:function(t){var e,n,r,i,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{e=a.indexOf(t.charAt(c++))<<2|(i=a.indexOf(t.charAt(c++)))>>4,n=(15&i)<<4|(o=a.indexOf(t.charAt(c++)))>>2,r=(3&o)<<6|(s=a.indexOf(t.charAt(c++))),u+=String.fromCharCode(e),64!==o&&(u+=String.fromCharCode(n)),64!==s&&(u+=String.fromCharCode(r))}while(c<t.length);return u};function X(t){if(G(t))return function(t){try{for(var e=W(t),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n}catch(t){throw new Error("Converting base64 string to bytes failed.")}}(t.slice(z.length))}var Y,Q,K=function(t,e,n){var r=new t.Int8Array(n),i=new t.Int32Array(n),o=(new t.Uint8Array(n),new t.Float32Array(n),new t.Float64Array(n)),s=0|e.p,a=t.Math.floor,u=t.Math.abs,c=t.Math.sqrt,l=t.Math.pow,h=t.Math.cos,A=t.Math.sin,f=t.Math.tan,p=t.Math.acos,d=t.Math.asin,g=t.Math.atan,y=t.Math.atan2,m=t.Math.ceil,_=t.Math.imul,v=t.Math.min,b=t.Math.clz32,w=e.b,E=e.c,x=e.d,S=e.e,P=e.f,T=e.g,C=e.h,M=e.i,I=24048;function O(t,e,n,r){var i,o;0|R(t|=0,e|=0,n|=0,r|=0,0)&&(Ce(0|r,0,(o=1+(0|_(3*n|0,n+1|0))|0)<<3|0),(i=0|_e(o,4))&&(L(t,e,n,r,i,o,0),me(i)))}function R(t,e,n,r,o){t|=0,e|=0,n|=0,o|=0;var s,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0;if(s=I,I=I+16|0,p=s,i[(a=r|=0)>>2]=t,i[a+4>>2]=e,(a=0!=(0|o))&&(i[o>>2]=0),0|Nt(t,e))return I=s,1;i[p>>2]=0;t:do{if((0|n)>=1)if(a)for(h=0,A=1,f=1,u=0,a=t;;){if(!(u|h)){if(0==(0|(a=0|N(a,e,4,p)))&0==(0|(e=0|E()))){a=2;break t}if(0|Nt(a,e)){a=1;break t}}if(0==(0|(a=0|N(a,e,0|i[16+(h<<2)>>2],p)))&0==(0|(e=0|E()))){a=2;break t}if(i[(t=r+(f<<3)|0)>>2]=a,i[t+4>>2]=e,i[o+(f<<2)>>2]=A,t=(0|(u=u+1|0))==(0|A),l=6==(0|(c=h+1|0)),0|Nt(a,e)){a=1;break t}if((0|(A=A+(l&t&1)|0))>(0|n)){a=0;break}h=t?l?0:c:h,f=f+1|0,u=t?0:u}else for(h=0,A=1,f=1,u=0,a=t;;){if(!(u|h)){if(0==(0|(a=0|N(a,e,4,p)))&0==(0|(e=0|E()))){a=2;break t}if(0|Nt(a,e)){a=1;break t}}if(0==(0|(a=0|N(a,e,0|i[16+(h<<2)>>2],p)))&0==(0|(e=0|E()))){a=2;break t}if(i[(t=r+(f<<3)|0)>>2]=a,i[t+4>>2]=e,t=(0|(u=u+1|0))==(0|A),l=6==(0|(c=h+1|0)),0|Nt(a,e)){a=1;break t}if((0|(A=A+(l&t&1)|0))>(0|n)){a=0;break}h=t?l?0:c:h,f=f+1|0,u=t?0:u}else a=0}while(0);return I=s,0|a}function L(t,e,n,r,o,s,a){n|=0,r|=0,o|=0,s|=0,a|=0;var u,c,l=0,h=0,A=0,f=0,p=0;if(c=I,I=I+16|0,u=c,0==(0|(t|=0))&0==(0|(e|=0)))I=c;else{if(l=0|we(0|t,0|e,0|s,((0|s)<0)<<31>>31|0),E(),!(0==(0|(p=0|i[(f=h=r+(l<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2]))|(A=(0|p)==(0|t)&(0|f)==(0|e))))do{A=(0|(f=0|i[(p=h=r+((l=(l+1|0)%(0|s)|0)<<3)|0)>>2]))==(0|t)&(0|(p=0|i[p+4>>2]))==(0|e)}while(!(0==(0|f)&0==(0|p)|A));l=o+(l<<2)|0,A&&(0|i[l>>2])<=(0|a)||(i[(p=h)>>2]=t,i[p+4>>2]=e,i[l>>2]=a,(0|a)>=(0|n)||(p=a+1|0,i[u>>2]=0,L(f=0|N(t,e,2,u),0|E(),n,r,o,s,p),i[u>>2]=0,L(f=0|N(t,e,3,u),0|E(),n,r,o,s,p),i[u>>2]=0,L(f=0|N(t,e,1,u),0|E(),n,r,o,s,p),i[u>>2]=0,L(f=0|N(t,e,5,u),0|E(),n,r,o,s,p),i[u>>2]=0,L(f=0|N(t,e,4,u),0|E(),n,r,o,s,p),i[u>>2]=0,L(f=0|N(t,e,6,u),0|E(),n,r,o,s,p))),I=c}}function N(t,e,n,r){t|=0,e|=0,n|=0;var o,s,a=0,u=0,c=0,l=0,h=0,A=0,f=0;if((0|i[(r|=0)>>2])>0){a=0;do{n=0|ut(n),a=a+1|0}while((0|a)<(0|i[r>>2]))}o=0|Ee(0|t,0|e,45),E(),s=127&o,u=0|Dt(t,e),a=0|Ee(0|t,0|e,52),E(),a&=15;t:do{if(a)for(;;){if(A=0|Ee(0|t,0|e,0|(h=3*(15-a|0)|0)),E(),A&=7,f=0==(0|Ut(a)),a=a+-1|0,l=0|xe(7,0,0|h),e&=~(0|E()),t=(h=0|xe(0|i[(f?464:48)+(28*A|0)+(n<<2)>>2],0,0|h))|t&~l,e|=0|E(),!(n=0|i[(f?672:256)+(28*A|0)+(n<<2)>>2])){n=0;break t}if(!a){c=6;break}}else c=6}while(0);6==(0|c)&&(t|=A=0|xe(0|(f=0|i[880+(28*s|0)+(n<<2)>>2]),0,45),e=0|E()|-1040385&e,n=0|i[4304+(28*s|0)+(n<<2)>>2],127==(127&f|0)&&(f=0|xe(0|i[880+(28*s|0)+20>>2],0,45),e=0|E()|-1040385&e,n=0|i[4304+(28*s|0)+20>>2],t=0|kt(f|t,e),e=0|E(),i[r>>2]=1+(0|i[r>>2]))),c=0|Ee(0|t,0|e,45),E(),c&=127;t:do{if(0|F(c)){e:do{if(1==(0|Dt(t,e))){if((0|s)!=(0|c)){if(0|U(c,0|i[7728+(28*s|0)>>2])){t=0|jt(t,e),u=1,e=0|E();break}t=0|kt(t,e),u=1,e=0|E();break}switch(0|u){case 5:t=0|jt(t,e),e=0|E(),i[r>>2]=5+(0|i[r>>2]),u=0;break e;case 3:t=0|kt(t,e),e=0|E(),i[r>>2]=1+(0|i[r>>2]),u=0;break e;default:return f=0,w(0|(A=0)),0|f}}else u=0}while(0);if((0|n)>0){a=0;do{t=0|Ft(t,e),e=0|E(),a=a+1|0}while((0|a)!=(0|n))}if((0|s)!=(0|c)){if(!(0|k(c))){if(0!=(0|u)|5!=(0|Dt(t,e)))break;i[r>>2]=1+(0|i[r>>2]);break}switch(127&o){case 8:case 118:break t}3!=(0|Dt(t,e))&&(i[r>>2]=1+(0|i[r>>2]))}}else if((0|n)>0){a=0;do{t=0|kt(t,e),e=0|E(),a=a+1|0}while((0|a)!=(0|n))}}while(0);return i[r>>2]=((0|i[r>>2])+n|0)%6|0,f=t,w(0|(A=e)),0|f}function D(t,e,n,r,s,a){e|=0,n|=0,r|=0,s|=0,a|=0;var u,c,l,h,A,f,p,d,g,y=0,m=0,_=0,v=0,b=0,w=0,x=0,S=0,P=0,T=0,C=0,M=0,O=0,R=0;if(g=I,I=I+48|0,f=g+32|0,p=g+16|0,d=g,(0|(y=0|i[(t|=0)>>2]))<=0)return I=g,0;u=t+4|0,c=f+8|0,l=p+8|0,h=d+8|0,A=((0|e)<0)<<31>>31,C=0;t:for(;;){P=(m=0|i[u>>2])+(C<<4)|0,i[f>>2]=i[P>>2],i[f+4>>2]=i[P+4>>2],i[f+8>>2]=i[P+8>>2],i[f+12>>2]=i[P+12>>2],(0|C)==(y+-1|0)?(i[p>>2]=i[m>>2],i[p+4>>2]=i[m+4>>2],i[p+8>>2]=i[m+8>>2],i[p+12>>2]=i[m+12>>2]):(P=m+(C+1<<4)|0,i[p>>2]=i[P>>2],i[p+4>>2]=i[P+4>>2],i[p+8>>2]=i[P+8>>2],i[p+12>>2]=i[P+12>>2]),P=0|q(f,p,n);e:do{if((0|P)>0){T=+(0|P),S=0;n:for(;;){R=+(P-S|0),O=+(0|S),o[d>>3]=+o[f>>3]*R/T+ +o[p>>3]*O/T,o[h>>3]=+o[c>>3]*R/T+ +o[l>>3]*O/T,m=0|we(0|(w=0|zt(d,n)),0|(x=0|E()),0|e,0|A),E(),v=0|i[(_=y=a+(m<<3)|0)>>2],_=0|i[_+4>>2];r:do{if(0==(0|v)&0==(0|_))M=14;else for(b=0;;){if((0|b)>(0|e)){y=1;break r}if((0|v)==(0|w)&(0|_)==(0|x)){y=7;break r}if(0==(0|(v=0|i[(_=y=a+((m=(m+1|0)%(0|e)|0)<<3)|0)>>2]))&0==(0|(_=0|i[_+4>>2]))){M=14;break}b=b+1|0}}while(0);switch(14==(0|M)&&(M=0,0==(0|w)&0==(0|x)?y=7:(i[y>>2]=w,i[y+4>>2]=x,y=0|i[r>>2],i[(b=s+(y<<3)|0)>>2]=w,i[b+4>>2]=x,i[r>>2]=y+1,y=0)),7&y){case 7:case 0:break;default:break n}if((0|P)<=(0|(S=S+1|0))){M=8;break e}}if(0|y){y=-1,M=20;break t}}else M=8}while(0);if(8==(0|M)&&(M=0),(0|(C=C+1|0))>=(0|(y=0|i[t>>2]))){y=0,M=20;break}}return 20==(0|M)?(I=g,0|y):0}function F(t){return 0|i[7728+(28*(t|=0)|0)+16>>2]}function k(t){return 4==(0|(t|=0))|117==(0|t)|0}function B(t){return 0|i[11152+(216*(0|i[(t|=0)>>2])|0)+(72*(0|i[t+4>>2])|0)+(24*(0|i[t+8>>2])|0)+(i[t+12>>2]<<3)>>2]}function j(t){return 0|i[11152+(216*(0|i[(t|=0)>>2])|0)+(72*(0|i[t+4>>2])|0)+(24*(0|i[t+8>>2])|0)+(i[t+12>>2]<<3)+4>>2]}function U(t,e){return e|=0,(0|i[7728+(28*(t|=0)|0)+20>>2])==(0|e)?0|(e=1):0|(e=(0|i[7728+(28*t|0)+24>>2])==(0|e))}function z(t,e){return 0|i[880+(28*(t|=0)|0)+((e|=0)<<2)>>2]}function G(t,e){return e|=0,(0|i[880+(28*(t|=0)|0)>>2])==(0|e)?0|(e=0):(0|i[880+(28*t|0)+4>>2])==(0|e)?0|(e=1):(0|i[880+(28*t|0)+8>>2])==(0|e)?0|(e=2):(0|i[880+(28*t|0)+12>>2])==(0|e)?0|(e=3):(0|i[880+(28*t|0)+16>>2])==(0|e)?0|(e=4):(0|i[880+(28*t|0)+20>>2])==(0|e)?0|(e=5):0|((0|i[880+(28*t|0)+24>>2])==(0|e)?6:7)}function V(t){return+o[16+(t|=0)>>3]<+o[t+24>>3]|0}function Z(t,e){t|=0;var n,r,i=0;return(i=+o[(e|=0)>>3])>=+o[t+8>>3]&&i<=+o[t>>3]?(n=+o[t+16>>3],i=+o[t+24>>3],e=(r=+o[e+8>>3])>=i,t=r<=n&1,n<i?e&&(t=1):e||(t=0),0|(e=0!=(0|t))):0|(e=0)}function H(t,e){t|=0,e|=0;var n,r,s,a,c,l,h=0,A=0;a=I,I=I+288|0,n=a+264|0,r=a+96|0,A=(h=s=a)+96|0;do{i[h>>2]=0,h=h+4|0}while((0|h)<(0|A));return qt(e,s),Zt(A=0|i[(h=s)>>2],h=0|i[h+4>>2],n),Ht(A,h,r),c=+Ct(n,r+8|0),o[n>>3]=+o[t>>3],o[(h=n+8|0)>>3]=+o[t+16>>3],o[r>>3]=+o[t+8>>3],o[(A=r+8|0)>>3]=+o[t+24>>3],l=+Ct(n,r),A=~~+m(+l*l/+Se(+ +u(+(+o[h>>3]-+o[A>>3])/(+o[n>>3]-+o[r>>3])),3)/(c*(2.59807621135*c)*.8)),I=a,0|(0==(0|A)?1:A)}function q(t,e,n){t|=0,e|=0,n|=0;var r,o,s,a,u,c=0,l=0;a=I,I=I+288|0,r=a+264|0,o=a+96|0,l=(c=s=a)+96|0;do{i[c>>2]=0,c=c+4|0}while((0|c)<(0|l));return qt(n,s),Zt(c=0|i[(l=s)>>2],l=0|i[l+4>>2],r),Ht(c,l,o),u=+Ct(r,o+8|0),l=~~+m(+ +Ct(t,e)/(2*u)),I=a,0|(0==(0|l)?1:l)}function W(t,e,n,r){e|=0,n|=0,r|=0,i[(t|=0)>>2]=e,i[t+4>>2]=n,i[t+8>>2]=r}function X(t,e){t|=0;var n,r,s,a,c=0,l=0,h=0,A=0,f=0,p=0,d=0;i[(a=8+(e|=0)|0)>>2]=0,r=+o[t>>3],A=+u(+r),s=+o[t+8>>3],A+=.5*(f=+u(+s)/.8660254037844386),A-=+(0|(c=~~A)),f-=+(0|(t=~~f));do{if(A<.5){if(A<.3333333333333333){if(i[e>>2]=c,f<.5*(A+1)){i[e+4>>2]=t;break}t=t+1|0,i[e+4>>2]=t;break}if(t=(1&!(f<(d=1-A)))+t|0,i[e+4>>2]=t,d<=f&f<2*A){c=c+1|0,i[e>>2]=c;break}i[e>>2]=c;break}if(!(A<.6666666666666666)){if(c=c+1|0,i[e>>2]=c,f<.5*A){i[e+4>>2]=t;break}t=t+1|0,i[e+4>>2]=t;break}if(f<1-A){if(i[e+4>>2]=t,2*A-1<f){i[e>>2]=c;break}}else t=t+1|0,i[e+4>>2]=t;c=c+1|0,i[e>>2]=c}while(0);do{if(r<0){if(1&t){c=~~(+(0|c)-(2*(+((p=0|ve(0|c,((0|c)<0)<<31>>31|0,0|(p=(t+1|0)/2|0),((0|p)<0)<<31>>31|0))>>>0)+4294967296*+(0|E()))+1)),i[e>>2]=c;break}c=~~(+(0|c)-2*(+((p=0|ve(0|c,((0|c)<0)<<31>>31|0,0|(p=(0|t)/2|0),((0|p)<0)<<31>>31|0))>>>0)+4294967296*+(0|E()))),i[e>>2]=c;break}}while(0);p=e+4|0,s<0&&(c=c-((1|t<<1)/2|0)|0,i[e>>2]=c,t=0-t|0,i[p>>2]=t),l=t-c|0,(0|c)<0?(h=0-c|0,i[p>>2]=l,i[a>>2]=h,i[e>>2]=0,t=l,c=0):h=0,(0|t)<0&&(c=c-t|0,i[e>>2]=c,h=h-t|0,i[a>>2]=h,i[p>>2]=0,t=0),n=c-h|0,l=t-h|0,(0|h)<0&&(i[e>>2]=n,i[p>>2]=l,i[a>>2]=0,t=l,c=n,h=0),(0|(l=(0|h)<(0|(l=(0|t)<(0|c)?t:c))?h:l))<=0||(i[e>>2]=c-l,i[p>>2]=t-l,i[a>>2]=h-l)}function Y(t){var e,n=0,r=0,o=0,s=0,a=0;n=0|i[(t|=0)>>2],r=0|i[(e=t+4|0)>>2],(0|n)<0&&(r=r-n|0,i[e>>2]=r,i[(a=t+8|0)>>2]=(0|i[a>>2])-n,i[t>>2]=0,n=0),(0|r)<0?(n=n-r|0,i[t>>2]=n,s=(0|i[(a=t+8|0)>>2])-r|0,i[a>>2]=s,i[e>>2]=0,r=0):(a=s=t+8|0,s=0|i[s>>2]),(0|s)<0&&(n=n-s|0,i[t>>2]=n,r=r-s|0,i[e>>2]=r,i[a>>2]=0,s=0),(0|(o=(0|s)<(0|(o=(0|r)<(0|n)?r:n))?s:o))<=0||(i[t>>2]=n-o,i[e>>2]=r-o,i[a>>2]=s-o)}function Q(t,e){var n,r;e|=0,r=0|i[8+(t|=0)>>2],n=+((0|i[t+4>>2])-r|0),o[e>>3]=+((0|i[t>>2])-r|0)-.5*n,o[e+8>>3]=.8660254037844386*n}function K(t,e,n){t|=0,e|=0,i[(n|=0)>>2]=(0|i[e>>2])+(0|i[t>>2]),i[n+4>>2]=(0|i[e+4>>2])+(0|i[t+4>>2]),i[n+8>>2]=(0|i[e+8>>2])+(0|i[t+8>>2])}function J(t,e,n){t|=0,e|=0,i[(n|=0)>>2]=(0|i[t>>2])-(0|i[e>>2]),i[n+4>>2]=(0|i[t+4>>2])-(0|i[e+4>>2]),i[n+8>>2]=(0|i[t+8>>2])-(0|i[e+8>>2])}function $(t,e){e|=0;var n,r=0;r=0|_(0|i[(t|=0)>>2],e),i[t>>2]=r,n=0|_(0|i[(r=t+4|0)>>2],e),i[r>>2]=n,e=0|_(0|i[(t=t+8|0)>>2],e),i[t>>2]=e}function tt(t){var e,n,r=0,o=0,s=0,a=0,u=0;u=(0|(n=0|i[(t|=0)>>2]))<0,t=(t=(o=(0|(a=((e=(0|(s=(0|i[t+4>>2])-(u?n:0)|0))<0)?0-s|0:0)+((0|i[t+8>>2])-(u?n:0))|0))<0)?0:a)-((s=(0|(o=(0|t)<(0|(o=(0|(r=(e?0:s)-(o?a:0)|0))<(0|(a=(u?0:n)-(e?s:0)-(o?a:0)|0))?r:a))?t:o))>0)?o:0)|0,r=r-(s?o:0)|0;t:do{switch(a-(s?o:0)|0){case 0:switch(0|r){case 0:return 0|(0==(0|t)?0:1==(0|t)?1:7);case 1:return 0|(0==(0|t)?2:1==(0|t)?3:7);default:break t}case 1:switch(0|r){case 0:return 0|(0==(0|t)?4:1==(0|t)?5:7);case 1:if(t)break t;return 6;default:break t}}}while(0);return 7}function et(t){var e,n,r=0,o=0,s=0,a=0,u=0;o=0|i[(e=8+(t|=0)|0)>>2],s=0|ge(+((3*(r=(0|i[t>>2])-o|0)|0)-(o=(0|i[(n=t+4|0)>>2])-o|0)|0)/7),i[t>>2]=s,r=0|ge(+((o<<1)+r|0)/7),i[n>>2]=r,i[e>>2]=0,o=r-s|0,(0|s)<0?(u=0-s|0,i[n>>2]=o,i[e>>2]=u,i[t>>2]=0,r=o,s=0,o=u):o=0,(0|r)<0&&(s=s-r|0,i[t>>2]=s,o=o-r|0,i[e>>2]=o,i[n>>2]=0,r=0),u=s-o|0,a=r-o|0,(0|o)<0?(i[t>>2]=u,i[n>>2]=a,i[e>>2]=0,r=a,a=u,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|r)<(0|a)?r:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=r-s,i[e>>2]=o-s)}function nt(t){var e,n,r=0,o=0,s=0,a=0,u=0;o=0|i[(e=8+(t|=0)|0)>>2],s=0|ge(+(((r=(0|i[t>>2])-o|0)<<1)+(o=(0|i[(n=t+4|0)>>2])-o|0)|0)/7),i[t>>2]=s,r=0|ge(+((3*o|0)-r|0)/7),i[n>>2]=r,i[e>>2]=0,o=r-s|0,(0|s)<0?(u=0-s|0,i[n>>2]=o,i[e>>2]=u,i[t>>2]=0,r=o,s=0,o=u):o=0,(0|r)<0&&(s=s-r|0,i[t>>2]=s,o=o-r|0,i[e>>2]=o,i[n>>2]=0,r=0),u=s-o|0,a=r-o|0,(0|o)<0?(i[t>>2]=u,i[n>>2]=a,i[e>>2]=0,r=a,a=u,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|r)<(0|a)?r:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=r-s,i[e>>2]=o-s)}function rt(t){var e,n,r,o=0,s=0,a=0,u=0;o=0|i[(t|=0)>>2],s=0|i[(n=t+4|0)>>2],a=0|i[(r=t+8|0)>>2],u=s+(3*o|0)|0,i[t>>2]=u,s=a+(3*s|0)|0,i[n>>2]=s,o=(3*a|0)+o|0,i[r>>2]=o,a=s-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=a,i[r>>2]=o,i[t>>2]=0,s=a,a=0):a=u,(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,u=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=u,i[r>>2]=0,a=e,o=0):u=s,(0|(s=(0|o)<(0|(s=(0|u)<(0|a)?u:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=u-s,i[r>>2]=o-s)}function it(t){var e,n,r,o=0,s=0,a=0,u=0;u=0|i[(t|=0)>>2],a=(3*(o=0|i[(n=t+4|0)>>2])|0)+u|0,u=(s=0|i[(r=t+8|0)>>2])+(3*u|0)|0,i[t>>2]=u,i[n>>2]=a,o=(3*s|0)+o|0,i[r>>2]=o,s=a-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,u=0):s=a,(0|s)<0&&(u=u-s|0,i[t>>2]=u,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=u-o|0,a=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=a,i[r>>2]=0,u=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|u)?a:u))?o:s))<=0||(i[t>>2]=u-s,i[n>>2]=a-s,i[r>>2]=o-s)}function ot(t,e){t|=0;var n,r,o,s=0,a=0,u=0;((e|=0)-1|0)>>>0>=6||(u=(0|i[15472+(12*e|0)>>2])+(0|i[t>>2])|0,i[t>>2]=u,o=t+4|0,a=(0|i[15472+(12*e|0)+4>>2])+(0|i[o>>2])|0,i[o>>2]=a,r=t+8|0,e=(0|i[15472+(12*e|0)+8>>2])+(0|i[r>>2])|0,i[r>>2]=e,s=a-u|0,(0|u)<0?(e=e-u|0,i[o>>2]=s,i[r>>2]=e,i[t>>2]=0,a=0):(s=a,a=u),(0|s)<0&&(a=a-s|0,i[t>>2]=a,e=e-s|0,i[r>>2]=e,i[o>>2]=0,s=0),n=a-e|0,u=s-e|0,(0|e)<0?(i[t>>2]=n,i[o>>2]=u,i[r>>2]=0,a=n,e=0):u=s,(0|(s=(0|e)<(0|(s=(0|u)<(0|a)?u:a))?e:s))<=0||(i[t>>2]=a-s,i[o>>2]=u-s,i[r>>2]=e-s))}function st(t){var e,n,r,o=0,s=0,a=0,u=0;u=0|i[(t|=0)>>2],a=(o=0|i[(n=t+4|0)>>2])+u|0,u=(s=0|i[(r=t+8|0)>>2])+u|0,i[t>>2]=u,i[n>>2]=a,o=s+o|0,i[r>>2]=o,s=a-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,a=0):(s=a,a=u),(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,u=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=u,i[r>>2]=0,a=e,o=0):u=s,(0|(s=(0|o)<(0|(s=(0|u)<(0|a)?u:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=u-s,i[r>>2]=o-s)}function at(t){var e,n,r,o=0,s=0,a=0,u=0;o=0|i[(t|=0)>>2],a=0|i[(n=t+4|0)>>2],s=0|i[(r=t+8|0)>>2],u=a+o|0,i[t>>2]=u,a=s+a|0,i[n>>2]=a,o=s+o|0,i[r>>2]=o,s=a-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,a=0):(s=a,a=u),(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,u=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=u,i[r>>2]=0,a=e,o=0):u=s,(0|(s=(0|o)<(0|(s=(0|u)<(0|a)?u:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=u-s,i[r>>2]=o-s)}function ut(t){switch(0|(t|=0)){case 1:t=5;break;case 5:t=4;break;case 4:t=6;break;case 6:t=2;break;case 2:t=3;break;case 3:t=1}return 0|t}function ct(t){switch(0|(t|=0)){case 1:t=3;break;case 3:t=2;break;case 2:t=6;break;case 6:t=4;break;case 4:t=5;break;case 5:t=1}return 0|t}function lt(t){var e,n,r,o=0,s=0,a=0,u=0;o=0|i[(t|=0)>>2],s=0|i[(n=t+4|0)>>2],a=0|i[(r=t+8|0)>>2],u=s+(o<<1)|0,i[t>>2]=u,s=a+(s<<1)|0,i[n>>2]=s,o=(a<<1)+o|0,i[r>>2]=o,a=s-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=a,i[r>>2]=o,i[t>>2]=0,s=a,a=0):a=u,(0|s)<0&&(a=a-s|0,i[t>>2]=a,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=a-o|0,u=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=u,i[r>>2]=0,a=e,o=0):u=s,(0|(s=(0|o)<(0|(s=(0|u)<(0|a)?u:a))?o:s))<=0||(i[t>>2]=a-s,i[n>>2]=u-s,i[r>>2]=o-s)}function ht(t){var e,n,r,o=0,s=0,a=0,u=0;u=0|i[(t|=0)>>2],a=((o=0|i[(n=t+4|0)>>2])<<1)+u|0,u=(s=0|i[(r=t+8|0)>>2])+(u<<1)|0,i[t>>2]=u,i[n>>2]=a,o=(s<<1)+o|0,i[r>>2]=o,s=a-u|0,(0|u)<0?(o=o-u|0,i[n>>2]=s,i[r>>2]=o,i[t>>2]=0,u=0):s=a,(0|s)<0&&(u=u-s|0,i[t>>2]=u,o=o-s|0,i[r>>2]=o,i[n>>2]=0,s=0),e=u-o|0,a=s-o|0,(0|o)<0?(i[t>>2]=e,i[n>>2]=a,i[r>>2]=0,u=e,o=0):a=s,(0|(s=(0|o)<(0|(s=(0|a)<(0|u)?a:u))?o:s))<=0||(i[t>>2]=u-s,i[n>>2]=a-s,i[r>>2]=o-s)}function At(t,e){e|=0;var n,r,o,s=0,a=0,u=0;return o=(0|(r=(0|i[(t|=0)>>2])-(0|i[e>>2])|0))<0,n=(0|(a=(0|i[t+4>>2])-(0|i[e+4>>2])-(o?r:0)|0))<0,e=(e=(t=(0|(u=(o?0-r|0:0)+(0|i[t+8>>2])-(0|i[e+8>>2])+(n?0-a|0:0)|0))<0)?0:u)-((a=(0|(t=(0|e)<(0|(t=(0|(s=(n?0:a)-(t?u:0)|0))<(0|(u=(o?0:r)-(n?a:0)-(t?u:0)|0))?s:u))?e:t))>0)?t:0)|0,s=s-(a?t:0)|0,0|((0|(t=(0|(t=u-(a?t:0)|0))>-1?t:0-t|0))>(0|(e=(0|(s=(0|s)>-1?s:0-s|0))>(0|(e=(0|e)>-1?e:0-e|0))?s:e))?t:e)}function ft(t,e){var n;e|=0,n=0|i[8+(t|=0)>>2],i[e>>2]=(0|i[t>>2])-n,i[e+4>>2]=(0|i[t+4>>2])-n}function pt(t,e){e|=0;var n,r,o,s=0,a=0,u=0;a=0|i[(t|=0)>>2],i[e>>2]=a,t=0|i[t+4>>2],i[(r=e+4|0)>>2]=t,i[(o=e+8|0)>>2]=0,s=t-a|0,(0|a)<0?(t=0-a|0,i[r>>2]=s,i[o>>2]=t,i[e>>2]=0,a=0):(s=t,t=0),(0|s)<0&&(a=a-s|0,i[e>>2]=a,t=t-s|0,i[o>>2]=t,i[r>>2]=0,s=0),n=a-t|0,u=s-t|0,(0|t)<0?(i[e>>2]=n,i[r>>2]=u,i[o>>2]=0,s=u,u=n,t=0):u=a,(0|(a=(0|t)<(0|(a=(0|s)<(0|u)?s:u))?t:a))<=0||(i[e>>2]=u-a,i[r>>2]=s-a,i[o>>2]=t-a)}function dt(t){var e,n,r,o;n=(o=0|i[(e=8+(t|=0)|0)>>2])-(0|i[t>>2])|0,i[t>>2]=n,t=(0|i[(r=t+4|0)>>2])-o|0,i[r>>2]=t,i[e>>2]=0-(t+n)}function gt(t){var e,n,r=0,o=0,s=0,a=0,u=0;r=0-(o=0|i[(t|=0)>>2])|0,i[t>>2]=r,i[(e=t+8|0)>>2]=0,a=(s=0|i[(n=t+4|0)>>2])+o|0,(0|o)>0?(i[n>>2]=a,i[e>>2]=o,i[t>>2]=0,r=0,s=a):o=0,(0|s)<0?(u=r-s|0,i[t>>2]=u,o=o-s|0,i[e>>2]=o,i[n>>2]=0,a=u-o|0,r=0-o|0,(0|o)<0?(i[t>>2]=a,i[n>>2]=r,i[e>>2]=0,s=r,o=0):(s=0,a=u)):a=r,(0|(r=(0|o)<(0|(r=(0|s)<(0|a)?s:a))?o:r))<=0||(i[t>>2]=a-r,i[n>>2]=s-r,i[e>>2]=o-r)}function yt(t,e,n,r){e|=0,n|=0,r|=0;var s,a=0,u=0,c=0,l=0;if(s=I,I=I+32|0,function(t,e){e|=0;var n,r,i=0;i=+o[(t|=0)>>3],n=+h(+i),i=+A(+i),o[e+16>>3]=i,i=+o[t+8>>3],r=n*+h(+i),o[e>>3]=r,i=n*+A(+i),o[e+8>>3]=i}(t|=0,u=s),i[n>>2]=0,a=+ue(15888,u),(c=+ue(15912,u))<a&&(i[n>>2]=1,a=c),(c=+ue(15936,u))<a&&(i[n>>2]=2,a=c),(c=+ue(15960,u))<a&&(i[n>>2]=3,a=c),(c=+ue(15984,u))<a&&(i[n>>2]=4,a=c),(c=+ue(16008,u))<a&&(i[n>>2]=5,a=c),(c=+ue(16032,u))<a&&(i[n>>2]=6,a=c),(c=+ue(16056,u))<a&&(i[n>>2]=7,a=c),(c=+ue(16080,u))<a&&(i[n>>2]=8,a=c),(c=+ue(16104,u))<a&&(i[n>>2]=9,a=c),(c=+ue(16128,u))<a&&(i[n>>2]=10,a=c),(c=+ue(16152,u))<a&&(i[n>>2]=11,a=c),(c=+ue(16176,u))<a&&(i[n>>2]=12,a=c),(c=+ue(16200,u))<a&&(i[n>>2]=13,a=c),(c=+ue(16224,u))<a&&(i[n>>2]=14,a=c),(c=+ue(16248,u))<a&&(i[n>>2]=15,a=c),(c=+ue(16272,u))<a&&(i[n>>2]=16,a=c),(c=+ue(16296,u))<a&&(i[n>>2]=17,a=c),(c=+ue(16320,u))<a&&(i[n>>2]=18,a=c),(c=+ue(16344,u))<a&&(i[n>>2]=19,a=c),(c=+p(+(1-.5*a)))<1e-16)return i[r>>2]=0,i[r+4>>2]=0,i[r+8>>2]=0,i[r+12>>2]=0,void(I=s);if(n=0|i[n>>2],a=+Pt((a=+o[16368+(24*n|0)>>3])-+Pt(+function(t,e){t|=0;var n,r,i,s,a;return s=+o[(e|=0)>>3],r=+h(+s),i=+o[e+8>>3]-+o[t+8>>3],a=r*+A(+i),n=+o[t>>3],+ +y(+a,+(+A(+s)*+h(+n)-+h(+i)*(r*+A(+n))))}(15568+(n<<4)|0,t))),l=0|Ut(e)?+Pt(a+-.3334731722518321):a,a=+f(+c)/.381966011250105,(0|e)>0){u=0;do{a*=2.6457513110645907,u=u+1|0}while((0|u)!=(0|e))}c=+h(+l)*a,o[r>>3]=c,l=+A(+l)*a,o[r+8>>3]=l,I=s}function mt(t,e,n,r,s){e|=0,n|=0,r|=0,s|=0;var a=0,l=0;if((a=+function(t){var e,n;return n=+o[(t|=0)>>3],e=+o[t+8>>3],+ +c(+(n*n+e*e))}(t|=0))<1e-16)return e=15568+(e<<4)|0,i[s>>2]=i[e>>2],i[s+4>>2]=i[e+4>>2],i[s+8>>2]=i[e+8>>2],void(i[s+12>>2]=i[e+12>>2]);if(l=+y(+ +o[t+8>>3],+ +o[t>>3]),(0|n)>0){t=0;do{a/=2.6457513110645907,t=t+1|0}while((0|t)!=(0|n))}r?(a/=3,n=0==(0|Ut(n)),a=+g(.381966011250105*(n?a:a/2.6457513110645907))):(a=+g(.381966011250105*a),0|Ut(n)&&(l=+Pt(l+.3334731722518321))),function(t,e,n,r){t|=0,e=+e,r|=0;var s=0,a=0,c=0,l=0;if((n=+n)<1e-16)return i[r>>2]=i[t>>2],i[r+4>>2]=i[t+4>>2],i[r+8>>2]=i[t+8>>2],void(i[r+12>>2]=i[t+12>>2]);a=e<0?e+6.283185307179586:e,a=e>=6.283185307179586?a+-6.283185307179586:a;do{if(!(a<1e-16)){if(s=+u(+(a+-3.141592653589793))<1e-16,e=+o[t>>3],s){e-=n,o[r>>3]=e,s=r;break}if(c=+h(+n),n=+A(+n),e=c*+A(+e)+ +h(+a)*(n*+h(+e)),e=+d(+((e=e>1?1:e)<-1?-1:e)),o[r>>3]=e,+u(+(e+-1.5707963267948966))<1e-16)return o[r>>3]=1.5707963267948966,void(o[r+8>>3]=0);if(+u(+(e+1.5707963267948966))<1e-16)return o[r>>3]=-1.5707963267948966,void(o[r+8>>3]=0);if(l=+h(+e),a=n*+A(+a)/l,n=+o[t>>3],e=(c-+A(+e)*+A(+n))/+h(+n)/l,c=a>1?1:a,e=e>1?1:e,(e=+o[t+8>>3]+ +y(+(c<-1?-1:c),+(e<-1?-1:e)))>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);return void(o[r+8>>3]=e)}e=+o[t>>3]+n,o[r>>3]=e,s=r}while(0);if(+u(+(e+-1.5707963267948966))<1e-16)return o[s>>3]=1.5707963267948966,void(o[r+8>>3]=0);if(+u(+(e+1.5707963267948966))<1e-16)return o[s>>3]=-1.5707963267948966,void(o[r+8>>3]=0);if((e=+o[t+8>>3])>3.141592653589793)do{e+=-6.283185307179586}while(e>3.141592653589793);if(e<-3.141592653589793)do{e+=6.283185307179586}while(e<-3.141592653589793);o[r+8>>3]=e}(15568+(e<<4)|0,+Pt(+o[16368+(24*e|0)>>3]-l),a,s)}function _t(t,e,n){var r,o;e|=0,n|=0,r=I,I=I+16|0,Q(4+(t|=0)|0,o=r),mt(o,0|i[t>>2],e,0,n),I=r}function vt(t,e,n,r,s){t|=0,e|=0,n|=0,r|=0,s|=0;var a,u,c,l,h,A,f,p,d,g,y,m,_,v,b,w,E,S,P,T,C,M,O=0,R=0,L=0,N=0,D=0,F=0;if(M=I,I=I+272|0,N=M+240|0,P=M,T=M+224|0,C=M+208|0,y=M+176|0,m=M+160|0,_=M+192|0,v=M+144|0,b=M+128|0,w=M+112|0,E=M+96|0,S=M+80|0,i[(O=M+256|0)>>2]=e,i[N>>2]=i[t>>2],i[N+4>>2]=i[t+4>>2],i[N+8>>2]=i[t+8>>2],i[N+12>>2]=i[t+12>>2],bt(N,O,P),i[s>>2]=0,(0|(N=r+n+(5==(0|r)&1)|0))<=(0|n))I=M;else{u=T+4|0,c=y+4|0,l=n+5|0,h=16848+((a=0|i[O>>2])<<2)|0,A=16928+(a<<2)|0,f=b+8|0,p=w+8|0,d=E+8|0,g=C+4|0,L=n;t:for(;;){R=P+(((0|L)%5|0)<<4)|0,i[C>>2]=i[R>>2],i[C+4>>2]=i[R+4>>2],i[C+8>>2]=i[R+8>>2],i[C+12>>2]=i[R+12>>2];do{}while(2==(0|wt(C,a,0,1)));if((0|L)>(0|n)&0!=(0|Ut(e))){if(i[y>>2]=i[C>>2],i[y+4>>2]=i[C+4>>2],i[y+8>>2]=i[C+8>>2],i[y+12>>2]=i[C+12>>2],Q(u,m),r=0|i[y>>2],O=0|i[17008+(80*r|0)+(i[T>>2]<<2)>>2],i[y>>2]=i[18608+(80*r|0)+(20*O|0)>>2],(0|(R=0|i[18608+(80*r|0)+(20*O|0)+16>>2]))>0){t=0;do{st(c),t=t+1|0}while((0|t)<(0|R))}switch(R=18608+(80*r|0)+(20*O|0)+4|0,i[_>>2]=i[R>>2],i[_+4>>2]=i[R+4>>2],i[_+8>>2]=i[R+8>>2],$(_,3*(0|i[h>>2])|0),K(c,_,c),Y(c),Q(c,v),D=+(0|i[A>>2]),o[b>>3]=3*D,o[f>>3]=0,F=-1.5*D,o[w>>3]=F,o[p>>3]=2.598076211353316*D,o[E>>3]=F,o[d>>3]=-2.598076211353316*D,0|i[17008+(80*(0|i[y>>2])|0)+(i[C>>2]<<2)>>2]){case 1:t=w,r=b;break;case 3:t=E,r=w;break;case 2:t=b,r=E;break;default:t=12;break t}se(m,v,r,t,S),mt(S,0|i[y>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])}if((0|L)<(0|l)&&(Q(g,y),mt(y,0|i[C>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])),i[T>>2]=i[C>>2],i[T+4>>2]=i[C+4>>2],i[T+8>>2]=i[C+8>>2],i[T+12>>2]=i[C+12>>2],(0|(L=L+1|0))>=(0|N)){t=3;break}}3!=(0|t)?12==(0|t)&&x(22474,22521,581,22531):I=M}}function bt(t,e,n){t|=0,e|=0,n|=0;var r,o=0,s=0,a=0,u=0,c=0;r=I,I=I+128|0,s=r,u=20208,c=60+(a=o=r+64|0)|0;do{i[a>>2]=i[u>>2],a=a+4|0,u=u+4|0}while((0|a)<(0|c));u=20272,c=(a=s)+60|0;do{i[a>>2]=i[u>>2],a=a+4|0,u=u+4|0}while((0|a)<(0|c));o=(c=0==(0|Ut(0|i[e>>2])))?o:s,lt(s=t+4|0),ht(s),0|Ut(0|i[e>>2])&&(it(s),i[e>>2]=1+(0|i[e>>2])),i[n>>2]=i[t>>2],K(s,o,e=n+4|0),Y(e),i[n+16>>2]=i[t>>2],K(s,o+12|0,e=n+20|0),Y(e),i[n+32>>2]=i[t>>2],K(s,o+24|0,e=n+36|0),Y(e),i[n+48>>2]=i[t>>2],K(s,o+36|0,e=n+52|0),Y(e),i[n+64>>2]=i[t>>2],K(s,o+48|0,n=n+68|0),Y(n),I=r}function wt(t,e,n,r){n|=0,r|=0;var o,s,a,u,c,l,h=0,A=0,f=0,p=0,d=0;if(l=I,I=I+32|0,c=l+12|0,s=l,d=4+(t|=0)|0,p=0|i[16928+((e|=0)<<2)>>2],p=(u=0!=(0|r))?3*p|0:p,h=0|i[d>>2],o=0|i[(a=t+8|0)>>2],u){if((0|(h=o+h+(r=0|i[(A=t+12|0)>>2])|0))==(0|p))return I=l,1;f=A}else h=o+h+(r=0|i[(f=t+12|0)>>2])|0;if((0|h)<=(0|p))return I=l,0;do{if((0|r)>0){if(r=0|i[t>>2],(0|o)>0){A=18608+(80*r|0)+60|0,r=t;break}r=18608+(80*r|0)+40|0,n?(W(c,p,0,0),J(d,c,s),at(s),K(s,c,d),A=r,r=t):(A=r,r=t)}else A=18608+(80*(0|i[t>>2])|0)+20|0,r=t}while(0);if(i[r>>2]=i[A>>2],(0|i[(h=A+16|0)>>2])>0){r=0;do{st(d),r=r+1|0}while((0|r)<(0|i[h>>2]))}return t=A+4|0,i[c>>2]=i[t>>2],i[c+4>>2]=i[t+4>>2],i[c+8>>2]=i[t+8>>2],e=0|i[16848+(e<<2)>>2],$(c,u?3*e|0:e),K(d,c,d),Y(d),r=u&&((0|i[a>>2])+(0|i[d>>2])+(0|i[f>>2])|0)==(0|p)?1:2,I=l,0|r}function Et(t,e){t|=0,e|=0;var n=0;do{n=0|wt(t,e,0,1)}while(2==(0|n));return 0|n}function xt(t,e,n,r,s){t|=0,e|=0,n|=0,r|=0,s|=0;var a,u,c,l,h,A,f,p,d,g,y,m,_,v,b,w,E,S,P=0,T=0,C=0,M=0,O=0;if(S=I,I=I+240|0,v=S+208|0,b=S,w=S+192|0,E=S+176|0,d=S+160|0,g=S+144|0,y=S+128|0,m=S+112|0,_=S+96|0,i[(P=S+224|0)>>2]=e,i[v>>2]=i[t>>2],i[v+4>>2]=i[t+4>>2],i[v+8>>2]=i[t+8>>2],i[v+12>>2]=i[t+12>>2],St(v,P,b),i[s>>2]=0,(0|(p=r+n+(6==(0|r)&1)|0))<=(0|n))I=S;else{u=n+6|0,c=16928+((a=0|i[P>>2])<<2)|0,l=g+8|0,h=y+8|0,A=m+8|0,f=w+4|0,T=0,C=n,r=-1;t:for(;;){if(t=b+((P=(0|C)%6|0)<<4)|0,i[w>>2]=i[t>>2],i[w+4>>2]=i[t+4>>2],i[w+8>>2]=i[t+8>>2],i[w+12>>2]=i[t+12>>2],t=T,T=0|wt(w,a,0,1),(0|C)>(0|n)&0!=(0|Ut(e))&&1!=(0|t)&&(0|i[w>>2])!=(0|r)){switch(Q(b+(((P+5|0)%6|0)<<4)+4|0,E),Q(b+(P<<4)+4|0,d),M=+(0|i[c>>2]),o[g>>3]=3*M,o[l>>3]=0,O=-1.5*M,o[y>>3]=O,o[h>>3]=2.598076211353316*M,o[m>>3]=O,o[A>>3]=-2.598076211353316*M,P=0|i[v>>2],0|i[17008+(80*P|0)+(((0|r)==(0|P)?0|i[w>>2]:r)<<2)>>2]){case 1:t=y,r=g;break;case 3:t=m,r=y;break;case 2:t=g,r=m;break;default:t=8;break t}se(E,d,r,t,_),0|ae(E,_)||0|ae(d,_)||(mt(_,0|i[v>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2]))}if((0|C)<(0|u)&&(Q(f,E),mt(E,0|i[w>>2],a,1,s+8+(i[s>>2]<<4)|0),i[s>>2]=1+(0|i[s>>2])),(0|(C=C+1|0))>=(0|p)){t=3;break}r=0|i[w>>2]}3!=(0|t)?8==(0|t)&&x(22557,22521,746,22602):I=S}}function St(t,e,n){t|=0,e|=0,n|=0;var r,o=0,s=0,a=0,u=0,c=0;r=I,I=I+160|0,s=r,u=20336,c=72+(a=o=r+80|0)|0;do{i[a>>2]=i[u>>2],a=a+4|0,u=u+4|0}while((0|a)<(0|c));u=20416,c=(a=s)+72|0;do{i[a>>2]=i[u>>2],a=a+4|0,u=u+4|0}while((0|a)<(0|c));o=(c=0==(0|Ut(0|i[e>>2])))?o:s,lt(s=t+4|0),ht(s),0|Ut(0|i[e>>2])&&(it(s),i[e>>2]=1+(0|i[e>>2])),i[n>>2]=i[t>>2],K(s,o,e=n+4|0),Y(e),i[n+16>>2]=i[t>>2],K(s,o+12|0,e=n+20|0),Y(e),i[n+32>>2]=i[t>>2],K(s,o+24|0,e=n+36|0),Y(e),i[n+48>>2]=i[t>>2],K(s,o+36|0,e=n+52|0),Y(e),i[n+64>>2]=i[t>>2],K(s,o+48|0,e=n+68|0),Y(e),i[n+80>>2]=i[t>>2],K(s,o+60|0,n=n+84|0),Y(n),I=r}function Pt(t){var e;return e=(t=+t)<0?t+6.283185307179586:t,+(t>=6.283185307179586?e+-6.283185307179586:e)}function Tt(t,e){return e|=0,+u(+(+o[(t|=0)>>3]-+o[e>>3]))<17453292519943298e-27?0|(e=+u(+(+o[t+8>>3]-+o[e+8>>3]))<17453292519943298e-27):0|(e=0)}function Ct(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+A(.5*(r-n)))*i+(s=+A(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+y(+ +c(+s),+ +c(+(1-s)))*6371.007180918475}function Mt(t,e,n){t|=0,n|=0;var r,i,s,a,u=0,l=0,p=0,d=0,m=0,_=0;return _=+o[(e|=0)>>3],s=+o[t>>3],m=+A(.5*(_-s)),p=+o[e+8>>3],i=+o[t+8>>3],d=+A(.5*(p-i)),r=+h(+s),a=+h(+_),d=2*+y(+ +c(+(d=m*m+d*(a*r*d))),+ +c(+(1-d))),m=+o[n>>3],_=+A(.5*(m-_)),u=+o[n+8>>3],p=+A(.5*(u-p)),l=+h(+m),p=2*+y(+ +c(+(p=_*_+p*(a*l*p))),+ +c(+(1-p))),m=+A(.5*(s-m)),u=+A(.5*(i-u)),u=2*+y(+ +c(+(u=m*m+u*(r*l*u))),+ +c(+(1-u))),4*+g(+ +c(+ +f(.5*(l=.5*(d+p+u)))*+f(.5*(l-d))*+f(.5*(l-p))*+f(.5*(l-u))))}function It(t,e){return e=0|Ee(0|(t|=0),0|(e|=0),45),E(),127&e|0}function Ot(t,e){var n=0,r=0,i=0,o=0,s=0,a=0;if(!(!0&134217728==(-16777216&(e|=0)|0)))return 0;if(s=0|Ee(0|(t|=0),0|e,45),E(),(s&=127)>>>0>121)return 0;n=0|Ee(0|t,0|e,52),E(),n&=15;do{if(0|n){for(i=1,r=0;;){if(o=0|Ee(0|t,0|e,3*(15-i|0)|0),E(),0!=(0|(o&=7))&(1^r)){if(1==(0|o)&0!=(0|F(s))){a=0,r=13;break}r=1}if(7==(0|o)){a=0,r=13;break}if(!(i>>>0<n>>>0)){r=9;break}i=i+1|0}if(9==(0|r)){if(15!=(0|n))break;return 1}if(13==(0|r))return 0|a}}while(0);for(;;){if(a=0|Ee(0|t,0|e,3*(14-n|0)|0),E(),!(7==(7&a|0)&!0)){a=0,r=13;break}if(!(n>>>0<14)){a=1,r=13;break}n=n+1|0}return 13==(0|r)?0|a:0}function Rt(t,e,n){n|=0;var r=0,i=0;if(r=0|Ee(0|(t|=0),0|(e|=0),52),E(),(0|(r&=15))>=(0|n)){if((0|r)!=(0|n))if(n>>>0<=15){if(t|=i=0|xe(0|n,0,52),e=0|E()|-15728641&e,(0|r)>(0|n))do{i=0|xe(7,0,3*(14-n|0)|0),n=n+1|0,t|=i,e=0|E()|e}while((0|n)<(0|r))}else e=0,t=0}else e=0,t=0;return w(0|e),0|t}function Lt(t,e,n,r){n|=0,r|=0;var o,s=0,a=0,u=0,c=0,l=0,h=0;if(u=0|Ee(0|(t|=0),0|(e|=0),52),E(),(0|n)<16&(0|(u&=15))<=(0|n)){if((0|u)==(0|n))return i[(n=r)>>2]=t,void(i[n+4>>2]=e);if(o=(0|(l=0|ee(7,n-u|0)))/7|0,c=0|Ee(0|t,0|e,45),E(),0|F(127&c)){t:do{if(u)for(a=1;;){if(s=0|Ee(0|t,0|e,3*(15-a|0)|0),E(),0|(s&=7))break t;if(!(a>>>0<u>>>0)){s=0;break}a=a+1|0}else s=0}while(0);a=0==(0|s)}else a=0;if(h=0|xe(u+1|0,0,52),s=0|E()|-15728641&e,Lt(e=(h|t)&~(e=0|xe(7,0,0|(c=3*(14-u|0)|0))),u=s&~(0|E()),n,r),s=r+(o<<3)|0,!a)return Lt((h=0|xe(1,0,0|c))|e,0|E()|u,n,s),h=s+(o<<3)|0,Lt((l=0|xe(2,0,0|c))|e,0|E()|u,n,h),h=h+(o<<3)|0,Lt((l=0|xe(3,0,0|c))|e,0|E()|u,n,h),h=h+(o<<3)|0,Lt((l=0|xe(4,0,0|c))|e,0|E()|u,n,h),h=h+(o<<3)|0,Lt((l=0|xe(5,0,0|c))|e,0|E()|u,n,h),void Lt((l=0|xe(6,0,0|c))|e,0|E()|u,n,h+(o<<3)|0);a=s+(o<<3)|0,(0|l)>6&&(Ce(0|s,0,8+(h=(a>>>0>(l=s+8|0)>>>0?a:l)+-1+(0-s)|0)&-8|0),s=l+(h>>>3<<3)|0),Lt((h=0|xe(2,0,0|c))|e,0|E()|u,n,s),h=s+(o<<3)|0,Lt((l=0|xe(3,0,0|c))|e,0|E()|u,n,h),h=h+(o<<3)|0,Lt((l=0|xe(4,0,0|c))|e,0|E()|u,n,h),h=h+(o<<3)|0,Lt((l=0|xe(5,0,0|c))|e,0|E()|u,n,h),Lt((l=0|xe(6,0,0|c))|e,0|E()|u,n,h+(o<<3)|0)}}function Nt(t,e){var n=0,r=0,i=0;if(i=0|Ee(0|(t|=0),0|(e|=0),45),E(),!(0|F(127&i)))return 0;i=0|Ee(0|t,0|e,52),E(),i&=15;t:do{if(i)for(r=1;;){if(n=0|Ee(0|t,0|e,3*(15-r|0)|0),E(),0|(n&=7))break t;if(!(r>>>0<i>>>0)){n=0;break}r=r+1|0}else n=0}while(0);return 0|0==(0|n)&1}function Dt(t,e){var n=0,r=0,i=0;if(i=0|Ee(0|(t|=0),0|(e|=0),52),E(),!(i&=15))return 0;for(r=1;;){if(n=0|Ee(0|t,0|e,3*(15-r|0)|0),E(),0|(n&=7)){r=5;break}if(!(r>>>0<i>>>0)){n=0,r=5;break}r=r+1|0}return 5==(0|r)?0|n:0}function Ft(t,e){var n=0,r=0,i=0,o=0,s=0,a=0,u=0;if(u=0|Ee(0|(t|=0),0|(e|=0),52),E(),!(u&=15))return u=t,w(0|(a=e)),0|u;for(a=1,n=0;;){r=0|xe(7,0,0|(o=3*(15-a|0)|0)),i=0|E(),s=0|Ee(0|t,0|e,0|o),E(),t=(o=0|xe(0|ut(7&s),0,0|o))|t&~r,e=(s=0|E())|e&~i;t:do{if(!n)if(0==(o&r|0)&0==(s&i|0))n=0;else if(r=0|Ee(0|t,0|e,52),E(),r&=15){n=1;e:for(;;){switch(s=0|Ee(0|t,0|e,3*(15-n|0)|0),E(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<r>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(i=0|Ee(0|t,0|e,0|(s=3*(15-n|0)|0)),E(),o=0|xe(7,0,0|s),e&=~(0|E()),t=t&~o|(s=0|xe(0|ut(7&i),0,0|s)),e=0|e|E(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<u>>>0))break;a=a+1|0}return w(0|e),0|t}function kt(t,e){var n=0,r=0,i=0,o=0,s=0;if(r=0|Ee(0|(t|=0),0|(e|=0),52),E(),!(r&=15))return r=t,w(0|(n=e)),0|r;for(n=1;s=0|Ee(0|t,0|e,0|(o=3*(15-n|0)|0)),E(),i=0|xe(7,0,0|o),e&=~(0|E()),t=(o=0|xe(0|ut(7&s),0,0|o))|t&~i,e=0|E()|e,n>>>0<r>>>0;)n=n+1|0;return w(0|e),0|t}function Bt(t,e){var n=0,r=0,i=0,o=0,s=0,a=0,u=0;if(u=0|Ee(0|(t|=0),0|(e|=0),52),E(),!(u&=15))return u=t,w(0|(a=e)),0|u;for(a=1,n=0;;){r=0|xe(7,0,0|(o=3*(15-a|0)|0)),i=0|E(),s=0|Ee(0|t,0|e,0|o),E(),t=(o=0|xe(0|ct(7&s),0,0|o))|t&~r,e=(s=0|E())|e&~i;t:do{if(!n)if(0==(o&r|0)&0==(s&i|0))n=0;else if(r=0|Ee(0|t,0|e,52),E(),r&=15){n=1;e:for(;;){switch(s=0|Ee(0|t,0|e,3*(15-n|0)|0),E(),7&s){case 1:break e;case 0:break;default:n=1;break t}if(!(n>>>0<r>>>0)){n=1;break t}n=n+1|0}for(n=1;;){if(o=0|xe(7,0,0|(i=3*(15-n|0)|0)),s=e&~(0|E()),e=0|Ee(0|t,0|e,0|i),E(),t=t&~o|(e=0|xe(0|ct(7&e),0,0|i)),e=0|s|E(),!(n>>>0<r>>>0)){n=1;break}n=n+1|0}}else n=1}while(0);if(!(a>>>0<u>>>0))break;a=a+1|0}return w(0|e),0|t}function jt(t,e){var n=0,r=0,i=0,o=0,s=0;if(r=0|Ee(0|(t|=0),0|(e|=0),52),E(),!(r&=15))return r=t,w(0|(n=e)),0|r;for(n=1;o=0|xe(7,0,0|(s=3*(15-n|0)|0)),i=e&~(0|E()),e=0|Ee(0|t,0|e,0|s),E(),t=(e=0|xe(0|ct(7&e),0,0|s))|t&~o,e=0|E()|i,n>>>0<r>>>0;)n=n+1|0;return w(0|e),0|t}function Ut(t){return 0|(0|(t|=0))%2}function zt(t,e){var n,r;return t|=0,r=I,I=I+16|0,n=r,(e|=0)>>>0<=15&&2146435072!=(2146435072&i[t+4>>2]|0)&&2146435072!=(2146435072&i[t+8+4>>2]|0)?(function(t,e,n){var r,i;r=I,I=I+16|0,yt(t|=0,e|=0,n|=0,i=r),X(i,n+4|0),I=r}(t,e,n),e=0|function(t,e){t|=0;var n,r=0,o=0,s=0,a=0,u=0,c=0,l=0,h=0;if(n=I,I=I+64|0,c=n+40|0,o=n+24|0,s=n+12|0,a=n,xe(0|(e|=0),0,52),r=134225919|E(),!e)return(0|i[t+4>>2])>2||(0|i[t+8>>2])>2||(0|i[t+12>>2])>2?(c=0,w(0|(u=0)),I=n,0|c):(xe(0|B(t),0,45),u=0|E()|r,c=-1,w(0|u),I=n,0|c);if(i[c>>2]=i[t>>2],i[c+4>>2]=i[t+4>>2],i[c+8>>2]=i[t+8>>2],i[c+12>>2]=i[t+12>>2],u=c+4|0,(0|e)>0)for(t=-1;i[o>>2]=i[u>>2],i[o+4>>2]=i[u+4>>2],i[o+8>>2]=i[u+8>>2],1&e?(et(u),i[s>>2]=i[u>>2],i[s+4>>2]=i[u+4>>2],i[s+8>>2]=i[u+8>>2],rt(s)):(nt(u),i[s>>2]=i[u>>2],i[s+4>>2]=i[u+4>>2],i[s+8>>2]=i[u+8>>2],it(s)),J(o,s,a),Y(a),l=0|xe(7,0,0|(h=3*(15-e|0)|0)),r&=~(0|E()),t=(h=0|xe(0|tt(a),0,0|h))|t&~l,r=0|E()|r,(0|e)>1;)e=e+-1|0;else t=-1;t:do{if((0|i[u>>2])<=2&&(0|i[c+8>>2])<=2&&(0|i[c+12>>2])<=2){if(e=0|xe(0|(o=0|B(c)),0,45),e|=t,t=0|E()|-1040385&r,a=0|j(c),!(0|F(o))){if((0|a)<=0)break;for(s=0;;){if(o=0|Ee(0|e,0|t,52),E(),o&=15)for(r=1;c=0|Ee(0|e,0|t,0|(h=3*(15-r|0)|0)),E(),l=0|xe(7,0,0|h),t&=~(0|E()),e=e&~l|(h=0|xe(0|ut(7&c),0,0|h)),t=0|t|E(),r>>>0<o>>>0;)r=r+1|0;if((0|(s=s+1|0))==(0|a))break t}}s=0|Ee(0|e,0|t,52),E(),s&=15;e:do{if(s){r=1;n:for(;;){switch(h=0|Ee(0|e,0|t,3*(15-r|0)|0),E(),7&h){case 1:break n;case 0:break;default:break e}if(!(r>>>0<s>>>0))break e;r=r+1|0}if(0|U(o,0|i[c>>2]))for(r=1;l=0|xe(7,0,0|(c=3*(15-r|0)|0)),h=t&~(0|E()),t=0|Ee(0|e,0|t,0|c),E(),e=e&~l|(t=0|xe(0|ct(7&t),0,0|c)),t=0|h|E(),r>>>0<s>>>0;)r=r+1|0;else for(r=1;c=0|Ee(0|e,0|t,0|(h=3*(15-r|0)|0)),E(),l=0|xe(7,0,0|h),t&=~(0|E()),e=e&~l|(h=0|xe(0|ut(7&c),0,0|h)),t=0|t|E(),r>>>0<s>>>0;)r=r+1|0}}while(0);if((0|a)>0){r=0;do{e=0|Ft(e,t),t=0|E(),r=r+1|0}while((0|r)!=(0|a))}}else e=0,t=0}while(0);return h=e,w(0|(l=t)),I=n,0|h}(n,e),t=0|E()):(t=0,e=0),w(0|t),I=r,0|e}function Gt(t,e,n){var r,o=0,s=0,a=0;if(r=4+(n|=0)|0,s=0|Ee(0|(t|=0),0|(e|=0),52),E(),s&=15,a=0|Ee(0|t,0|e,45),E(),o=0==(0|s),0|F(127&a)){if(o)return 1;o=1}else{if(o)return 0;o=0==(0|i[r>>2])&&0==(0|i[n+8>>2])?0!=(0|i[n+12>>2])&1:1}for(n=1;1&n?rt(r):it(r),a=0|Ee(0|t,0|e,3*(15-n|0)|0),E(),ot(r,7&a),n>>>0<s>>>0;)n=n+1|0;return 0|o}function Vt(t,e,n){n|=0;var r,o,s=0,a=0,u=0,c=0,l=0,h=0;o=I,I=I+16|0,r=o,h=0|Ee(0|(t|=0),0|(e|=0),45),E(),h&=127;t:do{if(0!=(0|F(h))&&(u=0|Ee(0|t,0|e,52),E(),0!=(0|(u&=15)))){s=1;e:for(;;){switch(l=0|Ee(0|t,0|e,3*(15-s|0)|0),E(),7&l){case 5:break e;case 0:break;default:s=e;break t}if(!(s>>>0<u>>>0)){s=e;break t}s=s+1|0}for(a=1,s=e;c=0|xe(7,0,0|(e=3*(15-a|0)|0)),l=s&~(0|E()),s=0|Ee(0|t,0|s,0|e),E(),t=t&~c|(s=0|xe(0|ct(7&s),0,0|e)),s=0|l|E(),a>>>0<u>>>0;)a=a+1|0}else s=e}while(0);if(l=7728+(28*h|0)|0,i[n>>2]=i[l>>2],i[n+4>>2]=i[l+4>>2],i[n+8>>2]=i[l+8>>2],i[n+12>>2]=i[l+12>>2],0|Gt(t,s,n)){if(c=n+4|0,i[r>>2]=i[c>>2],i[r+4>>2]=i[c+4>>2],i[r+8>>2]=i[c+8>>2],u=0|Ee(0|t,0|s,52),E(),l=15&u,1&u?(it(c),u=l+1|0):u=l,0|F(h)){t:do{if(l)for(e=1;;){if(a=0|Ee(0|t,0|s,3*(15-e|0)|0),E(),0|(a&=7)){s=a;break t}if(!(e>>>0<l>>>0)){s=0;break}e=e+1|0}else s=0}while(0);s=4==(0|s)&1}else s=0;if(0|wt(n,u,s,0)){if(0|F(h))do{}while(0!=(0|wt(n,u,0,0)));(0|u)!=(0|l)&&nt(c)}else(0|u)!=(0|l)&&(i[c>>2]=i[r>>2],i[c+4>>2]=i[r+4>>2],i[c+8>>2]=i[r+8>>2]);I=o}else I=o}function Zt(t,e,n){var r,i;n|=0,r=I,I=I+16|0,Vt(t|=0,e|=0,i=r),e=0|Ee(0|t,0|e,52),E(),_t(i,15&e,n),I=r}function Ht(t,e,n){n|=0;var r,i,o=0,s=0;i=I,I=I+16|0,Vt(t|=0,e|=0,r=i),o=0|Ee(0|t,0|e,45),E(),o=0==(0|F(127&o)),s=0|Ee(0|t,0|e,52),E(),s&=15;t:do{if(!o){if(0|s)for(o=1;;){if(!(0==((0|xe(7,0,3*(15-o|0)|0))&t|0)&0==((0|E())&e|0)))break t;if(!(o>>>0<s>>>0))break;o=o+1|0}return vt(r,s,0,5,n),void(I=i)}}while(0);xt(r,s,0,6,n),I=i}function qt(t,e){e|=0;var n,r=0,o=0,s=0,a=0,u=0,c=0;if(xe(0|(t|=0),0,52),n=134225919|E(),(0|t)<1){o=0,r=0;do{0|F(o)&&(xe(0|o,0,45),u=0|n|E(),i[(t=e+(r<<3)|0)>>2]=-1,i[t+4>>2]=u,r=r+1|0),o=o+1|0}while(122!=(0|o))}else{u=0,r=0;do{if(0|F(u)){for(xe(0|u,0,45),o=1,s=-1,a=0|n|E();s&=~(c=0|xe(7,0,3*(15-o|0)|0)),a&=~(0|E()),(0|o)!=(0|t);)o=o+1|0;i[(c=e+(r<<3)|0)>>2]=s,i[c+4>>2]=a,r=r+1|0}u=u+1|0}while(122!=(0|u))}}function Wt(t,e,n,r){var o,s=0,a=0,u=0,c=0,l=0;if(o=I,I=I+64|0,u=o,(0|(t|=0))==(0|(n|=0))&(0|(e|=0))==(0|(r|=0))|!1|134217728!=(2013265920&e|0)|!1|134217728!=(2013265920&r|0))return I=o,0;if(s=0|Ee(0|t,0|e,52),E(),s&=15,a=0|Ee(0|n,0|r,52),E(),(0|s)!=(15&a|0))return I=o,0;if(a=s+-1|0,s>>>0>1&&(l=0|Rt(t,e,a),c=0|E(),(0|l)==(0|(a=0|Rt(n,r,a)))&(0|c)==(0|E()))){if(s=0|Ee(0|t,0|e,0|(a=3*(15^s)|0)),E(),s&=7,a=0|Ee(0|n,0|r,0|a),E(),0==(0|s)|0==(0|(a&=7)))return I=o,1;if((0|i[21136+(s<<2)>>2])==(0|a))return I=o,1;if((0|i[21168+(s<<2)>>2])==(0|a))return I=o,1}a=(s=u)+56|0;do{i[s>>2]=0,s=s+4|0}while((0|s)<(0|a));return O(t,e,1,u),s=(0|i[(l=u)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)||(0|i[(l=u+8|0)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)||(0|i[(l=u+16|0)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)||(0|i[(l=u+24|0)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)||(0|i[(l=u+32|0)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)||(0|i[(l=u+40|0)>>2])==(0|n)&&(0|i[l+4>>2])==(0|r)?1:1&((0|i[(s=u+48|0)>>2])==(0|n)?(0|i[s+4>>2])==(0|r):0),I=o,0|s}function Xt(t,e,n){n|=0;var r,o,s,a,u=0;if(s=I,I=I+16|0,o=s,u=0|Ee(0|(t|=0),0|(e|=0),56),E(),-1==(0|(e=0|function(t,e,n){n|=0;var r,o=0;return o=0|Nt(t|=0,e|=0),(n+-1|0)>>>0>5||1==(0|n)&(r=0!=(0|o))?-1:(o=0|function(t,e){var n,r,o,s=0,a=0,u=0,c=0,l=0;if(o=I,I=I+32|0,r=o,Vt(t|=0,e|=0,n=o+16|0),u=0|It(t,e),l=0|Dt(t,e),function(t,e){t=7728+(28*(t|=0)|0)|0,i[(e|=0)>>2]=i[t>>2],i[e+4>>2]=i[t+4>>2],i[e+8>>2]=i[t+8>>2],i[e+12>>2]=i[t+12>>2]}(u,r),e=0|function(t,e){t|=0;var n=0,r=0;if((e|=0)>>>0>20)return-1;do{if((0|i[11152+(216*e|0)>>2])!=(0|t))if((0|i[11152+(216*e|0)+8>>2])!=(0|t))if((0|i[11152+(216*e|0)+16>>2])!=(0|t))if((0|i[11152+(216*e|0)+24>>2])!=(0|t))if((0|i[11152+(216*e|0)+32>>2])!=(0|t))if((0|i[11152+(216*e|0)+40>>2])!=(0|t))if((0|i[11152+(216*e|0)+48>>2])!=(0|t))if((0|i[11152+(216*e|0)+56>>2])!=(0|t))if((0|i[11152+(216*e|0)+64>>2])!=(0|t))if((0|i[11152+(216*e|0)+72>>2])!=(0|t))if((0|i[11152+(216*e|0)+80>>2])!=(0|t))if((0|i[11152+(216*e|0)+88>>2])!=(0|t))if((0|i[11152+(216*e|0)+96>>2])!=(0|t))if((0|i[11152+(216*e|0)+104>>2])!=(0|t))if((0|i[11152+(216*e|0)+112>>2])!=(0|t))if((0|i[11152+(216*e|0)+120>>2])!=(0|t))if((0|i[11152+(216*e|0)+128>>2])!=(0|t)){if((0|i[11152+(216*e|0)+136>>2])!=(0|t)){if((0|i[11152+(216*e|0)+144>>2])==(0|t)){t=0,n=2,r=0;break}if((0|i[11152+(216*e|0)+152>>2])==(0|t)){t=0,n=2,r=1;break}if((0|i[11152+(216*e|0)+160>>2])==(0|t)){t=0,n=2,r=2;break}if((0|i[11152+(216*e|0)+168>>2])==(0|t)){t=1,n=2,r=0;break}if((0|i[11152+(216*e|0)+176>>2])==(0|t)){t=1,n=2,r=1;break}if((0|i[11152+(216*e|0)+184>>2])==(0|t)){t=1,n=2,r=2;break}if((0|i[11152+(216*e|0)+192>>2])==(0|t)){t=2,n=2,r=0;break}if((0|i[11152+(216*e|0)+200>>2])==(0|t)){t=2,n=2,r=1;break}if((0|i[11152+(216*e|0)+208>>2])==(0|t)){t=2,n=2,r=2;break}return-1}t=2,n=1,r=2}else t=2,n=1,r=1;else t=2,n=1,r=0;else t=1,n=1,r=2;else t=1,n=1,r=1;else t=1,n=1,r=0;else t=0,n=1,r=2;else t=0,n=1,r=1;else t=0,n=1,r=0;else t=2,n=0,r=2;else t=2,n=0,r=1;else t=2,n=0,r=0;else t=1,n=0,r=2;else t=1,n=0,r=1;else t=1,n=0,r=0;else t=0,n=0,r=2;else t=0,n=0,r=1;else t=0,n=0,r=0}while(0);return 0|i[11152+(216*e|0)+(72*n|0)+(24*t|0)+(r<<3)+4>>2]}(u,0|i[n>>2]),!(0|F(u)))return I=o,0|e;switch(0|u){case 4:t=0,s=14;break;case 14:t=1,s=14;break;case 24:t=2,s=14;break;case 38:t=3,s=14;break;case 49:t=4,s=14;break;case 58:t=5,s=14;break;case 63:t=6,s=14;break;case 72:t=7,s=14;break;case 83:t=8,s=14;break;case 97:t=9,s=14;break;case 107:t=10,s=14;break;case 117:t=11,s=14;break;default:c=0,a=0}return 14==(0|s)&&(c=0|i[22096+(24*t|0)+8>>2],a=0|i[22096+(24*t|0)+16>>2]),(0|(t=0|i[n>>2]))!=(0|i[r>>2])&&(u=0|k(u))|(0|(t=0|i[n>>2]))==(0|a)&&(e=(e+1|0)%6|0),3==(0|l)&(0|t)==(0|a)?(I=o,0|(e+5|0)%6):5==(0|l)&(0|t)==(0|c)?(I=o,0|(e+1|0)%6):(I=o,0|e)}(t,e),r?0|(n=(5-o+(0|i[22384+(n<<2)>>2])|0)%5|0):0|(n=(6-o+(0|i[22416+(n<<2)>>2])|0)%6|0))}(r=(a=!0&268435456==(2013265920&e|0))?t:0,t=a?-2130706433&e|134217728:0,7&u))))return i[n>>2]=0,void(I=s);Vt(r,t,o),u=0|Ee(0|r,0|t,52),E(),u&=15,0|Nt(r,t)?vt(o,u,e,2,n):xt(o,u,e,2,n),I=s}function Yt(t){t|=0;var e,n,r=0;return(e=0|_e(1,12))||x(22691,22646,49,22704),0|(r=0|i[(n=t+4|0)>>2])?(i[(r=r+8|0)>>2]=e,i[n>>2]=e,0|e):(0|i[t>>2]&&x(22721,22646,61,22744),i[(r=t)>>2]=e,i[n>>2]=e,0|e)}function Qt(t,e){var n,r;return t|=0,e|=0,(r=0|ye(24))||x(22758,22646,78,22772),i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],i[r+12>>2]=i[e+12>>2],i[r+16>>2]=0,0|(n=0|i[(e=t+4|0)>>2])?(i[n+16>>2]=r,i[e>>2]=r,0|r):(0|i[t>>2]&&x(22787,22646,82,22772),i[t>>2]=r,i[e>>2]=r,0|r)}function Kt(t){var e,n,r=0,s=0,a=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0,E=0,S=0,P=0,T=0,C=0,M=0,I=0,O=0,R=0,L=0,N=0,D=0,F=0;if(0|i[(c=8+(t|=0)|0)>>2])return 1;if(!(a=0|i[t>>2]))return 0;r=a,s=0;do{s=s+1|0,r=0|i[r+8>>2]}while(0!=(0|r));if(s>>>0<2)return 0;(n=0|ye(s<<2))||x(22807,22646,317,22826),(e=0|ye(s<<5))||x(22848,22646,321,22826),i[t>>2]=0,i[(C=t+4|0)>>2]=0,i[c>>2]=0,s=0,N=0,T=0,g=0;t:for(;;){if(d=0|i[a>>2]){l=0,h=d;do{if(f=+o[h+8>>3],r=h,h=0|i[h+16>>2],A=+o[(c=(p=0==(0|h))?d:h)+8>>3],+u(+(f-A))>3.141592653589793){F=14;break}l+=(A-f)*(+o[r>>3]+ +o[c>>3])}while(!p);if(14==(0|F)){F=0,l=0,r=d;do{P=+o[r+8>>3],R=0|i[(L=r+16|0)>>2],S=+o[(R=0==(0|R)?d:R)+8>>3],l+=(+o[r>>3]+ +o[R>>3])*((S<0?S+6.283185307179586:S)-(P<0?P+6.283185307179586:P)),r=0|i[(0==(0|r)?a:L)>>2]}while(0!=(0|r))}l>0?(i[n+(N<<2)>>2]=a,N=N+1|0,c=T,r=g):F=19}else F=19;if(19==(0|F)){F=0;do{if(!s){if(g){c=C,h=g+8|0,r=a,s=t;break}if(0|i[t>>2]){F=27;break t}c=C,h=t,r=a,s=t;break}if(0|i[(r=s+8|0)>>2]){F=21;break t}if(!(s=0|_e(1,12))){F=23;break t}i[r>>2]=s,c=s+4|0,h=s,r=g}while(0);if(i[h>>2]=a,i[c>>2]=a,h=e+(T<<5)|0,p=0|i[a>>2]){for(o[(d=e+(T<<5)+8|0)>>3]=17976931348623157e292,o[(g=e+(T<<5)+24|0)>>3]=17976931348623157e292,o[h>>3]=-17976931348623157e292,o[(y=e+(T<<5)+16|0)>>3]=-17976931348623157e292,w=17976931348623157e292,E=-17976931348623157e292,c=0,m=p,f=17976931348623157e292,v=17976931348623157e292,b=-17976931348623157e292,A=-17976931348623157e292;l=+o[m>>3],P=+o[m+8>>3],m=0|i[m+16>>2],S=+o[((_=0==(0|m))?p:m)+8>>3],l<f&&(o[d>>3]=l,f=l),P<v&&(o[g>>3]=P,v=P),l>b?o[h>>3]=l:l=b,P>A&&(o[y>>3]=P,A=P),w=P>0&P<w?P:w,E=P<0&P>E?P:E,c|=+u(+(P-S))>3.141592653589793,!_;)b=l;c&&(o[y>>3]=E,o[g>>3]=w)}else i[h>>2]=0,i[h+4>>2]=0,i[h+8>>2]=0,i[h+12>>2]=0,i[h+16>>2]=0,i[h+20>>2]=0,i[h+24>>2]=0,i[h+28>>2]=0;c=T+1|0}if(a=0|i[(L=a+8|0)>>2],i[L>>2]=0,!a){F=45;break}T=c,g=r}if(21==(0|F))x(22624,22646,35,22658);else if(23==(0|F))x(22678,22646,37,22658);else if(27==(0|F))x(22721,22646,61,22744);else if(45==(0|F)){t:do{if((0|N)>0){for(L=0==(0|c),O=c<<2,R=0==(0|t),I=0,r=0;;){if(M=0|i[n+(I<<2)>>2],L)F=73;else{if(!(T=0|ye(O))){F=50;break}if(!(C=0|ye(O))){F=52;break}e:do{if(R)s=0;else{for(c=0,s=0,h=t;a=e+(c<<5)|0,0|Jt(0|i[h>>2],a,0|i[M>>2])?(i[T+(s<<2)>>2]=h,i[C+(s<<2)>>2]=a,_=s+1|0):_=s,h=0|i[h+8>>2];)c=c+1|0,s=_;if((0|_)>0)if(a=0|i[T>>2],1==(0|_))s=a;else for(y=0,m=-1,s=a,g=a;;){for(p=0|i[g>>2],a=0,h=0;d=(0|(c=0|i[i[T+(h<<2)>>2]>>2]))==(0|p)?a:a+(1&(0|Jt(c,0|i[C+(h<<2)>>2],0|i[p>>2])))|0,(0|(h=h+1|0))!=(0|_);)a=d;if(s=(c=(0|d)>(0|m))?g:s,(0|(a=y+1|0))==(0|_))break e;y=a,m=c?d:m,g=0|i[T+(a<<2)>>2]}else s=0}}while(0);if(me(T),me(C),s){if(a=0|i[(c=s+4|0)>>2])s=a+8|0;else if(0|i[s>>2]){F=70;break}i[s>>2]=M,i[c>>2]=M}else F=73}if(73==(0|F)){if(F=0,0|(r=0|i[M>>2]))do{C=r,r=0|i[r+16>>2],me(C)}while(0!=(0|r));me(M),r=2}if((0|(I=I+1|0))>=(0|N)){D=r;break t}}50==(0|F)?x(22863,22646,249,22882):52==(0|F)?x(22901,22646,252,22882):70==(0|F)&&x(22721,22646,61,22744)}else D=0}while(0);return me(n),me(e),0|D}return 0}function Jt(t,e,n){t|=0;var r,s=0,a=0,u=0,c=0,l=0,h=0,A=0;if(!(0|Z(e|=0,n|=0)))return 0;if(e=0|V(e),r=+o[n>>3],s=e&(s=+o[n+8>>3])<0?s+6.283185307179586:s,!(t=0|i[t>>2]))return 0;if(e){e=0,n=t;t:for(;;){for(;c=+o[n>>3],h=+o[n+8>>3],A=0|i[(n=n+16|0)>>2],u=+o[(A=0==(0|A)?t:A)>>3],a=+o[A+8>>3],c>u?(l=c,c=h):(l=u,u=c,c=a,a=h),r<u|r>l;)if(!(n=0|i[n>>2])){n=22;break t}if(s=(c=c<0?c+6.283185307179586:c)==s|(h=a<0?a+6.283185307179586:a)==s?s+-2220446049250313e-31:s,((h+=(r-u)/(l-u)*(c-h))<0?h+6.283185307179586:h)>s&&(e^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|e}else{e=0,n=t;t:for(;;){for(;c=+o[n>>3],h=+o[n+8>>3],A=0|i[(n=n+16|0)>>2],u=+o[(A=0==(0|A)?t:A)>>3],a=+o[A+8>>3],c>u?(l=c,c=h):(l=u,u=c,c=a,a=h),r<u|r>l;)if(!(n=0|i[n>>2])){n=22;break t}if(a+(r-u)/(l-u)*(c-a)>(s=c==s|a==s?s+-2220446049250313e-31:s)&&(e^=1),!(n=0|i[n>>2])){n=22;break}}if(22==(0|n))return 0|e}return 0}function $t(t,e,n,o,s){n|=0,o|=0,s|=0;var a,u,c,l,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0;if(l=I,I=I+32|0,v=l+16|0,c=l,h=0|Ee(0|(t|=0),0|(e|=0),52),E(),h&=15,y=0|Ee(0|n,0|o,52),E(),(0|h)!=(15&y|0))return I=l,1;if(d=0|Ee(0|t,0|e,45),E(),d&=127,g=0|Ee(0|n,0|o,45),E(),y=(0|d)!=(0|(g&=127))){if(7==(0|(f=0|G(d,g))))return I=l,2;7==(0|(p=0|G(g,d)))?x(22925,22949,151,22959):(m=f,A=p)}else m=0,A=0;a=0|F(d),u=0|F(g),i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0;do{if(m){if(f=(0|(g=0|i[4304+(28*d|0)+(m<<2)>>2]))>0,u)if(f){d=0,p=n,f=o;do{p=0|Bt(p,f),f=0|E(),1==(0|(A=0|ct(A)))&&(A=0|ct(1)),d=d+1|0}while((0|d)!=(0|g));g=A,d=p,p=f}else g=A,d=n,p=o;else if(f){d=0,p=n,f=o;do{p=0|jt(p,f),f=0|E(),A=0|ct(A),d=d+1|0}while((0|d)!=(0|g));g=A,d=p,p=f}else g=A,d=n,p=o;if(Gt(d,p,v),y||x(22972,22949,181,22959),(f=0!=(0|a))&(A=0!=(0|u))&&x(22999,22949,182,22959),f){if(A=0|Dt(t,e),0|r[22032+(7*A|0)+m>>0]){h=3;break}d=p=0|i[21200+(28*A|0)+(m<<2)>>2],_=26}else if(A){if(A=0|Dt(d,p),0|r[22032+(7*A|0)+g>>0]){h=4;break}d=0,p=0|i[21200+(28*g|0)+(A<<2)>>2],_=26}else A=0;if(26==(0|_))if((0|p)<=-1&&x(23030,22949,212,22959),(0|d)<=-1&&x(23053,22949,213,22959),(0|p)>0){f=v+4|0,A=0;do{at(f),A=A+1|0}while((0|A)!=(0|p));A=d}else A=d;if(i[c>>2]=0,i[c+4>>2]=0,i[c+8>>2]=0,ot(c,m),0|h)for(;0|Ut(h)?rt(c):it(c),(0|h)>1;)h=h+-1|0;if((0|A)>0){h=0;do{at(c),h=h+1|0}while((0|h)!=(0|A))}K(_=v+4|0,c,_),Y(_),_=50}else if(Gt(n,o,v),0!=(0|a)&0!=(0|u))if((0|g)!=(0|d)&&x(23077,22949,243,22959),A=0|Dt(t,e),h=0|Dt(n,o),0|r[22032+(7*A|0)+h>>0])h=5;else if((0|(A=0|i[21200+(28*A|0)+(h<<2)>>2]))>0){f=v+4|0,h=0;do{at(f),h=h+1|0}while((0|h)!=(0|A));_=50}else _=50;else _=50}while(0);return 50==(0|_)&&(h=v+4|0,i[s>>2]=i[h>>2],i[s+4>>2]=i[h+4>>2],i[s+8>>2]=i[h+8>>2],h=0),I=l,0|h}function te(t,e,n,r){n|=0,r|=0;var o,s,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0;if(s=I,I=I+48|0,c=s+36|0,l=s+24|0,h=s+12|0,A=s,u=0|Ee(0|(t|=0),0|(e|=0),52),E(),u&=15,p=0|Ee(0|t,0|e,45),E(),o=0|F(p&=127),xe(0|u,0,52),y=134225919|E(),i[(g=r)>>2]=-1,i[g+4>>2]=y,!u)return(0|i[n>>2])>1||(0|i[n+4>>2])>1||(0|i[n+8>>2])>1||127==(0|(a=0|z(p,0|tt(n))))?(I=s,0|(y=1)):(d=0|xe(0|a,0,45),g=0|E(),g=-1040385&i[(p=r)+4>>2]|g,i[(y=r)>>2]=i[p>>2]|d,i[y+4>>2]=g,I=s,0|(y=0));for(i[c>>2]=i[n>>2],i[c+4>>2]=i[n+4>>2],i[c+8>>2]=i[n+8>>2];i[l>>2]=i[c>>2],i[l+4>>2]=i[c+4>>2],i[l+8>>2]=i[c+8>>2],0|Ut(u)?(et(c),i[h>>2]=i[c>>2],i[h+4>>2]=i[c+4>>2],i[h+8>>2]=i[c+8>>2],rt(h)):(nt(c),i[h>>2]=i[c>>2],i[h+4>>2]=i[c+4>>2],i[h+8>>2]=i[c+8>>2],it(h)),J(l,h,A),Y(A),m=0|i[(g=r)>>2],g=0|i[g+4>>2],n=0|xe(7,0,0|(_=3*(15-u|0)|0)),g&=~(0|E()),_=0|xe(0|tt(A),0,0|_),g=0|E()|g,i[(y=r)>>2]=_|m&~n,i[y+4>>2]=g,(0|u)>1;)u=u+-1|0;t:do{if((0|i[c>>2])<=1&&(0|i[c+4>>2])<=1&&(0|i[c+8>>2])<=1){A=127==(0|(l=0|z(p,u=0|tt(c))))?0:0|F(l);e:do{if(u){if(o){if(c=21408+(28*(0|Dt(t,e))|0)+(u<<2)|0,(0|(c=0|i[c>>2]))>0){n=0;do{u=0|ut(u),n=n+1|0}while((0|n)!=(0|c))}if(1==(0|u)){a=3;break t}127==(0|(n=0|z(p,u)))&&x(23104,22949,376,23134),0|F(n)?x(23147,22949,377,23134):(d=c,f=u,a=n)}else d=0,f=u,a=l;if((0|(h=0|i[4304+(28*p|0)+(f<<2)>>2]))<=-1&&x(23178,22949,384,23134),!A){if((0|d)<=-1&&x(23030,22949,417,23134),0|d){u=0,n=0|i[(c=r)>>2],c=0|i[c+4>>2];do{n=0|kt(n,c),c=0|E(),i[(_=r)>>2]=n,i[_+4>>2]=c,u=u+1|0}while((0|u)<(0|d))}if((0|h)<=0){u=54;break}for(u=0,n=0|i[(c=r)>>2],c=0|i[c+4>>2];;)if(n=0|kt(n,c),c=0|E(),i[(_=r)>>2]=n,i[_+4>>2]=c,(0|(u=u+1|0))==(0|h)){u=54;break e}}if(7==(0|(l=0|G(a,p)))&&x(22925,22949,393,23134),n=0|i[(u=r)>>2],u=0|i[u+4>>2],(0|h)>0){c=0;do{n=0|kt(n,u),u=0|E(),i[(_=r)>>2]=n,i[_+4>>2]=u,c=c+1|0}while((0|c)!=(0|h))}if(n=0|Dt(n,u),_=0|k(a),(0|(n=0|i[(_?21824:21616)+(28*l|0)+(n<<2)>>2]))<=-1&&x(23030,22949,412,23134),n){u=0,c=0|i[(l=r)>>2],l=0|i[l+4>>2];do{c=0|Ft(c,l),l=0|E(),i[(_=r)>>2]=c,i[_+4>>2]=l,u=u+1|0}while((0|u)<(0|n));u=54}else u=54}else if(0!=(0|o)&0!=(0|A))if(u=21408+(28*(_=0|Dt(t,e))|0)+((0|Dt(0|i[(u=r)>>2],0|i[u+4>>2]))<<2)|0,(0|(u=0|i[u>>2]))<=-1&&x(23201,22949,433,23134),u){a=0,n=0|i[(c=r)>>2],c=0|i[c+4>>2];do{n=0|kt(n,c),c=0|E(),i[(_=r)>>2]=n,i[_+4>>2]=c,a=a+1|0}while((0|a)<(0|u));a=l,u=54}else a=l,u=55;else a=l,u=54}while(0);if(54==(0|u)&&A&&(u=55),55==(0|u)&&1==(0|Dt(0|i[(_=r)>>2],0|i[_+4>>2]))){a=4;break}y=0|i[(_=r)>>2],_=-1040385&i[_+4>>2],m=0|xe(0|a,0,45),_=0|_|E(),i[(a=r)>>2]=y|m,i[a+4>>2]=_,a=0}else a=2}while(0);return I=s,0|a}function ee(t,e){var n=0;if(!(e|=0))return 1;n=t|=0,t=1;do{t=0|_(0==(1&e|0)?1:n,t),e>>=1,n=0|_(n,n)}while(0!=(0|e));return 0|t}function ne(t,e,n){t|=0;var r,s,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0;if(!(0|Z(e|=0,n|=0)))return 0;if(e=0|V(e),s=+o[n>>3],a=e&(a=+o[n+8>>3])<0?a+6.283185307179586:a,(0|(p=0|i[t>>2]))<=0)return 0;if(r=0|i[t+4>>2],e){e=0,n=-1,t=0;t:for(;;){for(f=t;l=+o[r+(f<<4)>>3],A=+o[r+(f<<4)+8>>3],c=+o[r+((t=(n+2|0)%(0|p)|0)<<4)>>3],u=+o[r+(t<<4)+8>>3],l>c?(h=l,l=A):(h=c,c=l,l=u,u=A),s<c|s>h;){if(!((0|(n=f+1|0))<(0|p))){n=22;break t}t=f,f=n,n=t}if(a=(l=l<0?l+6.283185307179586:l)==a|(A=u<0?u+6.283185307179586:u)==a?a+-2220446049250313e-31:a,((A+=(s-c)/(h-c)*(l-A))<0?A+6.283185307179586:A)>a&&(e^=1),(0|(t=f+1|0))>=(0|p)){n=22;break}n=f}if(22==(0|n))return 0|e}else{e=0,n=-1,t=0;t:for(;;){for(f=t;l=+o[r+(f<<4)>>3],A=+o[r+(f<<4)+8>>3],c=+o[r+((t=(n+2|0)%(0|p)|0)<<4)>>3],u=+o[r+(t<<4)+8>>3],l>c?(h=l,l=A):(h=c,c=l,l=u,u=A),s<c|s>h;){if(!((0|(n=f+1|0))<(0|p))){n=22;break t}t=f,f=n,n=t}if(u+(s-c)/(h-c)*(l-u)>(a=l==a|u==a?a+-2220446049250313e-31:a)&&(e^=1),(0|(t=f+1|0))>=(0|p)){n=22;break}n=f}if(22==(0|n))return 0|e}return 0}function re(t,e){e|=0;var n,r,s,a,c,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0;if(!(r=0|i[(t|=0)>>2]))return i[e>>2]=0,i[e+4>>2]=0,i[e+8>>2]=0,i[e+12>>2]=0,i[e+16>>2]=0,i[e+20>>2]=0,i[e+24>>2]=0,void(i[e+28>>2]=0);if(o[(s=e+8|0)>>3]=17976931348623157e292,o[(a=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(c=e+16|0)>>3]=-17976931348623157e292,!((0|r)<=0)){for(n=0|i[t+4>>2],y=17976931348623157e292,m=-17976931348623157e292,_=0,t=-1,f=17976931348623157e292,p=17976931348623157e292,g=-17976931348623157e292,h=-17976931348623157e292,v=0;l=+o[n+(v<<4)>>3],d=+o[n+(v<<4)+8>>3],A=+o[n+(((0|(t=t+2|0))==(0|r)?0:t)<<4)+8>>3],l<f&&(o[s>>3]=l,f=l),d<p&&(o[a>>3]=d,p=d),l>g?o[e>>3]=l:l=g,d>h&&(o[c>>3]=d,h=d),y=d>0&d<y?d:y,m=d<0&d>m?d:m,_|=+u(+(d-A))>3.141592653589793,(0|(t=v+1|0))!=(0|r);)b=v,g=l,v=t,t=b;_&&(o[c>>3]=m,o[a>>3]=y)}}function ie(t,e){e|=0;var n,r=0,s=0,a=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0,E=0,x=0,S=0,P=0;if(m=0|i[(t|=0)>>2]){if(o[(_=e+8|0)>>3]=17976931348623157e292,o[(v=e+24|0)>>3]=17976931348623157e292,o[e>>3]=-17976931348623157e292,o[(b=e+16|0)>>3]=-17976931348623157e292,(0|m)>0){for(a=0|i[t+4>>2],g=17976931348623157e292,y=-17976931348623157e292,s=0,r=-1,A=17976931348623157e292,f=17976931348623157e292,d=-17976931348623157e292,l=-17976931348623157e292,w=0;c=+o[a+(w<<4)>>3],p=+o[a+(w<<4)+8>>3],h=+o[a+(((0|(S=r+2|0))==(0|m)?0:S)<<4)+8>>3],c<A&&(o[_>>3]=c,A=c),p<f&&(o[v>>3]=p,f=p),c>d?o[e>>3]=c:c=d,p>l&&(o[b>>3]=p,l=p),g=p>0&p<g?p:g,y=p<0&p>y?p:y,s|=+u(+(p-h))>3.141592653589793,(0|(r=w+1|0))!=(0|m);)S=w,d=c,w=r,r=S;s&&(o[b>>3]=y,o[v>>3]=g)}}else i[e>>2]=0,i[e+4>>2]=0,i[e+8>>2]=0,i[e+12>>2]=0,i[e+16>>2]=0,i[e+20>>2]=0,i[e+24>>2]=0,i[e+28>>2]=0;if(!((0|(r=0|i[(S=t+8|0)>>2]))<=0)){n=t+12|0,x=0;do{if(a=0|i[n>>2],s=x,v=e+((x=x+1|0)<<5)|0,b=0|i[a+(s<<3)>>2]){if(o[(w=e+(x<<5)+8|0)>>3]=17976931348623157e292,o[(t=e+(x<<5)+24|0)>>3]=17976931348623157e292,o[v>>3]=-17976931348623157e292,o[(E=e+(x<<5)+16|0)>>3]=-17976931348623157e292,(0|b)>0){for(m=0|i[a+(s<<3)+4>>2],g=17976931348623157e292,y=-17976931348623157e292,a=0,s=-1,_=0,A=17976931348623157e292,f=17976931348623157e292,p=-17976931348623157e292,l=-17976931348623157e292;c=+o[m+(_<<4)>>3],d=+o[m+(_<<4)+8>>3],h=+o[m+(((0|(s=s+2|0))==(0|b)?0:s)<<4)+8>>3],c<A&&(o[w>>3]=c,A=c),d<f&&(o[t>>3]=d,f=d),c>p?o[v>>3]=c:c=p,d>l&&(o[E>>3]=d,l=d),g=d>0&d<g?d:g,y=d<0&d>y?d:y,a|=+u(+(d-h))>3.141592653589793,(0|(s=_+1|0))!=(0|b);)P=_,_=s,p=c,s=P;a&&(o[E>>3]=y,o[t>>3]=g)}}else i[v>>2]=0,i[v+4>>2]=0,i[v+8>>2]=0,i[v+12>>2]=0,i[v+16>>2]=0,i[v+20>>2]=0,i[v+24>>2]=0,i[v+28>>2]=0,r=0|i[S>>2]}while((0|x)<(0|r))}}function oe(t,e,n){var r=0,o=0,s=0;if(!(0|ne(t|=0,e|=0,n|=0)))return 0;if((0|i[(o=t+8|0)>>2])<=0)return 1;for(r=t+12|0,t=0;;){if(s=t,t=t+1|0,0|ne((0|i[r>>2])+(s<<3)|0,e+(t<<5)|0,n)){t=0,r=6;break}if((0|t)>=(0|i[o>>2])){t=1,r=6;break}}return 6==(0|r)?0|t:0}function se(t,e,n,r,i){e|=0,n|=0,r|=0,i|=0;var s,a,u,c,l,h,A,f=0;c=+o[(t|=0)>>3],u=+o[e>>3]-c,a=+o[t+8>>3],s=+o[e+8>>3]-a,h=+o[n>>3],f=((f=+o[r>>3]-h)*(a-(A=+o[n+8>>3]))-(c-h)*(l=+o[r+8>>3]-A))/(u*l-s*f),o[i>>3]=c+u*f,o[i+8>>3]=a+s*f}function ae(t,e){return e|=0,+o[(t|=0)>>3]!=+o[e>>3]?0|(e=0):0|(e=+o[t+8>>3]==+o[e+8>>3])}function ue(t,e){var n,r,i;return e|=0,+((i=+o[(t|=0)>>3]-+o[e>>3])*i+(r=+o[t+8>>3]-+o[e+8>>3])*r+(n=+o[t+16>>3]-+o[e+16>>3])*n)}function ce(t,e,n){t|=0,n|=0;var r=0;(0|(e|=0))>0?(r=0|_e(e,4),i[t>>2]=r,r||x(23230,23253,40,23267)):i[t>>2]=0,i[t+4>>2]=e,i[t+8>>2]=0,i[t+12>>2]=n}function le(t){var e,n,r,s=0,a=0,c=0,h=0;e=4+(t|=0)|0,n=t+12|0,r=t+8|0;t:for(;;){for(a=0|i[e>>2],s=0;;){if((0|s)>=(0|a))break t;if(c=0|i[t>>2],h=0|i[c+(s<<2)>>2])break;s=s+1|0}s=c+(~~(+u(+ +l(10,+ +(15-(0|i[n>>2])|0))*(+o[h>>3]+ +o[h+8>>3]))%+(0|a))>>>0<<2)|0,a=0|i[s>>2];e:do{if(0|a){if(c=h+32|0,(0|a)==(0|h))i[s>>2]=i[c>>2];else{if(!(s=0|i[(a=a+32|0)>>2]))break;for(;(0|s)!=(0|h);)if(!(s=0|i[(a=s+32|0)>>2]))break e;i[a>>2]=i[c>>2]}me(h),i[r>>2]=(0|i[r>>2])-1}}while(0)}me(0|i[t>>2])}function he(t){var e,n=0,r=0;for(e=0|i[4+(t|=0)>>2],r=0;;){if((0|r)>=(0|e)){n=0,r=4;break}if(n=0|i[(0|i[t>>2])+(r<<2)>>2]){r=4;break}r=r+1|0}return 4==(0|r)?0|n:0}function Ae(t,e){e|=0;var n=0,r=0,s=0,a=0;if(n=~~(+u(+ +l(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,n=(0|i[t>>2])+(n<<2)|0,!(r=0|i[n>>2]))return 1;a=e+32|0;do{if((0|r)!=(0|e)){if(!(n=0|i[r+32>>2]))return 1;for(s=n;;){if((0|s)==(0|e)){s=8;break}if(!(n=0|i[s+32>>2])){n=1,s=10;break}r=s,s=n}if(8==(0|s)){i[r+32>>2]=i[a>>2];break}if(10==(0|s))return 0|n}else i[n>>2]=i[a>>2]}while(0);return me(e),i[(a=t+8|0)>>2]=(0|i[a>>2])-1,0}function fe(t,e,n){t|=0,e|=0,n|=0;var r,s=0,a=0,c=0;(r=0|ye(40))||x(23283,23253,98,23296),i[r>>2]=i[e>>2],i[r+4>>2]=i[e+4>>2],i[r+8>>2]=i[e+8>>2],i[r+12>>2]=i[e+12>>2],i[(a=r+16|0)>>2]=i[n>>2],i[a+4>>2]=i[n+4>>2],i[a+8>>2]=i[n+8>>2],i[a+12>>2]=i[n+12>>2],i[r+32>>2]=0,a=~~(+u(+ +l(10,+ +(15-(0|i[t+12>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,a=(0|i[t>>2])+(a<<2)|0,s=0|i[a>>2];do{if(s){for(;!(0|Tt(s,e)&&0|Tt(s+16|0,n));)if(a=0|i[s+32>>2],!(0|i[(s=0==(0|a)?s:a)+32>>2])){c=10;break}if(10==(0|c)){i[s+32>>2]=r;break}return me(r),0|s}i[a>>2]=r}while(0);return i[(c=t+8|0)>>2]=1+(0|i[c>>2]),0|r}function pe(t,e,n){e|=0,n|=0;var r=0,s=0;if(s=~~(+u(+ +l(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,!(s=0|i[(0|i[t>>2])+(s<<2)>>2]))return 0;if(!n){for(t=s;;){if(0|Tt(t,e)){r=10;break}if(!(t=0|i[t+32>>2])){t=0,r=10;break}}if(10==(0|r))return 0|t}for(t=s;;){if(0|Tt(t,e)&&0|Tt(t+16|0,n)){r=10;break}if(!(t=0|i[t+32>>2])){t=0,r=10;break}}return 10==(0|r)?0|t:0}function de(t,e){e|=0;var n=0;if(n=~~(+u(+ +l(10,+ +(15-(0|i[12+(t|=0)>>2])|0))*(+o[e>>3]+ +o[e+8>>3]))%+(0|i[t+4>>2]))>>>0,!(t=0|i[(0|i[t>>2])+(n<<2)>>2]))return 0;for(;;){if(0|Tt(t,e)){e=5;break}if(!(t=0|i[t+32>>2])){t=0,e=5;break}}return 5==(0|e)?0|t:0}function ge(t){return 0|~~+function(t){return+ +Me(+(t=+t))}(t=+t)}function ye(t){t|=0;var e,n=0,r=0,o=0,s=0,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0;e=I,I=I+16|0,p=e;do{if(t>>>0<245){if(t=(h=t>>>0<11?16:t+11&-8)>>>3,3&(r=(f=0|i[5829])>>>t)|0)return o=0|i[(r=8+(t=23356+((n=(1&r^1)+t|0)<<1<<2)|0)|0)>>2],(0|(a=0|i[(s=o+8|0)>>2]))==(0|t)?i[5829]=f&~(1<<n):(i[a+12>>2]=t,i[r>>2]=a),w=n<<3,i[o+4>>2]=3|w,i[(w=o+w+4|0)>>2]=1|i[w>>2],I=e,0|s;if(h>>>0>(A=0|i[5831])>>>0){if(0|r)return n=((n=r<<t&((n=2<<t)|0-n))&0-n)-1|0,a=0|i[(t=8+(n=23356+((o=((r=(n>>>=c=n>>>12&16)>>>5&8)|c|(a=(n>>>=r)>>>2&4)|(t=(n>>>=a)>>>1&2)|(o=(n>>>=t)>>>1&1))+(n>>>o)|0)<<1<<2)|0)|0)>>2],(0|(r=0|i[(c=a+8|0)>>2]))==(0|n)?(t=f&~(1<<o),i[5829]=t):(i[r+12>>2]=n,i[t>>2]=r,t=f),u=(w=o<<3)-h|0,i[a+4>>2]=3|h,i[4+(s=a+h|0)>>2]=1|u,i[a+w>>2]=u,0|A&&(o=0|i[5834],r=23356+((n=A>>>3)<<1<<2)|0,t&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=o,i[n+12>>2]=o,i[o+8>>2]=n,i[o+12>>2]=r),i[5831]=u,i[5834]=s,I=e,0|c;if(a=0|i[5830]){for(r=(a&0-a)-1|0,r=l=0|i[23620+(((o=(r>>>=s=r>>>12&16)>>>5&8)|s|(u=(r>>>=o)>>>2&4)|(c=(r>>>=u)>>>1&2)|(l=(r>>>=c)>>>1&1))+(r>>>l)<<2)>>2],c=l,l=(-8&i[l+4>>2])-h|0;(t=0|i[r+16>>2])||(t=0|i[r+20>>2]);)r=t,c=(s=(u=(-8&i[t+4>>2])-h|0)>>>0<l>>>0)?t:c,l=s?u:l;if((u=c+h|0)>>>0>c>>>0){s=0|i[c+24>>2],n=0|i[c+12>>2];do{if((0|n)==(0|c)){if(!(n=0|i[(t=c+20|0)>>2])&&!(n=0|i[(t=c+16|0)>>2])){r=0;break}for(;;)if(r=0|i[(o=n+20|0)>>2])n=r,t=o;else{if(!(r=0|i[(o=n+16|0)>>2]))break;n=r,t=o}i[t>>2]=0,r=n}else r=0|i[c+8>>2],i[r+12>>2]=n,i[n+8>>2]=r,r=n}while(0);do{if(0|s){if(n=0|i[c+28>>2],(0|c)==(0|i[(t=23620+(n<<2)|0)>>2])){if(i[t>>2]=r,!r){i[5830]=a&~(1<<n);break}}else if(i[((0|i[(w=s+16|0)>>2])==(0|c)?w:s+20|0)>>2]=r,!r)break;i[r+24>>2]=s,0|(n=0|i[c+16>>2])&&(i[r+16>>2]=n,i[n+24>>2]=r),0|(n=0|i[c+20>>2])&&(i[r+20>>2]=n,i[n+24>>2]=r)}}while(0);return l>>>0<16?(w=l+h|0,i[c+4>>2]=3|w,i[(w=c+w+4|0)>>2]=1|i[w>>2]):(i[c+4>>2]=3|h,i[u+4>>2]=1|l,i[u+l>>2]=l,0|A&&(o=0|i[5834],r=23356+((n=A>>>3)<<1<<2)|0,(n=1<<n)&f?n=0|i[(t=r+8|0)>>2]:(i[5829]=n|f,n=r,t=r+8|0),i[t>>2]=o,i[n+12>>2]=o,i[o+8>>2]=n,i[o+12>>2]=r),i[5831]=l,i[5834]=u),I=e,0|c+8}f=h}else f=h}else f=h}else if(t>>>0<=4294967231)if(h=-8&(t=t+11|0),o=0|i[5830]){s=0-h|0,l=(t>>>=8)?h>>>0>16777215?31:h>>>(7+(l=14-((c=(520192+(y=t<<(f=(t+1048320|0)>>>16&8))|0)>>>16&4)|f|(l=(245760+(y<<=c)|0)>>>16&2))+(y<<l>>>15)|0)|0)&1|l<<1:0,r=0|i[23620+(l<<2)>>2];t:do{if(r)for(t=0,c=h<<(31==(0|l)?0:25-(l>>>1)|0),a=0;;){if((u=(-8&i[r+4>>2])-h|0)>>>0<s>>>0){if(!u){t=r,s=0,y=65;break t}t=r,s=u}if(a=0==(0|(y=0|i[r+20>>2]))|(0|y)==(0|(r=0|i[r+16+(c>>>31<<2)>>2]))?a:y,!r){r=a,y=61;break}c<<=1}else r=0,t=0,y=61}while(0);if(61==(0|y)){if(0==(0|r)&0==(0|t)){if(!(t=((t=2<<l)|0-t)&o)){f=h;break}f=(t&0-t)-1|0,t=0,r=0|i[23620+(((a=(f>>>=u=f>>>12&16)>>>5&8)|u|(c=(f>>>=a)>>>2&4)|(l=(f>>>=c)>>>1&2)|(r=(f>>>=l)>>>1&1))+(f>>>r)<<2)>>2]}r?y=65:(c=t,u=s)}if(65==(0|y))for(a=r;;){if(s=(r=(f=(-8&i[a+4>>2])-h|0)>>>0<s>>>0)?f:s,t=r?a:t,(r=0|i[a+16>>2])||(r=0|i[a+20>>2]),!r){c=t,u=s;break}a=r}if(0!=(0|c)&&u>>>0<((0|i[5831])-h|0)>>>0&&(A=c+h|0)>>>0>c>>>0){a=0|i[c+24>>2],n=0|i[c+12>>2];do{if((0|n)==(0|c)){if(!(n=0|i[(t=c+20|0)>>2])&&!(n=0|i[(t=c+16|0)>>2])){n=0;break}for(;;)if(r=0|i[(s=n+20|0)>>2])n=r,t=s;else{if(!(r=0|i[(s=n+16|0)>>2]))break;n=r,t=s}i[t>>2]=0}else w=0|i[c+8>>2],i[w+12>>2]=n,i[n+8>>2]=w}while(0);do{if(a){if(t=0|i[c+28>>2],(0|c)==(0|i[(r=23620+(t<<2)|0)>>2])){if(i[r>>2]=n,!n){o&=~(1<<t),i[5830]=o;break}}else if(i[((0|i[(w=a+16|0)>>2])==(0|c)?w:a+20|0)>>2]=n,!n)break;i[n+24>>2]=a,0|(t=0|i[c+16>>2])&&(i[n+16>>2]=t,i[t+24>>2]=n),(t=0|i[c+20>>2])&&(i[n+20>>2]=t,i[t+24>>2]=n)}}while(0);t:do{if(u>>>0<16)w=u+h|0,i[c+4>>2]=3|w,i[(w=c+w+4|0)>>2]=1|i[w>>2];else{if(i[c+4>>2]=3|h,i[A+4>>2]=1|u,i[A+u>>2]=u,n=u>>>3,u>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=A,i[n+12>>2]=A,i[A+8>>2]=n,i[A+12>>2]=r;break}if(n=23620+((r=(n=u>>>8)?u>>>0>16777215?31:u>>>(7+(r=14-((v=(520192+(w=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(r=(245760+(w<<=v)|0)>>>16&2))+(w<<r>>>15)|0)|0)&1|r<<1:0)<<2)|0,i[A+28>>2]=r,i[4+(t=A+16|0)>>2]=0,i[t>>2]=0,!(o&(t=1<<r))){i[5830]=o|t,i[n>>2]=A,i[A+24>>2]=n,i[A+12>>2]=A,i[A+8>>2]=A;break}n=0|i[n>>2];e:do{if((-8&i[n+4>>2]|0)!=(0|u)){for(o=u<<(31==(0|r)?0:25-(r>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|u)){n=t;break e}o<<=1,n=t}i[r>>2]=A,i[A+24>>2]=n,i[A+12>>2]=A,i[A+8>>2]=A;break t}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=A,i[b>>2]=A,i[A+8>>2]=w,i[A+12>>2]=n,i[A+24>>2]=0}}while(0);return I=e,0|c+8}f=h}else f=h;else f=-1}while(0);if((r=0|i[5831])>>>0>=f>>>0)return n=r-f|0,t=0|i[5834],n>>>0>15?(w=t+f|0,i[5834]=w,i[5831]=n,i[w+4>>2]=1|n,i[t+r>>2]=n,i[t+4>>2]=3|f):(i[5831]=0,i[5834]=0,i[t+4>>2]=3|r,i[(w=t+r+4|0)>>2]=1|i[w>>2]),I=e,0|t+8;if((u=0|i[5832])>>>0>f>>>0)return v=u-f|0,i[5832]=v,b=(w=0|i[5835])+f|0,i[5835]=b,i[b+4>>2]=1|v,i[w+4>>2]=3|f,I=e,0|w+8;if(0|i[5947]?t=0|i[5949]:(i[5949]=4096,i[5948]=4096,i[5950]=-1,i[5951]=-1,i[5952]=0,i[5940]=0,i[5947]=-16&p^1431655768,t=4096),c=f+48|0,(h=(a=t+(l=f+47|0)|0)&(s=0-t|0))>>>0<=f>>>0)return I=e,0;if(0|(t=0|i[5939])&&(p=(A=0|i[5937])+h|0)>>>0<=A>>>0|p>>>0>t>>>0)return I=e,0;t:do{if(4&i[5940])n=0,y=143;else{r=0|i[5835];e:do{if(r){for(o=23764;!((p=0|i[o>>2])>>>0<=r>>>0&&(p+(0|i[o+4>>2])|0)>>>0>r>>>0);){if(!(t=0|i[o+8>>2])){y=128;break e}o=t}if((n=a-u&s)>>>0<2147483647)if((0|(t=0|Ie(0|n)))==((0|i[o>>2])+(0|i[o+4>>2])|0)){if(-1!=(0|t)){u=n,a=t,y=145;break t}}else o=t,y=136;else n=0}else y=128}while(0);do{if(128==(0|y))if(-1!=(0|(r=0|Ie(0)))&&(n=r,g=(n=(0==((g=(d=0|i[5948])-1|0)&n|0)?0:(g+n&0-d)-n|0)+h|0)+(d=0|i[5937])|0,n>>>0>f>>>0&n>>>0<2147483647)){if(0|(p=0|i[5939])&&g>>>0<=d>>>0|g>>>0>p>>>0){n=0;break}if((0|(t=0|Ie(0|n)))==(0|r)){u=n,a=r,y=145;break t}o=t,y=136}else n=0}while(0);do{if(136==(0|y)){if(r=0-n|0,!(c>>>0>n>>>0&n>>>0<2147483647&-1!=(0|o))){if(-1==(0|o)){n=0;break}u=n,a=o,y=145;break t}if((t=l-n+(t=0|i[5949])&0-t)>>>0>=2147483647){u=n,a=o,y=145;break t}if(-1==(0|Ie(0|t))){Ie(0|r),n=0;break}u=t+n|0,a=o,y=145;break t}}while(0);i[5940]=4|i[5940],y=143}}while(0);if(143==(0|y)&&h>>>0<2147483647&&!(-1==(0|(v=0|Ie(0|h)))|1^(_=(m=(g=0|Ie(0))-v|0)>>>0>(f+40|0)>>>0)|v>>>0<g>>>0&-1!=(0|v)&-1!=(0|g)^1)&&(u=_?m:n,a=v,y=145),145==(0|y)){n=(0|i[5937])+u|0,i[5937]=n,n>>>0>(0|i[5938])>>>0&&(i[5938]=n),l=0|i[5835];t:do{if(l){for(n=23764;;){if((0|a)==((t=0|i[n>>2])+(r=0|i[n+4>>2])|0)){y=154;break}if(!(o=0|i[n+8>>2]))break;n=o}if(154==(0|y)&&(b=n+4|0,0==(8&i[n+12>>2]|0))&&a>>>0>l>>>0&t>>>0<=l>>>0){i[b>>2]=r+u,b=l+(v=0==(7&(v=l+8|0)|0)?0:0-v&7)|0,v=(w=(0|i[5832])+u|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[l+w+4>>2]=40,i[5836]=i[5951];break}for(a>>>0<(0|i[5833])>>>0&&(i[5833]=a),r=a+u|0,n=23764;;){if((0|i[n>>2])==(0|r)){y=162;break}if(!(t=0|i[n+8>>2]))break;n=t}if(162==(0|y)&&0==(8&i[n+12>>2]|0)){i[n>>2]=a,i[(A=n+4|0)>>2]=(0|i[A>>2])+u,h=(A=a+(0==(7&(A=a+8|0)|0)?0:0-A&7)|0)+f|0,c=(n=r+(0==(7&(n=r+8|0)|0)?0:0-n&7)|0)-A-f|0,i[A+4>>2]=3|f;e:do{if((0|l)==(0|n))w=(0|i[5832])+c|0,i[5832]=w,i[5835]=h,i[h+4>>2]=1|w;else{if((0|i[5834])==(0|n)){w=(0|i[5831])+c|0,i[5831]=w,i[5834]=h,i[h+4>>2]=1|w,i[h+w>>2]=w;break}if(1==(3&(t=0|i[n+4>>2])|0)){u=-8&t,o=t>>>3;n:do{if(t>>>0<256){if(t=0|i[n+8>>2],(0|(r=0|i[n+12>>2]))==(0|t)){i[5829]=i[5829]&~(1<<o);break}i[t+12>>2]=r,i[r+8>>2]=t;break}a=0|i[n+24>>2],t=0|i[n+12>>2];do{if((0|t)==(0|n)){if(t=0|i[(o=4+(r=n+16|0)|0)>>2])r=o;else if(!(t=0|i[r>>2])){t=0;break}for(;;)if(o=0|i[(s=t+20|0)>>2])t=o,r=s;else{if(!(o=0|i[(s=t+16|0)>>2]))break;t=o,r=s}i[r>>2]=0}else w=0|i[n+8>>2],i[w+12>>2]=t,i[t+8>>2]=w}while(0);if(!a)break;o=23620+((r=0|i[n+28>>2])<<2)|0;do{if((0|i[o>>2])==(0|n)){if(i[o>>2]=t,0|t)break;i[5830]=i[5830]&~(1<<r);break n}if(i[((0|i[(w=a+16|0)>>2])==(0|n)?w:a+20|0)>>2]=t,!t)break n}while(0);if(i[t+24>>2]=a,0|(o=0|i[(r=n+16|0)>>2])&&(i[t+16>>2]=o,i[o+24>>2]=t),!(r=0|i[r+4>>2]))break;i[t+20>>2]=r,i[r+24>>2]=t}while(0);n=n+u|0,s=u+c|0}else s=c;if(i[(n=n+4|0)>>2]=-2&i[n>>2],i[h+4>>2]=1|s,i[h+s>>2]=s,n=s>>>3,s>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=h,i[n+12>>2]=h,i[h+8>>2]=n,i[h+12>>2]=r;break}n=s>>>8;do{if(n){if(s>>>0>16777215){o=31;break}o=s>>>(7+(o=14-((v=(520192+(w=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(o=(245760+(w<<=v)|0)>>>16&2))+(w<<o>>>15)|0)|0)&1|o<<1}else o=0}while(0);if(n=23620+(o<<2)|0,i[h+28>>2]=o,i[4+(t=h+16|0)>>2]=0,i[t>>2]=0,!((t=0|i[5830])&(r=1<<o))){i[5830]=t|r,i[n>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break}n=0|i[n>>2];n:do{if((-8&i[n+4>>2]|0)!=(0|s)){for(o=s<<(31==(0|o)?0:25-(o>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|s)){n=t;break n}o<<=1,n=t}i[r>>2]=h,i[h+24>>2]=n,i[h+12>>2]=h,i[h+8>>2]=h;break e}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=h,i[b>>2]=h,i[h+8>>2]=w,i[h+12>>2]=n,i[h+24>>2]=0}}while(0);return I=e,0|A+8}for(n=23764;!((t=0|i[n>>2])>>>0<=l>>>0&&(w=t+(0|i[n+4>>2])|0)>>>0>l>>>0);)n=0|i[n+8>>2];n=(t=(t=(s=w+-47|0)+(0==(7&(t=s+8|0)|0)?0:0-t&7)|0)>>>0<(s=l+16|0)>>>0?l:t)+8|0,b=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=(r=u+-40|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[a+r+4>>2]=40,i[5836]=i[5951],i[(r=t+4|0)>>2]=27,i[n>>2]=i[5941],i[n+4>>2]=i[5942],i[n+8>>2]=i[5943],i[n+12>>2]=i[5944],i[5941]=a,i[5942]=u,i[5944]=0,i[5943]=n,n=t+24|0;do{b=n,i[(n=n+4|0)>>2]=7}while((b+8|0)>>>0<w>>>0);if((0|t)!=(0|l)){if(a=t-l|0,i[r>>2]=-2&i[r>>2],i[l+4>>2]=1|a,i[t>>2]=a,n=a>>>3,a>>>0<256){r=23356+(n<<1<<2)|0,(t=0|i[5829])&(n=1<<n)?n=0|i[(t=r+8|0)>>2]:(i[5829]=t|n,n=r,t=r+8|0),i[t>>2]=l,i[n+12>>2]=l,i[l+8>>2]=n,i[l+12>>2]=r;break}if(r=23620+((o=(n=a>>>8)?a>>>0>16777215?31:a>>>(7+(o=14-((v=(520192+(w=n<<(b=(n+1048320|0)>>>16&8))|0)>>>16&4)|b|(o=(245760+(w<<=v)|0)>>>16&2))+(w<<o>>>15)|0)|0)&1|o<<1:0)<<2)|0,i[l+28>>2]=o,i[l+20>>2]=0,i[s>>2]=0,!((n=0|i[5830])&(t=1<<o))){i[5830]=n|t,i[r>>2]=l,i[l+24>>2]=r,i[l+12>>2]=l,i[l+8>>2]=l;break}n=0|i[r>>2];e:do{if((-8&i[n+4>>2]|0)!=(0|a)){for(o=a<<(31==(0|o)?0:25-(o>>>1)|0);t=0|i[(r=n+16+(o>>>31<<2)|0)>>2];){if((-8&i[t+4>>2]|0)==(0|a)){n=t;break e}o<<=1,n=t}i[r>>2]=l,i[l+24>>2]=n,i[l+12>>2]=l,i[l+8>>2]=l;break t}}while(0);w=0|i[(b=n+8|0)>>2],i[w+12>>2]=l,i[b>>2]=l,i[l+8>>2]=w,i[l+12>>2]=n,i[l+24>>2]=0}}else 0==(0|(w=0|i[5833]))|a>>>0<w>>>0&&(i[5833]=a),i[5941]=a,i[5942]=u,i[5944]=0,i[5838]=i[5947],i[5837]=-1,i[5842]=23356,i[5841]=23356,i[5844]=23364,i[5843]=23364,i[5846]=23372,i[5845]=23372,i[5848]=23380,i[5847]=23380,i[5850]=23388,i[5849]=23388,i[5852]=23396,i[5851]=23396,i[5854]=23404,i[5853]=23404,i[5856]=23412,i[5855]=23412,i[5858]=23420,i[5857]=23420,i[5860]=23428,i[5859]=23428,i[5862]=23436,i[5861]=23436,i[5864]=23444,i[5863]=23444,i[5866]=23452,i[5865]=23452,i[5868]=23460,i[5867]=23460,i[5870]=23468,i[5869]=23468,i[5872]=23476,i[5871]=23476,i[5874]=23484,i[5873]=23484,i[5876]=23492,i[5875]=23492,i[5878]=23500,i[5877]=23500,i[5880]=23508,i[5879]=23508,i[5882]=23516,i[5881]=23516,i[5884]=23524,i[5883]=23524,i[5886]=23532,i[5885]=23532,i[5888]=23540,i[5887]=23540,i[5890]=23548,i[5889]=23548,i[5892]=23556,i[5891]=23556,i[5894]=23564,i[5893]=23564,i[5896]=23572,i[5895]=23572,i[5898]=23580,i[5897]=23580,i[5900]=23588,i[5899]=23588,i[5902]=23596,i[5901]=23596,i[5904]=23604,i[5903]=23604,b=a+(v=0==(7&(v=a+8|0)|0)?0:0-v&7)|0,v=(w=u+-40|0)-v|0,i[5835]=b,i[5832]=v,i[b+4>>2]=1|v,i[a+w+4>>2]=40,i[5836]=i[5951]}while(0);if((n=0|i[5832])>>>0>f>>>0)return v=n-f|0,i[5832]=v,b=(w=0|i[5835])+f|0,i[5835]=b,i[b+4>>2]=1|v,i[w+4>>2]=3|f,I=e,0|w+8}return i[(w=23312)>>2]=12,I=e,0}function me(t){var e=0,n=0,r=0,o=0,s=0,a=0,u=0,c=0;if(t|=0){n=t+-8|0,o=0|i[5833],c=n+(e=-8&(t=0|i[t+-4>>2]))|0;do{if(1&t)u=n,a=n;else{if(r=0|i[n>>2],!(3&t))return;if(s=r+e|0,(a=n+(0-r)|0)>>>0<o>>>0)return;if((0|i[5834])==(0|a)){if(3!=(3&(e=0|i[(t=c+4|0)>>2])|0)){u=a,e=s;break}return i[5831]=s,i[t>>2]=-2&e,i[a+4>>2]=1|s,void(i[a+s>>2]=s)}if(n=r>>>3,r>>>0<256){if(t=0|i[a+8>>2],(0|(e=0|i[a+12>>2]))==(0|t)){i[5829]=i[5829]&~(1<<n),u=a,e=s;break}i[t+12>>2]=e,i[e+8>>2]=t,u=a,e=s;break}o=0|i[a+24>>2],t=0|i[a+12>>2];do{if((0|t)==(0|a)){if(t=0|i[(n=4+(e=a+16|0)|0)>>2])e=n;else if(!(t=0|i[e>>2])){t=0;break}for(;;)if(n=0|i[(r=t+20|0)>>2])t=n,e=r;else{if(!(n=0|i[(r=t+16|0)>>2]))break;t=n,e=r}i[e>>2]=0}else u=0|i[a+8>>2],i[u+12>>2]=t,i[t+8>>2]=u}while(0);if(o){if(e=0|i[a+28>>2],(0|i[(n=23620+(e<<2)|0)>>2])==(0|a)){if(i[n>>2]=t,!t){i[5830]=i[5830]&~(1<<e),u=a,e=s;break}}else if(i[((0|i[(u=o+16|0)>>2])==(0|a)?u:o+20|0)>>2]=t,!t){u=a,e=s;break}i[t+24>>2]=o,0|(n=0|i[(e=a+16|0)>>2])&&(i[t+16>>2]=n,i[n+24>>2]=t),(e=0|i[e+4>>2])?(i[t+20>>2]=e,i[e+24>>2]=t,u=a,e=s):(u=a,e=s)}else u=a,e=s}}while(0);if(!(a>>>0>=c>>>0)&&1&(r=0|i[(t=c+4|0)>>2])){if(2&r)i[t>>2]=-2&r,i[u+4>>2]=1|e,i[a+e>>2]=e,o=e;else{if((0|i[5835])==(0|c)){if(c=(0|i[5832])+e|0,i[5832]=c,i[5835]=u,i[u+4>>2]=1|c,(0|u)!=(0|i[5834]))return;return i[5834]=0,void(i[5831]=0)}if((0|i[5834])==(0|c))return c=(0|i[5831])+e|0,i[5831]=c,i[5834]=a,i[u+4>>2]=1|c,void(i[a+c>>2]=c);o=(-8&r)+e|0,n=r>>>3;do{if(r>>>0<256){if(e=0|i[c+8>>2],(0|(t=0|i[c+12>>2]))==(0|e)){i[5829]=i[5829]&~(1<<n);break}i[e+12>>2]=t,i[t+8>>2]=e;break}s=0|i[c+24>>2],t=0|i[c+12>>2];do{if((0|t)==(0|c)){if(t=0|i[(n=4+(e=c+16|0)|0)>>2])e=n;else if(!(t=0|i[e>>2])){n=0;break}for(;;)if(n=0|i[(r=t+20|0)>>2])t=n,e=r;else{if(!(n=0|i[(r=t+16|0)>>2]))break;t=n,e=r}i[e>>2]=0,n=t}else n=0|i[c+8>>2],i[n+12>>2]=t,i[t+8>>2]=n,n=t}while(0);if(0|s){if(t=0|i[c+28>>2],(0|i[(e=23620+(t<<2)|0)>>2])==(0|c)){if(i[e>>2]=n,!n){i[5830]=i[5830]&~(1<<t);break}}else if(i[((0|i[(r=s+16|0)>>2])==(0|c)?r:s+20|0)>>2]=n,!n)break;i[n+24>>2]=s,0|(e=0|i[(t=c+16|0)>>2])&&(i[n+16>>2]=e,i[e+24>>2]=n),0|(t=0|i[t+4>>2])&&(i[n+20>>2]=t,i[t+24>>2]=n)}}while(0);if(i[u+4>>2]=1|o,i[a+o>>2]=o,(0|u)==(0|i[5834]))return void(i[5831]=o)}if(t=o>>>3,o>>>0<256)return n=23356+(t<<1<<2)|0,(e=0|i[5829])&(t=1<<t)?t=0|i[(e=n+8|0)>>2]:(i[5829]=e|t,t=n,e=n+8|0),i[e>>2]=u,i[t+12>>2]=u,i[u+8>>2]=t,void(i[u+12>>2]=n);t=23620+((r=(t=o>>>8)?o>>>0>16777215?31:o>>>(7+(r=14-((s=(520192+(c=t<<(a=(t+1048320|0)>>>16&8))|0)>>>16&4)|a|(r=(245760+(c<<=s)|0)>>>16&2))+(c<<r>>>15)|0)|0)&1|r<<1:0)<<2)|0,i[u+28>>2]=r,i[u+20>>2]=0,i[u+16>>2]=0,e=0|i[5830],n=1<<r;t:do{if(e&n){t=0|i[t>>2];e:do{if((-8&i[t+4>>2]|0)!=(0|o)){for(r=o<<(31==(0|r)?0:25-(r>>>1)|0);e=0|i[(n=t+16+(r>>>31<<2)|0)>>2];){if((-8&i[e+4>>2]|0)==(0|o)){t=e;break e}r<<=1,t=e}i[n>>2]=u,i[u+24>>2]=t,i[u+12>>2]=u,i[u+8>>2]=u;break t}}while(0);c=0|i[(a=t+8|0)>>2],i[c+12>>2]=u,i[a>>2]=u,i[u+8>>2]=c,i[u+12>>2]=t,i[u+24>>2]=0}else i[5830]=e|n,i[t>>2]=u,i[u+24>>2]=t,i[u+12>>2]=u,i[u+8>>2]=u}while(0);if(c=(0|i[5837])-1|0,i[5837]=c,!(0|c)){for(t=23772;t=0|i[t>>2];)t=t+8|0;i[5837]=-1}}}}function _e(t,e){e|=0;var n=0;return(t|=0)?(n=0|_(e,t),(e|t)>>>0>65535&&(n=(0|(n>>>0)/(t>>>0))==(0|e)?n:-1)):n=0,(t=0|ye(n))&&3&i[t+-4>>2]?(Ce(0|t,0,0|n),0|t):0|t}function ve(t,e,n,r){return 0|(w(0|(r=(e|=0)-(r|=0)-((n|=0)>>>0>(t|=0)>>>0|0)>>>0)),t-n>>>0|0)}function be(t){return 0|((t|=0)?31-(0|b(t^t-1))|0:32)}function we(t,e,n,r){var o,s;return s=I,I=I+16|0,function(t,e,n,r,o){o|=0;var s=0,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0;if(h=t|=0,a=n|=0,u=f=r|=0,!(l=c=e|=0))return s=0!=(0|o),u?s?(i[o>>2]=0|t,i[o+4>>2]=0&e,o=0,0|(w(0|(f=0)),o)):(o=0,0|(w(0|(f=0)),o)):(s&&(i[o>>2]=(h>>>0)%(a>>>0),i[o+4>>2]=0),o=(h>>>0)/(a>>>0)>>>0,0|(w(0|(f=0)),o));s=0==(0|u);do{if(a){if(!s){if((s=(0|b(0|u))-(0|b(0|l))|0)>>>0<=31){a=A=s+1|0,t=h>>>(A>>>0)&(e=s-31>>31)|l<<(u=31-s|0),e&=l>>>(A>>>0),s=0,u=h<<u;break}return o?(i[o>>2]=0|t,i[o+4>>2]=c|0&e,o=0,0|(w(0|(f=0)),o)):(o=0,0|(w(0|(f=0)),o))}if((s=a-1|0)&a|0){a=u=33+(0|b(0|a))-(0|b(0|l))|0,t=(A=32-u|0)-1>>31&l>>>((p=u-32|0)>>>0)|(l<<A|h>>>(u>>>0))&(e=p>>31),e&=l>>>(u>>>0),s=h<<(d=64-u|0)&(c=A>>31),u=(l<<d|h>>>(p>>>0))&c|h<<A&u-33>>31;break}return 0|o&&(i[o>>2]=s&h,i[o+4>>2]=0),1==(0|a)?(d=0|t,0|(w(0|(p=c|0&e)),d)):(p=l>>>((d=0|be(0|a))>>>0)|0,d=l<<32-d|h>>>(d>>>0)|0,0|(w(0|p),d))}if(s)return 0|o&&(i[o>>2]=(l>>>0)%(a>>>0),i[o+4>>2]=0),d=(l>>>0)/(a>>>0)>>>0,0|(w(0|(p=0)),d);if(!h)return 0|o&&(i[o>>2]=0,i[o+4>>2]=(l>>>0)%(u>>>0)),d=(l>>>0)/(u>>>0)>>>0,0|(w(0|(p=0)),d);if(!((s=u-1|0)&u))return 0|o&&(i[o>>2]=0|t,i[o+4>>2]=s&l|0&e),p=0,d=l>>>((0|be(0|u))>>>0),0|(w(0|p),d);if((s=(0|b(0|u))-(0|b(0|l))|0)>>>0<=30){a=e=s+1|0,t=l<<(u=31-s|0)|h>>>(e>>>0),e=l>>>(e>>>0),s=0,u=h<<u;break}return o?(i[o>>2]=0|t,i[o+4>>2]=c|0&e,d=0,0|(w(0|(p=0)),d)):(d=0,0|(w(0|(p=0)),d))}while(0);if(a){l=0|function(t,e,n,r){return 0|(w((e|=0)+(r|=0)+((n=(t|=0)+(n|=0)>>>0)>>>0<t>>>0|0)>>>0|0),0|n)}(0|(A=0|n),0|(h=f|0&r),-1,-1),n=0|E(),c=u,u=0;do{r=c,c=s>>>31|c<<1,s=u|s<<1,ve(0|l,0|n,0|(r=t<<1|r>>>31|0),0|(f=t>>>31|e<<1|0)),u=1&(p=(d=0|E())>>31|((0|d)<0?-1:0)<<1),t=0|ve(0|r,0|f,p&A|0,(((0|d)<0?-1:0)>>31|((0|d)<0?-1:0)<<1)&h|0),e=0|E(),a=a-1|0}while(0!=(0|a));l=c,c=0}else l=u,c=0,u=0;a=0,0|o&&(i[o>>2]=t,i[o+4>>2]=e),d=-2&(s<<1|0)|u,w(0|(p=(0|s)>>>31|(l|a)<<1|0&(a<<1|s>>>31)|c))}(t|=0,e|=0,n|=0,r|=0,o=0|s),I=s,0|(w(0|i[o+4>>2]),0|i[o>>2])}function Ee(t,e,n){return t|=0,e|=0,(0|(n|=0))<32?(w(e>>>n|0),t>>>n|(e&(1<<n)-1)<<32-n):(w(0),e>>>n-32|0)}function xe(t,e,n){return t|=0,(0|(n|=0))<32?(w((e|=0)<<n|(t&(1<<n)-1<<32-n)>>>32-n|0),t<<n):(w(t<<n-32|0),0)}function Se(t,e){return e=+e,(t=+t)!=t?+e:e!=e?+t:+v(+t,+e)}function Pe(t){return(t=+t)>=0?+a(t+.5):+m(t-.5)}function Te(t,e,n){t|=0,e|=0;var o,s,a=0;if((0|(n|=0))>=8192)return T(0|t,0|e,0|n),0|t;if(s=0|t,o=t+n|0,(3&t)==(3&e)){for(;3&t;){if(!n)return 0|s;r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0,n=n-1|0}for(a=(n=-4&o|0)-64|0;(0|t)<=(0|a);)i[t>>2]=i[e>>2],i[t+4>>2]=i[e+4>>2],i[t+8>>2]=i[e+8>>2],i[t+12>>2]=i[e+12>>2],i[t+16>>2]=i[e+16>>2],i[t+20>>2]=i[e+20>>2],i[t+24>>2]=i[e+24>>2],i[t+28>>2]=i[e+28>>2],i[t+32>>2]=i[e+32>>2],i[t+36>>2]=i[e+36>>2],i[t+40>>2]=i[e+40>>2],i[t+44>>2]=i[e+44>>2],i[t+48>>2]=i[e+48>>2],i[t+52>>2]=i[e+52>>2],i[t+56>>2]=i[e+56>>2],i[t+60>>2]=i[e+60>>2],t=t+64|0,e=e+64|0;for(;(0|t)<(0|n);)i[t>>2]=i[e>>2],t=t+4|0,e=e+4|0}else for(n=o-4|0;(0|t)<(0|n);)r[t>>0]=0|r[e>>0],r[t+1>>0]=0|r[e+1>>0],r[t+2>>0]=0|r[e+2>>0],r[t+3>>0]=0|r[e+3>>0],t=t+4|0,e=e+4|0;for(;(0|t)<(0|o);)r[t>>0]=0|r[e>>0],t=t+1|0,e=e+1|0;return 0|s}function Ce(t,e,n){e|=0;var o,s=0,a=0,u=0;if(o=(t|=0)+(n|=0)|0,e&=255,(0|n)>=67){for(;3&t;)r[t>>0]=e,t=t+1|0;for(u=e|e<<8|e<<16|e<<24,a=(s=-4&o|0)-64|0;(0|t)<=(0|a);)i[t>>2]=u,i[t+4>>2]=u,i[t+8>>2]=u,i[t+12>>2]=u,i[t+16>>2]=u,i[t+20>>2]=u,i[t+24>>2]=u,i[t+28>>2]=u,i[t+32>>2]=u,i[t+36>>2]=u,i[t+40>>2]=u,i[t+44>>2]=u,i[t+48>>2]=u,i[t+52>>2]=u,i[t+56>>2]=u,i[t+60>>2]=u,t=t+64|0;for(;(0|t)<(0|s);)i[t>>2]=u,t=t+4|0}for(;(0|t)<(0|o);)r[t>>0]=e,t=t+1|0;return o-n|0}function Me(t){return(t=+t)>=0?+a(t+.5):+m(t-.5)}function Ie(t){var e,n,r;return t|=0,r=0|P(),(0|t)>0&(0|(e=(n=0|i[s>>2])+t|0))<(0|n)|(0|e)<0?(M(0|e),S(12),-1):(0|e)>(0|r)&&!(0|C(0|e))?(S(12),-1):(i[s>>2]=e,0|n)}return{___uremdi3:we,_bitshift64Lshr:Ee,_bitshift64Shl:xe,_calloc:_e,_cellAreaKm2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),Ht(t,e,r),(0|(e=0|i[r>>2]))>0){if(s=+Mt(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1!=(0|e)){t=1;do{s+=+Mt(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e))}}else s=0;return I=o,6371.007180918475*s*6371.007180918475},_cellAreaM2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),Ht(t,e,r),(0|(e=0|i[r>>2]))>0){if(s=+Mt(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1!=(0|e)){t=1;do{s+=+Mt(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e))}}else s=0;return I=o,6371.007180918475*s*6371.007180918475*1e3*1e3},_cellAreaRads2:function(t,e){var n,r,o,s=0;if(o=I,I=I+192|0,r=o,Zt(t|=0,e|=0,n=o+168|0),Ht(t,e,r),(0|(e=0|i[r>>2]))<=0)return I=o,+(s=0);if(s=+Mt(r+8|0,r+8+((1!=(0|e)&1)<<4)|0,n)+0,1==(0|e))return I=o,+s;t=1;do{s+=+Mt(r+8+(t<<4)|0,r+8+(((0|(t=t+1|0))%(0|e)|0)<<4)|0,n)}while((0|t)<(0|e));return I=o,+s},_compact:function(t,e,n){e|=0;var r,o=0,s=0,a=0,u=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0,x=0,S=0,P=0;if(!(n|=0))return 0;if(o=0|i[(s=t|=0)>>2],!0&0==(15728640&(s=0|i[s+4>>2])|0)){if((0|n)<=0)return 0;if(i[(S=e)>>2]=o,i[S+4>>2]=s,1==(0|n))return 0;o=1;do{x=0|i[4+(w=t+(o<<3)|0)>>2],i[(S=e+(o<<3)|0)>>2]=i[w>>2],i[S+4>>2]=x,o=o+1|0}while((0|o)!=(0|n));return 0}if(!(x=0|ye(w=n<<3)))return-3;if(Te(0|x,0|t,0|w),!(r=0|_e(n,8)))return me(x),-3;o=n;t:for(;;){v=0|Ee(0|(A=0|i[(u=x)>>2]),0|(u=0|i[u+4>>2]),52),E(),b=(v&=15)-1|0,_=(0|o)>0;e:do{if(_){if(m=((0|o)<0)<<31>>31,g=0|xe(0|b,0,52),y=0|E(),b>>>0>15)for(s=0,t=A,n=u;;){if(!(0==(0|t)&0==(0|n))){if(a=0|Ee(0|t,0|n,52),E(),c=(0|(a&=15))<(0|b),a=(0|a)==(0|b),n=0|we(0|(h=c?0:a?t:0),0|(t=c?0:a?n:0),0|o,0|m),E(),0==(0|(l=0|i[(c=a=r+(n<<3)|0)>>2]))&0==(0|(c=0|i[c+4>>2])))n=h;else for(g=0,d=n,p=c,n=h;;){if((0|g)>(0|o)){S=41;break t}if((0|l)==(0|n)&(-117440513&p|0)==(0|t)){h=0|Ee(0|l,0|p,56),E(),f=1+(h&=7)|0,y=0|Ee(0|l,0|p,45),E();n:do{if(0|F(127&y)){if(l=0|Ee(0|l,0|p,52),E(),!(l&=15)){c=6;break}for(c=1;;){if(!(0==((y=0|xe(7,0,3*(15-c|0)|0))&n|0)&0==((0|E())&t|0))){c=7;break n}if(!(c>>>0<l>>>0)){c=6;break}c=c+1|0}}else c=7}while(0);if((h+2|0)>>>0>c>>>0){S=51;break t}y=0|xe(0|f,0,56),t=0|E()|-117440513&t,i[(c=a)>>2]=0,i[c+4>>2]=0,c=d,n|=y}else c=(d+1|0)%(0|o)|0;if(0==(0|(l=0|i[(p=a=r+(c<<3)|0)>>2]))&0==(0|(p=0|i[p+4>>2])))break;g=g+1|0,d=c}i[(y=a)>>2]=n,i[y+4>>2]=t}if((0|(s=s+1|0))>=(0|o))break e;t=0|i[(n=x+(s<<3)|0)>>2],n=0|i[n+4>>2]}for(s=0,t=A,n=u;;){if(!(0==(0|t)&0==(0|n))){if(c=0|Ee(0|t,0|n,52),E(),(0|(c&=15))>=(0|b)){if((0|c)!=(0|b)&&(t|=g,n=-15728641&n|y,c>>>0>=v>>>0)){a=b;do{d=0|xe(7,0,3*(14-a|0)|0),a=a+1|0,t|=d,n=0|E()|n}while(a>>>0<c>>>0)}}else t=0,n=0;if(c=0|we(0|t,0|n,0|o,0|m),E(),!(0==(0|(h=0|i[(l=a=r+(c<<3)|0)>>2]))&0==(0|(l=0|i[l+4>>2]))))for(d=0;;){if((0|d)>(0|o)){S=41;break t}if((0|h)==(0|t)&(-117440513&l|0)==(0|n)){f=0|Ee(0|h,0|l,56),E(),p=1+(f&=7)|0,P=0|Ee(0|h,0|l,45),E();n:do{if(0|F(127&P)){if(h=0|Ee(0|h,0|l,52),E(),!(h&=15)){l=6;break}for(l=1;;){if(!(0==((P=0|xe(7,0,3*(15-l|0)|0))&t|0)&0==((0|E())&n|0))){l=7;break n}if(!(l>>>0<h>>>0)){l=6;break}l=l+1|0}}else l=7}while(0);if((f+2|0)>>>0>l>>>0){S=51;break t}P=0|xe(0|p,0,56),n=0|E()|-117440513&n,i[(p=a)>>2]=0,i[p+4>>2]=0,t|=P}else c=(c+1|0)%(0|o)|0;if(0==(0|(h=0|i[(l=a=r+(c<<3)|0)>>2]))&0==(0|(l=0|i[l+4>>2])))break;d=d+1|0}i[(P=a)>>2]=t,i[P+4>>2]=n}if((0|(s=s+1|0))>=(0|o))break e;t=0|i[(n=x+(s<<3)|0)>>2],n=0|i[n+4>>2]}}}while(0);if((o+5|0)>>>0<11){S=99;break}if(!(y=0|_e((0|o)/6|0,8))){S=58;break}e:do{if(_){d=0,p=0;do{if(!(0==(0|(s=0|i[(t=c=r+(d<<3)|0)>>2]))&0==(0|(t=0|i[t+4>>2])))){l=0|Ee(0|s,0|t,56),E(),n=1+(l&=7)|0,h=-117440513&t,P=0|Ee(0|s,0|t,45),E();n:do{if(0|F(127&P)){if(f=0|Ee(0|s,0|t,52),E(),0|(f&=15))for(a=1;;){if(!(0==(s&(P=0|xe(7,0,3*(15-a|0)|0))|0)&0==(h&(0|E())|0)))break n;if(!(a>>>0<f>>>0))break;a=a+1|0}s|=t=0|xe(0|n,0,56),t=0|E()|h,i[(n=c)>>2]=s,i[n+4>>2]=t,n=l+2|0}}while(0);7==(0|n)&&(i[(P=y+(p<<3)|0)>>2]=s,i[P+4>>2]=-117440513&t,p=p+1|0)}d=d+1|0}while((0|d)!=(0|o));if(_){if(g=((0|o)<0)<<31>>31,f=0|xe(0|b,0,52),d=0|E(),b>>>0>15)for(t=0,s=0;;){do{if(!(0==(0|A)&0==(0|u))){for(l=0|Ee(0|A,0|u,52),E(),a=(0|(l&=15))<(0|b),l=(0|l)==(0|b),a=0|we(0|(c=a?0:l?A:0),0|(l=a?0:l?u:0),0|o,0|g),E(),n=0;;){if((0|n)>(0|o)){S=98;break t}if((-117440513&(h=0|i[4+(P=r+(a<<3)|0)>>2])|0)==(0|l)&&(0|i[P>>2])==(0|c)){S=70;break}if((0|i[(P=r+((a=(a+1|0)%(0|o)|0)<<3)|0)>>2])==(0|c)&&(0|i[P+4>>2])==(0|l))break;n=n+1|0}if(70==(0|S)&&(S=0,!0&100663296==(117440512&h|0)))break;i[(P=e+(s<<3)|0)>>2]=A,i[P+4>>2]=u,s=s+1|0}}while(0);if((0|(t=t+1|0))>=(0|o)){o=p;break e}A=0|i[(u=x+(t<<3)|0)>>2],u=0|i[u+4>>2]}for(t=0,s=0;;){do{if(!(0==(0|A)&0==(0|u))){if(l=0|Ee(0|A,0|u,52),E(),(0|(l&=15))>=(0|b))if((0|l)!=(0|b))if(n=A|f,a=-15728641&u|d,l>>>0<v>>>0)l=a;else{c=b;do{P=0|xe(7,0,3*(14-c|0)|0),c=c+1|0,n|=P,a=0|E()|a}while(c>>>0<l>>>0);l=a}else n=A,l=u;else n=0,l=0;for(c=0|we(0|n,0|l,0|o,0|g),E(),a=0;;){if((0|a)>(0|o)){S=98;break t}if((-117440513&(h=0|i[4+(P=r+(c<<3)|0)>>2])|0)==(0|l)&&(0|i[P>>2])==(0|n)){S=93;break}if((0|i[(P=r+((c=(c+1|0)%(0|o)|0)<<3)|0)>>2])==(0|n)&&(0|i[P+4>>2])==(0|l))break;a=a+1|0}if(93==(0|S)&&(S=0,!0&100663296==(117440512&h|0)))break;i[(P=e+(s<<3)|0)>>2]=A,i[P+4>>2]=u,s=s+1|0}}while(0);if((0|(t=t+1|0))>=(0|o)){o=p;break e}A=0|i[(u=x+(t<<3)|0)>>2],u=0|i[u+4>>2]}}else s=0,o=p}else s=0,o=0}while(0);if(Ce(0|r,0,0|w),Te(0|x,0|y,o<<3|0),me(y),!o)break;e=e+(s<<3)|0}return 41==(0|S)?(me(x),me(r),0|(P=-1)):51==(0|S)?(me(x),me(r),0|(P=-2)):58==(0|S)?(me(x),me(r),0|(P=-3)):98==(0|S)?(me(y),me(x),me(r),0|(P=-1)):(99==(0|S)&&Te(0|e,0|x,o<<3|0),me(x),me(r),0|(P=0))},_destroyLinkedPolygon:function(t){var e=0,n=0,r=0,o=0;if(t|=0)for(r=1;;){if(0|(e=0|i[t>>2]))do{if(0|(n=0|i[e>>2]))do{o=n,n=0|i[n+16>>2],me(o)}while(0!=(0|n));o=e,e=0|i[e+8>>2],me(o)}while(0!=(0|e));if(e=t,t=0|i[t+8>>2],r||me(e),!t)break;r=0}},_edgeLengthKm:function(t){return+ +o[20752+((t|=0)<<3)>>3]},_edgeLengthM:function(t){return+ +o[20880+((t|=0)<<3)>>3]},_emscripten_replace_memory:function(t){return r=new Int8Array(t),new Uint8Array(t),i=new Int32Array(t),new Float32Array(t),o=new Float64Array(t),n=t,!0},_exactEdgeLengthKm:function(t,e){var n,r,s=0,a=0,u=0,l=0,f=0,p=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(u=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],u=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],p=+A(.5*(a-f)),l=u,u=+o[n+8+(t<<4)+8>>3],l=p*p+(l=+A(.5*(u-l)))*(+h(+f)*+h(+a)*l),s+=2*+y(+ +c(+l),+ +c(+(1-l)))}while((0|t)!=(0|e));return I=r,+(p=6371.007180918475*s)},_exactEdgeLengthM:function(t,e){var n,r,s=0,a=0,u=0,l=0,f=0,p=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(u=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],u=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],p=+A(.5*(a-f)),l=u,u=+o[n+8+(t<<4)+8>>3],l=p*p+(l=+A(.5*(u-l)))*(+h(+f)*+h(+a)*l),s+=2*+y(+ +c(+l),+ +c(+(1-l)))}while((0|t)!=(0|e));return I=r,+(p=6371.007180918475*s*1e3)},_exactEdgeLengthRads:function(t,e){var n,r,s=0,a=0,u=0,l=0,f=0,p=0;if(r=I,I=I+176|0,Xt(t|=0,e|=0,n=r),(0|(t=0|i[n>>2]))<=1)return I=r,+(u=0);e=t+-1|0,t=0,s=0,a=+o[n+8>>3],u=+o[n+16>>3];do{f=a,a=+o[n+8+((t=t+1|0)<<4)>>3],p=+A(.5*(a-f)),l=u,u=+o[n+8+(t<<4)+8>>3],l=p*p+(l=+A(.5*(u-l)))*(+h(+a)*+h(+f)*l),s+=2*+y(+ +c(+l),+ +c(+(1-l)))}while((0|t)<(0|e));return I=r,+s},_experimentalH3ToLocalIj:function(t,e,n,r,i){var o,s;return i|=0,s=I,I=I+16|0,(t=0|$t(t|=0,e|=0,n|=0,r|=0,o=s))||(ft(o,i),t=0),I=s,0|t},_experimentalLocalIjToH3:function(t,e,n,r){var i,o;return t|=0,e|=0,r|=0,i=I,I=I+16|0,pt(n|=0,o=i),r=0|te(t,e,o,r),I=i,0|r},_free:me,_geoToH3:zt,_getDestinationH3IndexFromUnidirectionalEdge:function(t,e){t|=0;var n,r,o=0;return n=I,I=I+16|0,o=n,!0&268435456==(2013265920&(e|=0)|0)?(r=0|Ee(0|t,0|e,56),E(),i[o>>2]=0,o=0|N(t,-2130706433&e|134217728,7&r,o),e=0|E(),w(0|e),I=n,0|o):(o=0,w(0|(e=0)),I=n,0|o)},_getH3IndexesFromUnidirectionalEdge:function(t,e,n){t|=0;var r,o,s,a,u=0;s=I,I=I+16|0,r=s,a=!0&268435456==(2013265920&(e|=0)|0),o=-2130706433&e|134217728,i[(u=n|=0)>>2]=a?t:0,i[u+4>>2]=a?o:0,a?(e=0|Ee(0|t,0|e,56),E(),i[r>>2]=0,t=0|N(t,o,7&e,r),e=0|E()):(t=0,e=0),i[(u=n+8|0)>>2]=t,i[u+4>>2]=e,I=s},_getH3UnidirectionalEdge:function(t,e,n,r){var o,s,a=0,u=0,c=0,l=0,h=0;if(s=I,I=I+16|0,o=s,!(0|Wt(t|=0,e|=0,n|=0,r|=0)))return l=0,w(0|(c=0)),I=s,0|l;for(c=-2130706433&e,a=(a=0==(0|Nt(t,e)))?1:2;i[o>>2]=0,u=a+1|0,!((0|(h=0|N(t,e,a,o)))==(0|n)&(0|E())==(0|r));){if(!(u>>>0<7)){a=0,t=0,l=6;break}a=u}return 6==(0|l)?(w(0|a),I=s,0|t):(h=0|xe(0|a,0,56),l=0|c|E()|268435456,h|=t,w(0|l),I=s,0|h)},_getH3UnidirectionalEdgeBoundary:Xt,_getH3UnidirectionalEdgesFromHexagon:function(t,e,n){n|=0;var r,o=0;r=0==(0|Nt(t|=0,e|=0)),e&=-2130706433,i[(o=n)>>2]=r?t:0,i[o+4>>2]=r?285212672|e:0,i[(o=n+8|0)>>2]=t,i[o+4>>2]=301989888|e,i[(o=n+16|0)>>2]=t,i[o+4>>2]=318767104|e,i[(o=n+24|0)>>2]=t,i[o+4>>2]=335544320|e,i[(o=n+32|0)>>2]=t,i[o+4>>2]=352321536|e,i[(n=n+40|0)>>2]=t,i[n+4>>2]=369098752|e},_getOriginH3IndexFromUnidirectionalEdge:function(t,e){var n;return t|=0,w(0|((n=!0&268435456==(2013265920&(e|=0)|0))?-2130706433&e|134217728:0)),0|(n?t:0)},_getPentagonIndexes:qt,_getRes0Indexes:function(t){t|=0;var e=0,n=0,r=0;e=0;do{xe(0|e,0,45),r=134225919|E(),i[(n=t+(e<<3)|0)>>2]=-1,i[n+4>>2]=r,e=e+1|0}while(122!=(0|e))},_h3Distance:function(t,e,n,r){var i,o,s;return n|=0,r|=0,s=I,I=I+32|0,o=s,t=0==(0|$t(t|=0,e|=0,t,e,i=s+12|0))&&0==(0|$t(t,e,n,r,o))?0|At(i,o):-1,I=s,0|t},_h3GetBaseCell:It,_h3GetFaces:function t(e,n,r){r|=0;var o,s=0,a=0,u=0,c=0,l=0,h=0,A=0,f=0;o=I,I=I+128|0,A=o+112|0,u=o+96|0,f=o,a=0|Ee(0|(e|=0),0|(n|=0),52),E(),l=15&a,i[A>>2]=l,c=0|Ee(0|e,0|n,45),E(),c&=127;t:do{if(0|F(c)){if(0|l)for(s=1;;){if(!(0==((h=0|xe(7,0,3*(15-s|0)|0))&e|0)&0==((0|E())&n|0))){a=0;break t}if(!(s>>>0<l>>>0))break;s=s+1|0}if(!(1&a))return h=0|xe(l+1|0,0,52),f=0|E()|-15728641&n,t((h|e)&~(A=0|xe(7,0,3*(14-l|0)|0)),f&~(0|E()),r),void(I=o);a=1}else a=0}while(0);Vt(e,n,u),a?(bt(u,A,f),h=5):(St(u,A,f),h=6);t:do{if(0|F(c))if(l)for(s=1;;){if(!(0==((c=0|xe(7,0,3*(15-s|0)|0))&e|0)&0==((0|E())&n|0))){s=8;break t}if(!(s>>>0<l>>>0)){s=20;break}s=s+1|0}else s=20;else s=8}while(0);if(Ce(0|r,-1,0|s),a){a=0;do{for(Et(u=f+(a<<4)|0,0|i[A>>2]),u=0|i[u>>2],s=0;!(-1==(0|(l=0|i[(c=r+(s<<2)|0)>>2]))|(0|l)==(0|u));)s=s+1|0;i[c>>2]=u,a=a+1|0}while((0|a)!=(0|h))}else{a=0;do{for(wt(u=f+(a<<4)|0,0|i[A>>2],0,1),u=0|i[u>>2],s=0;!(-1==(0|(l=0|i[(c=r+(s<<2)|0)>>2]))|(0|l)==(0|u));)s=s+1|0;i[c>>2]=u,a=a+1|0}while((0|a)!=(0|h))}I=o},_h3GetResolution:function(t,e){return e=0|Ee(0|(t|=0),0|(e|=0),52),E(),15&e|0},_h3IndexesAreNeighbors:Wt,_h3IsPentagon:Nt,_h3IsResClassIII:function(t,e){return e=0|Ee(0|(t|=0),0|(e|=0),52),E(),1&e|0},_h3IsValid:Ot,_h3Line:function(t,e,n,r,o){n|=0,r|=0,o|=0;var s,a=0,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0,E=0,x=0;if(s=I,I=I+48|0,c=s+12|0,E=s,0==(0|$t(t|=0,e|=0,t,e,a=s+24|0))&&0==(0|$t(t,e,n,r,c))){if((0|(w=0|At(a,c)))<0)return I=s,0|w;for(i[a>>2]=0,i[a+4>>2]=0,i[a+8>>2]=0,i[c>>2]=0,i[c+4>>2]=0,i[c+8>>2]=0,$t(t,e,t,e,a),$t(t,e,n,r,c),dt(a),dt(c),w?(g=+(0|w),b=a,n=f=0|i[a>>2],r=p=0|i[(_=a+4|0)>>2],a=d=0|i[(v=a+8|0)>>2],y=+((0|i[c>>2])-f|0)/g,m=+((0|i[c+4>>2])-p|0)/g,g=+((0|i[c+8>>2])-d|0)/g):(_=r=a+4|0,v=d=a+8|0,b=a,n=0|i[a>>2],r=0|i[r>>2],a=0|i[d>>2],y=0,m=0,g=0),i[E>>2]=n,i[(d=E+4|0)>>2]=r,i[(p=E+8|0)>>2]=a,f=0;;){x=y*(h=+(0|f))+ +(0|n),l=m*h+ +(0|i[_>>2]),h=g*h+ +(0|i[v>>2]),r=~~+Pe(+x),c=~~+Pe(+l),n=~~+Pe(+h),x=+u(+(+(0|r)-x)),l=+u(+(+(0|c)-l)),h=+u(+(+(0|n)-h));do{if(!(x>l&x>h)){if(A=0-r|0,l>h){a=A-n|0;break}a=c,n=A-c|0;break}r=0-(c+n)|0,a=c}while(0);if(i[E>>2]=r,i[d>>2]=a,i[p>>2]=n,gt(E),te(t,e,E,o+(f<<3)|0),(0|f)==(0|w))break;f=f+1|0,n=0|i[b>>2]}return I=s,0}return I=s,-1},_h3LineSize:function(t,e,n,r){var i,o,s;return n|=0,r|=0,s=I,I=I+32|0,o=s,t=0==(0|$t(t|=0,e|=0,t,e,i=s+12|0))&&0==(0|$t(t,e,n,r,o))?0|At(i,o):-1,I=s,(t>>>31^1)+t|0},_h3SetToLinkedGeo:function(t,e,n){n|=0;var r,o,s,a=0;if(s=I,I=I+32|0,r=s,function(t,e,n){t|=0,n|=0;var r,o,s=0,a=0,u=0,c=0,l=0;if(o=I,I=I+176|0,r=o,(0|(e|=0))<1)return ce(n,0,0),void(I=o);c=0|Ee(0|i[(c=t)>>2],0|i[c+4>>2],52),E(),ce(n,(0|e)>6?e:6,15&c),c=0;do{if(Ht(0|i[(s=t+(c<<3)|0)>>2],0|i[s+4>>2],r),(0|(s=0|i[r>>2]))>0){l=0;do{u=r+8+(l<<4)|0,(a=0|pe(n,s=r+8+(((0|(l=l+1|0))%(0|s)|0)<<4)|0,u))?Ae(n,a):fe(n,u,s),s=0|i[r>>2]}while((0|l)<(0|s))}c=c+1|0}while((0|c)!=(0|e));I=o}(t|=0,e|=0,o=s+16|0),i[n>>2]=0,i[n+4>>2]=0,i[n+8>>2]=0,!(t=0|he(o)))return Kt(n),le(o),void(I=s);do{e=0|Yt(n);do{Qt(e,t),a=t+16|0,i[r>>2]=i[a>>2],i[r+4>>2]=i[a+4>>2],i[r+8>>2]=i[a+8>>2],i[r+12>>2]=i[a+12>>2],Ae(o,t),t=0|de(o,r)}while(0!=(0|t));t=0|he(o)}while(0!=(0|t));Kt(n),le(o),I=s},_h3ToCenterChild:function(t,e,n){n|=0;var r=0,i=0;if(r=0|Ee(0|(t|=0),0|(e|=0),52),E(),(0|n)<16&(0|(r&=15))<=(0|n)){if((0|r)!=(0|n)&&(t|=i=0|xe(0|n,0,52),e=0|E()|-15728641&e,(0|r)<(0|n)))do{i=0|xe(7,0,3*(14-r|0)|0),r=r+1|0,t&=~i,e&=~(0|E())}while((0|r)<(0|n))}else e=0,t=0;return w(0|e),0|t},_h3ToChildren:Lt,_h3ToGeo:Zt,_h3ToGeoBoundary:Ht,_h3ToParent:Rt,_h3UnidirectionalEdgeIsValid:function(t,e){var n=0;if(!(!0&268435456==(2013265920&(e|=0)|0)))return 0;switch(n=0|Ee(0|(t|=0),0|e,56),E(),7&n){case 0:case 7:return 0}return!0&16777216==(117440512&e|0)&0!=(0|Nt(t,n=-2130706433&e|134217728))?0|(n=0):0|(n=0|Ot(t,n))},_hexAreaKm2:function(t){return+ +o[20496+((t|=0)<<3)>>3]},_hexAreaM2:function(t){return+ +o[20624+((t|=0)<<3)>>3]},_hexRing:function(t,e,n,r){t|=0,e|=0,r|=0;var o,s=0,a=0,u=0,c=0,l=0,h=0,A=0;if(o=I,I=I+16|0,A=o,!(n|=0))return i[(A=r)>>2]=t,i[A+4>>2]=e,I=o,0;i[A>>2]=0;t:do{if(0|Nt(t,e))t=1;else{if(a=(0|n)>0){s=0,h=t;do{if(0==(0|(h=0|N(h,e,4,A)))&0==(0|(e=0|E()))){t=2;break t}if(s=s+1|0,0|Nt(h,e)){t=1;break t}}while((0|s)<(0|n));if(i[(l=r)>>2]=h,i[l+4>>2]=e,l=n+-1|0,a){a=0,u=1,s=h,t=e;do{if(0==(0|(s=0|N(s,t,2,A)))&0==(0|(t=0|E()))){t=2;break t}if(i[(c=r+(u<<3)|0)>>2]=s,i[c+4>>2]=t,u=u+1|0,0|Nt(s,t)){t=1;break t}a=a+1|0}while((0|a)<(0|n));c=0,a=u;do{if(0==(0|(s=0|N(s,t,3,A)))&0==(0|(t=0|E()))){t=2;break t}if(i[(u=r+(a<<3)|0)>>2]=s,i[u+4>>2]=t,a=a+1|0,0|Nt(s,t)){t=1;break t}c=c+1|0}while((0|c)<(0|n));u=0;do{if(0==(0|(s=0|N(s,t,1,A)))&0==(0|(t=0|E()))){t=2;break t}if(i[(c=r+(a<<3)|0)>>2]=s,i[c+4>>2]=t,a=a+1|0,0|Nt(s,t)){t=1;break t}u=u+1|0}while((0|u)<(0|n));u=0;do{if(0==(0|(s=0|N(s,t,5,A)))&0==(0|(t=0|E()))){t=2;break t}if(i[(c=r+(a<<3)|0)>>2]=s,i[c+4>>2]=t,a=a+1|0,0|Nt(s,t)){t=1;break t}u=u+1|0}while((0|u)<(0|n));u=0;do{if(0==(0|(s=0|N(s,t,4,A)))&0==(0|(t=0|E()))){t=2;break t}if(i[(c=r+(a<<3)|0)>>2]=s,i[c+4>>2]=t,a=a+1|0,0|Nt(s,t)){t=1;break t}u=u+1|0}while((0|u)<(0|n));for(u=0;;){if(0==(0|(s=0|N(s,t,6,A)))&0==(0|(t=0|E()))){t=2;break t}if((0|u)!=(0|l)){if(i[(c=r+(a<<3)|0)>>2]=s,i[c+4>>2]=t,0|Nt(s,t)){t=1;break t}a=a+1|0}if((0|(u=u+1|0))>=(0|n)){u=h,a=e;break}}}else u=h,s=h,a=e,t=e}else i[(u=r)>>2]=t,i[u+4>>2]=e,u=t,s=t,a=e,t=e;t=1&((0|u)!=(0|s)|(0|a)!=(0|t))}}while(0);return I=o,0|t},_i64Subtract:ve,_kRing:O,_kRingDistances:function(t,e,n,r,i){var o;if(0|R(t|=0,e|=0,n|=0,r|=0,i|=0)){if(Ce(0|r,0,(o=1+(0|_(3*n|0,n+1|0))|0)<<3|0),0|i)return Ce(0|i,0,o<<2|0),void L(t,e,n,r,i,o,0);(i=0|_e(o,4))&&(L(t,e,n,r,i,o,0),me(i))}},_llvm_minnum_f64:Se,_llvm_round_f64:Pe,_malloc:ye,_maxFaceCount:function(t,e){var n=0,r=0;if(r=0|Ee(0|(t|=0),0|(e|=0),45),E(),!(0|F(127&r)))return 2;if(r=0|Ee(0|t,0|e,52),E(),!(r&=15))return 5;for(n=1;;){if(!(0==((0|xe(7,0,3*(15-n|0)|0))&t|0)&0==((0|E())&e|0))){n=2,t=6;break}if(!(n>>>0<r>>>0)){n=5,t=6;break}n=n+1|0}return 6==(0|t)?0|n:0},_maxH3ToChildrenSize:function(t,e,n){return n|=0,t=0|Ee(0|(t|=0),0|(e|=0),52),E(),(0|n)<16&(0|(t&=15))<=(0|n)?0|(n=0|ee(7,n-t|0)):0|(n=0)},_maxKringSize:function(t){return 1+(0|_(3*(t|=0)|0,t+1|0))|0},_maxPolyfillSize:function(t,e){e|=0;var n,r=0,o=0,s=0,a=0,u=0;if(n=I,I=I+48|0,s=n+8|0,o=n,a=0|i[4+(u=t|=0)>>2],i[(r=o)>>2]=i[u>>2],i[r+4>>2]=a,re(o,s),s=0|H(s,e),e=0|i[o>>2],(0|(o=0|i[t+8>>2]))<=0)return I=n,0|(u=(a=(0|s)<(0|(u=e)))?u:s)+12;r=0|i[t+12>>2],t=0;do{e=(0|i[r+(t<<3)>>2])+e|0,t=t+1|0}while((0|t)<(0|o));return I=n,0|(u=(u=(0|s)<(0|e))?e:s)+12},_maxUncompactSize:function(t,e,n){t|=0;var r=0,o=0,s=0,a=0;if((0|(e|=0))<=0)return 0;if((0|(n|=0))>=16){for(r=0;;){if(!(0==(0|i[(a=t+(r<<3)|0)>>2])&0==(0|i[a+4>>2]))){r=-1,o=13;break}if((0|(r=r+1|0))>=(0|e)){r=0,o=13;break}}if(13==(0|o))return 0|r}r=0,a=0;t:for(;;){s=0|i[(o=t+(a<<3)|0)>>2],o=0|i[o+4>>2];do{if(!(0==(0|s)&0==(0|o))){if(o=0|Ee(0|s,0|o,52),E(),(0|(o&=15))>(0|n)){r=-1,o=13;break t}if((0|o)==(0|n)){r=r+1|0;break}r=(0|ee(7,n-o|0))+r|0;break}}while(0);if((0|(a=a+1|0))>=(0|e)){o=13;break}}return 13==(0|o)?0|r:0},_memcpy:Te,_memset:Ce,_numHexagons:function(t){var e;return t=0|i[(e=21008+((t|=0)<<3)|0)>>2],w(0|i[e+4>>2]),0|t},_pentagonIndexCount:function(){return 12},_pointDistKm:Ct,_pointDistM:function(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+A(.5*(r-n)))*i+(s=+A(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+y(+ +c(+s),+ +c(+(1-s)))*6371.007180918475*1e3},_pointDistRads:function(t,e){t|=0;var n,r,i,s=0;return r=+o[(e|=0)>>3],n=+o[t>>3],s=(i=+A(.5*(r-n)))*i+(s=+A(.5*(+o[e+8>>3]-+o[t+8>>3])))*(+h(+r)*+h(+n)*s),2*+y(+ +c(+s),+ +c(+(1-s)))},_polyfill:function(t,e,n){var r,o=0,s=0,a=0,u=0,c=0;if(r=I,I=I+48|0,o=r+8|0,s=r,0|function(t,e,n){e|=0,n|=0;var r,o,s,a,u,c=0,l=0,h=0,A=0,f=0,p=0,d=0,g=0,y=0,m=0,_=0,v=0,b=0,w=0,S=0,P=0,T=0,C=0,M=0,O=0,N=0,F=0,k=0,B=0,j=0;if(u=I,I=I+112|0,o=u+80|0,p=u+72|0,s=u,a=u+56|0,(j=0|ye(32+(i[(d=8+(t|=0)|0)>>2]<<5)|0))||x(22848,22448,800,22456),ie(t,j),c=0|i[(h=t)+4>>2],i[(f=p)>>2]=i[h>>2],i[f+4>>2]=c,re(p,o),f=0|H(o,e),c=0|i[p>>2],(0|(h=0|i[d>>2]))>0){A=0|i[t+12>>2],l=0;do{c=(0|i[A+(l<<3)>>2])+c|0,l=l+1|0}while((0|l)!=(0|h))}if(l=0|_e(r=(f=(0|f)<(0|c)?c:f)+12|0,8),g=0|_e(r,8),i[o>>2]=0,B=0|i[(k=t)+4>>2],i[(c=p)>>2]=i[k>>2],i[c+4>>2]=B,0|(c=0|D(p,r,e,o,l,g)))return me(l),me(g),me(j),I=u,0|c;t:do{if((0|i[d>>2])>0){for(h=t+12|0,c=0;A=0|D((0|i[h>>2])+(c<<3)|0,r,e,o,l,g),c=c+1|0,!(0|A);)if((0|c)>=(0|i[d>>2]))break t;return me(l),me(g),me(j),I=u,0|A}}while(0);(0|f)>-12&&Ce(0|g,0,((0|r)>1?r:1)<<3|0);t:do{if((0|i[o>>2])>0){B=((0|r)<0)<<31>>31,C=l,M=g,O=l,N=l,F=g,k=l,c=l,w=l,S=g,P=g,T=g,l=g;e:for(;;){for(b=0|i[o>>2],_=0,v=0,h=0;;){f=(A=s)+56|0;do{i[A>>2]=0,A=A+4|0}while((0|A)<(0|f));if(0|R(p=0|i[(e=C+(_<<3)|0)>>2],e=0|i[e+4>>2],1,s,0)){f=(A=s)+56|0;do{i[A>>2]=0,A=A+4|0}while((0|A)<(0|f));0|(A=0|_e(7,4))&&(L(p,e,1,s,A,7,0),me(A))}m=0;do{g=0|i[(y=s+(m<<3)|0)>>2],y=0|i[y+4>>2];n:do{if(!(0==(0|g)&0==(0|y))){if(p=0|we(0|g,0|y,0|r,0|B),E(),!(0==(0|(e=0|i[(f=A=n+(p<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2]))))for(d=0;;){if((0|d)>(0|r))break e;if((0|e)==(0|g)&(0|f)==(0|y))break n;if(0==(0|(e=0|i[(f=A=n+((p=(p+1|0)%(0|r)|0)<<3)|0)>>2]))&0==(0|(f=0|i[f+4>>2])))break;d=d+1|0}0==(0|g)&0==(0|y)||(Zt(g,y,a),0|oe(t,j,a)&&(i[(d=A)>>2]=g,i[d+4>>2]=y,i[(d=M+(h<<3)|0)>>2]=g,i[d+4>>2]=y,h=h+1|0))}}while(0);m=m+1|0}while(m>>>0<7);if((0|(v=v+1|0))>=(0|b))break;_=_+1|0}if((0|b)>0&&Ce(0|O,0,b<<3|0),i[o>>2]=h,!((0|h)>0))break t;g=l,y=T,m=k,_=P,v=S,b=M,l=w,T=c,P=N,S=O,w=g,c=y,k=F,F=m,N=_,O=v,M=C,C=b}return me(N),me(F),me(j),I=u,-1}c=g}while(0);return me(j),me(l),me(c),I=u,0}(t|=0,e|=0,n|=0)){if(a=0|i[(c=t)+4>>2],i[(u=s)>>2]=i[c>>2],i[u+4>>2]=a,re(s,o),u=0|H(o,e),e=0|i[s>>2],(0|(a=0|i[t+8>>2]))>0){s=0|i[t+12>>2],o=0;do{e=(0|i[s+(o<<3)>>2])+e|0,o=o+1|0}while((0|o)!=(0|a))}(0|(e=(0|u)<(0|e)?e:u))<=-12||Ce(0|n,0,8+(((0|(c=e+11|0))>0?c:0)<<3)|0),I=r}else I=r},_res0IndexCount:function(){return 122},_round:Me,_sbrk:Ie,_sizeOfCoordIJ:function(){return 8},_sizeOfGeoBoundary:function(){return 168},_sizeOfGeoCoord:function(){return 16},_sizeOfGeoPolygon:function(){return 16},_sizeOfGeofence:function(){return 8},_sizeOfH3Index:function(){return 8},_sizeOfLinkedGeoPolygon:function(){return 12},_uncompact:function(t,e,n,r,o){t|=0,n|=0,r|=0;var s=0,a=0,u=0,c=0,l=0,h=0;if((0|(e|=0))<=0)return 0;if((0|(o|=0))>=16){for(s=0;;){if(!(0==(0|i[(h=t+(s<<3)|0)>>2])&0==(0|i[h+4>>2]))){s=14;break}if((0|(s=s+1|0))>=(0|e)){a=0,s=16;break}}if(14==(0|s))return 0|((0|r)>0?-2:-1);if(16==(0|s))return 0|a}s=0,h=0;t:for(;;){a=0|i[(u=l=t+(h<<3)|0)>>2],u=0|i[u+4>>2];do{if(!(0==(0|a)&0==(0|u))){if((0|s)>=(0|r)){a=-1,s=16;break t}if(c=0|Ee(0|a,0|u,52),E(),(0|(c&=15))>(0|o)){a=-2,s=16;break t}if((0|c)==(0|o)){i[(l=n+(s<<3)|0)>>2]=a,i[l+4>>2]=u,s=s+1|0;break}if((0|(a=(0|ee(7,o-c|0))+s|0))>(0|r)){a=-1,s=16;break t}Lt(0|i[l>>2],0|i[l+4>>2],o,n+(s<<3)|0),s=a}}while(0);if((0|(h=h+1|0))>=(0|e)){a=0,s=16;break}}return 16==(0|s)?0|a:0},establishStackSpace:function(t,e){I=t|=0},stackAlloc:function(t){var e;return e=I,I=15+(I=I+(t|=0)|0)&-16,0|e},stackRestore:function(t){I=t|=0},stackSave:function(){return 0|I}}}({Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},{a:at,b:function(t){c=t},c:l,d:function(t,e,n,r){at("Assertion failed: "+w(t)+", at: "+[e?w(e):"unknown filename",n,r?w(r):"unknown function"])},e:function(t){return n.___errno_location&&(m[n.___errno_location()>>2]=t),t},f:H,g:function(t,e,n){g.set(g.subarray(e,e+n),t)},h:function(t){var e=H(),n=16777216,r=2130706432;if(t>r)return!1;for(var i=Math.max(e,16777216);i<t;)i=i<=536870912?E(2*i,n):Math.min(E((3*i+2147483648)/4,n),r);return!!q(i)},i:function(t){at("OOM")},j:function(t){return t},k:V,l:q,m:Z,n:function(){var t=Z();return n.extraStackTrace&&(t+="\n"+n.extraStackTrace()),V(t)},o:24032,p:24016},p),J=(n.___uremdi3=K.___uremdi3,n._bitshift64Lshr=K._bitshift64Lshr,n._bitshift64Shl=K._bitshift64Shl,n._calloc=K._calloc,n._cellAreaKm2=K._cellAreaKm2,n._cellAreaM2=K._cellAreaM2,n._cellAreaRads2=K._cellAreaRads2,n._compact=K._compact,n._destroyLinkedPolygon=K._destroyLinkedPolygon,n._edgeLengthKm=K._edgeLengthKm,n._edgeLengthM=K._edgeLengthM,n._emscripten_replace_memory=K._emscripten_replace_memory),$=(n._exactEdgeLengthKm=K._exactEdgeLengthKm,n._exactEdgeLengthM=K._exactEdgeLengthM,n._exactEdgeLengthRads=K._exactEdgeLengthRads,n._experimentalH3ToLocalIj=K._experimentalH3ToLocalIj,n._experimentalLocalIjToH3=K._experimentalLocalIjToH3,n._free=K._free,n._geoToH3=K._geoToH3,n._getDestinationH3IndexFromUnidirectionalEdge=K._getDestinationH3IndexFromUnidirectionalEdge,n._getH3IndexesFromUnidirectionalEdge=K._getH3IndexesFromUnidirectionalEdge,n._getH3UnidirectionalEdge=K._getH3UnidirectionalEdge,n._getH3UnidirectionalEdgeBoundary=K._getH3UnidirectionalEdgeBoundary,n._getH3UnidirectionalEdgesFromHexagon=K._getH3UnidirectionalEdgesFromHexagon,n._getOriginH3IndexFromUnidirectionalEdge=K._getOriginH3IndexFromUnidirectionalEdge,n._getPentagonIndexes=K._getPentagonIndexes,n._getRes0Indexes=K._getRes0Indexes,n._h3Distance=K._h3Distance,n._h3GetBaseCell=K._h3GetBaseCell,n._h3GetFaces=K._h3GetFaces,n._h3GetResolution=K._h3GetResolution,n._h3IndexesAreNeighbors=K._h3IndexesAreNeighbors,n._h3IsPentagon=K._h3IsPentagon,n._h3IsResClassIII=K._h3IsResClassIII,n._h3IsValid=K._h3IsValid,n._h3Line=K._h3Line,n._h3LineSize=K._h3LineSize,n._h3SetToLinkedGeo=K._h3SetToLinkedGeo,n._h3ToCenterChild=K._h3ToCenterChild,n._h3ToChildren=K._h3ToChildren,n._h3ToGeo=K._h3ToGeo,n._h3ToGeoBoundary=K._h3ToGeoBoundary,n._h3ToParent=K._h3ToParent,n._h3UnidirectionalEdgeIsValid=K._h3UnidirectionalEdgeIsValid,n._hexAreaKm2=K._hexAreaKm2,n._hexAreaM2=K._hexAreaM2,n._hexRing=K._hexRing,n._i64Subtract=K._i64Subtract,n._kRing=K._kRing,n._kRingDistances=K._kRingDistances,n._llvm_minnum_f64=K._llvm_minnum_f64,n._llvm_round_f64=K._llvm_round_f64,n._malloc=K._malloc,n._maxFaceCount=K._maxFaceCount,n._maxH3ToChildrenSize=K._maxH3ToChildrenSize,n._maxKringSize=K._maxKringSize,n._maxPolyfillSize=K._maxPolyfillSize,n._maxUncompactSize=K._maxUncompactSize,n._memcpy=K._memcpy,n._memset=K._memset,n._numHexagons=K._numHexagons,n._pentagonIndexCount=K._pentagonIndexCount,n._pointDistKm=K._pointDistKm,n._pointDistM=K._pointDistM,n._pointDistRads=K._pointDistRads,n._polyfill=K._polyfill,n._res0IndexCount=K._res0IndexCount,n._round=K._round,n._sbrk=K._sbrk,n._sizeOfCoordIJ=K._sizeOfCoordIJ,n._sizeOfGeoBoundary=K._sizeOfGeoBoundary,n._sizeOfGeoCoord=K._sizeOfGeoCoord,n._sizeOfGeoPolygon=K._sizeOfGeoPolygon,n._sizeOfGeofence=K._sizeOfGeofence,n._sizeOfH3Index=K._sizeOfH3Index,n._sizeOfLinkedGeoPolygon=K._sizeOfLinkedGeoPolygon,n._uncompact=K._uncompact,n.establishStackSpace=K.establishStackSpace,n.stackAlloc=K.stackAlloc),tt=n.stackRestore=K.stackRestore,et=n.stackSave=K.stackSave;if(n.asm=K,n.cwrap=function(t,e,n,r){var i=(n=n||[]).every((function(t){return"number"===t}));return"string"!==e&&i&&!r?A(t):function(){return f(t,e,n,arguments)}},n.setValue=function(t,e,n,r){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":d[t>>0]=e;break;case"i16":y[t>>1]=e;break;case"i32":m[t>>2]=e;break;case"i64":j=[e>>>0,(B=e,+O(B)>=1?B>0?(0|N(+L(B/4294967296),4294967295))>>>0:~~+R((B-+(~~B>>>0))/4294967296)>>>0:0)],m[t>>2]=j[0],m[t+4>>2]=j[1];break;case"float":_[t>>2]=e;break;case"double":v[t>>3]=e;break;default:at("invalid type for setValue: "+n)}},n.getValue=function(t,e,n){switch("*"===(e=e||"i8").charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return d[t>>0];case"i16":return y[t>>1];case"i32":case"i64":return m[t>>2];case"float":return _[t>>2];case"double":return v[t>>3];default:at("invalid type for getValue: "+e)}return null},n.getTempRet0=l,U){G(U)||(Y=U,U=n.locateFile?n.locateFile(Y,s):s+Y),D++,n.monitorRunDependencies&&n.monitorRunDependencies(D);var nt=function(t){t.byteLength&&(t=new Uint8Array(t)),g.set(t,8),n.memoryInitializerRequest&&delete n.memoryInitializerRequest.response,function(t){if(D--,n.monitorRunDependencies&&n.monitorRunDependencies(D),0==D&&(null!==F&&(clearInterval(F),F=null),k)){var e=k;k=null,e()}}()},rt=function(){i(U,nt,(function(){throw"could not load memory initializer "+U}))},it=X(U);if(it)nt(it.buffer);else if(n.memoryInitializerRequest){var ot=function(){var t=n.memoryInitializerRequest,e=t.response;if(200!==t.status&&0!==t.status){var r=X(n.memoryInitializerRequestURL);if(!r)return console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+t.status+", retrying "+U),void rt();e=r.buffer}nt(e)};n.memoryInitializerRequest.response?setTimeout(ot,0):n.memoryInitializerRequest.addEventListener("load",ot)}else rt()}function st(t){function e(){Q||(Q=!0,h||(P(C),P(M),n.onRuntimeInitialized&&n.onRuntimeInitialized(),function(){if(n.postRun)for("function"==typeof n.postRun&&(n.postRun=[n.postRun]);n.postRun.length;)t=n.postRun.shift(),I.unshift(t);var t;P(I)}()))}t=t||o,D>0||(function(){if(n.preRun)for("function"==typeof n.preRun&&(n.preRun=[n.preRun]);n.preRun.length;)t=n.preRun.shift(),T.unshift(t);var t;P(T)}(),D>0||(n.setStatus?(n.setStatus("Running..."),setTimeout((function(){setTimeout((function(){n.setStatus("")}),1),e()}),1)):e()))}function at(t){throw n.onAbort&&n.onAbort(t),a(t+=""),u(t),h=!0,"abort("+t+"). Build with -s ASSERTIONS=1 for more info."}if(k=function t(){Q||st(),Q||(k=t)},n.run=st,n.abort=at,n.preInit)for("function"==typeof n.preInit&&(n.preInit=[n.preInit]);n.preInit.length>0;)n.preInit.pop()();return st(),t}("object"==typeof r?r:{}),i="number",o={};[["sizeOfH3Index",i],["sizeOfGeoCoord",i],["sizeOfGeoBoundary",i],["sizeOfGeoPolygon",i],["sizeOfGeofence",i],["sizeOfLinkedGeoPolygon",i],["sizeOfCoordIJ",i],["h3IsValid",i,[i,i]],["geoToH3",i,[i,i,i]],["h3ToGeo",null,[i,i,i]],["h3ToGeoBoundary",null,[i,i,i]],["maxKringSize",i,[i]],["kRing",null,[i,i,i,i]],["kRingDistances",null,[i,i,i,i,i]],["hexRing",null,[i,i,i,i]],["maxPolyfillSize",i,[i,i]],["polyfill",null,[i,i,i]],["h3SetToLinkedGeo",null,[i,i,i]],["destroyLinkedPolygon",null,[i]],["compact",i,[i,i,i]],["uncompact",i,[i,i,i,i,i]],["maxUncompactSize",i,[i,i,i]],["h3IsPentagon",i,[i,i]],["h3IsResClassIII",i,[i,i]],["h3GetBaseCell",i,[i,i]],["h3GetResolution",i,[i,i]],["maxFaceCount",i,[i,i]],["h3GetFaces",null,[i,i,i]],["h3ToParent",i,[i,i,i]],["h3ToChildren",null,[i,i,i,i]],["h3ToCenterChild",i,[i,i,i]],["maxH3ToChildrenSize",i,[i,i,i]],["h3IndexesAreNeighbors",i,[i,i,i,i]],["getH3UnidirectionalEdge",i,[i,i,i,i]],["getOriginH3IndexFromUnidirectionalEdge",i,[i,i]],["getDestinationH3IndexFromUnidirectionalEdge",i,[i,i]],["h3UnidirectionalEdgeIsValid",i,[i,i]],["getH3IndexesFromUnidirectionalEdge",null,[i,i,i]],["getH3UnidirectionalEdgesFromHexagon",null,[i,i,i]],["getH3UnidirectionalEdgeBoundary",null,[i,i,i]],["h3Distance",i,[i,i,i,i]],["h3Line",i,[i,i,i,i,i]],["h3LineSize",i,[i,i,i,i]],["experimentalH3ToLocalIj",i,[i,i,i,i,i]],["experimentalLocalIjToH3",i,[i,i,i,i]],["hexAreaM2",i,[i]],["hexAreaKm2",i,[i]],["edgeLengthM",i,[i]],["edgeLengthKm",i,[i]],["pointDistM",i,[i,i]],["pointDistKm",i,[i,i]],["pointDistRads",i,[i,i]],["cellAreaM2",i,[i,i]],["cellAreaKm2",i,[i,i]],["cellAreaRads2",i,[i,i]],["exactEdgeLengthM",i,[i,i]],["exactEdgeLengthKm",i,[i,i]],["exactEdgeLengthRads",i,[i,i]],["numHexagons",i,[i]],["getRes0Indexes",null,[i]],["res0IndexCount",i],["getPentagonIndexes",null,[i,i]],["pentagonIndexCount",i]].forEach((function(t){o[t[0]]=r.cwrap.apply(r,t)}));var s=16,a=o.sizeOfH3Index(),u=o.sizeOfGeoCoord(),c=o.sizeOfGeoBoundary(),l=o.sizeOfGeoPolygon(),h=o.sizeOfGeofence(),A=o.sizeOfLinkedGeoPolygon(),f=o.sizeOfCoordIJ(),p={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function d(t){if("number"!=typeof t||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var g=/[^0-9a-fA-F]/;function y(t){if(Array.isArray(t)&&2===t.length&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if("string"!=typeof t||g.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),s);return[parseInt(t.substring(t.length-8),s),e]}function m(t){if(t>=0)return t.toString(s);var e=v(8,(t&=2147483647).toString(s));return(parseInt(e[0],s)+8).toString(s)+e.substring(1)}function _(t,e){return m(e)+v(8,m(t))}function v(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r+e}function b(t,e,n){for(var i=t.length,o=r._calloc(i,u),s=n?1:0,a=n?0:1,c=0;c<2*i;c+=2)r.HEAPF64.set([t[c/2][s],t[c/2][a]].map(mt),o/8+c);return r.HEAPU32.set([i,o],e/4),e}function w(t){return[t,r.getTempRet0()]}function E(t){var e=w(t),n=e[0],r=e[1];return r?_(n,r):null}function x(t,e){void 0===e&&(e=0);var n=r.getValue(t+4*e*2,"i32"),i=r.getValue(t+4*(2*e+1),"i32");return i?_(n,i):null}function S(t,e,n){r.HEAPU32.set(y(t),e/4+2*n)}function P(t,e){for(var n=[],r=0;r<e;r++){var i=x(t,r);null!==i&&n.push(i)}return n}function T(t,e){for(var n=e.length,r=0;r<n;r++)S(e[r],t,r)}function C(t,e){var n=r._calloc(1,u);return r.HEAPF64.set([t,e].map(mt),n/8),n}function M(t){return _t(r.getValue(t,"double"))}function I(t){return[M(t),M(t+8)]}function O(t){return[M(t+8),M(t)]}function R(t,e,n){for(var i=r.getValue(t,"i32"),o=t+8,s=[],a=e?O:I,u=0;u<2*i;u+=2)s.push(a(o+8*u));return n&&s.push(s[0]),s}function L(t){var e=y(t),n=e[0],r=e[1];return Boolean(o.h3IsValid(n,r))}function N(t){var e=y(t),n=e[0],r=e[1];return Boolean(o.h3IsPentagon(n,r))}function D(t){var e=y(t),n=e[0],r=e[1];return Boolean(o.h3IsResClassIII(n,r))}function F(t){var e=y(t),n=e[0],r=e[1];return o.h3GetBaseCell(n,r)}function k(t){var e=y(t),n=e[0],i=e[1],s=o.maxFaceCount(n,i),a=r._malloc(4*s);o.h3GetFaces(n,i,a);var u=function(t,e){for(var n=[],i=0;i<e;i++){var o=r.getValue(t+4*i,"i32");o>=0&&n.push(o)}return n}(a,s);return r._free(a),u}function B(t){var e=y(t),n=e[0],r=e[1];return o.h3IsValid(n,r)?o.h3GetResolution(n,r):-1}function j(t,e,n){var i=r._malloc(u);r.HEAPF64.set([t,e].map(mt),i/8);var s=E(o.geoToH3(i,n));return r._free(i),s}function U(t){var e=r._malloc(u),n=y(t),i=n[0],s=n[1];o.h3ToGeo(i,s,e);var a=I(e);return r._free(e),a}function z(t,e){var n=r._malloc(c),i=y(t),s=i[0],a=i[1];o.h3ToGeoBoundary(s,a,n);var u=R(n,e,e);return r._free(n),u}function G(t,e){var n=y(t),r=n[0],i=n[1];return E(o.h3ToParent(r,i,e))}function V(t,e){if(!L(t))return[];var n=y(t),i=n[0],s=n[1],u=o.maxH3ToChildrenSize(i,s,e),c=r._calloc(u,a);o.h3ToChildren(i,s,e,c);var l=P(c,u);return r._free(c),l}function Z(t,e){var n=y(t),r=n[0],i=n[1];return E(o.h3ToCenterChild(r,i,e))}function H(t,e){var n=y(t),i=n[0],s=n[1],u=o.maxKringSize(e),c=r._calloc(u,a);o.kRing(i,s,e,c);var l=P(c,u);return r._free(c),l}function q(t,e){var n=y(t),i=n[0],s=n[1],u=o.maxKringSize(e),c=r._calloc(u,a),l=r._calloc(u,4);o.kRingDistances(i,s,e,c,l);for(var h=[],A=0;A<e+1;A++)h.push([]);for(var f=0;f<2*u;f+=2){var p=r.getValue(c+4*f,"i32"),d=r.getValue(c+4*(f+1),"i32"),g=r.getValue(l+f/2*4,"i32");0===p&&0===d||h[g].push(_(p,d))}return r._free(c),r._free(l),h}function W(t,e){var n=0===e?1:6*e,i=r._calloc(n,a);if(0!==o.hexRing.apply(o,y(t).concat([e],[i])))throw r._free(i),new Error("Failed to get hexRing (encountered a pentagon?)");var s=P(i,n);return r._free(i),s}function X(t,e,n){if(d(e),n=Boolean(n),0===t.length||0===t[0].length)return[];"number"==typeof t[0][0]&&(t=[t]);var i=function(t,e){var n,i=t.length-1,o=r._calloc(l),s=0+h,a=s+4;if(b(t[0],o+0,e),i>0){n=r._calloc(i,h);for(var u=0;u<i;u++)b(t[u+1],n+h*u,e)}return r.setValue(o+s,i,"i32"),r.setValue(o+a,n,"i32"),o}(t,n),s=o.maxPolyfillSize(i,e),u=r._calloc(s,a);o.polyfill(i,e,u);var c=P(u,s);return r._free(u),function(t){var e=0+h,n=e+4;r._free(r.getValue(t+0+4,"i8*"));var i=r.getValue(t+e,"i32");if(i>0){for(var o=r.getValue(t+n,"i32"),s=0;s<i;s++)r._free(r.getValue(o+h*s+4,"i8*"));r._free(o)}r._free(t)}(i),c}function Y(t,e){if(!t||!t.length)return[];var n=t.length,i=r._calloc(n,a);T(i,t);var s=r._calloc(A),u=s;o.h3SetToLinkedGeo(i,n,s);var c=function(t,e){for(var n,i,o,s,a=[],u=e?O:I;t;){for(a.push(n=[]),i=r.getValue(t,"i8*");i;){for(n.push(o=[]),s=r.getValue(i,"i8*");s;)o.push(u(s)),s=r.getValue(s+16,"i8*");e&&o.push(o[0]),i=r.getValue(i+8,"i8*")}t=r.getValue(t+8,"i8*")}return a}(s,e);return o.destroyLinkedPolygon(u),r._free(u),r._free(i),c}function Q(t){if(!t||!t.length)return[];var e=t.length,n=r._calloc(e,a);T(n,t);var i=r._calloc(e,a);if(0!==o.compact(n,i,e))throw r._free(n),r._free(i),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var s=P(i,e);return r._free(n),r._free(i),s}function K(t,e){if(d(e),!t||!t.length)return[];var n=t.length,i=r._calloc(n,a);T(i,t);var s=o.maxUncompactSize(i,n,e),u=r._calloc(s,a);if(0!==o.uncompact(i,n,u,s,e))throw r._free(i),r._free(u),new Error("Failed to uncompact (bad resolution?)");var c=P(u,s);return r._free(i),r._free(u),c}function J(t,e){var n=y(t),r=n[0],i=n[1],s=y(e),a=s[0],u=s[1];return Boolean(o.h3IndexesAreNeighbors(r,i,a,u))}function $(t,e){var n=y(t),r=n[0],i=n[1],s=y(e),a=s[0],u=s[1];return E(o.getH3UnidirectionalEdge(r,i,a,u))}function tt(t){var e=y(t),n=e[0],r=e[1];return E(o.getOriginH3IndexFromUnidirectionalEdge(n,r))}function et(t){var e=y(t),n=e[0],r=e[1];return E(o.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function nt(t){var e=y(t),n=e[0],r=e[1];return Boolean(o.h3UnidirectionalEdgeIsValid(n,r))}function rt(t){var e=y(t),n=e[0],i=e[1],s=r._calloc(2,a);o.getH3IndexesFromUnidirectionalEdge(n,i,s);var u=P(s,2);return r._free(s),u}function it(t){var e=y(t),n=e[0],i=e[1],s=r._calloc(6,a);o.getH3UnidirectionalEdgesFromHexagon(n,i,s);var u=P(s,6);return r._free(s),u}function ot(t,e){var n=r._malloc(c),i=y(t),s=i[0],a=i[1];o.getH3UnidirectionalEdgeBoundary(s,a,n);var u=R(n,e);return r._free(n),u}function st(t,e){var n=y(t),r=n[0],i=n[1],s=y(e),a=s[0],u=s[1];return o.h3Distance(r,i,a,u)}function at(t,e){var n=y(t),i=n[0],s=n[1],u=y(e),c=u[0],l=u[1],h=o.h3LineSize(i,s,c,l);if(h<0)throw new Error("Line cannot be calculated");var A=r._calloc(h,a);o.h3Line(i,s,c,l,A);var f=P(A,h);return r._free(A),f}function ut(t,e){var n,i=r._malloc(f),s=o.experimentalH3ToLocalIj.apply(o,y(t).concat(y(e),[i])),a=(n=i,{i:r.getValue(n,"i32"),j:r.getValue(n+4,"i32")});switch(r._free(i),s){case 0:return a;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function ct(t,e){if(!e||"number"!=typeof e.i||"number"!=typeof e.j)throw new Error("Coordinates must be provided as an {i, j} object");var n,i,s,u,c=r._malloc(f),l=r._malloc(a);n=c,s=(i=e).i,u=i.j,r.setValue(n,s,"i32"),r.setValue(n+4,u,"i32");var h=o.experimentalLocalIjToH3.apply(o,y(t).concat([c],[l])),A=x(l);if(r._free(c),r._free(l),0!==h)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return A}function lt(t,e,n){var i,s=C(t[0],t[1]),a=C(e[0],e[1]);switch(n){case p.m:i=o.pointDistM(s,a);break;case p.km:i=o.pointDistKm(s,a);break;case p.rads:i=o.pointDistRads(s,a);break;default:i=null}if(r._free(s),r._free(a),null===i)throw new Error("Unknown unit: "+n);return i}function ht(t,e){var n=y(t),r=n[0],i=n[1];switch(e){case p.m2:return o.cellAreaM2(r,i);case p.km2:return o.cellAreaKm2(r,i);case p.rads2:return o.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function At(t,e){var n=y(t),r=n[0],i=n[1];switch(e){case p.m:return o.exactEdgeLengthM(r,i);case p.km:return o.exactEdgeLengthKm(r,i);case p.rads:return o.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function ft(t,e){switch(d(t),e){case p.m2:return o.hexAreaM2(t);case p.km2:return o.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function pt(t,e){switch(d(t),e){case p.m:return o.edgeLengthM(t);case p.km:return o.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function dt(t){d(t);var e=w(o.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function gt(){var t=o.res0IndexCount(),e=r._malloc(a*t);o.getRes0Indexes(e);var n=P(e,t);return r._free(e),n}function yt(t){d(t);var e=o.pentagonIndexCount(),n=r._malloc(a*e);o.getPentagonIndexes(t,n);var i=P(n,e);return r._free(n),i}function mt(t){return t*Math.PI/180}function _t(t){return 180*t/Math.PI}},840:(t,e,n)=>{var r;!function(i,o,s,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),h=Math.round,A=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(b(t,n),e)}function d(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var m=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),_=y((function(t,e){return m(t,e,!0)}),"merge","Use `assign`.");function v(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function b(t,e){return function(){return t.apply(e,arguments)}}function w(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function E(t,e){return t===a?e:t}function x(t,e,n){g(C(e),(function(e){t.addEventListener(e,n,!1)}))}function S(t,e,n){g(C(e),(function(e){t.removeEventListener(e,n,!1)}))}function P(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function T(t,e){return t.indexOf(e)>-1}function C(t){return t.trim().split(/\s+/g)}function M(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function I(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];M(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function R(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}return a}var L=1;function N(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var D="ontouchstart"in i,F=R(i,"PointerEvent")!==a,k=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",j="mouse",U=["x","y"],z=["clientX","clientY"];function G(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){w(t.options.enable,[t])&&n.handler(e)},this.init()}function V(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,s=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=Z(e)),i>1&&!n.firstMultiple?n.firstMultiple=Z(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,u=s?s.center:o.center,c=e.center=H(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=Y(u,c),e.distance=X(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=W(e.deltaX,e.deltaY);var l,h,p=q(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=A(p.x)>A(p.y)?p.x:p.y,e.scale=s?(l=s.pointers,X((h=r)[0],h[1],z)/X(l[0],l[1],z)):1,e.rotation=s?function(t,e){return Y(e[1],e[0],z)+Y(t[1],t[0],z)}(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===a)){var c=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,h=q(u,c,l);r=h.x,i=h.y,n=A(h.x)>A(h.y)?h.x:h.y,o=W(c,l),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var d=t.element;P(e.srcEvent.target,d)&&(d=e.srcEvent.target),e.target=d}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function Z(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:H(e),deltaX:t.deltaX,deltaY:t.deltaY}}function H(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function q(t,e,n){return{x:e/t||0,y:n/t||0}}function W(t,e){return t===e?1:A(t)>=A(e)?t<0?2:4:e<0?8:16}function X(t,e,n){n||(n=U);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function Y(t,e,n){n||(n=U);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}G.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(N(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(N(this.element),this.evWin,this.domHandler)}};var Q={mousedown:1,mousemove:2,mouseup:4},K="mousedown",J="mousemove mouseup";function $(){this.evEl=K,this.evWin=J,this.pressed=!1,G.apply(this,arguments)}v($,G,{handler:function(t){var e=Q[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:j,srcEvent:t}))}});var tt={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},et={2:B,3:"pen",4:j,5:"kinect"},nt="pointerdown",rt="pointermove pointerup pointercancel";function it(){this.evEl=nt,this.evWin=rt,G.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(nt="MSPointerDown",rt="MSPointerMove MSPointerUp MSPointerCancel"),v(it,G,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=tt[r],o=et[t.pointerType]||t.pointerType,s=o==B,a=M(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&i&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var ot={touchstart:1,touchmove:2,touchend:4,touchcancel:8},st="touchstart",at="touchstart touchmove touchend touchcancel";function ut(){this.evTarget=st,this.evWin=at,this.started=!1,G.apply(this,arguments)}function ct(t,e){var n=I(t.touches),r=I(t.changedTouches);return 12&e&&(n=O(n.concat(r),"identifier",!0)),[n,r]}v(ut,G,{handler:function(t){var e=ot[t.type];if(1===e&&(this.started=!0),this.started){var n=ct.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}});var lt={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function At(){this.evTarget=ht,this.targetIds={},G.apply(this,arguments)}function ft(t,e){var n=I(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=I(t.changedTouches),a=[],u=this.target;if(o=n.filter((function(t){return P(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}function pt(){G.apply(this,arguments);var t=b(this.handler,this);this.touch=new At(this.manager,t),this.mouse=new $(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function dt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,gt.call(this,e)):12&t&&gt.call(this,e)}function gt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function yt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}v(At,G,{handler:function(t){var e=lt[t.type],n=ft.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}),v(pt,G,{handler:function(t,e,n){var r=n.pointerType==B,i=n.pointerType==j;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)dt.call(this,e,n);else if(i&&yt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var mt=R(l.style,"touchAction"),_t=mt!==a,vt="compute",bt="auto",wt="manipulation",Et="none",xt="pan-x",St="pan-y",Pt=function(){if(!_t)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function Tt(t,e){this.manager=t,this.set(e)}Tt.prototype={set:function(t){t==vt&&(t=this.compute()),_t&&this.manager.element.style&&Pt[t]&&(this.manager.element.style[mt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){w(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(T(t,Et))return Et;var e=T(t,xt),n=T(t,St);return e&&n?Et:e||n?e?xt:St:T(t,wt)?wt:bt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=T(r,Et)&&!Pt.none,o=T(r,St)&&!Pt["pan-y"],s=T(r,xt)&&!Pt["pan-x"];if(i){var a=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(a&&u&&c)return}if(!s||!o)return i||o&&6&n||s&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Ct=32;function Mt(t){this.options=u({},this.defaults,t||{}),this.id=L++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function It(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Ot(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Rt(t,e){var n=e.manager;return n?n.get(t):t}function Lt(){Mt.apply(this,arguments)}function Nt(){Lt.apply(this,arguments),this.pX=null,this.pY=null}function Dt(){Lt.apply(this,arguments)}function Ft(){Mt.apply(this,arguments),this._timer=null,this._input=null}function kt(){Lt.apply(this,arguments)}function Bt(){Lt.apply(this,arguments)}function jt(){Mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ut(t,e){return(e=e||{}).recognizers=E(e.recognizers,Ut.defaults.preset),new zt(t,e)}function zt(t,e){this.options=u({},Ut.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(F?it:k?At:D?pt:$))(this,V),this.touchAction=new Tt(this,this.options.touchAction),Gt(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Gt(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,o){n=R(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Mt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(d(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Rt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return d(t,"dropRecognizeWith",this)||(t=Rt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(d(t,"requireFailure",this))return this;var e=this.requireFail;return-1===M(e,t=Rt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(d(t,"dropRequireFailure",this))return this;t=Rt(t,this);var e=M(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+It(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+It(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Ct},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!w(this.options.enable,[this,e]))return this.reset(),void(this.state=Ct);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},v(Lt,Mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Ct}}),v(Nt,Lt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(St),24&t&&e.push(xt),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return Lt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ot(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),v(Dt,Lt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Et]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),v(Ft,Mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[bt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Ct},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),v(kt,Lt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Et]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),v(Bt,Lt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Nt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&A(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Ot(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),v(jt,Mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[wt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||X(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Ct},failTimeout:function(){return this._timer=p((function(){this.state=Ct}),this.options.interval,this),Ct},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ut.VERSION="2.0.7",Ut.defaults={domEvents:!1,touchAction:vt,enable:!0,inputTarget:null,inputClass:null,preset:[[kt,{enable:!1}],[Dt,{enable:!1},["rotate"]],[Bt,{direction:6}],[Nt,{direction:6},["swipe"]],[jt],[jt,{event:"doubletap",taps:2},["tap"]],[Ft]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},zt.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof Mt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(d(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(d(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=M(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return g(C(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return g(C(t),(function(t){e?n[t]&&n[t].splice(M(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Gt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Ut,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ct,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:zt,Input:G,TouchAction:Tt,TouchInput:At,MouseInput:$,PointerEventInput:it,TouchMouseInput:pt,SingleTouchInput:ut,Recognizer:Mt,AttrRecognizer:Lt,Tap:jt,Pan:Nt,Swipe:Bt,Pinch:Dt,Rotate:kt,Press:Ft,on:x,off:S,each:g,merge:_,extend:m,assign:u,inherit:v,bindFn:b,prefixed:R}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Ut,(r=function(){return Ut}.call(e,n,e,t))===a||(t.exports=r)}(window,document)},645:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,A=n?-1:1,f=t[e+h];for(h+=A,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=A,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=A,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=c}return(f?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,A=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?A/u:A*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+f]=255&s,f+=p,s/=256,c-=8);t[n+f-p]|=128*d}},3096:(t,e,n)=>{var r="Expected a function",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,h=c||l||Function("return this")(),A=Object.prototype.toString,f=Math.max,p=Math.min,d=function(){return h.Date.now()};function g(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==A.call(t)}(t))return NaN;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var n=s.test(t);return n||a.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}t.exports=function(t,e,n){var i=!0,o=!0;if("function"!=typeof t)throw new TypeError(r);return g(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),function(t,e,n){var i,o,s,a,u,c,l=0,h=!1,A=!1,m=!0;if("function"!=typeof t)throw new TypeError(r);function _(e){var n=i,r=o;return i=o=void 0,l=e,a=t.apply(r,n)}function v(t){return l=t,u=setTimeout(w,e),h?_(t):a}function b(t){var n=t-c;return void 0===c||n>=e||n<0||A&&t-l>=s}function w(){var t=d();if(b(t))return E(t);u=setTimeout(w,function(t){var n=e-(t-c);return A?p(n,s-(t-l)):n}(t))}function E(t){return u=void 0,m&&i?_(t):(i=o=void 0,a)}function x(){var t=d(),n=b(t);if(i=arguments,o=this,c=t,n){if(void 0===u)return v(c);if(A)return u=setTimeout(w,e),_(c)}return void 0===u&&(u=setTimeout(w,e)),a}return e=y(e)||0,g(n)&&(h=!!n.leading,s=(A="maxWait"in n)?f(y(n.maxWait)||0,e):s,m="trailing"in n?!!n.trailing:m),x.cancel=function(){void 0!==u&&clearTimeout(u),l=0,i=c=o=u=void 0},x.flush=function(){return void 0===u?a:E(d())},x}(t,e,{leading:i,maxWait:e,trailing:o})}},514:function(t,e){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function t(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function e(t){return!0===(t&&t.__isLong__)}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var n={},r={};function i(t,e){var i,o,a;return e?(a=0<=(t>>>=0)&&t<256)&&(o=r[t])?o:(i=s(t,(0|t)<0?-1:0,!0),a&&(r[t]=i),i):(a=-128<=(t|=0)&&t<128)&&(o=n[t])?o:(i=s(t,t<0?-1:0,!1),a&&(n[t]=i),i)}function o(t,e){if(isNaN(t)||!isFinite(t))return e?d:p;if(e){if(t<0)return d;if(t>=h)return v}else{if(t<=-A)return b;if(t+1>=A)return _}return t<0?o(-t,e).neg():s(t%l|0,t/l|0,e)}function s(e,n,r){return new t(e,n,r)}t.fromInt=i,t.fromNumber=o,t.fromBits=s;var a=Math.pow;function u(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return p;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return u(t.substring(1),e,n).neg();for(var i=o(a(n,8)),s=p,c=0;c<t.length;c+=8){var l=Math.min(8,t.length-c),h=parseInt(t.substring(c,c+l),n);if(l<8){var A=o(a(n,l));s=s.mul(A).add(o(h))}else s=(s=s.mul(i)).add(o(h))}return s.unsigned=e,s}function c(e){return e instanceof t?e:"number"==typeof e?o(e):"string"==typeof e?u(e):s(e.low,e.high,e.unsigned)}t.fromString=u,t.fromValue=c;var l=4294967296,h=l*l,A=h/2,f=i(1<<24),p=i(0);t.ZERO=p;var d=i(0,!0);t.UZERO=d;var g=i(1);t.ONE=g;var y=i(1,!0);t.UONE=y;var m=i(-1);t.NEG_ONE=m;var _=s(-1,2147483647,!1);t.MAX_VALUE=_;var v=s(-1,-1,!0);t.MAX_UNSIGNED_VALUE=v;var b=s(0,-2147483648,!1);t.MIN_VALUE=b;var w=t.prototype;return w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(b)){var e=o(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=o(a(t,6),this.unsigned),s=this,u="";;){var c=s.div(i),l=(s.sub(c.mul(i)).toInt()>>>0).toString(t);if((s=c).isZero())return l+u;for(;l.length<6;)l="0"+l;u=""+l+u}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(b)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return e(t)||(t=c(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.compare=function(t){if(e(t)||(t=c(t)),this.eq(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(b)?b:this.not().add(g)},w.neg=w.negate,w.add=function(t){e(t)||(t=c(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,u=65535&t.high,l=t.low>>>16,h=0,A=0,f=0,p=0;return f+=(p+=o+(65535&t.low))>>>16,A+=(f+=i+l)>>>16,h+=(A+=r+u)>>>16,h+=n+a,s((f&=65535)<<16|(p&=65535),(h&=65535)<<16|(A&=65535),this.unsigned)},w.subtract=function(t){return e(t)||(t=c(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return p;if(e(t)||(t=c(t)),t.isZero())return p;if(this.eq(b))return t.isOdd()?b:p;if(t.eq(b))return this.isOdd()?b:p;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(f)&&t.lt(f))return o(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,u=t.high>>>16,l=65535&t.high,h=t.low>>>16,A=65535&t.low,d=0,g=0,y=0,m=0;return y+=(m+=a*A)>>>16,g+=(y+=i*A)>>>16,y&=65535,g+=(y+=a*h)>>>16,d+=(g+=r*A)>>>16,g&=65535,d+=(g+=i*h)>>>16,g&=65535,d+=(g+=a*l)>>>16,d+=n*A+r*h+i*l+a*u,s((y&=65535)<<16|(m&=65535),(d&=65535)<<16|(g&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(e(t)||(t=c(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?d:p;var n,r,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return d;if(t.gt(this.shru(1)))return y;i=d}else{if(this.eq(b))return t.eq(g)||t.eq(m)?b:t.eq(b)?g:(n=this.shr(1).div(t).shl(1)).eq(p)?t.isNegative()?g:m:(r=this.sub(t.mul(n)),i=n.add(r.div(t)));if(t.eq(b))return this.unsigned?d:p;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=p}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),u=s<=48?1:a(2,s-48),l=o(n),h=l.mul(t);h.isNegative()||h.gt(r);)h=(l=o(n-=u,this.unsigned)).mul(t);l.isZero()&&(l=g),i=i.add(l),r=r.sub(h)}return i},w.div=w.divide,w.modulo=function(t){return e(t)||(t=c(t)),this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.not=function(){return s(~this.low,~this.high,this.unsigned)},w.and=function(t){return e(t)||(t=c(t)),s(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return e(t)||(t=c(t)),s(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return e(t)||(t=c(t)),s(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):s(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?s(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):s(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0==(t&=63))return this;var n=this.high;return t<32?s(this.low>>>t|n<<32-t,n>>>t,this.unsigned):s(32===t?n:n>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t})?n.apply(e,[]):n)||(t.exports=r)},9811:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Euler:()=>v,Matrix3:()=>A.Z,Matrix4:()=>f.Z,Pose:()=>b,Quaternion:()=>p.Z,SphericalCoordinates:()=>g.Z,Vector2:()=>i.Z,Vector3:()=>o.Z,Vector4:()=>h,_Euler:()=>v,_MathUtils:()=>d.Z,_Pose:()=>b,_SphericalCoordinates:()=>g.Z,acos:()=>r.Kh,asin:()=>r.ZR,assert:()=>w.Z,atan:()=>r.z4,checkNumber:()=>a.u5,clamp:()=>r.uZ,clone:()=>r.d9,config:()=>r.vc,configure:()=>r.jQ,cos:()=>r.mC,degrees:()=>r.RW,equals:()=>r.fS,exactEquals:()=>r.I6,formatValue:()=>r.Bw,isArray:()=>r.kJ,lerp:()=>r.t7,radians:()=>r.uR,sin:()=>r.O$,tan:()=>r.OR,toDegrees:()=>r.Ux,toRadians:()=>r.Yr,withEpsilon:()=>r.BJ});var r=n(4034),i=n(7069),o=n(3855),s=n(9521),a=n(6281),u=n(7160),c=n(1031);const l={};class h extends s.Z{static get ZERO(){return l.ZERO=l.ZERO||Object.freeze(new h(0,0,0,0))}constructor(t=0,e=0,n=0,i=0){super(-0,-0,-0,-0),(0,r.kJ)(t)&&1===arguments.length?this.copy(t):(r.vc.debug&&((0,a.u5)(t),(0,a.u5)(e),(0,a.u5)(n),(0,a.u5)(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return r.vc.debug&&((0,a.u5)(t.x),(0,a.u5)(t.y),(0,a.u5)(t.z),(0,a.u5)(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=(0,a.u5)(t)}get w(){return this[3]}set w(t){this[3]=(0,a.u5)(t)}transform(t){return u.fF(this,this,t),this.check()}transformByMatrix3(t){return(0,c._x)(this,this,t),this.check()}transformByMatrix2(t){return(0,c.G7)(this,this,t),this.check()}transformByQuaternion(t){return u.VC(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}var A=n(540),f=n(5451),p=n(4782),d=n(9057),g=n(7858),y=n(6357);const m="Unknown Euler angle order",_=.99999;class v extends y.Z{static get ZYX(){return 0}static get YXZ(){return 1}static get XZY(){return 2}static get ZXY(){return 3}static get YZX(){return 4}static get XYZ(){return 5}static get RollPitchYaw(){return 0}static get DefaultOrder(){return v.ZYX}static get RotationOrders(){return["ZYX","YXZ","XZY","ZXY","YZX","XYZ"]}static rotationOrder(t){return v.RotationOrders[t]}get ELEMENTS(){return 4}constructor(t=0,e=0,n=0,r=v.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,e,n,r)}fromQuaternion(t){const[e,n,r,i]=t,o=n*n,s=-2*(o+r*r)+1,a=2*(e*n+i*r);let u=-2*(e*r-i*n);const c=2*(n*r+i*e),l=-2*(e*e+o)+1;u=u>1?1:u,u=u<-1?-1:u;const h=Math.atan2(c,l),A=Math.asin(u),f=Math.atan2(a,s);return new v(h,A,f,v.RollPitchYaw)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,e=0,n=0,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=Number.isFinite(r)?r:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}toArray4(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t[e+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=(0,a.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,a.u5)(t)}get z(){return this[2]}set z(t){this[2]=(0,a.u5)(t)}get alpha(){return this[0]}set alpha(t){this[0]=(0,a.u5)(t)}get beta(){return this[1]}set beta(t){this[1]=(0,a.u5)(t)}get gamma(){return this[2]}set gamma(t){this[2]=(0,a.u5)(t)}get phi(){return this[0]}set phi(t){this[0]=(0,a.u5)(t)}get theta(){return this[1]}set theta(t){this[1]=(0,a.u5)(t)}get psi(){return this[2]}set psi(t){this[2]=(0,a.u5)(t)}get roll(){return this[0]}set roll(t){this[0]=(0,a.u5)(t)}get pitch(){return this[1]}set pitch(t){this[1]=(0,a.u5)(t)}get yaw(){return this[2]}set yaw(t){this[2]=(0,a.u5)(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(m);return t}(t)}fromVector3(t,e){return this.set(t[0],t[1],t[2],Number.isFinite(e)?e:this[3])}fromArray(t,e=0){return this[0]=t[0+e],this[1]=t[1+e],this[2]=t[2+e],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,e,n){return this.set(t,e,n,v.ZYX)}fromRotationMatrix(t,e=v.DefaultOrder){return this._fromRotationMatrix(t,e),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new p.Z;switch(this[4]){case v.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case v.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case v.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case v.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case v.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case v.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(m)}}_fromRotationMatrix(t,e=v.DefaultOrder){const n=t.elements,i=n[0],o=n[4],s=n[8],a=n[1],u=n[5],c=n[9],l=n[2],h=n[6],A=n[10];switch(e=e||this[3]){case v.XYZ:this[1]=Math.asin((0,r.uZ)(s,-1,1)),Math.abs(s)<_?(this[0]=Math.atan2(-c,A),this[2]=Math.atan2(-o,i)):(this[0]=Math.atan2(h,u),this[2]=0);break;case v.YXZ:this[0]=Math.asin(-(0,r.uZ)(c,-1,1)),Math.abs(c)<_?(this[1]=Math.atan2(s,A),this[2]=Math.atan2(a,u)):(this[1]=Math.atan2(-l,i),this[2]=0);break;case v.ZXY:this[0]=Math.asin((0,r.uZ)(h,-1,1)),Math.abs(h)<_?(this[1]=Math.atan2(-l,A),this[2]=Math.atan2(-o,u)):(this[1]=0,this[2]=Math.atan2(a,i));break;case v.ZYX:this[1]=Math.asin(-(0,r.uZ)(l,-1,1)),Math.abs(l)<_?(this[0]=Math.atan2(h,A),this[2]=Math.atan2(a,i)):(this[0]=0,this[2]=Math.atan2(-o,u));break;case v.YZX:this[2]=Math.asin((0,r.uZ)(a,-1,1)),Math.abs(a)<_?(this[0]=Math.atan2(-c,u),this[1]=Math.atan2(-l,i)):(this[0]=0,this[1]=Math.atan2(s,A));break;case v.XZY:this[2]=Math.asin(-(0,r.uZ)(o,-1,1)),Math.abs(o)<_?(this[0]=Math.atan2(h,u),this[1]=Math.atan2(s,i)):(this[0]=Math.atan2(-c,A),this[1]=0);break;default:throw new Error(m)}return this[3]=e,this}_getRotationMatrix(t){const e=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,r=this.y,i=this.z,o=Math.cos(n),s=Math.cos(r),a=Math.cos(i),u=Math.sin(n),c=Math.sin(r),l=Math.sin(i);switch(this[3]){case v.XYZ:{const t=o*a,n=o*l,r=u*a,i=u*l;e[0]=s*a,e[4]=-s*l,e[8]=c,e[1]=n+r*c,e[5]=t-i*c,e[9]=-u*s,e[2]=i-t*c,e[6]=r+n*c,e[10]=o*s;break}case v.YXZ:{const t=s*a,n=s*l,r=c*a,i=c*l;e[0]=t+i*u,e[4]=r*u-n,e[8]=o*c,e[1]=o*l,e[5]=o*a,e[9]=-u,e[2]=n*u-r,e[6]=i+t*u,e[10]=o*s;break}case v.ZXY:{const t=s*a,n=s*l,r=c*a,i=c*l;e[0]=t-i*u,e[4]=-o*l,e[8]=r+n*u,e[1]=n+r*u,e[5]=o*a,e[9]=i-t*u,e[2]=-o*c,e[6]=u,e[10]=o*s;break}case v.ZYX:{const t=o*a,n=o*l,r=u*a,i=u*l;e[0]=s*a,e[4]=r*c-n,e[8]=t*c+i,e[1]=s*l,e[5]=i*c+t,e[9]=n*c-r,e[2]=-c,e[6]=u*s,e[10]=o*s;break}case v.YZX:{const t=o*s,n=o*c,r=u*s,i=u*c;e[0]=s*a,e[4]=i-t*l,e[8]=r*l+n,e[1]=l,e[5]=o*a,e[9]=-u*a,e[2]=-c*a,e[6]=n*l+r,e[10]=t-i*l;break}case v.XZY:{const t=o*s,n=o*c,r=u*s,i=u*c;e[0]=s*a,e[4]=-l,e[8]=c*a,e[1]=t*l+i,e[5]=o*a,e[9]=n*l-r,e[2]=r*l-n,e[6]=u*a,e[10]=i*l+t;break}default:throw new Error(m)}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}toQuaternion(){const t=Math.cos(.5*this.yaw),e=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),r=Math.sin(.5*this.roll),i=Math.cos(.5*this.pitch),o=Math.sin(.5*this.pitch),s=t*n*i+e*r*o,a=t*r*i-e*n*o,u=t*n*o+e*r*i,c=e*n*i-t*r*o;return new p.Z(a,u,c,s)}}class b{constructor({x:t=0,y:e=0,z:n=0,roll:r=0,pitch:i=0,yaw:s=0,position:a,orientation:u}={}){Array.isArray(a)&&3===a.length?this.position=new o.Z(a):this.position=new o.Z(t,e,n),Array.isArray(u)&&4===u.length?this.orientation=new v(u,u[3]):this.orientation=new v(r,i,s,v.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&this.position.equals(t.position)&&this.orientation.equals(t.orientation)}exactEquals(t){return!!t&&this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation)}getTransformationMatrix(){const t=Math.sin(this.roll),e=Math.sin(this.pitch),n=Math.sin(this.yaw),r=Math.cos(this.roll),i=Math.cos(this.pitch),o=Math.cos(this.yaw);return(new f.Z).setRowMajor(o*i,-n*r+o*e*t,n*t+o*e*r,this.x,n*i,o*r+n*e*t,-o*t+n*e*r,this.y,-e,i*t,i*r,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new f.Z).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new f.Z).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}var w=n(394);const E="undefined"!=typeof self&&self,x="undefined"!=typeof window&&window;(void 0!==n.g&&n.g||E||x).mathgl={config:r.vc}},3614:(t,e,n)=>{"use strict";t.exports=i;var r=n(645);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,s=1/o,a="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function u(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function c(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function l(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function h(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function A(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function f(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function _(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function v(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function b(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function w(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=v(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=w(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=v(this.buf,this.pos)+v(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=v(this.buf,this.pos)+w(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(r=(112&(i=o[n.pos++]))>>4,i<128)return c(t,r,e);if(r|=(127&(i=o[n.pos++]))<<3,i<128)return c(t,r,e);if(r|=(127&(i=o[n.pos++]))<<10,i<128)return c(t,r,e);if(r|=(127&(i=o[n.pos++]))<<17,i<128)return c(t,r,e);if(r|=(127&(i=o[n.pos++]))<<24,i<128)return c(t,r,e);if(r|=(1&(i=o[n.pos++]))<<31,i<128)return c(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,n){return a.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){for(var r="",i=e;i<n;){var o,s,a,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&((c=(15&u)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&((c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=u(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),b(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),b(this.buf,-1&t,this.pos),b(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=127&t)))))}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&l(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&l(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,A,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,_,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},2676:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}var r=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function i(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){for(var i=new r(null,null),o=i,s=i;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var u=e.left;if(e.left=u.right,u.right=e,null===(e=u).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(u=e.right,e.right=u.left,u.left=e,null===(e=u).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=i.right,e.right=i.left,e}function s(t,e,n,i){var s=new r(t,e);if(null===n)return s.left=s.right=null,s;var a=i(t,(n=o(t,n,i)).key);return a<0?(s.left=n.left,s.right=n,n.left=null):a>=0&&(s.right=n.right,s.left=n,n.right=null),s}function a(t,e,n){var r=null,i=null;if(e){var s=n((e=o(t,e,n)).key,t);0===s?(r=e.left,i=e.right):s<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function u(t,e,n,r,i){if(t){r(e+(n?" ":" ")+i(t)+"\n");var o=e+(n?"    ":"   ");t.left&&u(t.left,o,!1,r,i),t.right&&u(t.right,o,!0,r,i)}}var c=function(){function t(t){void 0===t&&(t=i),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new r(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,s=o(t,this._root,i),a=i(t,s.key);return 0===a?this._root=s:(a<0?(n.left=s.left,n.right=s,s.left=null):a>0&&(n.right=s.right,n.left=s,s.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var r;return null===e?null:0===n(t,(e=o(t,e,n)).key)?(null===e.left?r=e.right:(r=o(t,e.left,n)).right=e.right,this._size--,r):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return e;e=r<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var r=n(t,e.key);if(0===r)return!0;e=r<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,r=[],i=!1;!i;)null!==n?(r.push(n),n=n.left):0!==r.length?(n=r.pop(),t.call(e,n),n=n.right):i=!0;return this},t.prototype.range=function(t,e,n,r){for(var i=[],o=this._comparator,s=this._root;0!==i.length||s;)if(s)i.push(s),s=s.left;else{if(o((s=i.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(r,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,r=0,i=[];!n;)if(e)i.push(e),e=e.left;else if(i.length>0){if(e=i.pop(),r===t)return e;r++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var r=this._comparator;e;){var i=r(t.key,e.key);if(0===i)break;i<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,n=[],i=!1,o=new r(null,null),s=o;!i;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:i=!0;return s.next=null,o.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var i=t.length,o=this._comparator;if(n&&A(t,e,0,i-1,o),null===this._root)this._root=l(t,e,0,i),this._size=i;else{var s=function(t,e,n){for(var i=new r(null,null),o=i,s=t,a=e;null!==s&&null!==a;)n(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),i.next}(this.toList(),function(t,e){for(var n=new r(null,null),i=n,o=0;o<t.length;o++)i=i.next=new r(t[o],e[o]);return i.next=null,n.next}(t,e),o);i=this._size+i,this._root=h({head:s},0,i)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return u(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var r=this._comparator,i=a(t,this._root,r),u=i.left,c=i.right;r(t,e)<0?c=s(e,n,c,r):u=s(e,n,u,r),this._root=function(t,e,n){return null===e?t:(null===t||((e=o(t.key,e,n)).left=t),e)}(u,c,r)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function l(t,e,n,i){var o=i-n;if(o>0){var s=n+Math.floor(o/2),a=t[s],u=e[s],c=new r(a,u);return c.left=l(t,e,n,s),c.right=l(t,e,s+1,i),c}return null}function h(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=h(t,e,i),s=t.head;return s.left=o,t.head=t.head.next,s.right=h(t,i+1,n),s}return null}function A(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],s=n-1,a=r+1;;){do{s++}while(i(t[s],o)<0);do{a--}while(i(t[a],o)>0);if(s>=a)break;var u=t[s];t[s]=t[a],t[a]=u,u=e[s],e[s]=e[a],e[a]=u}A(t,e,n,a,i),A(t,e,a+1,r,i)}}var f=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},p=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,r=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:r,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},d=Number.EPSILON;void 0===d&&(d=Math.pow(2,-52));var g=d*d,y=function(t,e){if(-d<t&&t<d&&-d<e&&e<d)return 0;var n=t-e;return n*n<g*t*e?0:t<e?-1:1},m=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new _,this.yRounder=new _}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),_=function(){function e(){t(this,e),this.tree=new c,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===y(e.key,n.key))return this.tree.remove(t),n.key;var r=this.tree.next(e);return null!==r&&0===y(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),e}(),v=new m,b=function(t,e){return t.x*e.y-t.y*e.x},w=function(t,e){return t.x*e.x+t.y*e.y},E=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},o=b(r,i);return y(o,0)},x=function(t){return Math.sqrt(w(t,t))},S=function(t,e,n){var r={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return w(i,r)/x(i)/x(r)},P=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},T=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},C=function(){function e(n,r){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=r}return n(e,null,[{key:"compare",value:function(t,n){var r=e.comparePoints(t.point,n.point);return 0!==r?r:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:I.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,r=e.length;n<r;n++){var i=e[n];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var r=e+1;r<t;r++){var i=this.point.events[r];void 0===i.consumedBy&&n.otherSE.point.events===i.otherSE.point.events&&n.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var r=this.point.events[e];r!==this&&!r.segment.ringOut&&r.segment.isInResult()&&t.push(r)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,r=function(r){var i,o,s,a,u,c=r.otherSE;n.set(r,{sine:(i=e.point,o=t.point,s=c.point,a={x:o.x-i.x,y:o.y-i.y},u={x:s.x-i.x,y:s.y-i.y},b(u,a)/x(u)/x(a)),cosine:S(e.point,t.point,c.point)})};return function(t,e){n.has(t)||r(t),n.has(e)||r(e);var i=n.get(t),o=i.sine,s=i.cosine,a=n.get(e),u=a.sine,c=a.cosine;return o>=0&&u>=0?s<c?1:s>c?-1:0:o<0&&u<0?s<c?-1:s>c?1:0:u<o?-1:u>o?1:0}}}]),e}(),M=0,I=function(){function e(n,r,i,o){t(this,e),this.id=++M,this.leftSE=n,n.segment=this,n.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=n,this.rings=i,this.windings=o}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,r=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(i<r)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,u=t.rightSE.point.y,c=e.rightSE.point.y;if(n<r){if(a<s&&a<u)return 1;if(a>s&&a>u)return-1;var l=t.comparePoint(e.leftSE.point);if(l<0)return 1;if(l>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(n>r){if(s<a&&s<c)return-1;if(s>a&&s>c)return 1;var A=e.comparePoint(t.leftSE.point);if(0!==A)return A;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(i<o){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(i>o){var d=t.comparePoint(e.rightSE.point);if(d<0)return 1;if(d>0)return-1}if(i!==o){var g=u-s,y=i-n,m=c-a,_=o-r;if(g>y&&m<_)return 1;if(g<y&&m>_)return-1}return i>o?1:i<o||u<c?-1:u>c?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,r=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var i=(t.y-e.y)/r.y,o=e.x+i*r.x;if(t.x===o)return 0;var s=(t.x-e.x)/r.x,a=e.y+s*r.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),r=p(e,n);if(null===r)return null;var i=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,u=f(e,s)&&0===this.comparePoint(s),c=f(n,i)&&0===t.comparePoint(i),l=f(e,a)&&0===this.comparePoint(a),h=f(n,o)&&0===t.comparePoint(o);if(c&&u)return h&&!l?o:!h&&l?a:null;if(c)return l&&i.x===a.x&&i.y===a.y?null:i;if(u)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&l)return null;if(h)return o;if(l)return a;var A=function(t,e,n,r){if(0===e.x)return T(n,r,t.x);if(0===r.x)return T(t,e,n.x);if(0===e.y)return P(n,r,t.y);if(0===r.y)return P(t,e,n.y);var i=b(e,r);if(0==i)return null;var o={x:n.x-t.x,y:n.y-t.y},s=b(o,e)/i,a=b(o,r)/i;return{x:(t.x+a*e.x+(n.x+s*r.x))/2,y:(t.y+a*e.y+(n.y+s*r.y))/2}}(i,this.vector(),s,t.vector());return null===A?null:f(r,A)?v.round(A.x,A.y):null}},{key:"split",value:function(t){var n=[],r=void 0!==t.events,i=new C(t,!0),o=new C(t,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var a=new e(i,s,this.rings.slice(),this.windings.slice());return C.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),C.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,r=t;n.consumedBy;)n=n.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var i=e.compare(n,r);if(0!==i){if(i>0){var o=n;n=r,r=o}if(n.prev===r){var s=n;n=r,r=s}for(var a=0,u=r.rings.length;a<u;a++){var c=r.rings[a],l=r.windings[a],h=n.rings.indexOf(c);-1===h?(n.rings.push(c),n.windings.push(l)):n.windings[h]+=l}r.rings=null,r.windings=null,r.consumedBy=n,r.leftSE.consumedBy=n.leftSE,r.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,r=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var s=this.rings[i],a=this.windings[i],u=e.indexOf(s);-1===u?(e.push(s),n.push(a)):n[u]+=a}for(var c=[],l=[],h=0,A=e.length;h<A;h++)if(0!==n[h]){var f=e[h],p=f.poly;if(-1===l.indexOf(p))if(f.isExterior)c.push(p);else{-1===l.indexOf(p)&&l.push(p);var d=c.indexOf(f.poly);-1!==d&&c.splice(d,1)}}for(var g=0,y=c.length;g<y;g++){var m=c[g].multiPoly;-1===r.indexOf(m)&&r.push(m)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(U.type){case"union":var n=0===t.length,r=0===e.length;this._isInResult=n!==r;break;case"intersection":var i,o;t.length<e.length?(i=t.length,o=e.length):(i=e.length,o=t.length),this._isInResult=o===U.numMultiPolys&&i<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(U.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,r){var i,o,s,a=C.comparePoints(t,n);if(a<0)i=t,o=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));i=n,o=t,s=-1}return new e(new C(i,!0),new C(o,!1),[r],[s])}}]),e}(),O=function(){function e(n,r,i){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=i,this.segments=[],"number"!=typeof n[0][0]||"number"!=typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=v.round(n[0][0],n[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,u=n.length;a<u;a++){if("number"!=typeof n[a][0]||"number"!=typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var c=v.round(n[a][0],n[a][1]);c.x===s.x&&c.y===s.y||(this.segments.push(I.fromRing(s,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),s=c)}o.x===s.x&&o.y===s.y||this.segments.push(I.fromRing(s,o,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var r=this.segments[e];t.push(r.leftSE),t.push(r.rightSE)}return t}}]),e}(),R=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new O(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var i=1,o=n.length;i<o;i++){var s=new O(n[i],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var r=this.interiorRings[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),L=function(){function e(n,r){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof n[0][0][0]&&(n=[n])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var i=0,o=n.length;i<o;i++){var s=new R(n[i],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=r}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var r=this.polys[e].getSweepEvents(),i=0,o=r.length;i<o;i++)t.push(r[i]);return t}}]),e}(),N=function(){function e(n){t(this,e),this.events=n;for(var r=0,i=n.length;r<i;r++)n[r].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,u=o.rightSE,c=[a],l=a.point,h=[];s=a,a=u,c.push(a),a.point!==l;)for(;;){var A=a.getAvailableLinkedEvents();if(0===A.length){var f=c[0].point,p=c[c.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===A.length){u=A[0].otherSE;break}for(var d=null,g=0,y=h.length;g<y;g++)if(h[g].point===a.point){d=g;break}if(null===d){h.push({index:c.length,point:a.point});var m=a.getLeftmostComparator(s);u=A.sort(m)[0].otherSE;break}var _=h.splice(d)[0],v=c.splice(_.index);v.unshift(v[0].otherSE),n.push(new e(v.reverse()))}n.push(new e(c))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,r=this.events.length-1;n<r;n++){var i=this.events[n].point,o=this.events[n+1].point;0!==E(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var s=e[0],a=e[1];0===E(s,t,a)&&e.shift(),e.push(e[0]);for(var u=this.isExteriorRing()?1:-1,c=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,h=[],A=c;A!=l;A+=u)h.push([e[A].x,e[A].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var r=this.events[e];C.compare(t,r)>0&&(t=r)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();i=o.prevInResult(),o=i?i.prevInResult():null}}}]),e}(),D=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var r=this.interiorRings[e].getGeom();null!==r&&t.push(r)}return t}}]),e}(),F=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var r=this.polys[e].getGeom();null!==r&&t.push(r)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];if(!i.poly)if(i.isExteriorRing())e.push(new D(i));else{var o=i.enclosingRing();o.poly||e.push(new D(o)),o.poly.addInterior(i)}}return e}}]),e}(),k=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.compare;t(this,e),this.queue=n,this.tree=new c(r),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var r=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!r)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var i=r,o=r,s=void 0,a=void 0;void 0===s;)null===(i=this.tree.prev(i))?s=null:void 0===i.key.consumedBy&&(s=i.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var u=null;if(s){var c=s.getIntersection(e);if(null!==c&&(e.isAnEndpoint(c)||(u=c),!s.isAnEndpoint(c)))for(var l=this._splitSafely(s,c),h=0,A=l.length;h<A;h++)n.push(l[h])}var f=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(f=p),!a.isAnEndpoint(p)))for(var d=this._splitSafely(a,p),g=0,y=d.length;g<y;g++)n.push(d[g])}if(null!==u||null!==f){var m;m=null===u?f:null===f||C.comparePoints(u,f)<=0?u:f,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(m),v=0,b=_.length;v<b;v++)n.push(_[v])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var E=this._splitSafely(s,w),x=0,S=E.length;x<S;x++)n.push(E[x]);if(!a.isAnEndpoint(w))for(var P=this._splitSafely(a,w),T=0,M=P.length;T<M;T++)n.push(P[T])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var r=t.split(e);return r.push(n),void 0===t.consumedBy&&this.tree.insert(t),r}}]),e}(),B="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,j="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,U=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){U.type=t,v.reset();for(var r=[new L(e,!0)],i=0,o=n.length;i<o;i++)r.push(new L(n[i],!1));if(U.numMultiPolys=r.length,"difference"===U.type)for(var s=r[0],a=1;a<r.length;)null!==p(r[a].bbox,s.bbox)?a++:r.splice(a,1);if("intersection"===U.type)for(var u=0,l=r.length;u<l;u++)for(var h=r[u],A=u+1,f=r.length;A<f;A++)if(null===p(h.bbox,r[A].bbox))return[];for(var d=new c(C.compare),g=0,y=r.length;g<y;g++)for(var m=r[g].getSweepEvents(),_=0,b=m.length;_<b;_++)if(d.insert(m[_]),d.size>B)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new k(d),E=d.size,x=d.pop();x;){var S=x.key;if(d.size===E){var P=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(P.id," ")+"[".concat(P.leftSE.point.x,", ").concat(P.leftSE.point.y,"] -> ")+"[".concat(P.rightSE.point.x,", ").concat(P.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>B)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>j)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var T=w.process(S),M=0,I=T.length;M<I;M++){var O=T[M];void 0===O.consumedBy&&d.insert(O)}E=d.size,x=d.pop()}v.reset();var R=N.factory(w.segments);return new F(R).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U.run("difference",t,n)}}}()},8297:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){return void 0!==i.window.orientation},e.default=function(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");return r||a?"IE":i.window.chrome?"Chrome":i.window.safari?"Safari":i.window.mozInnerScreenX?"Firefox":"Unknown"};var i=n(2361),o=r(n(2999)),s=r(n(3941))},2361:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var i=r(n(8)),o={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&process},s=o.self||o.window||o.global;e.self=s;var a=o.window||o.self||o.global;e.window=a;var u=o.global||o.self||o.window;e.global=u;var c=o.document||{};e.document=c;var l=o.process||{};e.process=l;var h=console;e.console=h},9718:(t,e,n)=>{"use strict";var r=n(5318),i=n(8);Object.defineProperty(e,"CO",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"jU",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"qs",{enumerable:!0,get:function(){return a.default}});var o=n(2361),s=c(n(2999)),a=c(n(8297));r(n(3941));function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(u=function(t){return t?n:e})(t)}function c(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!=typeof t)return{default:t};var n=u(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},2999:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s,e.isBrowserMainThread=function(){return s()&&"undefined"!=typeof document};var i=r(n(8)),o=r(n(3941));function s(){return!("object"===("undefined"==typeof process?"undefined":(0,i.default)(process))&&"[object process]"===String(process)&&!process.browser)||(0,o.default)()}},3941:(t,e,n)=>{"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!=typeof window&&"object"===(0,i.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"===(0,i.default)(process.versions)&&Boolean(process.versions.electron))return!0;var e="object"===("undefined"==typeof navigator?"undefined":(0,i.default)(navigator))&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)};var i=r(n(8))},6073:(t,e,n)=>{"use strict";n.d(e,{u9:()=>i,N4:()=>o});const r={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==n.g&&n.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},i=r.window||r.self||r.global,o=r.process||{};console},5989:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});var r=n(1202);function i(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||(0,r.Z)()}},1202:(t,e,n)=>{"use strict";function r(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}n.d(e,{Z:()=>r})},4708:(t,e,n)=>{"use strict";n.d(e,{Z:()=>_});var r=n(5989);const i="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source",o=(0,r.Z)();class s{constructor(t,e,n="sessionStorage"){this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function a(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const u={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function c(t){return"string"==typeof t?u[t.toUpperCase()]||u.WHITE:t}function l(t,e){if(!t)throw new Error(e||"Assertion failed")}var h=n(6073);function A(){let t;if(o&&h.u9.performance)t=h.u9.performance.now();else if(h.N4.hrtime){const e=h.N4.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const f={debug:o&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},p={enabled:!0,level:0};function d(){}const g={},y={once:!0};function m(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class _{constructor({id:t}={id:""}){this.id=t,this.VERSION=i,this._startTs=A(),this._deltaTs=A(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new s("__probe-".concat(this.id,"__"),p),this.userData={},this.timeStamp("".concat(this.id," started")),function(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const n of r)"function"==typeof t[n]&&(e.find((t=>n===t))||(t[n]=t[n].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((A()-this._startTs).toPrecision(10))}getDelta(){return Number((A()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){l(t,e)}warn(t){return this._getLogFunction(0,t,f.warn,arguments,y)}error(t){return this._getLogFunction(0,t,f.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,f.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,f.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,f.debug||f.info,arguments,y)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||d,n&&[n],{tag:m(e)}):d}image({logLevel:t,priority:e,image:r,message:i="",scale:s=1}){return this._shouldLog(t||e)?o?function({image:t,message:e="",scale:n=1}){if("string"==typeof t){const r=new Image;return r.onload=()=>{const t=a(r,e,n);console.log(...t)},r.src=t,d}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...a(t,e,n)),d;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...a(r,e,n)),r.src=t.toDataURL(),d}return d}({image:r,message:i,scale:s}):function({image:t,message:e="",scale:r=1}){let i=null;try{i=n(5307)}catch(t){}return i?()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then((t=>console.log(t))):d}({image:r,message:i,scale:s}):d}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||d)}group(t,e,n={collapsed:!1}){n=b({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||d)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=v(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=b({logLevel:t,message:e,args:r,opts:i}),l(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=A();const s=i.tag||i.message;if(i.once){if(g[s])return d;g[s]=A()}return e=function(t,e,n){if("string"==typeof e){const a=n.time?function(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";r=e=n.time?"".concat(t,": ").concat(a,"  ").concat(e):"".concat(t,": ").concat(e),i=n.color,s=n.background,o||"string"!=typeof r||(i&&(i=c(i),r="[".concat(i,"m").concat(r,"[39m")),s&&(i=c(s),r="[".concat(s+10,"m").concat(r,"[49m"))),e=r}var r,i,s;return e}(this.id,i.message,i),n.bind(console,e,...i.args)}return d}}function v(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return l(Number.isFinite(e)&&e>=0),e}function b(t){const{logLevel:e,message:n}=t;t.logLevel=v(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const i=typeof t.message;return l("string"===i||"object"===i),Object.assign(t,t.opts)}_.VERSION=i},2582:function(t){t.exports=function(){"use strict";function t(t,r,i,o,s){!function t(n,r,i,o,s){for(;o>i;){if(o-i>600){var a=o-i+1,u=r-i+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*(u-a/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-u*l/a+h)),Math.min(o,Math.floor(r+(a-u)*l/a+h)),s)}var A=n[r],f=i,p=o;for(e(n,i,r),s(n[o],A)>0&&e(n,i,o);f<p;){for(e(n,f,p),f++,p--;s(n[f],A)<0;)f++;for(;s(n[p],A)>0;)p--}0===s(n[i],A)?e(n,i,p):e(n,++p,o),p<=r&&(i=p+1),r<=p&&(o=p-1)}}(t,r,i||0,o||t.length-1,s||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(i,t.leaf?r(s):s)}return i}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function A(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function f(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(e,n,r,i,o){for(var s=[n,r];s.length;)if(!((r=s.pop())-(n=s.pop())<=i)){var a=n+Math.ceil((r-n)/i/2)*i;t(e,a,n,r,o),s.push(n,a,a,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!f(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?r(s):s;f(t,a)&&(e.leaf?n.push(s):A(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!f(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(f(t,o)){if(e.leaf||A(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,s=this.data,a=this.toBBox(t),u=[],c=[];s||u.length;){if(s||(s=u.pop(),r=u[u.length-1],n=c.pop(),o=!0),s.leaf){var l=i(t,s.children,e);if(-1!==l)return s.children.splice(l,1),u.push(s),this._condense(u),this}o||s.leaf||!A(s,a)?r?(n++,s=r.children[n],o=!1):s=null:(u.push(s),c.push(n),n=0,r=s,s=s.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,s=n-e+1,a=this._maxEntries;if(s<=a)return o(i=p(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,r-1))),(i=p([])).leaf=!1,i.height=r;var u=Math.ceil(s/a),c=u*Math.ceil(Math.sqrt(a));d(t,e,n,c,this.compareMinX);for(var l=e;l<=n;l+=c){var h=Math.min(l+c-1,n);d(t,l,h,u,this.compareMinY);for(var A=l;A<=h;A+=u){var f=Math.min(A+u-1,h);i.children.push(this._build(t,A,f,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var u=e.children[a],c=l(u),h=(A=t,f=u,(Math.max(f.maxX,A.maxX)-Math.min(f.minX,A.minX))*(Math.max(f.maxY,A.maxY)-Math.min(f.minY,A.minY))-c);h<o?(o=h,i=c<i?c:i,s=u):h===o&&c<i&&(i=c,s=u)}e=s||e.children[0]}var A,f;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),a(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var s=this._chooseSplitIndex(n,i,r),a=p(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},r.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,a,u,c,h,A=1/0,f=1/0,p=e;p<=n-e;p++){var d=s(t,0,p,this.toBBox),g=s(t,p,n,this.toBBox),y=(i=d,o=g,void 0,void 0,void 0,void 0,a=Math.max(i.minX,o.minX),u=Math.max(i.minY,o.minY),c=Math.min(i.maxX,o.maxX),h=Math.min(i.maxY,o.maxY),Math.max(0,c-a)*Math.max(0,h-u)),m=l(d)+l(g);y<A?(A=y,r=p,f=m<f?m:f):y===A&&m<f&&(f=m,r=p)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:u,i=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=s(t,0,e,i),u=s(t,n-e,n,i),c=h(o)+h(u),l=e;l<n-e;l++){var A=t.children[l];a(o,t.leaf?i(A):A),c+=h(o)}for(var f=n-e-1;f>=e;f--){var p=t.children[f];a(u,t.leaf?i(p):p),c+=h(u)}return c},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)a(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},2044:(t,e,n)=>{var r=n(3379),i=n(5107);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.id,i,""]]);r(i,{insert:"head",singleton:!1}),t.exports=i.locals||{}},3379:(t,e,n)=>{"use strict";var r,i=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),o=[];function s(t){for(var e=-1,n=0;n<o.length;n++)if(o[n].identifier===t){e=n;break}return e}function a(t,e){for(var n={},r=[],i=0;i<t.length;i++){var a=t[i],u=e.base?a[0]+e.base:a[0],c=n[u]||0,l="".concat(u," ").concat(c);n[u]=c+1;var h=s(l),A={css:a[1],media:a[2],sourceMap:a[3]};-1!==h?(o[h].references++,o[h].updater(A)):o.push({identifier:l,updater:d(A,e),references:1}),r.push(l)}return r}function u(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var s=i(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var c,l=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function h(t,e,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=l(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function A(t,e,n){var r=n.css,i=n.media,o=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var f=null,p=0;function d(t,e){var n,r,i;if(e.singleton){var o=p++;n=f||(f=u(e)),r=h.bind(null,n,o,!1),i=h.bind(null,n,o,!0)}else n=u(e),r=A.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r));var n=a(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var i=s(n[r]);o[i].references--}for(var u=a(t,e),c=0;c<n.length;c++){var l=s(n[c]);0===o[l].references&&(o[l].updater(),o.splice(l,1))}n=u}}}},675:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function r(t){this.message=t||""}function i(t){this.message=t||""}function o(){}function s(t){return null===t?Nt:t.color}function a(t){return null===t?null:t.parent}function u(t,e){null!==t&&(t.color=e)}function c(t){return null===t?null:t.left}function l(t){return null===t?null:t.right}function h(){this.root_=null,this.size_=0}function A(){}function f(){this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}function p(){}function d(t){this.message=t||""}function g(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,r=1 in arguments&&parseInt(Number(arguments[1]),10)||0;r=r<0?Math.max(n+r,0):Math.min(r,n);var i=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(i=i<0?Math.max(n+arguments[2],0):Math.min(i,n);r<i;)e[r]=t,++r;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var y=function(){};y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var m=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),_=function(){},v={MAX_VALUE:{configurable:!0}};_.isNaN=function(t){return Number.isNaN(t)},_.doubleToLongBits=function(t){return t},_.longBitsToDouble=function(t){return t},_.isInfinite=function(t){return!Number.isFinite(t)},v.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(_,v);var b=function(){},w=function(){},E=function(){},x=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},S={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};x.prototype.setOrdinate=function(t,e){switch(t){case x.X:this.x=e;break;case x.Y:this.y=e;break;case x.Z:this.z=e;break;default:throw new m("Invalid ordinate index: "+t)}},x.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!y.equalsWithTolerance(this.x,e.x,n)&&!!y.equalsWithTolerance(this.y,e.y,n)}},x.prototype.getOrdinate=function(t){switch(t){case x.X:return this.x;case x.Y:return this.y;case x.Z:return this.z}throw new m("Invalid ordinate index: "+t)},x.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||_.isNaN(this.z))&&_.isNaN(t.z)},x.prototype.equals=function(t){return t instanceof x&&this.equals2D(t)},x.prototype.equalInZ=function(t,e){return y.equalsWithTolerance(this.z,t.z,e)},x.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},x.prototype.clone=function(){},x.prototype.copy=function(){return new x(this)},x.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},x.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return Math.sqrt(e*e+n*n+r*r)},x.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},x.prototype.hashCode=function(){var t=17;return 37*(t=37*t+x.hashCode(this.x))+x.hashCode(this.y)},x.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},x.prototype.interfaces_=function(){return[b,w,e]},x.prototype.getClass=function(){return x},x.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=_.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},S.DimensionalComparator.get=function(){return P},S.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},S.NULL_ORDINATE.get=function(){return _.NaN},S.X.get=function(){return 0},S.Y.get=function(){return 1},S.Z.get=function(){return 2},Object.defineProperties(x,S);var P=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new m("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};P.prototype.compare=function(t,e){var n=t,r=e,i=P.compare(n.x,r.x);if(0!==i)return i;var o=P.compare(n.y,r.y);return 0!==o?o:this._dimensionsToTest<=2?0:P.compare(n.z,r.z)},P.prototype.interfaces_=function(){return[E]},P.prototype.getClass=function(){return P},P.compare=function(t,e){return t<e?-1:t>e?1:_.isNaN(t)?_.isNaN(e)?0:-1:_.isNaN(e)?1:0};var T=function(){};T.prototype.create=function(){},T.prototype.interfaces_=function(){return[]},T.prototype.getClass=function(){return T};var C=function(){},M={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};C.prototype.interfaces_=function(){return[]},C.prototype.getClass=function(){return C},C.toLocationSymbol=function(t){switch(t){case C.EXTERIOR:return"e";case C.BOUNDARY:return"b";case C.INTERIOR:return"i";case C.NONE:return"-"}throw new m("Unknown location value: "+t)},M.INTERIOR.get=function(){return 0},M.BOUNDARY.get=function(){return 1},M.EXTERIOR.get=function(){return 2},M.NONE.get=function(){return-1},Object.defineProperties(C,M);var I=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},O=function(){},R={LOG_10:{configurable:!0}};O.prototype.interfaces_=function(){return[]},O.prototype.getClass=function(){return O},O.log10=function(t){var e=Math.log(t);return _.isInfinite(e)||_.isNaN(e)?e:e/O.LOG_10},O.min=function(t,e,n,r){var i=t;return e<i&&(i=e),n<i&&(i=n),r<i&&(i=r),i},O.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var r=arguments[0],i=arguments[1],o=arguments[2];return r<i?i:r>o?o:r}},O.wrap=function(t,e){return t<0?e- -t%e:t%e},O.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var r=arguments[1],i=arguments[2],o=arguments[3],s=arguments[0];return r>s&&(s=r),i>s&&(s=i),o>s&&(s=o),s}},O.average=function(t,e){return(t+e)/2},R.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(O,R);var L=function(t){this.str=t};L.prototype.append=function(t){this.str+=t},L.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},L.prototype.toString=function(t){return this.str};var N=function(t){this.value=t};N.prototype.intValue=function(){return this.value},N.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},N.isNaN=function(t){return Number.isNaN(t)};var D=function(){};D.isWhitespace=function(t){return t<=32&&t>=0||127===t},D.toUpperCase=function(t){return t.toUpperCase()};var F=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r,i)}},k={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};F.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},F.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),r=F.magnitude(n._hi),i=F.TEN.pow(r);(n=n.divide(i)).gt(F.TEN)?(n=n.divide(F.TEN),r+=1):n.lt(F.ONE)&&(n=n.multiply(F.TEN),r-=1);for(var o=r+1,s=new L,a=F.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var c=Math.trunc(n._hi);if(c<0)break;var l=!1,h=0;c>9?(l=!0,h="9"):h="0"+c,s.append(h),n=n.subtract(F.valueOf(c)).multiply(F.TEN),l&&n.selfAdd(F.TEN);var A=!0,f=F.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(A=!1),!A)break}return e[0]=r,s.toString()},F.prototype.sqr=function(){return this.multiply(this)},F.prototype.doubleValue=function(){return this._hi+this._lo},F.prototype.subtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},F.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},F.prototype.isZero=function(){return 0===this._hi&&0===this._lo},F.prototype.selfSubtract=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},F.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},F.prototype.min=function(t){return this.le(t)?this:t},F.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,s=null,a=null,u=null,c=null,l=null,h=null;return u=this._hi/n,h=(i=(c=F.SPLIT*u)-(i=c-u))*(s=(h=F.SPLIT*n)-(s=h-n))-(l=u*n)+i*(a=n-s)+(o=u-i)*s+o*a,h=u+(c=(this._hi-l-h+this._lo-u*r)/n),this._hi=h,this._lo=u-h+c,this}},F.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},F.prototype.divide=function(){if(arguments[0]instanceof F){var t=arguments[0],e=null,n=null,r=null,i=null,o=null,s=null,a=null,u=null;return n=(o=this._hi/t._hi)-(e=(s=F.SPLIT*o)-(e=s-o)),u=e*(r=(u=F.SPLIT*t._hi)-(r=u-t._hi))-(a=o*t._hi)+e*(i=t._hi-r)+n*r+n*i,s=(this._hi-a-u+this._lo-o*t._lo)/t._hi,new F(u=o+s,o-u+s)}if("number"==typeof arguments[0]){var c=arguments[0];return _.isNaN(c)?F.createNaN():F.copy(this).selfDivide(c,0)}},F.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},F.prototype.pow=function(t){if(0===t)return F.valueOf(1);var e=new F(this),n=F.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&n.selfMultiply(e),(r/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},F.prototype.ceil=function(){if(this.isNaN())return F.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new F(t,e)},F.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},F.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},F.prototype.setValue=function(){if(arguments[0]instanceof F){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},F.prototype.max=function(t){return this.ge(t)?this:t},F.prototype.sqrt=function(){if(this.isZero())return F.valueOf(0);if(this.isNegative())return F.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=F.valueOf(e),r=this.subtract(n.sqr())._hi*(.5*t);return n.add(r)},F.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0],n=null,r=null,i=null,o=null,s=null,a=null;return o=(i=this._hi+e)-(s=i-this._hi),r=(a=(o=e-s+(this._hi-o))+this._lo)+(i-(n=i+a)),this._hi=n+r,this._lo=r+(n-this._hi),this}}else if(2===arguments.length){var u=arguments[0],c=arguments[1],l=null,h=null,A=null,f=null,p=null,d=null,g=null;f=this._hi+u,h=this._lo+c,p=f-(d=f-this._hi),A=h-(g=h-this._lo);var y=(l=f+(d=(p=u-d+(this._hi-p))+h))+(d=(A=c-g+(this._lo-A))+(d+(f-l))),m=d+(l-y);return this._hi=y,this._lo=m,this}},F.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof F){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1],i=null,o=null,s=null,a=null,u=null,c=null;i=(u=F.SPLIT*this._hi)-this._hi,c=F.SPLIT*n,i=u-i,o=this._hi-i,s=c-n;var l=(u=this._hi*n)+(c=i*(s=c-s)-u+i*(a=n-s)+o*s+o*a+(this._hi*r+this._lo*n)),h=c+(i=u-l);return this._hi=l,this._lo=h,this}},F.prototype.selfSqr=function(){return this.selfMultiply(this)},F.prototype.floor=function(){if(this.isNaN())return F.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new F(t,e)},F.prototype.negate=function(){return this.isNaN()?this:new F(-this._hi,-this._lo)},F.prototype.clone=function(){},F.prototype.multiply=function(){if(arguments[0]instanceof F){var t=arguments[0];return t.isNaN()?F.createNaN():F.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return _.isNaN(e)?F.createNaN():F.copy(this).selfMultiply(e,0)}},F.prototype.isNaN=function(){return _.isNaN(this._hi)},F.prototype.intValue=function(){return Math.trunc(this._hi)},F.prototype.toString=function(){var t=F.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},F.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),r=e[0]+1,i=n;if("."===n.charAt(0))i="0"+n;else if(r<0)i="0."+F.stringOfChar("0",-r)+n;else if(-1===n.indexOf(".")){var o=r-n.length;i=n+F.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+i:i},F.prototype.reciprocal=function(){var t,e,n,r,i=null,o=null,s=null,a=null;t=(n=1/this._hi)-(i=(s=F.SPLIT*n)-(i=s-n)),o=(a=F.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(r=n*this._hi)-(a=i*(o=a-o)-r+i*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new F(u,n-u+s)},F.prototype.toSciNotation=function(){if(this.isZero())return F.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),r=F.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var i="";n.length>1&&(i=n.substring(1));var o=n.charAt(0)+"."+i;return this.isNegative()?"-"+o+r:o+r},F.prototype.abs=function(){return this.isNaN()?F.NaN:this.isNegative()?this.negate():new F(this)},F.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},F.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},F.prototype.add=function(){if(arguments[0]instanceof F){var t=arguments[0];return F.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return F.copy(this).selfAdd(e)}},F.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof F){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._hi=n,this._lo=r}},F.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},F.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},F.prototype.trunc=function(){return this.isNaN()?F.NaN:this.isPositive()?this.floor():this.ceil()},F.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},F.prototype.interfaces_=function(){return[e,b,w]},F.prototype.getClass=function(){return F},F.sqr=function(t){return F.valueOf(t).selfMultiply(t)},F.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return F.parse(t)}if("number"==typeof arguments[0])return new F(arguments[0])},F.sqrt=function(t){return F.valueOf(t).sqrt()},F.parse=function(t){for(var e=0,n=t.length;D.isWhitespace(t.charAt(e));)e++;var r=!1;if(e<n){var i=t.charAt(e);"-"!==i&&"+"!==i||(e++,"-"===i&&(r=!0))}for(var o=new F,s=0,a=0,u=0;!(e>=n);){var c=t.charAt(e);if(e++,D.isDigit(c)){var l=c-"0";o.selfMultiply(F.TEN),o.selfAdd(l),s++}else{if("."!==c){if("e"===c||"E"===c){var h=t.substring(e);try{u=N.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+c+"' at position "+e+" in string "+t)}a=s}}var A=o,f=s-a-u;if(0===f)A=o;else if(f>0){var p=F.TEN.pow(f);A=o.divide(p)}else if(f<0){var d=F.TEN.pow(-f);A=o.multiply(d)}return r?A.negate():A},F.createNaN=function(){return new F(_.NaN,_.NaN)},F.copy=function(t){return new F(t)},F.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),r=Math.trunc(Math.floor(n));return 10*Math.pow(10,r)<=e&&(r+=1),r},F.stringOfChar=function(t,e){for(var n=new L,r=0;r<e;r++)n.append(t);return n.toString()},k.PI.get=function(){return new F(3.141592653589793,12246467991473532e-32)},k.TWO_PI.get=function(){return new F(6.283185307179586,24492935982947064e-32)},k.PI_2.get=function(){return new F(1.5707963267948966,6123233995736766e-32)},k.E.get=function(){return new F(2.718281828459045,14456468917292502e-32)},k.NaN.get=function(){return new F(_.NaN,_.NaN)},k.EPS.get=function(){return 123259516440783e-46},k.SPLIT.get=function(){return 134217729},k.MAX_PRINT_DIGITS.get=function(){return 32},k.TEN.get=function(){return F.valueOf(10)},k.ONE.get=function(){return F.valueOf(1)},k.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},k.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(F,k);var B=function(){},j={DP_SAFE_EPSILON:{configurable:!0}};B.prototype.interfaces_=function(){return[]},B.prototype.getClass=function(){return B},B.orientationIndex=function(t,e,n){var r=B.orientationIndexFilter(t,e,n);if(r<=1)return r;var i=F.valueOf(e.x).selfAdd(-t.x),o=F.valueOf(e.y).selfAdd(-t.y),s=F.valueOf(n.x).selfAdd(-e.x),a=F.valueOf(n.y).selfAdd(-e.y);return i.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},B.signOfDet2x2=function(t,e,n,r){return t.multiply(r).selfSubtract(e.multiply(n)).signum()},B.intersection=function(t,e,n,r){var i=F.valueOf(r.y).selfSubtract(n.y).selfMultiply(F.valueOf(e.x).selfSubtract(t.x)),o=F.valueOf(r.x).selfSubtract(n.x).selfMultiply(F.valueOf(e.y).selfSubtract(t.y)),s=i.subtract(o),a=F.valueOf(r.x).selfSubtract(n.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),u=F.valueOf(r.y).selfSubtract(n.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),c=a.subtract(u).selfDivide(s).doubleValue(),l=F.valueOf(t.x).selfAdd(F.valueOf(e.x).selfSubtract(t.x).selfMultiply(c)).doubleValue(),h=F.valueOf(e.x).selfSubtract(t.x).selfMultiply(F.valueOf(t.y).selfSubtract(n.y)),A=F.valueOf(e.y).selfSubtract(t.y).selfMultiply(F.valueOf(t.x).selfSubtract(n.x)),f=h.subtract(A).selfDivide(s).doubleValue(),p=F.valueOf(n.y).selfAdd(F.valueOf(r.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new x(l,p)},B.orientationIndexFilter=function(t,e,n){var r=null,i=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=i-o;if(i>0){if(o<=0)return B.signum(s);r=i+o}else{if(!(i<0))return B.signum(s);if(o>=0)return B.signum(s);r=-i-o}var a=B.DP_SAFE_EPSILON*r;return s>=a||-s>=a?B.signum(s):2},B.signum=function(t){return t>0?1:t<0?-1:0},j.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(B,j);var U=function(){},z={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};z.X.get=function(){return 0},z.Y.get=function(){return 1},z.Z.get=function(){return 2},z.M.get=function(){return 3},U.prototype.setOrdinate=function(t,e,n){},U.prototype.size=function(){},U.prototype.getOrdinate=function(t,e){},U.prototype.getCoordinate=function(){},U.prototype.getCoordinateCopy=function(t){},U.prototype.getDimension=function(){},U.prototype.getX=function(t){},U.prototype.clone=function(){},U.prototype.expandEnvelope=function(t){},U.prototype.copy=function(){},U.prototype.getY=function(t){},U.prototype.toCoordinateArray=function(){},U.prototype.interfaces_=function(){return[w]},U.prototype.getClass=function(){return U},Object.defineProperties(U,z);var G=function(){},V=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(G),Z=function(){};Z.arraycopy=function(t,e,n,r,i){for(var o=0,s=e;s<e+i;s++)n[r+o]=t[s],o++},Z.getProperty=function(t){return{"line.separator":"\n"}[t]};var H=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof x&&arguments[1]instanceof x){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var u=arguments[0],c=arguments[1],l=arguments[2];this.x=u,this.y=c,this.w=l}else if(4===arguments.length){var h=arguments[0],A=arguments[1],f=arguments[2],p=arguments[3],d=h.y-A.y,g=A.x-h.x,y=h.x*A.y-A.x*h.y,m=f.y-p.y,_=p.x-f.x,v=f.x*p.y-p.x*f.y;this.x=g*v-_*y,this.y=m*y-d*v,this.w=d*_-m*g}};H.prototype.getY=function(){var t=this.y/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new V;return t},H.prototype.getX=function(){var t=this.x/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new V;return t},H.prototype.getCoordinate=function(){var t=new x;return t.x=this.getX(),t.y=this.getY(),t},H.prototype.interfaces_=function(){return[]},H.prototype.getClass=function(){return H},H.intersection=function(t,e,n,r){var i=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-r.y,u=r.x-n.x,c=n.x*r.y-r.x*n.y,l=i*u-a*o,h=(o*c-u*s)/l,A=(a*s-i*c)/l;if(_.isNaN(h)||_.isInfinite(h)||_.isNaN(A)||_.isInfinite(A))throw new V;return new x(h,A)};var q=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof x){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];this.init(o,s,a,u)}},W={serialVersionUID:{configurable:!0}};q.prototype.getArea=function(){return this.getWidth()*this.getHeight()},q.prototype.equals=function(t){if(!(t instanceof q))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},q.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new q;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,r=this._maxx<t._maxx?this._maxx:t._maxx,i=this._maxy<t._maxy?this._maxy:t._maxy;return new q(e,r,n,i)},q.prototype.isNull=function(){return this._maxx<this._minx},q.prototype.getMaxX=function(){return this._maxx},q.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof q){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&r>=this._miny&&r<=this._maxy}},q.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof q){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof x){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||r>this._maxy||r<this._miny)}},q.prototype.getMinY=function(){return this._miny},q.prototype.getMinX=function(){return this._minx},q.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof q){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=r,this._maxy=r):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},q.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},q.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},q.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},q.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},q.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},q.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},q.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},q.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},q.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},q.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof q){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof x){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.covers(n,r)}},q.prototype.centre=function(){return this.isNull()?null:new x((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},q.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof q){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.init(n.x,r.x,n.y,r.y)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];i<o?(this._minx=i,this._maxx=o):(this._minx=o,this._maxx=i),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},q.prototype.getMaxY=function(){return this._maxy},q.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},q.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+x.hashCode(this._minx))+x.hashCode(this._maxx))+x.hashCode(this._miny))+x.hashCode(this._maxy)},q.prototype.interfaces_=function(){return[b,e]},q.prototype.getClass=function(){return q},q.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),c=Math.min(r.x,i.x),l=Math.max(r.x,i.x);return!(c>u||l<a||(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),c=Math.min(r.y,i.y),l=Math.max(r.y,i.y),c>u||l<a))}},W.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(q,W);var X={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Y=function(t){this.geometryFactory=t||new ye};Y.prototype.read=function(t){var e,n,r;t=t.replace(/[\n\r]/g," ");var i=X.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((i=X.emptyTypeStr.exec(t))[2]=void 0),i&&(n=i[1].toLowerCase(),r=i[2],K[n]&&(e=K[n].apply(this,[r]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Y.prototype.write=function(t){return this.extractGeometry(t)},Y.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Q[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Q[e].apply(this,[t])+")"};var Q={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Q.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Q.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Q.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,r=t._points._coordinates.length;n<r;++n)e.push(Q.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Q.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Q.linestring.apply(this,[t._shell])+")");for(var n=0,r=t._holes.length;n<r;++n)e.push("("+Q.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push("("+Q.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,r=t._geometries.length;n<r;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},K={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(X.spaces);return this.geometryFactory.createPoint(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(K.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(r)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(X.spaces),r.push(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(r)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),r=[],i=0,o=n.length;i<o;++i)e=n[i].trim().split(X.spaces),r.push(new x(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(X.parenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(K.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(r)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,r,i,o=t.trim().split(X.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace(X.trimParens,"$1"),n=K.linestring.apply(this,[e]),r=this.geometryFactory.createLinearRing(n._points),0===a?i=r:s.push(r);return this.geometryFactory.createPolygon(i,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(X.doubleParenComma),r=[],i=0,o=n.length;i<o;++i)e=n[i].replace(X.trimParens,"$1"),r.push(K.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(r)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],r=0,i=e.length;r<i;++r)n.push(this.read(e[r]));return this.geometryFactory.createGeometryCollection(n)}},J=function(t){this.parser=new Y(t)};J.prototype.write=function(t){return this.parser.write(t)},J.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var $=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t;if(1===arguments.length)et.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new tt:new tt(t)},et.equals=function(){var t,e,n;if(2===arguments.length)et.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new x,this._intPt[1]=new x,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},rt={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new L;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,r){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=r,this._result=this.computeIntersect(t,e,n,r)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return J.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+J.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var r=Math.abs(n.x-e.x),i=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r>i?r:i;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r>i?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var r=t.x-e.x,i=t.y-e.y,o=Math.sqrt(r*r+i*i);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},rt.DONT_INTERSECT.get=function(){return 0},rt.DO_INTERSECT.get=function(){return 1},rt.COLLINEAR.get=function(){return 2},rt.NO_INTERSECTION.get=function(){return 0},rt.POINT_INTERSECTION.get=function(){return 1},rt.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,rt);var it=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new q(this._inputLines[0][0],this._inputLines[0][1]),n=new q(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],r=arguments[2];if(this._isProper=!1,q.intersects(n,r,e)&&0===at.orientationIndex(n,r,e)&&0===at.orientationIndex(r,n,e))return this._isProper=!0,(e.equals(n)||e.equals(r))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,r,i){i.x=this.smallestInAbsValue(t.x,e.x,n.x,r.x),i.y=this.smallestInAbsValue(t.y,e.y,n.y,r.y),t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.safeHCoordinateIntersection=function(t,n,r,i){var o=null;try{o=H.intersection(t,n,r,i)}catch(s){if(!(s instanceof V))throw s;o=e.nearestEndpoint(t,n,r,i)}return o},e.prototype.intersection=function(t,n,r,i){var o=this.intersectionWithNormalization(t,n,r,i);return this.isInSegmentEnvelopes(o)||(o=new x(e.nearestEndpoint(t,n,r,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,r){var i=t,o=Math.abs(i);return Math.abs(e)<o&&(i=e,o=Math.abs(e)),Math.abs(n)<o&&(i=n,o=Math.abs(n)),Math.abs(r)<o&&(i=r),i},e.prototype.checkDD=function(t,e,n,r,i){var o=B.intersection(t,e,n,r),s=this.isInSegmentEnvelopes(o);Z.out.println("DD in env = "+s+"  --------------------- "+o),i.distance(o)>1e-4&&Z.out.println("Distance = "+i.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,r){var i=new x(t),o=new x(e),s=new x(n),a=new x(r),u=new x;this.normalizeToEnvCentre(i,o,s,a,u);var c=this.safeHCoordinateIntersection(i,o,s,a);return c.x+=u.x,c.y+=u.y,c},e.prototype.computeCollinearIntersection=function(e,n,r,i){var o=q.intersects(e,n,r),s=q.intersects(e,n,i),a=q.intersects(r,i,e),u=q.intersects(r,i,n);return o&&s?(this._intPt[0]=r,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):a&&u?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||s||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&u?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||o||u?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&u?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,r,i){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,c=n.x<r.x?n.x:r.x,l=n.y<r.y?n.y:r.y,h=n.x>r.x?n.x:r.x,A=n.y>r.y?n.y:r.y,f=((o>c?o:c)+(a<h?a:h))/2,p=((s>l?s:l)+(u<A?u:A))/2;i.x=f,i.y=p,t.x-=i.x,t.y-=i.y,e.x-=i.x,e.y-=i.y,n.x-=i.x,n.y-=i.y,r.x-=i.x,r.y-=i.y},e.prototype.computeIntersect=function(e,n,r,i){if(this._isProper=!1,!q.intersects(e,n,r,i))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,r),s=at.orientationIndex(e,n,i);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(r,i,e),u=at.orientationIndex(r,i,n);return a>0&&u>0||a<0&&u<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===u?this.computeCollinearIntersection(e,n,r,i):(0===o||0===s||0===a||0===u?(this._isProper=!1,e.equals2D(r)||e.equals2D(i)?this._intPt[0]=e:n.equals2D(r)||n.equals2D(i)?this._intPt[0]=n:0===o?this._intPt[0]=new x(r):0===s?this._intPt[0]=new x(i):0===a?this._intPt[0]=new x(e):0===u&&(this._intPt[0]=new x(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,r,i)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,r){var i=t,o=at.distancePointLine(t,n,r),s=at.distancePointLine(e,n,r);return s<o&&(o=s,i=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,i=n),(s=at.distancePointLine(r,t,e))<o&&(o=s,i=r),i},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(r,i,o,s)},ot.signOfDet2x2=function(t,e,n,r){var i=null,o=null,s=null;if(i=1,0===t||0===r)return 0===e||0===n?0:e>0?n>0?-i:i:n>0?i:-i;if(0===e||0===n)return r>0?t>0?i:-i:t>0?-i:i;if(e>0?r>0?e<=r||(i=-i,o=t,t=n,n=o,o=e,e=r,r=o):e<=-r?(i=-i,n=-n,r=-r):(o=t,t=-n,n=o,o=e,e=-r,r=o):r>0?-e<=r?(i=-i,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=r,r=o):e>=r?(t=-t,e=-e,n=-n,r=-r):(i=-i,o=-t,t=-n,n=o,o=-e,e=-r,r=o),t>0){if(!(n>0))return i;if(!(t<=n))return i}else{if(n>0)return-i;if(!(t>=n))return-i;i=-i,t=-t,n=-n}for(;;){if((r-=(s=Math.floor(n/t))*e)<0)return-i;if(r>e)return i;if(t>(n-=s*t)+n){if(e<r+r)return i}else{if(e>r+r)return-i;n=t-n,r=e-r,i=-i}if(0===r)return 0===n?0:-i;if(0===n)return i;if((e-=(s=Math.floor(t/n))*r)<0)return i;if(e>r)return-i;if(n>(t-=s*n)+t){if(r<e+e)return-i}else{if(r>e+e)return i;t=n-t,e=r-e,i=-i}if(0===e)return 0===t?0:i;if(0===t)return-i}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,r=e.x;return n>r&&(n=e.x,r=t.x),this._p.x>=n&&this._p.x<=r&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var i=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=ot.signOfDet2x2(i,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),u>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==C.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?C.BOUNDARY:this._crossingCount%2==1?C.INTERIOR:C.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof x&&I(arguments[1],U)){for(var t=arguments[1],e=new st(arguments[0]),n=new x,r=new x,i=1;i<t.size();i++)if(t.getCoordinate(i,n),t.getCoordinate(i-1,r),e.countSegment(n,r),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof x&&arguments[1]instanceof Array){for(var o=arguments[1],s=new st(arguments[0]),a=1;a<o.length;a++){var u=o[a],c=o[a-1];if(s.countSegment(u,c),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var at=function(){},ut={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return B.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,r=1;r<t.length-1;r++){var i=t[r].x-n,o=t[r+1].y;e+=i*(t[r-1].y-o)}return e/2}if(I(arguments[0],U)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new x,c=new x,l=new x;s.getCoordinate(0,c),s.getCoordinate(1,l);var h=c.x;l.x-=h;for(var A=0,f=1;f<a-1;f++)u.y=c.y,c.x=l.x,c.y=l.y,s.getCoordinate(f+1,l),l.x-=h,A+=c.x*(u.y-l.y);return A/2}},at.distanceLineLine=function(t,e,n,r){if(t.equals(e))return at.distancePointLine(t,n,r);if(n.equals(r))return at.distancePointLine(r,t,e);var i=!1;if(q.intersects(t,e,n,r)){var o=(e.x-t.x)*(r.y-n.y)-(e.y-t.y)*(r.x-n.x);if(0===o)i=!0;else{var s=(t.y-n.y)*(r.x-n.x)-(t.x-n.x)*(r.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||u>1||a<0||a>1)&&(i=!0)}}else i=!0;return i?O.min(at.distancePointLine(t,n,r),at.distancePointLine(e,n,r),at.distancePointLine(n,t,e),at.distancePointLine(r,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==C.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,r=new x;t.getCoordinate(0,r);for(var i=r.x,o=r.y,s=1;s<e;s++){t.getCoordinate(s,r);var a=r.x,u=r.y,c=a-i,l=u-o;n+=Math.sqrt(c*c+l*l),i=a,o=u}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new m("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],r=0,i=1;i<=e;i++){var o=t[i];o.y>n.y&&(n=o,r=i)}var s=r;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==r);var a=r;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==r);var u=t[s],c=t[a];if(u.equals2D(n)||c.equals2D(n)||u.equals2D(c))return!1;var l=at.computeOrientation(u,n,c);return 0===l?u.x>c.x:l>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var r=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),i=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/r;return Math.abs(i)*Math.sqrt(r)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new m("Line array must contain at least one vertex");for(var n=t.distance(e[0]),r=0;r<e.length-1;r++){var i=at.distancePointLine(t,e[r],e[r+1]);i<n&&(n=i)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),c=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u;if(c<=0)return o.distance(s);if(c>=1)return o.distance(a);var l=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u;return Math.abs(l)*Math.sqrt(u)}},at.isOnLine=function(t,e){for(var n=new it,r=1;r<e.length;r++){var i=e[r-1],o=e[r];if(n.computeIntersection(t,i,o),n.hasIntersection())return!0}return!1},ut.CLOCKWISE.get=function(){return-1},ut.RIGHT.get=function(){return at.CLOCKWISE},ut.COUNTERCLOCKWISE.get=function(){return 1},ut.LEFT.get=function(){return at.COUNTERCLOCKWISE},ut.COLLINEAR.get=function(){return 0},ut.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,ut);var ct=function(){};ct.prototype.filter=function(t){},ct.prototype.interfaces_=function(){return[]},ct.prototype.getClass=function(){return ct};var lt=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ht={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};lt.prototype.isGeometryCollection=function(){return this.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION},lt.prototype.getFactory=function(){return this._factory},lt.prototype.getGeometryN=function(t){return this},lt.prototype.getArea=function(){return 0},lt.prototype.isRectangle=function(){return!1},lt.prototype.equals=function(){if(arguments[0]instanceof lt){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof lt))return!1;var n=e;return this.equalsExact(n)}},lt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},lt.prototype.geometryChanged=function(){this.apply(lt.geometryChangedFilter)},lt.prototype.geometryChangedAction=function(){this._envelope=null},lt.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},lt.prototype.getLength=function(){return 0},lt.prototype.getNumGeometries=function(){return 1},lt.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],r=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,r)}},lt.prototype.getUserData=function(){return this._userData},lt.prototype.getSRID=function(){return this._SRID},lt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},lt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION)throw new m("This method does not support GeometryCollection arguments")},lt.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},lt.prototype.norm=function(){var t=this.copy();return t.normalize(),t},lt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},lt.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new q(this._envelope)},lt.prototype.setSRID=function(t){this._SRID=t},lt.prototype.setUserData=function(t){this._userData=t},lt.prototype.compare=function(t,e){for(var n=t.iterator(),r=e.iterator();n.hasNext()&&r.hasNext();){var i=n.next(),o=r.next(),s=i.compareTo(o);if(0!==s)return s}return n.hasNext()?1:r.hasNext()?-1:0},lt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},lt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===lt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===lt.SORTINDEX_MULTIPOINT||this.getSortIndex()===lt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===lt.SORTINDEX_MULTIPOLYGON},lt.prototype.interfaces_=function(){return[w,b,e]},lt.prototype.getClass=function(){return lt},lt.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},lt.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ht.serialVersionUID.get=function(){return 0x799ea46522854c00},ht.SORTINDEX_POINT.get=function(){return 0},ht.SORTINDEX_MULTIPOINT.get=function(){return 1},ht.SORTINDEX_LINESTRING.get=function(){return 2},ht.SORTINDEX_LINEARRING.get=function(){return 3},ht.SORTINDEX_MULTILINESTRING.get=function(){return 4},ht.SORTINDEX_POLYGON.get=function(){return 5},ht.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ht.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ht.geometryChangedFilter.get=function(){return At},Object.defineProperties(lt,ht);var At=function(){};At.interfaces_=function(){return[ct]},At.filter=function(t){t.geometryChangedAction()};var ft=function(){};ft.prototype.filter=function(t){},ft.prototype.interfaces_=function(){return[]},ft.prototype.getClass=function(){return ft};var pt=function(){},dt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};pt.prototype.isInBoundary=function(t){},pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},dt.Mod2BoundaryNodeRule.get=function(){return gt},dt.EndPointBoundaryNodeRule.get=function(){return yt},dt.MultiValentEndPointBoundaryNodeRule.get=function(){return mt},dt.MonoValentEndPointBoundaryNodeRule.get=function(){return _t},dt.MOD2_BOUNDARY_RULE.get=function(){return new gt},dt.ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},dt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new mt},dt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},dt.OGC_SFS_BOUNDARY_RULE.get=function(){return pt.MOD2_BOUNDARY_RULE},Object.defineProperties(pt,dt);var gt=function(){};gt.prototype.isInBoundary=function(t){return t%2==1},gt.prototype.interfaces_=function(){return[pt]},gt.prototype.getClass=function(){return gt};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>0},yt.prototype.interfaces_=function(){return[pt]},yt.prototype.getClass=function(){return yt};var mt=function(){};mt.prototype.isInBoundary=function(t){return t>1},mt.prototype.interfaces_=function(){return[pt]},mt.prototype.getClass=function(){return mt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 1===t},_t.prototype.interfaces_=function(){return[pt]},_t.prototype.getClass=function(){return _t};var vt=function(){};vt.prototype.add=function(){},vt.prototype.addAll=function(){},vt.prototype.isEmpty=function(){},vt.prototype.iterator=function(){},vt.prototype.size=function(){},vt.prototype.toArray=function(){},vt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var bt=function(){};bt.prototype.hasNext=function(){},bt.prototype.next=function(){},bt.prototype.remove=function(){};var wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(vt);(r.prototype=new Error).name="NoSuchElementException";var Et=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,vt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new xt(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,r=this.array_.length;n<r;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(wt),xt=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new r;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(bt),St=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.ensureCapacity(n.length),this.add(n,r)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],r=arguments[1];return this.add(n,r,!0),!0}if(arguments[0]instanceof x&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(i))return null;t.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],u=arguments[1];if(arguments[2])for(var c=0;c<a.length;c++)this.add(a[c],u);else for(var l=a.length-1;l>=0;l--)this.add(a[l],u);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof x){var h=arguments[0],A=arguments[1];if(!arguments[2]){var f=this.size();if(f>0){if(h>0&&this.get(h-1).equals2D(A))return null;if(h<f&&this.get(h).equals2D(A))return null}}t.prototype.add.call(this,h,A)}}else if(4===arguments.length){var p=arguments[0],d=arguments[1],g=arguments[2],y=arguments[3],m=1;g>y&&(m=-1);for(var _=g;_!==y;_+=m)this.add(p[_],d);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new x(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(Et),Pt=function(){},Tt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Tt.ForwardComparator.get=function(){return Ct},Tt.BidirectionalComparator.get=function(){return Mt},Tt.coordArrayType.get=function(){return new Array(0).fill(null)},Pt.prototype.interfaces_=function(){return[]},Pt.prototype.getClass=function(){return Pt},Pt.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Pt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(Pt.indexOf(r,e)<0)return r}return null},Pt.scroll=function(t,e){var n=Pt.indexOf(e,t);if(n<0)return null;var r=new Array(t.length).fill(null);Z.arraycopy(t,n,r,0,t.length-n),Z.arraycopy(t,0,r,t.length-n,n),Z.arraycopy(r,0,t,0,t.length)},Pt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];if(r===i)return!0;if(null===r||null===i)return!1;if(r.length!==i.length)return!1;for(var s=0;s<r.length;s++)if(0!==o.compare(r[s],i[s]))return!1;return!0}},Pt.intersection=function(t,e){for(var n=new St,r=0;r<t.length;r++)e.intersects(t[r])&&n.add(t[r],!0);return n.toCoordinateArray()},Pt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Pt.removeRepeatedPoints=function(t){return Pt.hasRepeatedPoints(t)?new St(t,!1).toCoordinateArray():t},Pt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),r=0;r<=n;r++){var i=t[r];t[r]=t[e-r],t[e-r]=i}},Pt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var r=new Array(e).fill(null);if(0===e)return r;for(var i=0,o=0;o<t.length;o++)null!==t[o]&&(r[i++]=t[o]);return r},Pt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new x(t[n]);return e}if(5===arguments.length)for(var r=arguments[0],i=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new x(r[i+u])},Pt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var r=t[n],i=e[t.length-n-1];if(0!==r.compareTo(i))return!1}return!0},Pt.envelope=function(t){for(var e=new q,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Pt.toCoordinateArray=function(t){return t.toArray(Pt.coordArrayType)},Pt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Pt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Pt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,r=t[e].compareTo(t[n]);if(0!==r)return r}return 1},Pt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var r=t[n].compareTo(e[n]);if(0!==r)return r;n++}return n<e.length?-1:n<t.length?1:0},Pt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Pt.extract=function(t,e,n){e=O.clamp(e,0,t.length);var r=(n=O.clamp(n,-1,t.length))-e+1;n<0&&(r=0),e>=t.length&&(r=0),n<e&&(r=0);var i=new Array(r).fill(null);if(0===r)return i;for(var o=0,s=e;s<=n;s++)i[o++]=t[s];return i},Object.defineProperties(Pt,Tt);var Ct=function(){};Ct.prototype.compare=function(t,e){return Pt.compare(t,e)},Ct.prototype.interfaces_=function(){return[E]},Ct.prototype.getClass=function(){return Ct};var Mt=function(){};Mt.prototype.compare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;var i=Pt.compare(n,r);return Pt.isEqualReversed(n,r)?0:i},Mt.prototype.OLDcompare=function(t,e){var n=t,r=e;if(n.length<r.length)return-1;if(n.length>r.length)return 1;if(0===n.length)return 0;for(var i=Pt.increasingDirection(n),o=Pt.increasingDirection(r),s=i>0?0:n.length-1,a=o>0?0:n.length-1,u=0;u<n.length;u++){var c=n[s].compareTo(r[a]);if(0!==c)return c;s+=i,a+=o}return 0},Mt.prototype.interfaces_=function(){return[E]},Mt.prototype.getClass=function(){return Mt};var It=function(){};It.prototype.get=function(){},It.prototype.put=function(){},It.prototype.size=function(){},It.prototype.values=function(){},It.prototype.entrySet=function(){};var Ot=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(It);(i.prototype=new Error).name="OperationNotSupported",(o.prototype=new vt).contains=function(){};var Rt=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof vt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Lt(this)},e}(o),Lt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new r;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new i},e}(bt),Nt=0;(h.prototype=new Ot).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},h.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Nt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,r,i=this.root_;do{if(n=i,(r=t.compareTo(i.key))<0)i=i.left;else{if(!(r>0)){var o=i.value;return i.value=e,o}i=i.right}}while(null!==i);var s={key:t,left:null,right:null,value:e,parent:n,color:Nt,getValue:function(){return this.value},getKey:function(){return this.key}};return r<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},h.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===c(a(a(t)))){var e=l(a(a(t)));1===s(e)?(u(a(t),Nt),u(e,Nt),u(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateLeft(t)),u(a(t),Nt),u(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=c(a(a(t)));1===s(n)?(u(a(t),Nt),u(n,Nt),u(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateRight(t)),u(a(t),Nt),u(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Nt},h.prototype.values=function(){var t=new Et,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=h.successor(e));)t.add(e.value);return t},h.prototype.entrySet=function(){var t=new Rt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=h.successor(e));)t.add(e);return t},h.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},h.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},h.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},h.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,r=t;null!==n&&r===n.right;)r=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var Dt=function(){};Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},A.prototype=new o,(f.prototype=new A).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new i},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new Ft(this)};var Ft=function(t){this.treeSet_=t,this.position_=0};Ft.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new r;return this.treeSet_.array_[this.position_++]},Ft.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Ft.prototype.remove=function(){throw new i};var kt=function(){};kt.sort=function(){var t,e,n,r,i=arguments[0];if(1===arguments.length)r=function(t,e){return t.compareTo(e)},i.sort(r);else if(2===arguments.length)n=arguments[1],r=function(t,e){return n.compare(t,e)},i.sort(r);else if(3===arguments.length){(e=i.slice(arguments[1],arguments[2])).sort();var o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length));for(i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])}else if(4===arguments.length)for(e=i.slice(arguments[1],arguments[2]),n=arguments[3],r=function(t,e){return n.compare(t,e)},e.sort(r),o=i.slice(0,arguments[1]).concat(e,i.slice(arguments[2],i.length)),i.splice(0,i.length),t=0;t<o.length;t++)i.push(o[t])},kt.asList=function(t){for(var e=new Et,n=0,r=t.length;n<r;n++)e.add(t[n]);return e};var Bt=function(){},jt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};jt.P.get=function(){return 0},jt.L.get=function(){return 1},jt.A.get=function(){return 2},jt.FALSE.get=function(){return-1},jt.TRUE.get=function(){return-2},jt.DONTCARE.get=function(){return-3},jt.SYM_FALSE.get=function(){return"F"},jt.SYM_TRUE.get=function(){return"T"},jt.SYM_DONTCARE.get=function(){return"*"},jt.SYM_P.get=function(){return"0"},jt.SYM_L.get=function(){return"1"},jt.SYM_A.get=function(){return"2"},Bt.prototype.interfaces_=function(){return[]},Bt.prototype.getClass=function(){return Bt},Bt.toDimensionSymbol=function(t){switch(t){case Bt.FALSE:return Bt.SYM_FALSE;case Bt.TRUE:return Bt.SYM_TRUE;case Bt.DONTCARE:return Bt.SYM_DONTCARE;case Bt.P:return Bt.SYM_P;case Bt.L:return Bt.SYM_L;case Bt.A:return Bt.SYM_A}throw new m("Unknown dimension value: "+t)},Bt.toDimensionValue=function(t){switch(D.toUpperCase(t)){case Bt.SYM_FALSE:return Bt.FALSE;case Bt.SYM_TRUE:return Bt.TRUE;case Bt.SYM_DONTCARE:return Bt.DONTCARE;case Bt.SYM_P:return Bt.P;case Bt.SYM_L:return Bt.L;case Bt.SYM_A:return Bt.A}throw new m("Unknown dimension symbol: "+t)},Object.defineProperties(Bt,jt);var Ut=function(){};Ut.prototype.filter=function(t){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var zt=function(){};zt.prototype.filter=function(t,e){},zt.prototype.isDone=function(){},zt.prototype.isGeometryChanged=function(){},zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt};var Gt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new m("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new q,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var r=this._geometries[n].getCoordinates(),i=0;i<r.length;i++)t[++e]=r[i];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._geometries.length!==r._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(r._geometries[i],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();kt.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=Bt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(kt.asList(this._geometries)),n=new f(kt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var r=arguments[1],i=arguments[0],o=this.getNumGeometries(),s=i.getNumGeometries(),a=0;a<o&&a<s;){var u=this.getGeometryN(a),c=i.getGeometryN(a),l=u.compareToSameClass(c,r);if(0!==l)return l;a++}return a<o?1:a<s?-1:0}},e.prototype.apply=function(){if(I(arguments[0],ft))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(I(arguments[0],zt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(n),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else if(I(arguments[0],Ut)){var i=arguments[0];i.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(i)}else if(I(arguments[0],ct)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(lt),Vt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new Zt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Gt),Zt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=pt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=r}};Zt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},Zt.prototype.getBoundary=function(){return this._geom instanceof Yt?this.boundaryLineString(this._geom):this._geom instanceof Vt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},Zt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},Zt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},Zt.prototype.computeBoundaryCoordinates=function(t){var e=new Et;this._endpointMap=new h;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);0!==r.getNumPoints()&&(this.addEndpoint(r.getCoordinateN(0)),this.addEndpoint(r.getCoordinateN(r.getNumPoints()-1)))}for(var i=this._endpointMap.entrySet().iterator();i.hasNext();){var o=i.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Pt.toCoordinateArray(e)},Zt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Ht,this._endpointMap.put(t,e)),e.count++},Zt.prototype.interfaces_=function(){return[]},Zt.prototype.getClass=function(){return Zt},Zt.getBoundary=function(){return 1===arguments.length?new Zt(arguments[0]).getBoundary():2===arguments.length?new Zt(arguments[0],arguments[1]).getBoundary():void 0};var Ht=function(){this.count=null};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht};var qt=function(){},Wt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.chars=function(t,e){for(var n=new Array(e).fill(null),r=0;r<e;r++)n[r]=t;return String(n)},qt.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var r=arguments[0],i=arguments[1],o="",s=new function(){}(new function(){}(qt.getStackTrace(r))),a=0;a<i;a++)try{o+=s.readLine()+qt.NEWLINE}catch(t){if(!(t instanceof p))throw t;et.shouldNeverReachHere()}return o}},qt.split=function(t,e){for(var n=e.length,r=new Et,i=""+t,o=i.indexOf(e);o>=0;){var s=i.substring(0,o);r.add(s),o=(i=i.substring(o+n)).indexOf(e)}i.length>0&&r.add(i);for(var a=new Array(r.size()).fill(null),u=0;u<a.length;u++)a[u]=r.get(u);return a},qt.toString=function(){if(1===arguments.length){var t=arguments[0];return qt.SIMPLE_ORDINATE_FORMAT.format(t)}},qt.spaces=function(t){return qt.chars(" ",t)},Wt.NEWLINE.get=function(){return Z.getProperty("line.separator")},Wt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(qt,Wt);var Xt=function(){};Xt.prototype.interfaces_=function(){return[]},Xt.prototype.getClass=function(){return Xt},Xt.copyCoord=function(t,e,n,r){for(var i=Math.min(t.getDimension(),n.getDimension()),o=0;o<i;o++)n.setOrdinate(r,o,t.getOrdinate(e,o))},Xt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,U.X)===t.getOrdinate(e-1,U.X)&&t.getOrdinate(0,U.Y)===t.getOrdinate(e-1,U.Y)},Xt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var r=Math.min(t.getDimension(),e.getDimension()),i=0;i<n;i++)for(var o=0;o<r;o++){var s=t.getOrdinate(i,o),a=e.getOrdinate(i,o);if(!(t.getOrdinate(i,o)===e.getOrdinate(i,o)||_.isNaN(s)&&_.isNaN(a)))return!1}return!0},Xt.extend=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();if(Xt.copy(e,0,r,0,i),i>0)for(var o=i;o<n;o++)Xt.copy(e,i-1,r,o,1);return r},Xt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),r=0;r<=n;r++)Xt.swap(t,r,e-r)},Xt.swap=function(t,e,n){if(e===n)return null;for(var r=0;r<t.getDimension();r++){var i=t.getOrdinate(e,r);t.setOrdinate(e,r,t.getOrdinate(n,r)),t.setOrdinate(n,r,i)}},Xt.copy=function(t,e,n,r,i){for(var o=0;o<i;o++)Xt.copyCoord(t,e+o,n,r+o)},Xt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),r=new L;r.append("(");for(var i=0;i<e;i++){i>0&&r.append(" ");for(var o=0;o<n;o++)o>0&&r.append(","),r.append(qt.toString(t.getOrdinate(i,o)))}return r.append(")"),r.toString()}},Xt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Xt.createClosedRing(t,e,4):e.getOrdinate(0,U.X)===e.getOrdinate(n-1,U.X)&&e.getOrdinate(0,U.Y)===e.getOrdinate(n-1,U.Y)?e:Xt.createClosedRing(t,e,n+1)},Xt.createClosedRing=function(t,e,n){var r=t.create(n,e.getDimension()),i=e.size();Xt.copy(e,0,r,0,i);for(var o=i;o<n;o++)Xt.copy(e,0,r,o,1);return r};var Yt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new q:this._points.expandEnvelope(new q)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e;if(this._points.size()!==r._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),r._points.getCoordinate(i),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Xt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Bt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var r=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==r)return r;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var i=arguments[0];return arguments[1].compare(this._points,i._points)}},e.prototype.apply=function(){if(I(arguments[0],ft))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(I(arguments[0],zt)){var n=arguments[0];if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(n.filter(this._points,r),!n.isDone());r++);n.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],Ut)||I(arguments[0],ct))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new Zt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new m("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Dt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(lt),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var Kt=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new q;var t=new q;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(I(arguments[0],ft)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(I(arguments[0],zt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(I(arguments[0],Ut)||I(arguments[0],ct))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(lt),Jt=function(){};Jt.prototype.interfaces_=function(){return[]},Jt.prototype.getClass=function(){return Jt};var $t=function(t){function e(e,n,r){if(t.call(this,r),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new m("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new m("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),r=0;r<n.length;r++)t[++e]=n[r];for(var i=0;i<this._holes.length;i++)for(var o=this._holes[i].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var r=t.getX(n);if(r!==e.getMinX()&&r!==e.getMaxX())return!1;var i=t.getY(n);if(i!==e.getMinY()&&i!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),c=t.getY(a);if(u!==o==(c!==s))return!1;o=u,s=c}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var r=e,i=this._shell,o=r._shell;if(!i.equalsExact(o,n))return!1;if(this._holes.length!==r._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(r._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);kt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var r=new Array(e.getCoordinates().length-1).fill(null);Z.arraycopy(e.getCoordinates(),0,r,0,r.length);var i=Pt.minCoordinate(e.getCoordinates());Pt.scroll(r,i),Z.arraycopy(r,0,e.getCoordinates(),0,r.length),e.getCoordinates()[r.length]=r[0],at.isCCW(e.getCoordinates())===n&&Pt.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var r=arguments[1],i=arguments[0],o=this._shell,s=i._shell,a=o.compareToSameClass(s,r);if(0!==a)return a;for(var u=this.getNumInteriorRing(),c=i.getNumInteriorRing(),l=0;l<u&&l<c;){var h=this.getInteriorRingN(l),A=i.getInteriorRingN(l),f=h.compareToSameClass(A,r);if(0!==f)return f;l++}return l<u?1:l<c?-1:0}},e.prototype.apply=function(t){if(I(t,ft)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(I(t,zt)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(I(t,Ut))t.filter(this);else if(I(t,ct)){t.filter(this),this._shell.apply(t);for(var r=0;r<this._holes.length;r++)this._holes[r].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),r=0;r<n.length;r++)n[r]=this._holes[r].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(lt),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Gt),ee=function(t){function e(e,n){e instanceof x&&n instanceof ye&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return Bt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Xt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new m("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new m("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Yt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return lt.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Et,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),r=0;r<n.getNumGeometries();r++)t.add(n.getGeometryN(r));var i=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(i))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Jt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Gt),re=function(t){this._factory=t||null,this._isUserDataCopied=!1},ie={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};re.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},re.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},re.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Gt?this.editGeometryCollection(t,e):t instanceof $t?this.editPolygon(t,e):t instanceof Kt||t instanceof Yt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},re.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),r=new Et,i=0;i<n.getNumGeometries();i++){var o=this.edit(n.getGeometryN(i),e);null===o||o.isEmpty()||r.add(o)}return n.getClass()===te?this._factory.createMultiPoint(r.toArray([])):n.getClass()===Vt?this._factory.createMultiLineString(r.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(r.toArray([])):this._factory.createGeometryCollection(r.toArray([]))},re.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var r=this.edit(n.getExteriorRing(),e);if(null===r||r.isEmpty())return this._factory.createPolygon();for(var i=new Et,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||i.add(s)}return this._factory.createPolygon(r,i.toArray([]))},re.prototype.interfaces_=function(){return[]},re.prototype.getClass=function(){return re},re.GeometryEditorOperation=function(){},ie.NoOpGeometryOperation.get=function(){return oe},ie.CoordinateOperation.get=function(){return se},ie.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(re,ie);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Yt?e.createLineString(n):t instanceof Kt?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Yt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof Kt?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[re.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var ue=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new x}else if(I(arguments[0],U)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=n.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1];this._coordinates=i,this._dimension=o,null===i&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var u=0;u<s;u++)this._coordinates[u]=new x}},ce={serialVersionUID:{configurable:!0}};ue.prototype.setOrdinate=function(t,e,n){switch(e){case U.X:this._coordinates[t].x=n;break;case U.Y:this._coordinates[t].y=n;break;case U.Z:this._coordinates[t].z=n;break;default:throw new m("invalid ordinateIndex")}},ue.prototype.size=function(){return this._coordinates.length},ue.prototype.getOrdinate=function(t,e){switch(e){case U.X:return this._coordinates[t].x;case U.Y:return this._coordinates[t].y;case U.Z:return this._coordinates[t].z}return _.NaN},ue.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},ue.prototype.getCoordinateCopy=function(t){return new x(this._coordinates[t])},ue.prototype.getDimension=function(){return this._dimension},ue.prototype.getX=function(t){return this._coordinates[t].x},ue.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new ue(t,this._dimension)},ue.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},ue.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new ue(t,this._dimension)},ue.prototype.toString=function(){if(this._coordinates.length>0){var t=new L(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},ue.prototype.getY=function(t){return this._coordinates[t].y},ue.prototype.toCoordinateArray=function(){return this._coordinates},ue.prototype.interfaces_=function(){return[U,e]},ue.prototype.getClass=function(){return ue},ce.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(ue,ce);var le=function(){},he={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};le.prototype.readResolve=function(){return le.instance()},le.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new ue(arguments[0]);if(I(arguments[0],U))return new ue(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new ue(t):new ue(t,e)}},le.prototype.interfaces_=function(){return[T,e]},le.prototype.getClass=function(){return le},le.instance=function(){return le.instanceObject},he.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},he.instanceObject.get=function(){return new le},Object.defineProperties(le,he);var Ae=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Et,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Rt;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(It),fe=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof de){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}},pe={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};fe.prototype.equals=function(t){if(!(t instanceof fe))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},fe.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),r=e.getMaximumSignificantDigits();return new N(n).compareTo(new N(r))},fe.prototype.getScale=function(){return this._scale},fe.prototype.isFloating=function(){return this._modelType===fe.FLOATING||this._modelType===fe.FLOATING_SINGLE},fe.prototype.getType=function(){return this._modelType},fe.prototype.toString=function(){var t="UNKNOWN";return this._modelType===fe.FLOATING?t="Floating":this._modelType===fe.FLOATING_SINGLE?t="Floating-Single":this._modelType===fe.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},fe.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return _.isNaN(t)||this._modelType===fe.FLOATING_SINGLE?t:this._modelType===fe.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof x){var e=arguments[0];if(this._modelType===fe.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},fe.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===fe.FLOATING?t=16:this._modelType===fe.FLOATING_SINGLE?t=6:this._modelType===fe.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},fe.prototype.setScale=function(t){this._scale=Math.abs(t)},fe.prototype.interfaces_=function(){return[e,b]},fe.prototype.getClass=function(){return fe},fe.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},pe.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},pe.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(fe,pe);var de=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},ge={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};de.prototype.readResolve=function(){return de.nameToTypeMap.get(this._name)},de.prototype.toString=function(){return this._name},de.prototype.interfaces_=function(){return[e]},de.prototype.getClass=function(){return de},ge.serialVersionUID.get=function(){return-552860263173159e4},ge.nameToTypeMap.get=function(){return new Ae},Object.defineProperties(de,ge),fe.Type=de,fe.FIXED=new de("FIXED"),fe.FLOATING=new de("FLOATING"),fe.FLOATING_SINGLE=new de("FLOATING SINGLE");var ye=function t(){this._precisionModel=new fe,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?I(arguments[0],T)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof fe&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},me={serialVersionUID:{configurable:!0}};ye.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new x(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new x(t.getMinX(),t.getMinY()),new x(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new x(t.getMinX(),t.getMinY()),new x(t.getMinX(),t.getMaxY()),new x(t.getMaxX(),t.getMaxY()),new x(t.getMaxX(),t.getMinY()),new x(t.getMinX(),t.getMinY())]),null)},ye.prototype.createLineString=function(t){return t?t instanceof Array?new Yt(this.getCoordinateSequenceFactory().create(t),this):I(t,U)?new Yt(t,this):void 0:new Yt(this.getCoordinateSequenceFactory().create([]),this)},ye.prototype.createMultiLineString=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},ye.prototype.buildGeometry=function(t){for(var e=null,n=!1,r=!1,i=t.iterator();i.hasNext();){var o=i.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(r=!0)}if(null===e)return this.createGeometryCollection();if(n||r)return this.createGeometryCollection(ye.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof $t)return this.createMultiPolygon(ye.toPolygonArray(t));if(a instanceof Yt)return this.createMultiLineString(ye.toLineStringArray(t));if(a instanceof Kt)return this.createMultiPoint(ye.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},ye.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},ye.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof x){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(I(arguments[0],U))return new Kt(arguments[0],this)}},ye.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},ye.prototype.createPolygon=function(){if(0===arguments.length)return new $t(null,null,this);if(1===arguments.length){if(I(arguments[0],U)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new $t(arguments[0],arguments[1],this)},ye.prototype.getSRID=function(){return this._SRID},ye.prototype.createGeometryCollection=function(){return 0===arguments.length?new Gt(null,this):1===arguments.length?new Gt(arguments[0],this):void 0},ye.prototype.createGeometry=function(t){return new re(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},ye.prototype.getPrecisionModel=function(){return this._precisionModel},ye.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],U))return new ee(arguments[0],this)}},ye.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},ye.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(I(arguments[0],U)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),r=0;r<e.size();r++){var i=this.getCoordinateSequenceFactory().create(1,e.getDimension());Xt.copy(e,r,i,0,1),n[r]=this.createPoint(i)}return this.createMultiPoint(n)}}},ye.prototype.interfaces_=function(){return[e]},ye.prototype.getClass=function(){return ye},ye.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.getDefaultCoordinateSequenceFactory=function(){return le.instance()},ye.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},me.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(ye,me);var _e=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],ve=function(t){this.geometryFactory=t||new ye};ve.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!be[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_e.indexOf(n)?be[n].apply(this,[e.coordinates]):"GeometryCollection"===n?be[n].apply(this,[e.geometries]):be[n].apply(this,[e])},ve.prototype.write=function(t){var e=t.getGeometryType();if(!we[e])throw new Error("Geometry is not supported");return we[e].apply(this,[t])};var be={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!be[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=be.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new x(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new x(t[0],t[1]),new x(t[2],t[1]),new x(t[2],t[3]),new x(t[0],t[3]),new x(t[0],t[1])])},Point:function(t){var e=new x(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=be.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(be.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=be.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),r=[],i=1;i<t.length;++i){var o=t[i],s=be.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);r.push(a)}return this.geometryFactory.createPolygon(n,r)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(be.Polygon.apply(this,[r]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(this.read(r))}return this.geometryFactory.createGeometryCollection(e)}},we={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:we.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.Point.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),r=0;r<n.length;++r){var i=n[r];e.push(we.coordinate.apply(this,[i]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.LineString.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=we.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var r=0;r<t._holes.length;++r){var i=t._holes[r],o=we.LineString.apply(this,[i]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=we.Polygon.apply(this,[r]);e.push(i.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var r=t._geometries[n],i=r.getGeometryType();e.push(we[i].apply(this,[r]))}return{type:"GeometryCollection",geometries:e}}},Ee=function(t){this.geometryFactory=t||new ye,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ve(this.geometryFactory)};Ee.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===fe.FIXED&&this.reducePrecision(e),e},Ee.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var xe=function(){this.parser=new ve(this.geometryFactory)};xe.prototype.write=function(t){return this.parser.write(t)};var Se=function(){},Pe={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Se.prototype.interfaces_=function(){return[]},Se.prototype.getClass=function(){return Se},Se.opposite=function(t){return t===Se.LEFT?Se.RIGHT:t===Se.RIGHT?Se.LEFT:t},Pe.ON.get=function(){return 0},Pe.LEFT.get=function(){return 1},Pe.RIGHT.get=function(){return 2},Object.defineProperties(Se,Pe),(d.prototype=new Error).name="EmptyStackException",(g.prototype=new wt).add=function(t){return this.array_.push(t),!0},g.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},g.prototype.push=function(t){return this.array_.push(t),t},g.prototype.pop=function(t){if(0===this.array_.length)throw new d;return this.array_.pop()},g.prototype.peek=function(){if(0===this.array_.length)throw new d;return this.array_[this.array_.length-1]},g.prototype.empty=function(){return 0===this.array_.length},g.prototype.isEmpty=function(){return this.empty()},g.prototype.search=function(t){return this.array_.indexOf(t)},g.prototype.size=function(){return this.array_.length},g.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Te=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Te.prototype.getCoordinate=function(){return this._minCoord},Te.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Te.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],r=at.computeOrientation(this._minCoord,n,e),i=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&r===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&r===at.CLOCKWISE)&&(i=!0),i&&(this._minIndex=this._minIndex-1)},Te.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var r=Se.LEFT;return n[e].y<n[e+1].y&&(r=Se.RIGHT),r},Te.prototype.getEdge=function(){return this._orientedDe},Te.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Te.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Te.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Se.LEFT&&(this._orientedDe=this._minDe.getSym())},Te.prototype.interfaces_=function(){return[]},Te.prototype.getClass=function(){return Te};var Ce=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new x(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}($),Me=function(){this.array_=[]};Me.prototype.addLast=function(t){this.array_.push(t)},Me.prototype.removeFirst=function(){return this.array_.shift()},Me.prototype.isEmpty=function(){return 0===this.array_.length};var Ie=function(){this._finder=null,this._dirEdgeList=new Et,this._nodes=new Et,this._rightMostCoord=null,this._env=null,this._finder=new Te};Ie.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Ie.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Ie.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var r=n.next();if(r.isVisited()||r.getSym().isVisited()){e=r;break}}if(null===e)throw new Ce("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var i=t.getEdges().iterator();i.hasNext();){var o=i.next();o.setVisited(!0),this.copySymDepths(o)}},Ie.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Se.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Ie.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Ie.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Se.RIGHT)>=1&&e.getDepth(Se.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Ie.prototype.computeDepths=function(t){var e=new Rt,n=new Me,r=t.getNode();for(n.addLast(r),e.add(r),t.setVisited(!0);!n.isEmpty();){var i=n.removeFirst();e.add(i),this.computeNodeDepth(i);for(var o=i.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Ie.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Ie.prototype.getEnvelope=function(){if(null===this._env){for(var t=new q,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),r=0;r<n.length-1;r++)t.expandToInclude(n[r]);this._env=t}return this._env},Ie.prototype.addReachable=function(t){var e=new g;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Ie.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Se.LEFT,t.getDepth(Se.RIGHT)),e.setDepth(Se.RIGHT,t.getDepth(Se.LEFT))},Ie.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var r=n.next();this._dirEdgeList.add(r);var i=r.getSym().getNode();i.isVisited()||e.push(i)}},Ie.prototype.getNodes=function(){return this._nodes},Ie.prototype.getDirectedEdges=function(){return this._dirEdgeList},Ie.prototype.interfaces_=function(){return[b]},Ie.prototype.getClass=function(){return Ie};var Oe=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Se.ON]=n}else if(arguments[0]instanceof t){var r=arguments[0];if(this.init(r.location.length),null!==r)for(var i=0;i<this.location.length;i++)this.location[i]=r.location[i]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Se.ON]=o,this.location[Se.LEFT]=s,this.location[Se.RIGHT]=a}};Oe.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Oe.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==C.NONE)return!1;return!0},Oe.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===C.NONE&&(this.location[e]=t)},Oe.prototype.isLine=function(){return 1===this.location.length},Oe.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Se.ON]=this.location[Se.ON],e[Se.LEFT]=C.NONE,e[Se.RIGHT]=C.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===C.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Oe.prototype.getLocations=function(){return this.location},Oe.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Se.LEFT];this.location[Se.LEFT]=this.location[Se.RIGHT],this.location[Se.RIGHT]=t},Oe.prototype.toString=function(){var t=new L;return this.location.length>1&&t.append(C.toLocationSymbol(this.location[Se.LEFT])),t.append(C.toLocationSymbol(this.location[Se.ON])),this.location.length>1&&t.append(C.toLocationSymbol(this.location[Se.RIGHT])),t.toString()},Oe.prototype.setLocations=function(t,e,n){this.location[Se.ON]=t,this.location[Se.LEFT]=e,this.location[Se.RIGHT]=n},Oe.prototype.get=function(t){return t<this.location.length?this.location[t]:C.NONE},Oe.prototype.isArea=function(){return this.location.length>1},Oe.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===C.NONE)return!0;return!1},Oe.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Se.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Oe.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(C.NONE)},Oe.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Oe.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe};var Re=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Oe(e),this.elt[1]=new Oe(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Oe(n.elt[0]),this.elt[1]=new Oe(n.elt[1])}}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.elt[0]=new Oe(C.NONE),this.elt[1]=new Oe(C.NONE),this.elt[r].setLocation(i)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Oe(o,s,a),this.elt[1]=new Oe(o,s,a)}else if(4===arguments.length){var u=arguments[0],c=arguments[1],l=arguments[2],h=arguments[3];this.elt[0]=new Oe(C.NONE,C.NONE,C.NONE),this.elt[1]=new Oe(C.NONE,C.NONE,C.NONE),this.elt[u].setLocations(c,l,h)}};Re.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Re.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Re.prototype.isNull=function(t){return this.elt[t].isNull()},Re.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Re.prototype.isLine=function(t){return this.elt[t].isLine()},Re.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Oe(t.elt[e]):this.elt[e].merge(t.elt[e])},Re.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Re.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Se.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Re.prototype.toString=function(){var t=new L;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Re.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Re.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Re.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Se.ON,e)}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this.elt[n].setLocation(r,i)}},Re.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Re.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Re.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Oe(this.elt[t].location[0]))},Re.prototype.interfaces_=function(){return[]},Re.prototype.getClass=function(){return Re},Re.toLineLabel=function(t){for(var e=new Re(C.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Le=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Et,this._pts=new Et,this._label=new Re(C.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Et,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Le.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Le.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Le.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Ce("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Ce("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var r=e.getLabel();et.isTrue(r.isArea()),this.mergeLabel(r),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Le.prototype.getLinearRing=function(){return this._ring},Le.prototype.getCoordinate=function(t){return this._pts.get(t)},Le.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Le.prototype.addPoints=function(t,e,n){var r=t.getCoordinates();if(e){var i=1;n&&(i=0);for(var o=i;o<r.length;o++)this._pts.add(r[o])}else{var s=r.length-2;n&&(s=r.length-1);for(var a=s;a>=0;a--)this._pts.add(r[a])}},Le.prototype.isHole=function(){return this._isHole},Le.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Le.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Le.prototype.addHole=function(t){this._holes.add(t)},Le.prototype.isShell=function(){return null===this._shell},Le.prototype.getLabel=function(){return this._label},Le.prototype.getEdges=function(){return this._edges},Le.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Le.prototype.getShell=function(){return this._shell},Le.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Se.RIGHT);if(n===C.NONE)return null;if(this._label.getLocation(e)===C.NONE)return this._label.setLocation(e,n),null}},Le.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Le.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Le.prototype.interfaces_=function(){return[]},Le.prototype.getClass=function(){return Le};var Ne=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),De=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Et,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Ne(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Le),Fe=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};Fe.prototype.setVisited=function(t){this._isVisited=t},Fe.prototype.setInResult=function(t){this._isInResult=t},Fe.prototype.isCovered=function(){return this._isCovered},Fe.prototype.isCoveredSet=function(){return this._isCoveredSet},Fe.prototype.setLabel=function(t){this._label=t},Fe.prototype.getLabel=function(){return this._label},Fe.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},Fe.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},Fe.prototype.isInResult=function(){return this._isInResult},Fe.prototype.isVisited=function(){return this._isVisited},Fe.prototype.interfaces_=function(){return[]},Fe.prototype.getClass=function(){return Fe};var ke=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Re(0,C.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=C.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var r=t.getLocation(e);n!==C.BOUNDARY&&(n=r)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Re(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Re)for(var n=arguments[0],r=0;r<2;r++){var i=this.computeMergedLocation(n,r);this._label.getLocation(r)===C.NONE&&this._label.setLocation(r,i)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=C.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case C.BOUNDARY:n=C.INTERIOR;break;case C.INTERIOR:default:n=C.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Fe),Be=function(){this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};Be.prototype.find=function(t){return this.nodeMap.get(t)},Be.prototype.addNode=function(){if(arguments[0]instanceof x){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof ke){var n=arguments[0],r=this.nodeMap.get(n.getCoordinate());return null===r?(this.nodeMap.put(n.getCoordinate(),n),n):(r.mergeLabel(n),r)}},Be.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},Be.prototype.iterator=function(){return this.nodeMap.values().iterator()},Be.prototype.values=function(){return this.nodeMap.values()},Be.prototype.getBoundaryNodes=function(t){for(var e=new Et,n=this.iterator();n.hasNext();){var r=n.next();r.getLabel().getLocation(t)===C.BOUNDARY&&e.add(r)}return e},Be.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be};var je=function(){},Ue={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};je.prototype.interfaces_=function(){return[]},je.prototype.getClass=function(){return je},je.isNorthern=function(t){return t===je.NE||t===je.NW},je.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},je.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},je.isInHalfPlane=function(t,e){return e===je.SE?t===je.SE||t===je.SW:t===e||t===e+1},je.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?je.NE:je.SE:e>=0?je.NW:je.SW}if(arguments[0]instanceof x&&arguments[1]instanceof x){var n=arguments[0],r=arguments[1];if(r.x===n.x&&r.y===n.y)throw new m("Cannot compute the quadrant for two identical points "+n);return r.x>=n.x?r.y>=n.y?je.NE:je.SE:r.y>=n.y?je.NW:je.SW}},Ue.NE.get=function(){return 0},Ue.NW.get=function(){return 1},Ue.SW.get=function(){return 2},Ue.SE.get=function(){return 3},Object.defineProperties(je,Ue);var ze=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._edge=e,this.init(n,r),this._label=null}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=i,this.init(o,s),this._label=a}};ze.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},ze.prototype.getDy=function(){return this._dy},ze.prototype.getCoordinate=function(){return this._p0},ze.prototype.setNode=function(t){this._node=t},ze.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},ze.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},ze.prototype.getDirectedCoordinate=function(){return this._p1},ze.prototype.getDx=function(){return this._dx},ze.prototype.getLabel=function(){return this._label},ze.prototype.getEdge=function(){return this._edge},ze.prototype.getQuadrant=function(){return this._quadrant},ze.prototype.getNode=function(){return this._node},ze.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},ze.prototype.computeLabel=function(t){},ze.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=je.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},ze.prototype.interfaces_=function(){return[b]},ze.prototype.getClass=function(){return ze};var Ge=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var r=e.getNumPoints()-1;this.init(e.getCoordinate(r),e.getCoordinate(r-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Re(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Ce("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Se.LEFT)===C.INTERIOR&&this._label.getLocation(e,Se.RIGHT)===C.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Se.LEFT]+"/"+this._depth[Se.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,C.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,C.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var r=1;t===Se.LEFT&&(r=-1);var i=Se.opposite(t),o=e+n*r;this.setDepth(t,e),this.setDepth(i,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===C.EXTERIOR&&e===C.INTERIOR?1:t===C.INTERIOR&&e===C.EXTERIOR?-1:0},e}(ze),Ve=function(){};Ve.prototype.createNode=function(t){return new ke(t,null)},Ve.prototype.interfaces_=function(){return[]},Ve.prototype.getClass=function(){return Ve};var Ze=function(){if(this._edges=new Et,this._nodes=null,this._edgeEndList=new Et,0===arguments.length)this._nodes=new Be(new Ve);else if(1===arguments.length){var t=arguments[0];this._nodes=new Be(t)}};Ze.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ze.prototype.find=function(t){return this._nodes.find(t)},Ze.prototype.addNode=function(){if(arguments[0]instanceof ke){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof x){var e=arguments[0];return this._nodes.addNode(e)}},Ze.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ze.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},Ze.prototype.debugPrintln=function(t){Z.out.println(t)},Ze.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var r=n.getLabel();return null!==r&&r.getLocation(t)===C.BOUNDARY},Ze.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},Ze.prototype.matchInSameDirection=function(t,e,n,r){return!!t.equals(n)&&at.computeOrientation(t,e,r)===at.COLLINEAR&&je.quadrant(t,e)===je.quadrant(n,r)},Ze.prototype.getEdgeEnds=function(){return this._edgeEndList},Ze.prototype.debugPrint=function(t){Z.out.print(t)},Ze.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ze.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(this.matchInSameDirection(t,e,i[0],i[1]))return r;if(this.matchInSameDirection(t,e,i[i.length-1],i[i.length-2]))return r}return null},Ze.prototype.insertEdge=function(t){this._edges.add(t)},Ze.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ze.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var r=new Ge(n,!0),i=new Ge(n,!1);r.setSym(i),i.setSym(r),this.add(r),this.add(i)}},Ze.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ze.prototype.getNodes=function(){return this._nodes.values()},Ze.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var r=this._edges.get(n),i=r.getCoordinates();if(t.equals(i[0])&&e.equals(i[1]))return r}return null},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze},Ze.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var He=function(){this._geometryFactory=null,this._shellList=new Et;var t=arguments[0];this._geometryFactory=t};He.prototype.sortShellsAndHoles=function(t,e,n){for(var r=t.iterator();r.hasNext();){var i=r.next();i.isHole()?n.add(i):e.add(i)}},He.prototype.computePolygons=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var r=n.next().toPolygon(this._geometryFactory);e.add(r)}return e},He.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(null===r.getShell()){var i=this.findEdgeRingContaining(r,t);if(null===i)throw new Ce("unable to assign hole to a shell",r.getCoordinate(0));r.setShell(i)}}},He.prototype.buildMinimalEdgeRings=function(t,e,n){for(var r=new Et,i=t.iterator();i.hasNext();){var o=i.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else r.add(o)}return r},He.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},He.prototype.buildMaximalEdgeRings=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var r=n.next();if(r.isInResult()&&r.getLabel().isArea()&&null===r.getEdgeRing()){var i=new De(r,this._geometryFactory);e.add(i),i.setInResult()}}return e},He.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.isHole()&&r.setShell(t)}},He.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},He.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),r=n.getEnvelopeInternal(),i=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),c=u.getLinearRing(),l=c.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;l.contains(r)&&at.isPointInRing(i,c.getCoordinates())&&(h=!0),h&&(null===o||s.contains(l))&&(o=u)}return o},He.prototype.findShell=function(t){for(var e=0,n=null,r=t.iterator();r.hasNext();){var i=r.next();i.isHole()||(n=i,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},He.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Ze.linkResultDirectedEdges(n);var r=this.buildMaximalEdgeRings(e),i=new Et,o=this.buildMinimalEdgeRings(r,this._shellList,i);this.sortShellsAndHoles(o,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var qe=function(){};qe.prototype.getBounds=function(){},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe};var We=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};We.prototype.getItem=function(){return this._item},We.prototype.getBounds=function(){return this._bounds},We.prototype.interfaces_=function(){return[qe,e]},We.prototype.getClass=function(){return We};var Xe=function(){this._size=null,this._items=null,this._size=0,this._items=new Et,this._items.add(null)};Xe.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Xe.prototype.size=function(){return this._size},Xe.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Xe.prototype.clear=function(){this._size=0,this._items.clear()},Xe.prototype.isEmpty=function(){return 0===this._size},Xe.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Xe.prototype.interfaces_=function(){return[]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){};Ye.prototype.visitItem=function(t){},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Qe=function(){};Qe.prototype.insert=function(t,e){},Qe.prototype.remove=function(t,e){},Qe.prototype.query=function(){},Qe.prototype.interfaces_=function(){return[]},Qe.prototype.getClass=function(){return Qe};var Ke=function(){if(this._childBoundables=new Et,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Je={serialVersionUID:{configurable:!0}};Ke.prototype.getLevel=function(){return this._level},Ke.prototype.size=function(){return this._childBoundables.size()},Ke.prototype.getChildBoundables=function(){return this._childBoundables},Ke.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},Ke.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Ke.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Ke.prototype.interfaces_=function(){return[qe,e]},Ke.prototype.getClass=function(){return Ke},Je.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Ke,Je);var $e=function(){};$e.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},$e.min=function(t){return $e.sort(t),t.get(0)},$e.sort=function(t,e){var n=t.toArray();e?kt.sort(n,e):kt.sort(n);for(var r=t.iterator(),i=0,o=n.length;i<o;i++)r.next(),r.set(n[i])},$e.singletonList=function(t){var e=new Et;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),r=tn.isComposite(this._boundable2);if(n&&r)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(r)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new m("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,r){for(var i=t.getChildBoundables().iterator();i.hasNext();){var o=i.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<r&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[b]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof Ke};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Et,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ke?t+=this.size(n):n instanceof We&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,r=t.getChildBoundables().iterator();r.hasNext();){var i=r.next();i instanceof We&&i.getItem()===e&&(n=i)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Et:t}if(1===arguments.length){for(var e=arguments[0],n=new Et,r=e.getChildBoundables().iterator();r.hasNext();){var i=r.next();if(i instanceof Ke){var o=this.itemsTree(i);null!==o&&n.add(o)}else i instanceof We?n.add(i.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new We(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Et;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];if(et.isTrue(n>-2),r.getLevel()===n)return i.add(r),null;for(var o=r.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Ke?this.boundablesAtLevel(n,s,i):(et.isTrue(s instanceof We),-1===n&&i.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Et;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],r=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r)}else if(3===arguments.length)if(I(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var i=arguments[0],o=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var u=s.get(a);this.getIntersectsOp().intersects(u.getBounds(),i)&&(u instanceof Ke?this.query(i,u,o):u instanceof We?o.visitItem(u.getItem()):et.shouldNeverReachHere())}else if(I(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke)for(var c=arguments[0],l=arguments[2],h=arguments[1].getChildBoundables(),A=0;A<h.size();A++){var f=h.get(A);this.getIntersectsOp().intersects(f.getBounds(),c)&&(f instanceof Ke?this.query(c,f,l):f instanceof We?l.add(f.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=this.removeItem(r,i);if(o)return!0;for(var s=null,a=r.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Ke&&(o=this.remove(n,u,i))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&r.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ke){var r=this.depth(n);r>t&&(t=r)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new Et;n.add(this.createNode(e));var r=new Et(t);$e.sort(r,this.getComparator());for(var i=r.iterator();i.hasNext();){var o=i.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var r={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new Et,r=0;r<t.length;r++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[r],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),r=new Array(e).fill(null),i=t.iterator(),o=0;o<e;o++){r[o]=new Et;for(var s=0;i.hasNext()&&s<n;){var a=i.next();r[o].add(a),s++}}return r},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],r=arguments[1];t.prototype.query.call(this,n,r)}else if(3===arguments.length)if(I(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var i=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,i,o,s)}else if(I(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof Ke){var a=arguments[0],u=arguments[1],c=arguments[2];t.prototype.query.call(this,a,u,c)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var r=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new Et(t);$e.sort(i,n.xComparator);var o=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(r))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(I(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var r=arguments[0];return this.nearestNeighbour(r,_.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&I(arguments[1],on)){var i=arguments[0],o=arguments[1],s=new tn(this.getRoot(),i.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],u=arguments[1],c=null,l=new Xe;for(l.add(a);!l.isEmpty()&&u>0;){var h=l.poll(),A=h.getDistance();if(A>=u)break;h.isLeaves()?(u=A,c=h):h.expandToQueue(l,u)}return[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else if(3===arguments.length){var f=arguments[2],p=new We(arguments[0],arguments[1]),d=new tn(this.getRoot(),p,f);return this.nearestNeighbour(d)[0]}},n.prototype.interfaces_=function(){return[Qe,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},r.STRtreeNode.get=function(){return an},r.serialVersionUID.get=function(){return 0x39920f7d5f261e0},r.xComparator.get=function(){return{interfaces_:function(){return[E]},compare:function(e,r){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(r.getBounds()))}}},r.yComparator.get=function(){return{interfaces_:function(){return[E]},compare:function(e,r){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(r.getBounds()))}}},r.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},r.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,r),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new q(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ke),un=function(){};un.prototype.interfaces_=function(){return[]},un.prototype.getClass=function(){return un},un.relativeSign=function(t,e){return t<e?-1:t>e?1:0},un.compare=function(t,e,n){if(e.equals2D(n))return 0;var r=un.relativeSign(e.x,n.x),i=un.relativeSign(e.y,n.y);switch(t){case 0:return un.compareValue(r,i);case 1:return un.compareValue(i,r);case 2:return un.compareValue(i,-r);case 3:return un.compareValue(-r,i);case 4:return un.compareValue(-r,-i);case 5:return un.compareValue(-i,-r);case 6:return un.compareValue(-i,r);case 7:return un.compareValue(r,-i)}return et.shouldNeverReachHere("invalid octant value"),0},un.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var cn=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._segString=t,this.coord=new x(e),this.segmentIndex=n,this._segmentOctant=r,this._isInterior=!e.equals2D(t.getCoordinate(n))};cn.prototype.getCoordinate=function(){return this.coord},cn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},cn.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:un.compare(this._segmentOctant,this.coord,e.coord)},cn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},cn.prototype.isInterior=function(){return this._isInterior},cn.prototype.interfaces_=function(){return[b]},cn.prototype.getClass=function(){return cn};var ln=function(){this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t};ln.prototype.getSplitCoordinates=function(){var t=new St;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next();this.addEdgeCoordinates(n,r,t),n=r}return t.toCoordinateArray()},ln.prototype.addCollapsedNodes=function(){var t=new Et;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},ln.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},ln.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),r=this._edge.getCoordinate(e+2);n.equals2D(r)&&t.add(new N(e+1))}},ln.prototype.addEdgeCoordinates=function(t,e,n){var r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);n.add(new x(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));i&&n.add(new x(e.coord))},ln.prototype.iterator=function(){return this._nodeMap.values().iterator()},ln.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},ln.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var r=e.segmentIndex-t.segmentIndex;return e.isInterior()||r--,1===r&&(n[0]=t.segmentIndex+1,!0)},ln.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),r=n.next();n.hasNext();){var i=n.next();this.findCollapseIndex(r,i,e)&&t.add(new N(e[0])),r=i}},ln.prototype.getEdge=function(){return this._edge},ln.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},ln.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this._edge.getCoordinate(e.segmentIndex),i=e.isInterior()||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new x(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return i&&(o[s]=new x(e.coord)),new pn(o,this._edge.getData())},ln.prototype.add=function(t,e){var n=new cn(this._edge,t,e,this._edge.getSegmentOctant(e)),r=this._nodeMap.get(n);return null!==r?(et.isTrue(r.coord.equals2D(t),"Found equal nodes with different coordinates"),r):(this._nodeMap.put(n,n),n)},ln.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new $("bad split edge start point at "+n);var r=t.get(t.size()-1).getCoordinates(),i=r[r.length-1];if(!i.equals2D(e[e.length-1]))throw new $("bad split edge end point at "+i)},ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln};var hn=function(){};hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new m("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),r=Math.abs(e);return t>=0?e>=0?n>=r?0:1:n>=r?7:6:e>=0?n>=r?3:2:n>=r?4:5}if(arguments[0]instanceof x&&arguments[1]instanceof x){var i=arguments[0],o=arguments[1],s=o.x-i.x,a=o.y-i.y;if(0===s&&0===a)throw new m("Cannot compute the octant for two identical points "+i);return hn.octant(s,a)}};var An=function(){};An.prototype.getCoordinates=function(){},An.prototype.size=function(){},An.prototype.getCoordinate=function(t){},An.prototype.isClosed=function(){},An.prototype.setData=function(t){},An.prototype.getData=function(){},An.prototype.interfaces_=function(){return[]},An.prototype.getClass=function(){return An};var fn=function(){};fn.prototype.addIntersection=function(t,e){},fn.prototype.interfaces_=function(){return[An]},fn.prototype.getClass=function(){return fn};var pn=function(){this._nodeList=new ln(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};pn.prototype.getCoordinates=function(){return this._pts},pn.prototype.size=function(){return this._pts.length},pn.prototype.getCoordinate=function(t){return this._pts[t]},pn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},pn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},pn.prototype.setData=function(t){this._data=t},pn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:hn.octant(t,e)},pn.prototype.getData=function(){return this._data},pn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],r=arguments[3],i=new x(arguments[0].getIntersection(r));this.addIntersection(i,n)}},pn.prototype.toString=function(){return J.toLineString(new ue(this._pts))},pn.prototype.getNodeList=function(){return this._nodeList},pn.prototype.addIntersectionNode=function(t,e){var n=e,r=n+1;if(r<this._pts.length){var i=this._pts[r];t.equals2D(i)&&(n=r)}return this._nodeList.add(t,n)},pn.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},pn.prototype.interfaces_=function(){return[fn]},pn.prototype.getClass=function(){return pn},pn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Et;return pn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(n)};var dn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new x,this.p1=new x;else if(1===arguments.length){var t=arguments[0];this.p0=new x(t.p0),this.p1=new x(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.p0=new x(e,n),this.p1=new x(r,i)}},gn={serialVersionUID:{configurable:!0}};dn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},dn.prototype.orientationIndex=function(){if(arguments[0]instanceof dn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof x){var r=arguments[0];return at.orientationIndex(this.p0,this.p1,r)}},dn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},dn.prototype.isVertical=function(){return this.p0.x===this.p1.x},dn.prototype.equals=function(t){if(!(t instanceof dn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},dn.prototype.intersection=function(t){var e=new it;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},dn.prototype.project=function(){if(arguments[0]instanceof x){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new x(t);var e=this.projectionFactor(t),n=new x;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof dn){var r=arguments[0],i=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(i>=1&&o>=1)return null;if(i<=0&&o<=0)return null;var s=this.project(r.p0);i<0&&(s=this.p0),i>1&&(s=this.p1);var a=this.project(r.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new dn(s,a)}},dn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},dn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},dn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},dn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},dn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},dn.prototype.midPoint=function(){return dn.midPoint(this.p0,this.p1)},dn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,r=e*e+n*n;return r<=0?_.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/r},dn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),r=_.MAX_VALUE,i=null,o=this.closestPoint(t.p0);r=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(i=s.distance(t.p1))<r&&(r=i,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(i=a.distance(this.p0))<r&&(r=i,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(i=u.distance(this.p1))<r&&(r=i,n[0]=this.p1,n[1]=u),n},dn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},dn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},dn.prototype.getLength=function(){return this.p0.distance(this.p1)},dn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},dn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},dn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},dn.prototype.lineIntersection=function(t){try{return H.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof V))throw t}return null},dn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},dn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),r=this.p0.y+t*(this.p1.y-this.p0.y),i=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(i*i+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*i/s,u=e*o/s}return new x(n-u,r+a)},dn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},dn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||_.isNaN(e))&&(e=1),e},dn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},dn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},dn.prototype.distance=function(){if(arguments[0]instanceof dn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof x){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},dn.prototype.pointAlong=function(t){var e=new x;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},dn.prototype.hashCode=function(){var t=_.doubleToLongBits(this.p0.x);t^=31*_.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=_.doubleToLongBits(this.p1.x);return n^=31*_.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},dn.prototype.interfaces_=function(){return[b,e]},dn.prototype.getClass=function(){return dn},dn.midPoint=function(t,e){return new x((t.x+e.x)/2,(t.y+e.y)/2)},gn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(dn,gn);var yn=function(){this.tempEnv1=new q,this.tempEnv2=new q,this._overlapSeg1=new dn,this._overlapSeg2=new dn};yn.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn};var mn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=r};mn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},mn.prototype.computeSelect=function(t,e,n,r){var i=this._pts[e],o=this._pts[n];if(r.tempEnv1.init(i,o),n-e==1)return r.select(this,e),null;if(!t.intersects(r.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,r),s<n&&this.computeSelect(t,s,n,r)},mn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},mn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},mn.prototype.setId=function(t){this._id=t},mn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},mn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new q(t,e)}return this._env},mn.prototype.getEndIndex=function(){return this._end},mn.prototype.getStartIndex=function(){return this._start},mn.prototype.getContext=function(){return this._context},mn.prototype.getId=function(){return this._id},mn.prototype.computeOverlapsInternal=function(t,e,n,r,i,o){var s=this._pts[t],a=this._pts[e],u=n._pts[r],c=n._pts[i];if(e-t==1&&i-r==1)return o.overlap(this,t,n,r),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,c),!o.tempEnv1.intersects(o.tempEnv2))return null;var l=Math.trunc((t+e)/2),h=Math.trunc((r+i)/2);t<l&&(r<h&&this.computeOverlapsInternal(t,l,n,r,h,o),h<i&&this.computeOverlapsInternal(t,l,n,h,i,o)),l<e&&(r<h&&this.computeOverlapsInternal(l,e,n,r,h,o),h<i&&this.computeOverlapsInternal(l,e,n,h,i,o))},mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.getChainStartIndices=function(t){var e=0,n=new Et;n.add(new N(e));do{var r=_n.findChainEnd(t,e);n.add(new N(r)),e=r}while(e<t.length-1);return _n.toIntArray(n)},_n.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var r=je.quadrant(t[n],t[n+1]),i=e+1;i<t.length&&(t[i-1].equals2D(t[i])||je.quadrant(t[i-1],t[i])===r);)i++;return i-1},_n.getChains=function(){if(1===arguments.length){var t=arguments[0];return _n.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],r=new Et,i=_n.getChainStartIndices(e),o=0;o<i.length-1;o++){var s=new mn(e,i[o],i[o+1],n);r.add(s)}return r}},_n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var vn=function(){};vn.prototype.computeNodes=function(t){},vn.prototype.getNodedSubstrings=function(){},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var bn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};bn.prototype.setSegmentIntersector=function(t){this._segInt=t},bn.prototype.interfaces_=function(){return[vn]},bn.prototype.getClass=function(){return bn};var wn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Et,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_n.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new En(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),r=this._index.query(n.getEnvelope()).iterator();r.hasNext();){var i=r.next();if(i.getId()>n.getId()&&(n.computeOverlaps(i,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return En},Object.defineProperties(e,n),e}(bn),En=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],r=arguments[3],i=arguments[0].getContext(),o=n.getContext();this._si.processIntersections(i,e,o,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(yn),xn=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(4===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Sn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};xn.prototype.getEndCapStyle=function(){return this._endCapStyle},xn.prototype.isSingleSided=function(){return this._isSingleSided},xn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=xn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=xn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==xn.JOIN_ROUND&&(this._quadrantSegments=xn.DEFAULT_QUADRANT_SEGMENTS)},xn.prototype.getJoinStyle=function(){return this._joinStyle},xn.prototype.setJoinStyle=function(t){this._joinStyle=t},xn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},xn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},xn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},xn.prototype.setEndCapStyle=function(t){this._endCapStyle=t},xn.prototype.getMitreLimit=function(){return this._mitreLimit},xn.prototype.setMitreLimit=function(t){this._mitreLimit=t},xn.prototype.setSingleSided=function(t){this._isSingleSided=t},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn},xn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Sn.CAP_ROUND.get=function(){return 1},Sn.CAP_FLAT.get=function(){return 2},Sn.CAP_SQUARE.get=function(){return 3},Sn.JOIN_ROUND.get=function(){return 1},Sn.JOIN_MITRE.get=function(){return 2},Sn.JOIN_BEVEL.get=function(){return 3},Sn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Sn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Sn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(xn,Sn);var Pn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},Tn={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Pn.prototype.isDeletable=function(t,e,n,r){var i=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(i,o,s)&&!!this.isShallow(i,o,s,r)&&this.isShallowSampled(i,o,t,n,r)},Pn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),r=!1;n<this._inputLine.length;){var i=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Pn.DELETE,i=!0,r=!0),t=i?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return r},Pn.prototype.isShallowConcavity=function(t,e,n,r){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<r},Pn.prototype.isShallowSampled=function(t,e,n,r,i){var o=Math.trunc((r-n)/Pn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<r;s+=o)if(!this.isShallow(t,e,this._inputLine[s],i))return!1;return!0},Pn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Pn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Pn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Pn.DELETE;)e++;return e},Pn.prototype.isShallow=function(t,e,n,r){return at.distancePointLine(e,t,n)<r},Pn.prototype.collapseLine=function(){for(var t=new St,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Pn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn},Pn.simplify=function(t,e){return new Pn(t).simplify(e)},Tn.INIT.get=function(){return 0},Tn.DELETE.get=function(){return 1},Tn.KEEP.get=function(){return 1},Tn.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Pn,Tn);var Cn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Et},Mn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Cn.prototype.getCoordinates=function(){return this._ptList.toArray(Cn.COORDINATE_ARRAY_TYPE)},Cn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Cn.prototype.addPt=function(t){var e=new x(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Cn.prototype.revere=function(){},Cn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var r=t.length-1;r>=0;r--)this.addPt(t[r])},Cn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Cn.prototype.toString=function(){return(new ye).createLineString(this.getCoordinates()).toString()},Cn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new x(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Cn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Mn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Cn,Mn);var In=function(){},On={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};In.prototype.interfaces_=function(){return[]},In.prototype.getClass=function(){return In},In.toDegrees=function(t){return 180*t/Math.PI},In.normalize=function(t){for(;t>Math.PI;)t-=In.PI_TIMES_2;for(;t<=-Math.PI;)t+=In.PI_TIMES_2;return t},In.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],r=n.x-e.x,i=n.y-e.y;return Math.atan2(i,r)}},In.isAcute=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)>0},In.isObtuse=function(t,e,n){var r=t.x-e.x,i=t.y-e.y;return r*(n.x-e.x)+i*(n.y-e.y)<0},In.interiorAngle=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n);return Math.abs(i-r)},In.normalizePositive=function(t){if(t<0){for(;t<0;)t+=In.PI_TIMES_2;t>=In.PI_TIMES_2&&(t=0)}else{for(;t>=In.PI_TIMES_2;)t-=In.PI_TIMES_2;t<0&&(t=0)}return t},In.angleBetween=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n);return In.diff(r,i)},In.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},In.toRadians=function(t){return t*Math.PI/180},In.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?In.COUNTERCLOCKWISE:n<0?In.CLOCKWISE:In.NONE},In.angleBetweenOriented=function(t,e,n){var r=In.angle(e,t),i=In.angle(e,n)-r;return i<=-Math.PI?i+In.PI_TIMES_2:i>Math.PI?i-In.PI_TIMES_2:i},On.PI_TIMES_2.get=function(){return 2*Math.PI},On.PI_OVER_2.get=function(){return Math.PI/2},On.PI_OVER_4.get=function(){return Math.PI/4},On.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},On.CLOCKWISE.get=function(){return at.CLOCKWISE},On.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(In,On);var Rn=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new dn,this._seg1=new dn,this._offset0=new dn,this._offset1=new dn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new it,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===xn.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},Ln={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};Rn.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),r=n===at.CLOCKWISE&&this._side===Se.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Se.RIGHT;0===n?this.addCollinear(e):r?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},Rn.prototype.addLineEndCap=function(t,e){var n=new dn(t,e),r=new dn;this.computeOffsetSegment(n,Se.LEFT,this._distance,r);var i=new dn;this.computeOffsetSegment(n,Se.RIGHT,this._distance,i);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case xn.CAP_ROUND:this._segList.addPt(r.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(i.p1);break;case xn.CAP_FLAT:this._segList.addPt(r.p1),this._segList.addPt(i.p1);break;case xn.CAP_SQUARE:var u=new x;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var c=new x(r.p1.x+u.x,r.p1.y+u.y),l=new x(i.p1.x+u.x,i.p1.y+u.y);this._segList.addPt(c),this._segList.addPt(l)}},Rn.prototype.getCoordinates=function(){return this._segList.getCoordinates()},Rn.prototype.addMitreJoin=function(t,e,n,r){var i=!0,o=null;try{o=H.intersection(e.p0,e.p1,n.p0,n.p1),(r<=0?1:o.distance(t)/Math.abs(r))>this._bufParams.getMitreLimit()&&(i=!1)}catch(t){if(!(t instanceof V))throw t;o=new x(0,0),i=!1}i?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,r,this._bufParams.getMitreLimit())},Rn.prototype.addFilletCorner=function(t,e,n,r,i){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,c=n.y-t.y,l=Math.atan2(c,u);r===at.CLOCKWISE?a<=l&&(a+=2*Math.PI):a>=l&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,l,r,i),this._segList.addPt(n)},Rn.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*Rn.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===xn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===xn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},Rn.prototype.createSquare=function(t){this._segList.addPt(new x(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new x(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new x(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new x(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},Rn.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},Rn.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},Rn.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},Rn.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},Rn.prototype.addLimitedMitreJoin=function(t,e,n,r){var i=this._seg0.p1,o=In.angle(i,this._seg0.p0),s=In.angleBetweenOriented(this._seg0.p0,i,this._seg1.p1)/2,a=In.normalize(o+s),u=In.normalize(a+Math.PI),c=r*n,l=n-c*Math.abs(Math.sin(s)),h=i.x+c*Math.cos(u),A=i.y+c*Math.sin(u),f=new x(h,A),p=new dn(i,f),d=p.pointAlongOffset(1,l),g=p.pointAlongOffset(1,-l);this._side===Se.LEFT?(this._segList.addPt(d),this._segList.addPt(g)):(this._segList.addPt(g),this._segList.addPt(d))},Rn.prototype.computeOffsetSegment=function(t,e,n,r){var i=e===Se.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=i*n*o/a,c=i*n*s/a;r.p0.x=t.p0.x-c,r.p0.y=t.p0.y+u,r.p1.x=t.p1.x-c,r.p1.y=t.p1.y+u},Rn.prototype.addFilletArc=function(t,e,n,r,i){var o=r===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,c=0,l=new x;c<s;){var h=e+o*c;l.x=t.x+i*Math.cos(h),l.y=t.y+i*Math.sin(h),this._segList.addPt(l),c+=u}},Rn.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*Rn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new x((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var r=new x((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},Rn.prototype.createCircle=function(t){var e=new x(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},Rn.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},Rn.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Cn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*Rn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},Rn.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===xn.JOIN_BEVEL||this._bufParams.getJoinStyle()===xn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},Rn.prototype.closeRing=function(){this._segList.closeRing()},Rn.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},Rn.prototype.interfaces_=function(){return[]},Rn.prototype.getClass=function(){return Rn},Ln.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Ln.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Ln.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Ln.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(Rn,Ln);var Nn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Nn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,r=Math.abs(e),i=this.getSegGen(r);t.length<=1?this.computePointCurve(t[0],i):this.computeOffsetCurve(t,n,i);var o=i.getCoordinates();return n&&Pt.reverse(o),o},Nn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var i=Pn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{n.addSegments(t,!1);var a=Pn.simplify(t,r),u=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var c=2;c<=u;c++)n.addNextSegment(a[c],!0)}n.addLastSegment(),n.closeRing()},Nn.prototype.computeRingBufferCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);e===Se.RIGHT&&(r=-r);var i=Pn.simplify(t,r),o=i.length-1;n.initSideSegments(i[o-1],i[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(i[s],a)}n.closeRing()},Nn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),r=Pn.simplify(t,n),i=r.length-1;e.initSideSegments(r[0],r[1],Se.LEFT);for(var o=2;o<=i;o++)e.addNextSegment(r[o],!0);e.addLastSegment(),e.addLineEndCap(r[i-1],r[i]);var s=Pn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Se.LEFT);for(var u=a-2;u>=0;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Nn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case xn.CAP_ROUND:e.createCircle(t);break;case xn.CAP_SQUARE:e.createSquare(t)}},Nn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),r=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],r);else if(this._bufParams.isSingleSided()){var i=e<0;this.computeSingleSidedBufferCurve(t,i,r)}else this.computeLineBufferCurve(t,r);return r.getCoordinates()},Nn.prototype.getBufferParameters=function(){return this._bufParams},Nn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Nn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Nn.copyCoordinates(t);var r=this.getSegGen(n);return this.computeRingBufferCurve(t,e,r),r.getCoordinates()},Nn.prototype.computeOffsetCurve=function(t,e,n){var r=this.simplifyTolerance(this._distance);if(e){var i=Pn.simplify(t,-r),o=i.length-1;n.initSideSegments(i[o],i[o-1],Se.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(i[s],!0)}else{var a=Pn.simplify(t,r),u=a.length-1;n.initSideSegments(a[0],a[1],Se.LEFT),n.addFirstSegment();for(var c=2;c<=u;c++)n.addNextSegment(a[c],!0)}n.addLastSegment()},Nn.prototype.getSegGen=function(t){return new Rn(this._precisionModel,this._bufParams,t)},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn},Nn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new x(t[n]);return e};var Dn=function(){this._subgraphs=null,this._seg=new dn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Fn={DepthSegment:{configurable:!0}};Dn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Et,n=this._subgraphs.iterator();n.hasNext();){var r=n.next(),i=r.getEnvelope();t.y<i.getMinY()||t.y>i.getMaxY()||this.findStabbedSegments(t,r.getDirectedEdges(),e)}return e}if(3===arguments.length)if(I(arguments[2],wt)&&arguments[0]instanceof x&&arguments[1]instanceof Ge){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),c=0;c<u.length-1;c++)if(this._seg.p0=u[c],this._seg.p1=u[c+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var l=s.getDepth(Se.LEFT);this._seg.p0.equals(u[c])||(l=s.getDepth(Se.RIGHT));var h=new kn(this._seg,l);a.add(h)}}else if(I(arguments[2],wt)&&arguments[0]instanceof x&&I(arguments[1],wt))for(var A=arguments[0],f=arguments[2],p=arguments[1].iterator();p.hasNext();){var d=p.next();d.isForward()&&this.findStabbedSegments(A,d,f)}},Dn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:$e.min(e)._leftDepth},Dn.prototype.interfaces_=function(){return[]},Dn.prototype.getClass=function(){return Dn},Fn.DepthSegment.get=function(){return kn},Object.defineProperties(Dn,Fn);var kn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new dn(t),this._leftDepth=e};kn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},kn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},kn.prototype.toString=function(){return this._upwardSeg.toString()},kn.prototype.interfaces_=function(){return[b]},kn.prototype.getClass=function(){return kn};var Bn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};Bn.prototype.area=function(){return Bn.area(this.p0,this.p1,this.p2)},Bn.prototype.signedArea=function(){return Bn.signedArea(this.p0,this.p1,this.p2)},Bn.prototype.interpolateZ=function(t){if(null===t)throw new m("Supplied point is null.");return Bn.interpolateZ(t,this.p0,this.p1,this.p2)},Bn.prototype.longestSideLength=function(){return Bn.longestSideLength(this.p0,this.p1,this.p2)},Bn.prototype.isAcute=function(){return Bn.isAcute(this.p0,this.p1,this.p2)},Bn.prototype.circumcentre=function(){return Bn.circumcentre(this.p0,this.p1,this.p2)},Bn.prototype.area3D=function(){return Bn.area3D(this.p0,this.p1,this.p2)},Bn.prototype.centroid=function(){return Bn.centroid(this.p0,this.p1,this.p2)},Bn.prototype.inCentre=function(){return Bn.inCentre(this.p0,this.p1,this.p2)},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn},Bn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Bn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Bn.det=function(t,e,n,r){return t*r-e*n},Bn.interpolateZ=function(t,e,n,r){var i=e.x,o=e.y,s=n.x-i,a=r.x-i,u=n.y-o,c=r.y-o,l=s*c-a*u,h=t.x-i,A=t.y-o,f=(c*h-a*A)/l,p=(-u*h+s*A)/l;return e.z+f*(n.z-e.z)+p*(r.z-e.z)},Bn.longestSideLength=function(t,e,n){var r=t.distance(e),i=e.distance(n),o=n.distance(t),s=r;return i>s&&(s=i),o>s&&(s=o),s},Bn.isAcute=function(t,e,n){return!!In.isAcute(t,e,n)&&!!In.isAcute(e,n,t)&&!!In.isAcute(n,t,e)},Bn.circumcentre=function(t,e,n){var r=n.x,i=n.y,o=t.x-r,s=t.y-i,a=e.x-r,u=e.y-i,c=2*Bn.det(o,s,a,u),l=Bn.det(s,o*o+s*s,u,a*a+u*u),h=Bn.det(o,o*o+s*s,a,a*a+u*u);return new x(r-l/c,i+h/c)},Bn.perpendicularBisector=function(t,e){var n=e.x-t.x,r=e.y-t.y,i=new H(t.x+n/2,t.y+r/2,1),o=new H(t.x-r+n/2,t.y+n+r/2,1);return new H(i,o)},Bn.angleBisector=function(t,e,n){var r=e.distance(t),i=r/(r+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new x(t.x+i*o,t.y+i*s)},Bn.area3D=function(t,e,n){var r=e.x-t.x,i=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,c=i*u-o*a,l=o*s-r*u,h=r*a-i*s,A=c*c+l*l+h*h;return Math.sqrt(A)/2},Bn.centroid=function(t,e,n){var r=(t.x+e.x+n.x)/3,i=(t.y+e.y+n.y)/3;return new x(r,i)},Bn.inCentre=function(t,e,n){var r=e.distance(n),i=t.distance(n),o=t.distance(e),s=r+i+o,a=(r*t.x+i*e.x+o*n.x)/s,u=(r*t.y+i*e.y+o*n.y)/s;return new x(a,u)};var jn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Et;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};jn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},jn.prototype.addPolygon=function(t){var e=this._distance,n=Se.LEFT;this._distance<0&&(e=-this._distance,n=Se.RIGHT);var r=t.getExteriorRing(),i=Pt.removeRepeatedPoints(r.getCoordinates());if(this._distance<0&&this.isErodedCompletely(r,this._distance))return null;if(this._distance<=0&&i.length<3)return null;this.addPolygonRing(i,e,n,C.EXTERIOR,C.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Pt.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Se.opposite(n),C.INTERIOR,C.EXTERIOR)}},jn.prototype.isTriangleErodedCompletely=function(t,e){var n=new Bn(t[0],t[1],t[2]),r=n.inCentre();return at.distancePointLine(r,n.p0,n.p1)<Math.abs(e)},jn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Pt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,C.EXTERIOR,C.INTERIOR)},jn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var r=new pn(t,new Re(0,C.BOUNDARY,e,n));this._curveList.add(r)},jn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},jn.prototype.addPolygonRing=function(t,e,n,r,i){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=r,s=i;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=i,s=r,n=Se.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},jn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof $t?this.addPolygon(t):t instanceof Yt?this.addLineString(t):t instanceof Kt?this.addPoint(t):(t instanceof te||t instanceof Vt||t instanceof ne||t instanceof Gt)&&this.addCollection(t)},jn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var r=t.getEnvelopeInternal(),i=Math.min(r.getHeight(),r.getWidth());return e<0&&2*Math.abs(e)>i},jn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var Un=function(){};Un.prototype.locate=function(t){},Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un};var zn=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};zn.prototype.next=function(){if(this._atStart)return this._atStart=!1,zn.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new r;var t=this._parent.getGeometryN(this._index++);return t instanceof Gt?(this._subcollectionIterator=new zn(t),this._subcollectionIterator.next()):t},zn.prototype.remove=function(){throw new Error(this.getClass().getName())},zn.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},zn.prototype.interfaces_=function(){return[bt]},zn.prototype.getClass=function(){return zn},zn.isAtomic=function(t){return!(t instanceof Gt)};var Gn=function(){this._geom=null;var t=arguments[0];this._geom=t};Gn.prototype.locate=function(t){return Gn.locate(t,this._geom)},Gn.prototype.interfaces_=function(){return[Un]},Gn.prototype.getClass=function(){return Gn},Gn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},Gn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Gn.isPointInRing(t,n))return!1;for(var r=0;r<e.getNumInteriorRing();r++){var i=e.getInteriorRingN(r);if(Gn.isPointInRing(t,i))return!1}return!0},Gn.containsPoint=function(t,e){if(e instanceof $t)return Gn.containsPointInPolygon(t,e);if(e instanceof Gt)for(var n=new zn(e);n.hasNext();){var r=n.next();if(r!==e&&Gn.containsPoint(t,r))return!0}return!1},Gn.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:Gn.containsPoint(t,e)?C.INTERIOR:C.EXTERIOR};var Vn=function(){this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[C.NONE,C.NONE]};Vn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Vn.prototype.propagateSideLabels=function(t){for(var e=C.NONE,n=this.iterator();n.hasNext();){var r=n.next().getLabel();r.isArea(t)&&r.getLocation(t,Se.LEFT)!==C.NONE&&(e=r.getLocation(t,Se.LEFT))}if(e===C.NONE)return null;for(var i=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Se.ON)===C.NONE&&a.setLocation(t,Se.ON,i),a.isArea(t)){var u=a.getLocation(t,Se.LEFT),c=a.getLocation(t,Se.RIGHT);if(c!==C.NONE){if(c!==i)throw new Ce("side location conflict",s.getCoordinate());u===C.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),i=u}else et.isTrue(a.getLocation(t,Se.LEFT)===C.NONE,"found single null side"),a.setLocation(t,Se.RIGHT,i),a.setLocation(t,Se.LEFT,i)}}},Vn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Vn.prototype.print=function(t){Z.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Vn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Vn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,r=e.get(n).getLabel().getLocation(t,Se.LEFT);et.isTrue(r!==C.NONE,"Found unlabelled area edge");for(var i=r,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Se.LEFT),u=s.getLocation(t,Se.RIGHT);if(a===u)return!1;if(u!==i)return!1;i=a}return!0},Vn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Vn.prototype.iterator=function(){return this.getEdges().iterator()},Vn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Et(this._edgeMap.values())),this._edgeList},Vn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===C.NONE&&(this._ptInAreaLocation[t]=Gn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Vn.prototype.toString=function(){var t=new L;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Vn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Vn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var r=n.next().getLabel(),i=0;i<2;i++)r.isLine(i)&&r.getLocation(i)===C.BOUNDARY&&(e[i]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var c=C.NONE;if(e[u])c=C.EXTERIOR;else{var l=s.getCoordinate();c=this.getLocation(u,l,t)}a.setAllLocationsIfNull(u,c)}},Vn.prototype.getDegree=function(){return this._edgeMap.size()},Vn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn};var Zn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,r=0;r<this._resultAreaEdgeList.size();r++){var i=this._resultAreaEdgeList.get(r),o=i.getSym();if(i.getLabel().isArea())switch(null===t&&i.isInResult()&&(t=i),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!i.isInResult())continue;e.setNext(i),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Ce("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var r=t.get(e-1),i=n.getQuadrant(),o=r.getQuadrant();return je.isNorthern(i)&&je.isNorthern(o)?n:je.isNorthern(i)||je.isNorthern(o)?0!==n.getDy()?n:0!==r.getDy()?r:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):r},e.prototype.print=function(t){Z.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Et;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var r=this._edgeList.get(n),i=r.getSym();null===e&&(e=i),null!==t&&i.setNext(t),t=r}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Se.LEFT),r=t.getDepth(Se.RIGHT),i=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,i)!==r)throw new Ce("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var u=this._edgeList.get(a);u.setEdgeDepths(Se.RIGHT,s),s=u.getDepth(Se.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,r=this._SCANNING_FOR_INCOMING,i=this._resultAreaEdgeList.size()-1;i>=0;i--){var o=this._resultAreaEdgeList.get(i),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),r){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,r=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),r=this._SCANNING_FOR_INCOMING}}r===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],r=0,i=this.iterator();i.hasNext();)i.next().getEdgeRing()===n&&r++;return r}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=C.NONE,e=this.iterator();e.hasNext();){var n=e.next(),r=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=C.INTERIOR;break}if(r.isInResult()){t=C.EXTERIOR;break}}}if(t===C.NONE)return null;for(var i=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(i===C.INTERIOR):(s.isInResult()&&(i=C.EXTERIOR),a.isInResult()&&(i=C.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Re(C.NONE);for(var n=this.iterator();n.hasNext();)for(var r=n.next().getEdge().getLabel(),i=0;i<2;i++){var o=r.getLocation(i);o!==C.INTERIOR&&o!==C.BOUNDARY||this._label.setLocation(i,C.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Vn),Hn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new ke(t,new Zn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ve),qn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};qn.prototype.compareTo=function(t){var e=t;return qn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},qn.prototype.interfaces_=function(){return[b]},qn.prototype.getClass=function(){return qn},qn.orientation=function(t){return 1===Pt.increasingDirection(t)},qn.compareOriented=function(t,e,n,r){for(var i=e?1:-1,o=r?1:-1,s=e?t.length:-1,a=r?n.length:-1,u=e?0:t.length-1,c=r?0:n.length-1;;){var l=t[u].compareTo(n[c]);if(0!==l)return l;var h=(u+=i)===s,A=(c+=o)===a;if(h&&!A)return-1;if(!h&&A)return 1;if(h&&A)return 0}};var Wn=function(){this._edges=new Et,this._ocaMap=new h};Wn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var r=n.getCoordinates(),i=0;i<r.length;i++)i>0&&t.print(","),t.print(r[i].x+" "+r[i].y);t.println(")")}t.print(")  ")},Wn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Wn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Wn.prototype.iterator=function(){return this._edges.iterator()},Wn.prototype.getEdges=function(){return this._edges},Wn.prototype.get=function(t){return this._edges.get(t)},Wn.prototype.findEqualEdge=function(t){var e=new qn(t.getCoordinates());return this._ocaMap.get(e)},Wn.prototype.add=function(t){this._edges.add(t);var e=new qn(t.getCoordinates());this._ocaMap.put(e,t)},Wn.prototype.interfaces_=function(){return[]},Wn.prototype.getClass=function(){return Wn};var Xn=function(){};Xn.prototype.processIntersections=function(t,e,n,r){},Xn.prototype.isDone=function(){},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Yn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Yn.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(Yn.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.size()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},Yn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Yn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Yn.prototype.getLineIntersector=function(){return this._li},Yn.prototype.hasProperIntersection=function(){return this._hasProper},Yn.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Yn.prototype.hasIntersection=function(){return this._hasIntersection},Yn.prototype.isDone=function(){return!1},Yn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Yn.prototype.interfaces_=function(){return[Xn]},Yn.prototype.getClass=function(){return Yn},Yn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Qn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new x(t),this.segmentIndex=e,this.dist=n};Qn.prototype.getSegmentIndex=function(){return this.segmentIndex},Qn.prototype.getCoordinate=function(){return this.coord},Qn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Qn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Qn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Qn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Qn.prototype.getDistance=function(){return this.dist},Qn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Qn.prototype.interfaces_=function(){return[b]},Qn.prototype.getClass=function(){return Qn};var Kn=function(){this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t};Kn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Kn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Kn.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var r=e.next(),i=this.createSplitEdge(n,r);t.add(i),n=r}},Kn.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Kn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,r=this.edge.pts[e.segmentIndex],i=e.dist>0||!e.coord.equals2D(r);i||n--;var o=new Array(n).fill(null),s=0;o[s++]=new x(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return i&&(o[s]=e.coord),new nr(o,new Re(this.edge._label))},Kn.prototype.add=function(t,e,n){var r=new Qn(t,e,n),i=this._nodeMap.get(r);return null!==i?i:(this._nodeMap.put(r,r),r)},Kn.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Kn.prototype.interfaces_=function(){return[]},Kn.prototype.getClass=function(){return Kn};var Jn=function(){};Jn.prototype.getChainStartIndices=function(t){var e=0,n=new Et;n.add(new N(e));do{var r=this.findChainEnd(t,e);n.add(new N(r)),e=r}while(e<t.length-1);return Jn.toIntArray(n)},Jn.prototype.findChainEnd=function(t,e){for(var n=je.quadrant(t[e],t[e+1]),r=e+1;r<t.length&&je.quadrant(t[r-1],t[r])===n;)r++;return r-1},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn},Jn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var $n=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new q,this.env2=new q;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Jn;this.startIndex=e.getChainStartIndices(this.pts)};$n.prototype.getCoordinates=function(){return this.pts},$n.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},$n.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},$n.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],r)}else if(6===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],c=arguments[5],l=this.pts[i],h=this.pts[o],A=s.pts[a],f=s.pts[u];if(o-i==1&&u-a==1)return c.addIntersections(this.e,i,s.e,a),null;if(this.env1.init(l,h),this.env2.init(A,f),!this.env1.intersects(this.env2))return null;var p=Math.trunc((i+o)/2),d=Math.trunc((a+u)/2);i<p&&(a<d&&this.computeIntersectsForChain(i,p,s,a,d,c),d<u&&this.computeIntersectsForChain(i,p,s,d,u,c)),p<o&&(a<d&&this.computeIntersectsForChain(p,o,s,a,d,c),d<u&&this.computeIntersectsForChain(p,o,s,d,u,c))}},$n.prototype.getStartIndexes=function(){return this.startIndex},$n.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var r=0;r<t.startIndex.length-1;r++)this.computeIntersectsForChain(n,t,r,e)},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};var tr=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},er={NULL_VALUE:{configurable:!0}};tr.prototype.getDepth=function(t,e){return this._depth[t][e]},tr.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},tr.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==tr.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===tr.NULL_VALUE}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._depth[r][i]===tr.NULL_VALUE}},tr.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var r=0;this._depth[t][n]>e&&(r=1),this._depth[t][n]=r}}},tr.prototype.getDelta=function(t){return this._depth[t][Se.RIGHT]-this._depth[t][Se.LEFT]},tr.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?C.EXTERIOR:C.INTERIOR},tr.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},tr.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var r=t.getLocation(e,n);r!==C.EXTERIOR&&r!==C.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=tr.depthAtLocation(r):this._depth[e][n]+=tr.depthAtLocation(r))}else if(3===arguments.length){var i=arguments[0],o=arguments[1];arguments[2]===C.INTERIOR&&this._depth[i][o]++}},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},tr.depthAtLocation=function(t){return t===C.EXTERIOR?0:t===C.INTERIOR?1:tr.NULL_VALUE},er.NULL_VALUE.get=function(){return-1},Object.defineProperties(tr,er);var nr=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Kn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new tr,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Re.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var r=!0,i=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(r=!1),this.pts[s].equals2D(n.pts[--o])||(i=!1),!r&&!i)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new $n(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new q;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,r){var i=new x(t.getIntersection(r)),o=e,s=t.getEdgeDistance(n,r),a=o+1;if(a<this.pts.length){var u=this.pts[a];i.equals2D(u)&&(o=a,s=0)}this.eiList.add(i,o,s)},e.prototype.toString=function(){var t=new L;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++)this.addIntersection(t,e,n,r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Se.ON),e.getLocation(1,Se.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Se.LEFT),e.getLocation(1,Se.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Se.RIGHT),e.getLocation(1,Se.RIGHT),2))},e}(Fe),rr=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Wn,this._bufParams=t||null};rr.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},rr.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Re(t.getLabel())).flip(),n.merge(r);var i=rr.depthDelta(r),o=e.getDepthDelta()+i;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(rr.depthDelta(t.getLabel()))},rr.prototype.buildSubgraphs=function(t,e){for(var n=new Et,r=t.iterator();r.hasNext();){var i=r.next(),o=i.getRightmostCoordinate(),s=new Dn(n).getDepth(o);i.computeDepth(s),i.findResultEdges(),n.add(i),e.add(i.getDirectedEdges(),i.getNodes())}},rr.prototype.createSubgraphs=function(t){for(var e=new Et,n=t.getNodes().iterator();n.hasNext();){var r=n.next();if(!r.isVisited()){var i=new Ie;i.create(r),e.add(i)}}return $e.sort(e,$e.reverseOrder()),e},rr.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},rr.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new wn,n=new it;return n.setPrecisionModel(t),e.setSegmentIntersector(new Yn(n)),e},rr.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var r=new Nn(n,this._bufParams),i=new jn(t,e,r).getCurves();if(i.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(i,n),this._graph=new Ze(new Hn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new He(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},rr.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var r=n.getNodedSubstrings().iterator();r.hasNext();){var i=r.next(),o=i.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=i.getData(),a=new nr(i.getCoordinates(),new Re(s));this.insertUniqueEdge(a)}}},rr.prototype.setNoder=function(t){this._workingNoder=t},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.depthDelta=function(t){var e=t.getLocation(0,Se.LEFT),n=t.getLocation(0,Se.RIGHT);return e===C.INTERIOR&&n===C.EXTERIOR?1:e===C.EXTERIOR&&n===C.INTERIOR?-1:0},rr.convertSegStrings=function(t){for(var e=new ye,n=new Et;t.hasNext();){var r=t.next(),i=e.createLineString(r.getCoordinates());n.add(i)}return e.buildGeometry(n)};var ir=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=r,this._offsetX=i,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ir.prototype.rescale=function(){if(I(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],r=0;r<n.length;r++)n[r].x=n[r].x/this._scaleFactor+this._offsetX,n[r].y=n[r].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&Z.out.println(n)}},ir.prototype.scale=function(){if(I(arguments[0],vt)){for(var t=arguments[0],e=new Et,n=t.iterator();n.hasNext();){var r=n.next();e.add(new pn(this.scale(r.getCoordinates()),r.getData()))}return e}if(arguments[0]instanceof Array){for(var i=arguments[0],o=new Array(i.length).fill(null),s=0;s<i.length;s++)o[s]=new x(Math.round((i[s].x-this._offsetX)*this._scaleFactor),Math.round((i[s].y-this._offsetY)*this._scaleFactor),i[s].z);return Pt.removeRepeatedPoints(o)}},ir.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ir.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ir.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ir.prototype.interfaces_=function(){return[vn]},ir.prototype.getClass=function(){return ir};var or=function(){this._li=new it,this._segStrings=null;var t=arguments[0];this._segStrings=t},sr={fact:{configurable:!0}};or.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],r=arguments[1].iterator();r.hasNext();)for(var i=r.next().getCoordinates(),o=1;o<i.length-1;o++)if(i[o].equals(n))throw new $("found endpt/interior pt intersection at index "+o+" :pt "+n)},or.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var r=n.next();this.checkInteriorIntersections(e,r)}else if(2===arguments.length)for(var i=arguments[0],o=arguments[1],s=i.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var c=0;c<a.length-1;c++)this.checkInteriorIntersections(i,u,o,c);else if(4===arguments.length){var l=arguments[0],h=arguments[1],A=arguments[2],f=arguments[3];if(l===A&&h===f)return null;var p=l.getCoordinates()[h],d=l.getCoordinates()[h+1],g=A.getCoordinates()[f],y=A.getCoordinates()[f+1];if(this._li.computeIntersection(p,d,g,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,p,d)||this.hasInteriorIntersection(this._li,g,y)))throw new $("found non-noded intersection at "+p+"-"+d+" and "+g+"-"+y)}},or.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},or.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),r=0;r<n.length-2;r++)this.checkCollapse(n[r],n[r+1],n[r+2])},or.prototype.hasInteriorIntersection=function(t,e,n){for(var r=0;r<t.getIntersectionNum();r++){var i=t.getIntersection(r);if(!i.equals(e)&&!i.equals(n))return!0}return!1},or.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new $("found non-noded collapse at "+or.fact.createLineString([t,e,n]))},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},sr.fact.get=function(){return new ye},Object.defineProperties(or,sr);var ar=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new m("Scale factor must be non-zero");1!==e&&(this._pt=new x(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new x,this._p1Scaled=new x),this.initCorners(this._pt)},ur={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ar.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),r=Math.max(t.x,e.x),i=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>r||this._maxy<i||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ar.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new x(this._maxx,this._maxy),this._corner[1]=new x(this._minx,this._maxy),this._corner[2]=new x(this._minx,this._miny),this._corner[3]=new x(this._maxx,this._miny)},ar.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ar.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ar.prototype.getCoordinate=function(){return this._originalPt},ar.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ar.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ar.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new q(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ar.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ar.prototype.intersectsToleranceSquare=function(t,e){var n=!1,r=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&r||t.equals(this._pt)||e.equals(this._pt)))))},ar.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),r=t.getCoordinate(e+1);return!!this.intersects(n,r)&&(t.addIntersection(this.getCoordinate(),e),!0)},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar},ur.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ar,ur);var cr=function(){this.tempEnv1=new q,this.selectedSegment=new dn};cr.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr};var lr=function(){this._index=null;var t=arguments[0];this._index=t},hr={HotPixelSnapAction:{configurable:!0}};lr.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getSafeEnvelope(),o=new Ar(e,n,r);return this._index.query(i,{interfaces_:function(){return[Ye]},visitItem:function(t){t.select(i,o)}}),o.isNodeAdded()}},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr},hr.HotPixelSnapAction.get=function(){return Ar},Object.defineProperties(lr,hr);var Ar=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(cr),fr=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Et};fr.prototype.processIntersections=function(t,e,n,r){if(t===n&&e===r)return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];if(this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)}},fr.prototype.isDone=function(){return!1},fr.prototype.getInteriorIntersections=function(){return this._interiorIntersections},fr.prototype.interfaces_=function(){return[Xn]},fr.prototype.getClass=function(){return fr};var pr=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new it,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};pr.prototype.checkCorrectness=function(t){var e=pn.getNodedSubstrings(t),n=new or(e);try{n.checkValid()}catch(t){if(!(t instanceof G))throw t;t.printStackTrace()}},pr.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},pr.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},pr.prototype.findInteriorIntersections=function(t,e){var n=new fr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},pr.prototype.computeVertexSnaps=function(){if(I(arguments[0],vt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof pn)for(var n=arguments[0],r=n.getCoordinates(),i=0;i<r.length;i++){var o=new ar(r[i],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,i)&&n.addIntersection(r[i],i)}},pr.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new wn,this._pointSnapper=new lr(this._noder.getIndex()),this.snapRound(t,this._li)},pr.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=new ar(n,this._scaleFactor,this._li);this._pointSnapper.snap(r)}},pr.prototype.interfaces_=function(){return[vn]},pr.prototype.getClass=function(){return pr};var dr=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new xn,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},gr={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};dr.prototype.bufferFixedPrecision=function(t){var e=new ir(new pr(new fe(1)),t.getScale()),n=new rr(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},dr.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=dr.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Ce))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],r=dr.precisionScaleFactor(this._argGeom,this._distance,n),i=new fe(r);this.bufferFixedPrecision(i)}},dr.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===fe.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},dr.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},dr.prototype.bufferOriginalPrecision=function(){try{var t=new rr(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof $))throw t;this._saveException=t}},dr.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},dr.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},dr.prototype.interfaces_=function(){return[]},dr.prototype.getClass=function(){return dr},dr.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new dr(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof lt&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],r=new dr(arguments[0]);return r.setQuadrantSegments(n),r.getResultGeometry(e)}if(arguments[2]instanceof xn&&arguments[0]instanceof lt&&"number"==typeof arguments[1]){var i=arguments[1];return new dr(arguments[0],arguments[2]).getResultGeometry(i)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],u=new dr(arguments[0]);return u.setQuadrantSegments(s),u.setEndCapStyle(a),u.getResultGeometry(o)}},dr.precisionScaleFactor=function(t,e,n){var r=t.getEnvelopeInternal(),i=O.max(Math.abs(r.getMaxX()),Math.abs(r.getMaxY()),Math.abs(r.getMinX()),Math.abs(r.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(i)/Math.log(10)+1);return Math.pow(10,o)},gr.CAP_ROUND.get=function(){return xn.CAP_ROUND},gr.CAP_BUTT.get=function(){return xn.CAP_FLAT},gr.CAP_FLAT.get=function(){return xn.CAP_FLAT},gr.CAP_SQUARE.get=function(){return xn.CAP_SQUARE},gr.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(dr,gr);var yr=function(){this._pt=[new x,new x],this._distance=_.NaN,this._isNull=!0};yr.prototype.getCoordinates=function(){return this._pt},yr.prototype.getCoordinate=function(t){return this._pt[t]},yr.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},yr.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},yr.prototype.getDistance=function(){return this._distance},yr.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr};var mr=function(){};mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},mr.computeDistance=function(){if(arguments[2]instanceof yr&&arguments[0]instanceof Yt&&arguments[1]instanceof x)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),r=new dn,i=0;i<n.length-1;i++){r.setCoordinates(n[i],n[i+1]);var o=r.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof yr&&arguments[0]instanceof $t&&arguments[1]instanceof x){var s=arguments[0],a=arguments[1],u=arguments[2];mr.computeDistance(s.getExteriorRing(),a,u);for(var c=0;c<s.getNumInteriorRing();c++)mr.computeDistance(s.getInteriorRingN(c),a,u)}else if(arguments[2]instanceof yr&&arguments[0]instanceof lt&&arguments[1]instanceof x){var l=arguments[0],h=arguments[1],A=arguments[2];if(l instanceof Yt)mr.computeDistance(l,h,A);else if(l instanceof $t)mr.computeDistance(l,h,A);else if(l instanceof Gt)for(var f=l,p=0;p<f.getNumGeometries();p++){var d=f.getGeometryN(p);mr.computeDistance(d,h,A)}else A.setMinimum(l.getCoordinate(),h)}else if(arguments[2]instanceof yr&&arguments[0]instanceof dn&&arguments[1]instanceof x){var g=arguments[1],y=arguments[2],m=arguments[0].closestPoint(g);y.setMinimum(m,g)}};var _r=function(t){this._maxPtDist=new yr,this._inputGeom=t||null},vr={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_r.prototype.computeMaxMidpointDistance=function(t){var e=new wr(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.computeMaxVertexDistance=function(t){var e=new br(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_r.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},_r.prototype.getDistancePoints=function(){return this._maxPtDist},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r},vr.MaxPointDistanceFilter.get=function(){return br},vr.MaxMidpointDistanceFilter.get=function(){return wr},Object.defineProperties(_r,vr);var br=function(t){this._maxPtDist=new yr,this._minPtDist=new yr,this._geom=t||null};br.prototype.filter=function(t){this._minPtDist.initialize(),mr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},br.prototype.getMaxPointDistance=function(){return this._maxPtDist},br.prototype.interfaces_=function(){return[ft]},br.prototype.getClass=function(){return br};var wr=function(t){this._maxPtDist=new yr,this._minPtDist=new yr,this._geom=t||null};wr.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=new x((n.x+r.x)/2,(n.y+r.y)/2);this._minPtDist.initialize(),mr.computeDistance(this._geom,i,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wr.prototype.isDone=function(){return!1},wr.prototype.isGeometryChanged=function(){return!1},wr.prototype.getMaxPointDistance=function(){return this._maxPtDist},wr.prototype.interfaces_=function(){return[zt]},wr.prototype.getClass=function(){return wr};var Er=function(t){this._comps=t||null};Er.prototype.filter=function(t){t instanceof $t&&this._comps.add(t)},Er.prototype.interfaces_=function(){return[Ut]},Er.prototype.getClass=function(){return Er},Er.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Er.getPolygons(t,new Et)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof $t?n.add(e):e instanceof Gt&&e.apply(new Er(n)),n}};var xr=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};xr.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Yt&&this._lines.add(t)},xr.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},xr.prototype.interfaces_=function(){return[ct]},xr.prototype.getClass=function(){return xr},xr.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(xr.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(xr.getLines(e,n))}},xr.getLines=function(){if(1===arguments.length){var t=arguments[0];return xr.getLines(t,!1)}if(2===arguments.length){if(I(arguments[0],vt)&&I(arguments[1],vt)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var r=n.next();xr.getLines(r,e)}return e}if(arguments[0]instanceof lt&&"boolean"==typeof arguments[1]){var i=arguments[0],o=arguments[1],s=new Et;return i.apply(new xr(s,o)),s}if(arguments[0]instanceof lt&&I(arguments[1],vt)){var a=arguments[0],u=arguments[1];return a instanceof Yt?u.add(a):a.apply(new xr(u)),u}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&I(arguments[0],vt)&&I(arguments[1],vt)){for(var c=arguments[1],l=arguments[2],h=arguments[0].iterator();h.hasNext();){var A=h.next();xr.getLines(A,c,l)}return c}if("boolean"==typeof arguments[2]&&arguments[0]instanceof lt&&I(arguments[1],vt)){var f=arguments[1],p=arguments[2];return arguments[0].apply(new xr(f,p)),f}}};var Sr=function(){if(this._boundaryRule=pt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new m("Rule must be non-null");this._boundaryRule=t}};Sr.prototype.locateInternal=function(){if(arguments[0]instanceof x&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1];if(e.isEmpty())return C.EXTERIOR;var n=e.getExteriorRing(),r=this.locateInPolygonRing(t,n);if(r===C.EXTERIOR)return C.EXTERIOR;if(r===C.BOUNDARY)return C.BOUNDARY;for(var i=0;i<e.getNumInteriorRing();i++){var o=e.getInteriorRingN(i),s=this.locateInPolygonRing(t,o);if(s===C.INTERIOR)return C.EXTERIOR;if(s===C.BOUNDARY)return C.BOUNDARY}return C.INTERIOR}if(arguments[0]instanceof x&&arguments[1]instanceof Yt){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return C.EXTERIOR;var c=u.getCoordinates();return u.isClosed()||!a.equals(c[0])&&!a.equals(c[c.length-1])?at.isOnLine(a,c)?C.INTERIOR:C.EXTERIOR:C.BOUNDARY}if(arguments[0]instanceof x&&arguments[1]instanceof Kt){var l=arguments[0];return arguments[1].getCoordinate().equals2D(l)?C.INTERIOR:C.EXTERIOR}},Sr.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):C.EXTERIOR},Sr.prototype.intersects=function(t,e){return this.locate(t,e)!==C.EXTERIOR},Sr.prototype.updateLocationInfo=function(t){t===C.INTERIOR&&(this._isIn=!0),t===C.BOUNDARY&&this._numBoundaries++},Sr.prototype.computeLocation=function(t,e){if(e instanceof Kt&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Yt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof $t)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Vt)for(var n=e,r=0;r<n.getNumGeometries();r++){var i=n.getGeometryN(r);this.updateLocationInfo(this.locateInternal(t,i))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Gt)for(var u=new zn(e);u.hasNext();){var c=u.next();c!==e&&this.computeLocation(t,c)}},Sr.prototype.locate=function(t,e){return e.isEmpty()?C.EXTERIOR:e instanceof Yt||e instanceof $t?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?C.BOUNDARY:this._numBoundaries>0||this._isIn?C.INTERIOR:C.EXTERIOR)},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr};var Pr=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];this._component=e,this._segIndex=n,this._pt=r}},Tr={INSIDE_AREA:{configurable:!0}};Pr.prototype.isInsideArea=function(){return this._segIndex===Pr.INSIDE_AREA},Pr.prototype.getCoordinate=function(){return this._pt},Pr.prototype.getGeometryComponent=function(){return this._component},Pr.prototype.getSegmentIndex=function(){return this._segIndex},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Tr.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Pr,Tr);var Cr=function(t){this._pts=t||null};Cr.prototype.filter=function(t){t instanceof Kt&&this._pts.add(t)},Cr.prototype.interfaces_=function(){return[Ut]},Cr.prototype.getClass=function(){return Cr},Cr.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof Kt?$e.singletonList(t):Cr.getPoints(t,new Et)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Kt?n.add(e):e instanceof Gt&&e.apply(new Cr(n)),n}};var Mr=function(){this._locations=null;var t=arguments[0];this._locations=t};Mr.prototype.filter=function(t){(t instanceof Kt||t instanceof Yt||t instanceof $t)&&this._locations.add(new Pr(t,0,t.getCoordinate()))},Mr.prototype.interfaces_=function(){return[Ut]},Mr.prototype.getClass=function(){return Mr},Mr.getLocations=function(t){var e=new Et;return t.apply(new Mr(e)),e};var Ir=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Sr,this._minDistanceLocation=null,this._minDistance=_.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=r,this._terminateDistance=i}};Ir.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=1-e,i=Er.getPolygons(this._geom[e]);if(i.size()>0){var o=Mr.getLocations(this._geom[r]);if(this.computeContainmentDistance(o,i,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&I(arguments[0],wt)&&I(arguments[1],wt)){for(var s=arguments[0],a=arguments[1],u=arguments[2],c=0;c<s.size();c++)for(var l=s.get(c),h=0;h<a.size();h++)if(this.computeContainmentDistance(l,a.get(h),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Pr&&arguments[1]instanceof $t){var A=arguments[0],f=arguments[1],p=arguments[2],d=A.getCoordinate();if(C.EXTERIOR!==this._ptLocator.locate(d,f))return this._minDistance=0,p[0]=A,p[1]=new Pr(f,d),null}},Ir.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=xr.getLines(this._geom[0]),n=xr.getLines(this._geom[1]),r=Cr.getPoints(this._geom[0]),i=Cr.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,i,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,r,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(r,i,t),void this.updateMinDistance(t,!1))))},Ir.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Ir.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Ir.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Ir.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Yt&&arguments[1]instanceof Kt){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var r=t.getCoordinates(),i=e.getCoordinate(),o=0;o<r.length-1;o++){var s=at.distancePointLine(i,r[o],r[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new dn(r[o],r[o+1]).closestPoint(i);n[0]=new Pr(t,o,a),n[1]=new Pr(e,0,i)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Yt&&arguments[1]instanceof Yt){var u=arguments[0],c=arguments[1],l=arguments[2];if(u.getEnvelopeInternal().distance(c.getEnvelopeInternal())>this._minDistance)return null;for(var h=u.getCoordinates(),A=c.getCoordinates(),f=0;f<h.length-1;f++)for(var p=0;p<A.length-1;p++){var d=at.distanceLineLine(h[f],h[f+1],A[p],A[p+1]);if(d<this._minDistance){this._minDistance=d;var g=new dn(h[f],h[f+1]),y=new dn(A[p],A[p+1]),m=g.closestPoints(y);l[0]=new Pr(u,f,m[0]),l[1]=new Pr(c,p,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Ir.prototype.computeMinDistancePoints=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o),a=i.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Pr(i,0,i.getCoordinate()),n[1]=new Pr(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new m("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Ir.prototype.computeMinDistanceLines=function(t,e,n){for(var r=0;r<t.size();r++)for(var i=t.get(r),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(i,s,n),this._minDistance<=this._terminateDistance)return null}},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir},Ir.distance=function(t,e){return new Ir(t,e).distance()},Ir.isWithinDistance=function(t,e,n){return new Ir(t,e,n).distance()<=n},Ir.nearestPoints=function(t,e){return new Ir(t,e).nearestPoints()};var Or=function(){this._pt=[new x,new x],this._distance=_.NaN,this._isNull=!0};Or.prototype.getCoordinates=function(){return this._pt},Or.prototype.getCoordinate=function(t){return this._pt[t]},Or.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r<this._distance&&this.initialize(e,n,r)}},Or.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(r),this._distance=i,this._isNull=!1}},Or.prototype.toString=function(){return J.toLineString(this._pt[0],this._pt[1])},Or.prototype.getDistance=function(){return this._distance},Or.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var r=e.distance(n);r>this._distance&&this.initialize(e,n,r)}},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or};var Rr=function(){};Rr.prototype.interfaces_=function(){return[]},Rr.prototype.getClass=function(){return Rr},Rr.computeDistance=function(){if(arguments[2]instanceof Or&&arguments[0]instanceof Yt&&arguments[1]instanceof x)for(var t=arguments[0],e=arguments[1],n=arguments[2],r=new dn,i=t.getCoordinates(),o=0;o<i.length-1;o++){r.setCoordinates(i[o],i[o+1]);var s=r.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Or&&arguments[0]instanceof $t&&arguments[1]instanceof x){var a=arguments[0],u=arguments[1],c=arguments[2];Rr.computeDistance(a.getExteriorRing(),u,c);for(var l=0;l<a.getNumInteriorRing();l++)Rr.computeDistance(a.getInteriorRingN(l),u,c)}else if(arguments[2]instanceof Or&&arguments[0]instanceof lt&&arguments[1]instanceof x){var h=arguments[0],A=arguments[1],f=arguments[2];if(h instanceof Yt)Rr.computeDistance(h,A,f);else if(h instanceof $t)Rr.computeDistance(h,A,f);else if(h instanceof Gt)for(var p=h,d=0;d<p.getNumGeometries();d++){var g=p.getGeometryN(d);Rr.computeDistance(g,A,f)}else f.setMinimum(h.getCoordinate(),A)}else if(arguments[2]instanceof Or&&arguments[0]instanceof dn&&arguments[1]instanceof x){var y=arguments[1],m=arguments[2],_=arguments[0].closestPoint(y);m.setMinimum(_,y)}};var Lr=function(){this._g0=null,this._g1=null,this._ptDist=new Or,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Nr={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Lr.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Lr.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new m("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Lr.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Lr.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Lr.prototype.computeOrientedDistance=function(t,e,n){var r=new Dr(e);if(t.apply(r),n.setMaximum(r.getMaxPointDistance()),this._densifyFrac>0){var i=new Fr(e,this._densifyFrac);t.apply(i),n.setMaximum(i.getMaxPointDistance())}},Lr.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.distance=function(){if(2===arguments.length)return new Lr(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Lr(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},Nr.MaxPointDistanceFilter.get=function(){return Dr},Nr.MaxDensifiedByFractionDistanceFilter.get=function(){return Fr},Object.defineProperties(Lr,Nr);var Dr=function(){this._maxPtDist=new Or,this._minPtDist=new Or,this._euclideanDist=new Rr,this._geom=null;var t=arguments[0];this._geom=t};Dr.prototype.filter=function(t){this._minPtDist.initialize(),Rr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Dr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Dr.prototype.interfaces_=function(){return[ft]},Dr.prototype.getClass=function(){return Dr};var Fr=function(){this._maxPtDist=new Or,this._minPtDist=new Or,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Fr.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),r=t.getCoordinate(e),i=(r.x-n.x)/this._numSubSegs,o=(r.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*i,u=n.y+s*o,c=new x(a,u);this._minPtDist.initialize(),Rr.computeDistance(this._geom,c,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Fr.prototype.isDone=function(){return!1},Fr.prototype.isGeometryChanged=function(){return!1},Fr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Fr.prototype.interfaces_=function(){return[zt]},Fr.prototype.getClass=function(){return Fr};var kr=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},Br={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};kr.prototype.checkMaximumDistance=function(t,e,n){var r=new Lr(e,t);if(r.setDensifyFraction(.25),this._maxDistanceFound=r.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var i=r.getCoordinates();this._errorLocation=i[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+J.toLineString(i[0],i[1])+")"}},kr.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=kr.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),kr.VERBOSE&&Z.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},kr.prototype.checkNegativeValid=function(){if(!(this._input instanceof $t||this._input instanceof ne||this._input instanceof Gt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},kr.prototype.getErrorIndicator=function(){return this._errorIndicator},kr.prototype.checkMinimumDistance=function(t,e,n){var r=new Ir(t,e,n);if(this._minDistanceFound=r.distance(),this._minDistanceFound<n){this._isValid=!1;var i=r.nearestPoints();this._errorLocation=r.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(i),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+J.toLineString(i[0],i[1])+" )"}},kr.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},kr.prototype.getErrorLocation=function(){return this._errorLocation},kr.prototype.getPolygonLines=function(t){for(var e=new Et,n=new xr(e),r=Er.getPolygons(t).iterator();r.hasNext();)r.next().apply(n);return t.getFactory().buildGeometry(e)},kr.prototype.getErrorMessage=function(){return this._errMsg},kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr},Br.VERBOSE.get=function(){return!1},Br.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(kr,Br);var jr=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},Ur={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};jr.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},jr.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*jr.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new q(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new q(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},jr.prototype.checkDistance=function(){var t=new kr(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},jr.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},jr.prototype.checkPolygonal=function(){this._result instanceof $t||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},jr.prototype.getErrorIndicator=function(){return this._errorIndicator},jr.prototype.getErrorLocation=function(){return this._errorLocation},jr.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},jr.prototype.report=function(t){if(!jr.VERBOSE)return null;Z.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},jr.prototype.getErrorMessage=function(){return this._errorMsg},jr.prototype.interfaces_=function(){return[]},jr.prototype.getClass=function(){return jr},jr.isValidMsg=function(t,e,n){var r=new jr(t,e,n);return r.isValid()?null:r.getErrorMessage()},jr.isValid=function(t,e,n){return!!new jr(t,e,n).isValid()},Ur.VERBOSE.get=function(){return!1},Ur.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(jr,Ur);var zr=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};zr.prototype.getCoordinates=function(){return this._pts},zr.prototype.size=function(){return this._pts.length},zr.prototype.getCoordinate=function(t){return this._pts[t]},zr.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},zr.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:hn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},zr.prototype.setData=function(t){this._data=t},zr.prototype.getData=function(){return this._data},zr.prototype.toString=function(){return J.toLineString(new ue(this._pts))},zr.prototype.interfaces_=function(){return[An]},zr.prototype.getClass=function(){return zr};var Gr=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Et,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Gr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Gr.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Gr.prototype.getIntersectionSegments=function(){return this._intSegments},Gr.prototype.count=function(){return this._intersectionCount},Gr.prototype.getIntersections=function(){return this._intersections},Gr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Gr.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Gr.prototype.processIntersections=function(t,e,n,r){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===r)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,r))return null;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=i,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Gr.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Gr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Gr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Gr.prototype.interfaces_=function(){return[Xn]},Gr.prototype.getClass=function(){return Gr},Gr.createAllIntersectionsFinder=function(t){var e=new Gr(t);return e.setFindAllIntersections(!0),e},Gr.createAnyIntersectionFinder=function(t){return new Gr(t)},Gr.createIntersectionCounter=function(t){var e=new Gr(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Vr=function(){this._li=new it,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Vr.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Vr.prototype.getIntersections=function(){return this._segInt.getIntersections()},Vr.prototype.isValid=function(){return this.execute(),this._isValid},Vr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vr.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Gr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new wn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Vr.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Ce(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Vr.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+J.toLineString(t[0],t[1])+" and "+J.toLineString(t[2],t[3])},Vr.prototype.interfaces_=function(){return[]},Vr.prototype.getClass=function(){return Vr},Vr.computeIntersections=function(t){var e=new Vr(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var Zr=function t(){this._nv=null;var e=arguments[0];this._nv=new Vr(t.toSegmentStrings(e))};Zr.prototype.checkValid=function(){this._nv.checkValid()},Zr.prototype.interfaces_=function(){return[]},Zr.prototype.getClass=function(){return Zr},Zr.toSegmentStrings=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var r=n.next();e.add(new zr(r.getCoordinates(),r))}return e},Zr.checkValid=function(t){new Zr(t).checkValid()};var Hr=function(t){this._mapOp=t};Hr.prototype.map=function(t){for(var e=new Et,n=0;n<t.getNumGeometries();n++){var r=this._mapOp.map(t.getGeometryN(n));r.isEmpty()||e.add(r)}return t.getFactory().createGeometryCollection(ye.toGeometryArray(e))},Hr.prototype.interfaces_=function(){return[]},Hr.prototype.getClass=function(){return Hr},Hr.map=function(t,e){return new Hr(e).map(t)};var qr=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Et,this._resultLineList=new Et;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};qr.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},qr.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},qr.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},qr.prototype.collectLineEdge=function(t,e,n){var r=t.getLabel(),i=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Pi.isResultOfOp(r,e)||i.isCovered()||(n.add(i),t.setVisitedEdge(!0)))},qr.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getEdge();if(n.isLineEdge()&&!r.isCoveredSet()){var i=this._op.isCoveredByA(n.getCoordinate());r.setCovered(i)}}},qr.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),r=n.getLabel();n.isIsolated()&&(r.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},qr.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),r=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(r),n.setInResult(!0)}},qr.prototype.collectBoundaryTouchEdge=function(t,e,n){var r=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Pi.isResultOfOp(r,e)&&e===Pi.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr};var Wr=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Et;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Wr.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Wr.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Pi.INTERSECTION)){var r=n.getLabel();Pi.isResultOfOp(r,t)&&this.filterCoveredNodeToPoint(n)}}},Wr.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Wr.prototype.interfaces_=function(){return[]},Wr.prototype.getClass=function(){return Wr};var Xr=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Xr.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Xr.prototype.transformPolygon=function(t,e){var n=!0,r=this.transformLinearRing(t.getExteriorRing(),t);null!==r&&r instanceof ee&&!r.isEmpty()||(n=!1);for(var i=new Et,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),i.add(s))}if(n)return this._factory.createPolygon(r,i.toArray([]));var a=new Et;return null!==r&&a.add(r),a.addAll(i),this._factory.buildGeometry(a)},Xr.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Xr.prototype.getInputGeometry=function(){return this._inputGeom},Xr.prototype.transformMultiLineString=function(t,e){for(var n=new Et,r=0;r<t.getNumGeometries();r++){var i=this.transformLineString(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.transformCoordinates=function(t,e){return this.copy(t)},Xr.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Xr.prototype.transformMultiPoint=function(t,e){for(var n=new Et,r=0;r<t.getNumGeometries();r++){var i=this.transformPoint(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.transformMultiPolygon=function(t,e){for(var n=new Et,r=0;r<t.getNumGeometries();r++){var i=this.transformPolygon(t.getGeometryN(r),t);null!==i&&(i.isEmpty()||n.add(i))}return this._factory.buildGeometry(n)},Xr.prototype.copy=function(t){return t.copy()},Xr.prototype.transformGeometryCollection=function(t,e){for(var n=new Et,r=0;r<t.getNumGeometries();r++){var i=this.transform(t.getGeometryN(r));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||n.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(ye.toGeometryArray(n)):this._factory.buildGeometry(n)},Xr.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof Kt)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Yt)return this.transformLineString(t,null);if(t instanceof Vt)return this.transformMultiLineString(t,null);if(t instanceof $t)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Gt)return this.transformGeometryCollection(t,null);throw new m("Unknown Geometry subtype: "+t.getClass().getName())},Xr.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var r=n.size();return r>0&&r<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Xr.prototype.interfaces_=function(){return[]},Xr.prototype.getClass=function(){return Xr};var Yr=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new dn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Yt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],r=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=r}};Yr.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),r=0;r<n;r++){var i=t.get(r),o=this.findSnapForVertex(i,e);null!==o&&(t.set(r,new x(o)),0===r&&this._isClosed&&t.set(t.size()-1,new x(o)))}},Yr.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Yr.prototype.snapTo=function(t){var e=new St(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Yr.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var r=0;r<n;r++){var i=e[r],o=this.findSegmentIndexToSnap(i,t);o>=0&&t.add(o+1,new x(i),!1)}},Yr.prototype.findSegmentIndexToSnap=function(t,e){for(var n=_.MAX_VALUE,r=-1,i=0;i<e.size()-1;i++){if(this._seg.p0=e.get(i),this._seg.p1=e.get(i+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,r=i)}return r},Yr.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Yr.prototype.interfaces_=function(){return[]},Yr.prototype.getClass=function(){return Yr},Yr.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Qr=function(t){this._srcGeom=t||null},Kr={SNAP_PRECISION_FACTOR:{configurable:!0}};Qr.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Jr(e,n).transform(this._srcGeom)},Qr.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),r=new Jr(t,n,!0).transform(this._srcGeom),i=r;return e&&I(i,Jt)&&(i=r.buffer(0)),i},Qr.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Qr.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),r=0;r<n.length;r++)e.add(n[r]);return e.toArray(new Array(0).fill(null))},Qr.prototype.computeMinimumSegmentLength=function(t){for(var e=_.MAX_VALUE,n=0;n<t.length-1;n++){var r=t[n].distance(t[n+1]);r<e&&(e=r)}return e},Qr.prototype.interfaces_=function(){return[]},Qr.prototype.getClass=function(){return Qr},Qr.snap=function(t,e,n){var r=new Array(2).fill(null),i=new Qr(t);r[0]=i.snapTo(e,n);var o=new Qr(e);return r[1]=o.snapTo(r[0],n),r},Qr.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Qr.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===fe.FIXED){var r=1/n.getScale()*2/1.415;r>e&&(e=r)}return e}if(2===arguments.length){var i=arguments[0],o=arguments[1];return Math.min(Qr.computeOverlaySnapTolerance(i),Qr.computeOverlaySnapTolerance(o))}},Qr.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Qr.SNAP_PRECISION_FACTOR},Qr.snapToSelf=function(t,e,n){return new Qr(t).snapToSelf(e,n)},Kr.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Qr,Kr);var Jr=function(t){function e(e,n,r){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==r&&r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Yr(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),r=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(r)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Xr),$r=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};$r.prototype.getCommon=function(){return _.longBitsToDouble(this._commonBits)},$r.prototype.add=function(t){var e=_.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=$r.signExpBits(this._commonBits),this._isFirst=!1,null):$r.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=$r.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=$r.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},$r.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=_.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+_.toBinaryString(t),r=n.substring(n.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+e+" ]"}},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.getBit=function(t,e){return 0!=(t&1<<e)?1:0},$r.signExpBits=function(t){return t>>52},$r.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},$r.numCommonMostSigMantissaBits=function(t,e){for(var n=0,r=52;r>=0;r--){if($r.getBit(t,r)!==$r.getBit(e,r))return n;n++}return 52};var ti=function(){this._commonCoord=null,this._ccFilter=new ni},ei={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};ti.prototype.addCommonBits=function(t){var e=new ri(this._commonCoord);t.apply(e),t.geometryChanged()},ti.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new x(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ri(e);return t.apply(n),t.geometryChanged(),t},ti.prototype.getCommonCoordinate=function(){return this._commonCoord},ti.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ei.CommonCoordinateFilter.get=function(){return ni},ei.Translater.get=function(){return ri},Object.defineProperties(ti,ei);var ni=function(){this._commonBitsX=new $r,this._commonBitsY=new $r};ni.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},ni.prototype.getCommonCoordinate=function(){return new x(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},ni.prototype.interfaces_=function(){return[ft]},ni.prototype.getClass=function(){return ni};var ri=function(){this.trans=null;var t=arguments[0];this.trans=t};ri.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,r=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,r)},ri.prototype.isDone=function(){return!1},ri.prototype.isGeometryChanged=function(){return!0},ri.prototype.interfaces_=function(){return[zt]},ri.prototype.getClass=function(){return ri};var ii=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};ii.prototype.selfSnap=function(t){return new Qr(t).snapTo(t,this._snapTolerance)},ii.prototype.removeCommonBits=function(t){this._cbr=new ti,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},ii.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},ii.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Pi.overlayOp(e[0],e[1],t);return this.prepareResult(n)},ii.prototype.checkValid=function(t){t.isValid()||Z.out.println("Snapped geometry is invalid")},ii.prototype.computeSnapTolerance=function(){this._snapTolerance=Qr.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},ii.prototype.snap=function(t){var e=this.removeCommonBits(t);return Qr.snap(e[0],e[1],this._snapTolerance)},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.overlayOp=function(t,e,n){return new ii(t,e).getResultGeometry(n)},ii.union=function(t,e){return ii.overlayOp(t,e,Pi.UNION)},ii.intersection=function(t,e){return ii.overlayOp(t,e,Pi.INTERSECTION)},ii.symDifference=function(t,e){return ii.overlayOp(t,e,Pi.SYMDIFFERENCE)},ii.difference=function(t,e){return ii.overlayOp(t,e,Pi.DIFFERENCE)};var oi=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};oi.prototype.getResultGeometry=function(t){var e=null,n=!1,r=null;try{e=Pi.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof $))throw t;r=t}if(!n)try{e=ii.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof $?r:t}return e},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},oi.overlayOp=function(t,e,n){return new oi(t,e).getResultGeometry(n)},oi.union=function(t,e){return oi.overlayOp(t,e,Pi.UNION)},oi.intersection=function(t,e){return oi.overlayOp(t,e,Pi.INTERSECTION)},oi.symDifference=function(t,e){return oi.overlayOp(t,e,Pi.SYMDIFFERENCE)},oi.difference=function(t,e){return oi.overlayOp(t,e,Pi.DIFFERENCE)};var si=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};si.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},si.prototype.interfaces_=function(){return[]},si.prototype.getClass=function(){return si};var ai=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=i,this._obj=o}},ui={INSERT:{configurable:!0},DELETE:{configurable:!0}};ai.prototype.isDelete=function(){return this._eventType===ai.DELETE},ai.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ai.prototype.getObject=function(){return this._obj},ai.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ai.prototype.getInsertEvent=function(){return this._insertEvent},ai.prototype.isInsert=function(){return this._eventType===ai.INSERT},ai.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ai.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ai.prototype.interfaces_=function(){return[b]},ai.prototype.getClass=function(){return ai},ui.INSERT.get=function(){return 1},ui.DELETE.get=function(){return 2},Object.defineProperties(ai,ui);var ci=function(){};ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci};var li=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};li.prototype.isTrivialIntersection=function(t,e,n,r){if(t===n&&1===this._li.getIntersectionNum()){if(li.isAdjacentSegments(e,r))return!0;if(t.isClosed()){var i=t.getNumPoints()-1;if(0===e&&r===i||0===r&&e===i)return!0}}return!1},li.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},li.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},li.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},li.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next().getCoordinate();if(t.isIntersection(r))return!0}return!1},li.prototype.hasProperIntersection=function(){return this._hasProper},li.prototype.hasIntersection=function(){return this._hasIntersection},li.prototype.isDone=function(){return this._isDone},li.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},li.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},li.prototype.addIntersections=function(t,e,n,r){if(t===n&&e===r)return null;this.numTests++;var i=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[r],a=n.getCoordinates()[r+1];this._li.computeIntersection(i,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,r)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,r,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},li.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hi=function(t){function e(){t.call(this),this.events=new Et,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){$e.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof li&&I(arguments[0],wt)&&I(arguments[1],wt)){var r=arguments[0],i=arguments[1],o=arguments[2];this.addEdges(r,r),this.addEdges(i,i),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&I(arguments[0],wt)&&arguments[1]instanceof li){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),r=n.getStartIndexes(),i=0;i<r.length-1;i++){var o=new si(n,i),s=new ai(e,n.getMinX(i),o);this.events.add(s),this.events.add(new ai(n.getMaxX(i),s))}},e.prototype.processOverlaps=function(t,e,n,r){for(var i=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(i.computeIntersections(a,r),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],r=arguments[0].iterator();r.hasNext();){var i=r.next();this.addEdge(i,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ci),Ai=function(){this._min=_.POSITIVE_INFINITY,this._max=_.NEGATIVE_INFINITY},fi={NodeComparator:{configurable:!0}};Ai.prototype.getMin=function(){return this._min},Ai.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},Ai.prototype.getMax=function(){return this._max},Ai.prototype.toString=function(){return J.toLineString(new x(this._min,0),new x(this._max,0))},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai},fi.NodeComparator.get=function(){return pi},Object.defineProperties(Ai,fi);var pi=function(){};pi.prototype.compare=function(t,e){var n=t,r=e,i=(n._min+n._max)/2,o=(r._min+r._max)/2;return i<o?-1:i>o?1:0},pi.prototype.interfaces_=function(){return[E]},pi.prototype.getClass=function(){return pi};var di=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._min=e,this._max=n,this._item=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ai),gi=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ai),yi=function(){this._leaves=new Et,this._root=null,this._level=0};yi.prototype.buildTree=function(){$e.sort(this._leaves,new Ai.NodeComparator);for(var t=this._leaves,e=null,n=new Et;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},yi.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new di(t,e,n))},yi.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},yi.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},yi.prototype.printNode=function(t){Z.out.println(J.toLineString(new x(t._min,this._level),new x(t._max,this._level)))},yi.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},yi.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var r=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(r);else{var i=new gi(t.get(n),t.get(n+1));e.add(i)}}},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi};var mi=function(){this._items=new Et};mi.prototype.visitItem=function(t){this._items.add(t)},mi.prototype.getItems=function(){return this._items},mi.prototype.interfaces_=function(){return[Ye]},mi.prototype.getClass=function(){return mi};var _i=function(){this._index=null;var t=arguments[0];if(!I(t,Jt))throw new m("Argument must be Polygonal");this._index=new wi(t)},vi={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};_i.prototype.locate=function(t){var e=new st(t),n=new bi(e);return this._index.query(t.y,t.y,n),e.getLocation()},_i.prototype.interfaces_=function(){return[Un]},_i.prototype.getClass=function(){return _i},vi.SegmentVisitor.get=function(){return bi},vi.IntervalIndexedGeometry.get=function(){return wi},Object.defineProperties(_i,vi);var bi=function(){this._counter=null;var t=arguments[0];this._counter=t};bi.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},bi.prototype.interfaces_=function(){return[Ye]},bi.prototype.getClass=function(){return bi};var wi=function(){this._index=new yi;var t=arguments[0];this.init(t)};wi.prototype.init=function(t){for(var e=xr.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},wi.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new dn(t[e-1],t[e]),r=Math.min(n.p0.y,n.p1.y),i=Math.max(n.p0.y,n.p1.y);this._index.insert(r,i,n)}},wi.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new mi;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2];this._index.query(r,i,o)}},wi.prototype.interfaces_=function(){return[]},wi.prototype.getClass=function(){return wi};var Ei=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new Ae,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Sr,2===arguments.length){var e=arguments[0],n=arguments[1],r=pt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=r,null!==n&&this.add(n)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=i,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var r=this._nodes.addNode(n).getLabel(),i=1;r.getLocation(t,Se.ON)===C.BOUNDARY&&i++;var o=e.determineBoundary(this._boundaryNodeRule,i);r.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],r=arguments[2],i=new li(arguments[0],!0,!1);i.setIsDoneIfProperInt(r);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ee||this._parentGeom instanceof $t||this._parentGeom instanceof ne,a=n||!s;return o.computeIntersections(this._edges,i,a),this.addSelfIntersectionNodes(this._argIndex),i}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var r=new li(e,n,!0);return r.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,r),r},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Kt){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,C.INTERIOR)}else if(arguments[0]instanceof x){var e=arguments[0];this.insertPoint(this._argIndex,e,C.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),C.EXTERIOR,C.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,C.INTERIOR,C.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],C.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],C.BOUNDARY)},e.prototype.addLineString=function(t){var e=Pt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new nr(e,new Re(this._argIndex,C.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,r=t.iterator();r.hasNext();){var i=r.next();e[n++]=i.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===C.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var r=Pt.removeRepeatedPoints(t.getCoordinates());if(r.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=r[0],null;var i=e,o=n;at.isCCW(r)&&(i=n,o=e);var s=new nr(r,new Re(this._argIndex,C.BOUNDARY,i,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,r[0],C.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var r=this._nodes.addNode(e),i=r.getLabel();null===i?r._label=new Re(t,n):i.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hi},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),r=n.getLabel().getLocation(t),i=n.eiList.iterator();i.hasNext();){var o=i.next();this.addSelfIntersectionNode(t,o.coord,r)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof $t)this.addPolygon(e);else if(e instanceof Yt)this.addLineString(e);else if(e instanceof Kt)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Vt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Gt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return I(this._parentGeom,Jt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new _i(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?C.BOUNDARY:C.INTERIOR},e}(Ze),xi=function(){if(this._li=new it,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Ei(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],r=pt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ei(0,e,r),this._arg[1]=new Ei(1,n,r)}else if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];i.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ei(0,i,s),this._arg[1]=new Ei(1,o,s)}};xi.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},xi.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},xi.prototype.interfaces_=function(){return[]},xi.prototype.getClass=function(){return xi};var Si=function(){};Si.prototype.interfaces_=function(){return[]},Si.prototype.getClass=function(){return Si},Si.map=function(){if(arguments[0]instanceof lt&&I(arguments[1],Si.MapOp)){for(var t=arguments[0],e=arguments[1],n=new Et,r=0;r<t.getNumGeometries();r++){var i=e.map(t.getGeometryN(r));null!==i&&n.add(i)}return t.getFactory().buildGeometry(n)}if(I(arguments[0],vt)&&I(arguments[1],Si.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Et,u=o.iterator();u.hasNext();){var c=u.next(),l=s.map(c);null!==l&&a.add(l)}return a}},Si.MapOp=function(){};var Pi=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Sr,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Wn,this._resultPolyList=new Et,this._resultLineList=new Et,this._resultPointList=new Et,this._graph=new Ze(new Hn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),r=t.getLabel();e.isPointwiseEqual(t)||(r=new Re(t.getLabel())).flip();var i=e.getDepth();i.isNull()&&i.add(n),i.add(r),n.merge(r)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,r,i){var o=new Et;return o.addAll(t),o.addAll(n),o.addAll(r),o.isEmpty()?e.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var r=n.next();if(this._ptLocator.locate(t,r)!==C.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Et,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Et;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Zr.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new He(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var r=new qr(this,this._geomFact,this._ptLocator);this._resultLineList=r.build(t);var i=new Wr(this,this._geomFact,this._ptLocator);this._resultPointList=i.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var r=n.next(),i=r.getLabel();i.isArea()&&!r.isInteriorAreaEdge()&&e.isResultOfOp(i.getLocation(0,Se.RIGHT),i.getLocation(1,Se.RIGHT),t)&&r.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),r=e.getDepth();if(!r.isNull()){r.normalize();for(var i=0;i<2;i++)n.isNull(i)||!n.isArea()||r.isNull(i)||(0===r.getDelta(i)?n.toLine(i):(et.isTrue(!r.isNull(i,Se.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(i,Se.LEFT,r.getLocation(i,Se.LEFT)),et.isTrue(!r.isNull(i,Se.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(i,Se.RIGHT,r.getLocation(i,Se.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(xi);Pi.overlayOp=function(t,e,n){return new Pi(t,e).getResultGeometry(n)},Pi.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Pi.createEmptyResult(Pi.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Hr.map(t,{interfaces_:function(){return[Si.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Pi.INTERSECTION)},Pi.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pi.createEmptyResult(Pi.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Pi.SYMDIFFERENCE)},Pi.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case Pi.INTERSECTION:o=Math.min(r,i);break;case Pi.UNION:o=Math.max(r,i);break;case Pi.DIFFERENCE:o=r;break;case Pi.SYMDIFFERENCE:o=Math.max(r,i)}return o},Pi.createEmptyResult=function(t,e,n,r){var i=null;switch(Pi.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon()}return i},Pi.difference=function(t,e){return t.isEmpty()?Pi.createEmptyResult(Pi.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Pi.DIFFERENCE))},Pi.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Pi.isResultOfOp(n,r,e)}if(3===arguments.length){var i=arguments[0],o=arguments[1],s=arguments[2];switch(i===C.BOUNDARY&&(i=C.INTERIOR),o===C.BOUNDARY&&(o=C.INTERIOR),s){case Pi.INTERSECTION:return i===C.INTERIOR&&o===C.INTERIOR;case Pi.UNION:return i===C.INTERIOR||o===C.INTERIOR;case Pi.DIFFERENCE:return i===C.INTERIOR&&o!==C.INTERIOR;case Pi.SYMDIFFERENCE:return i===C.INTERIOR&&o!==C.INTERIOR||i!==C.INTERIOR&&o===C.INTERIOR}return!1}},Pi.INTERSECTION=1,Pi.UNION=2,Pi.DIFFERENCE=3,Pi.SYMDIFFERENCE=4;var Ti=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Sr,this._seg=new dn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Ti.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),r=0;r<n.size()-1;r++)if(n.getCoordinate(r,this._seg.p0),n.getCoordinate(r+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Ti.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?C.BOUNDARY:this._ptLocator.locate(t,this._g)},Ti.prototype.extractLinework=function(t){var e=new Ci;t.apply(e);var n=e.getLinework(),r=ye.toLineStringArray(n);return t.getFactory().createMultiLineString(r)},Ti.prototype.interfaces_=function(){return[]},Ti.prototype.getClass=function(){return Ti};var Ci=function(){this._linework=null,this._linework=new Et};Ci.prototype.getLinework=function(){return this._linework},Ci.prototype.filter=function(t){if(t instanceof $t){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Ci.prototype.interfaces_=function(){return[Ut]},Ci.prototype.getClass=function(){return Ci};var Mi=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Mi.prototype.extractPoints=function(t,e,n){for(var r=t.getCoordinates(),i=0;i<r.length-1;i++)this.computeOffsetPoints(r[i],r[i+1],e,n)},Mi.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Mi.prototype.getPoints=function(t){for(var e=new Et,n=xr.getLines(this._g).iterator();n.hasNext();){var r=n.next();this.extractPoints(r,t,e)}return e},Mi.prototype.computeOffsetPoints=function(t,e,n,r){var i=e.x-t.x,o=e.y-t.y,s=Math.sqrt(i*i+o*o),a=n*i/s,u=n*o/s,c=(e.x+t.x)/2,l=(e.y+t.y)/2;if(this._doLeft){var h=new x(c-u,l+a);r.add(h)}if(this._doRight){var A=new x(c+u,l-a);r.add(A)}},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};var Ii=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Et;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new Ti(this._geom[0],this._boundaryDistanceTolerance),new Ti(this._geom[1],this._boundaryDistanceTolerance),new Ti(this._geom[2],this._boundaryDistanceTolerance)]},Oi={TOLERANCE:{configurable:!0}};Ii.prototype.reportResult=function(t,e,n){Z.out.println("Overlay result invalid - A:"+C.toLocationSymbol(e[0])+" B:"+C.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+C.toLocationSymbol(e[2]))},Ii.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Ii.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var r=arguments[0],i=arguments[1];return this._location[0]=this._locFinder[0].getLocation(i),this._location[1]=this._locFinder[1].getLocation(i),this._location[2]=this._locFinder[2].getLocation(i),!!Ii.hasLocation(this._location,C.BOUNDARY)||this.isValidResult(r,this._location)}},Ii.prototype.addTestPts=function(t){var e=new Mi(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Ii.prototype.isValidResult=function(t,e){var n=Pi.isResultOfOp(e[0],e[1],t),r=!(n^e[2]===C.INTERIOR);return r||this.reportResult(t,e,n),r},Ii.prototype.getInvalidLocation=function(){return this._invalidLocation},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii},Ii.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Ii.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Qr.computeSizeBasedSnapTolerance(t),Qr.computeSizeBasedSnapTolerance(e))},Ii.isValid=function(t,e,n,r){return new Ii(t,e,r).isValid(n)},Oi.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Ii,Oi);var Ri=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Ri.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var r=t.getGeometryN(n);this._skipEmpty&&r.isEmpty()||e.add(r)}},Ri.prototype.combine=function(){for(var t=new Et,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri.combine=function(){if(1===arguments.length)return new Ri(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Ri(Ri.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],r=arguments[1],i=arguments[2];return new Ri(Ri.createList(n,r,i)).combine()}},Ri.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Ri.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Et;return n.add(t),n.add(e),n}if(3===arguments.length){var r=arguments[0],i=arguments[1],o=arguments[2],s=new Et;return s.add(r),s.add(i),s.add(o),s}};var Li=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Et)},Ni={STRTREE_NODE_CAPACITY:{configurable:!0}};Li.prototype.reduceToGeometries=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var r=n.next(),i=null;I(r,wt)?i=this.unionTree(r):r instanceof lt&&(i=r),e.add(i)}return e},Li.prototype.extractByEnvelope=function(t,e,n){for(var r=new Et,i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getEnvelopeInternal().intersects(t)?r.add(o):n.add(o)}return this._geomFactory.buildGeometry(r)},Li.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),r=e.getEnvelopeInternal();if(!n.intersects(r))return Ri.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var i=n.intersection(r);return this.unionUsingEnvelopeIntersection(t,e,i)},Li.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Li.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var r=t.itemsTree();return this.unionTree(r)},Li.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],r=arguments[2];if(r-n<=1){var i=Li.getGeometry(e,n);return this.unionSafe(i,null)}if(r-n==2)return this.unionSafe(Li.getGeometry(e,n),Li.getGeometry(e,n+1));var o=Math.trunc((r+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,r);return this.unionSafe(s,a)}},Li.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var r=n.next();e=null===e?r.copy():e.union(r)}return e},Li.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Li.prototype.unionActual=function(t,e){return Li.restrictToPolygons(t.union(e))},Li.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Li.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var r=new Et,i=this.extractByEnvelope(n,t,r),o=this.extractByEnvelope(n,e,r),s=this.unionActual(i,o);return r.add(s),Ri.combine(r)},Li.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.restrictToPolygons=function(t){if(I(t,Jt))return t;var e=Er.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(ye.toPolygonArray(e))},Li.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Li.union=function(t){return new Li(t).union()},Ni.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Li,Ni);var Di=function(){};Di.prototype.interfaces_=function(){return[]},Di.prototype.getClass=function(){return Di},Di.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Pi.createEmptyResult(Pi.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),oi.overlayOp(t,e,Pi.UNION)},t.GeoJSONReader=Ee,t.GeoJSONWriter=xe,t.OverlayOp=Pi,t.UnionOp=Di,t.BufferOp=dr,Object.defineProperty(t,"__esModule",{value:!0})}(e)},4235:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r.DW,WebMercatorViewport:()=>r.DW,addMetersToLngLat:()=>r.eG,altitudeToFovy:()=>r.Lu,fitBounds:()=>r.Xg,flyToViewport:()=>r.if,fovyToAltitude:()=>r.sj,getBounds:()=>r.zX,getDistanceScales:()=>r.ro,getFlyToDuration:()=>r.up,getMeterZoom:()=>r.Bf,getProjectionMatrix:()=>r.c7,getProjectionParameters:()=>r.wl,getViewMatrix:()=>r.lf,lngLatToWorld:()=>r.w5,normalizeViewportProps:()=>r.QA,pixelsToWorld:()=>r.CT,scaleToZoom:()=>r.sO,worldToLngLat:()=>r.es,worldToPixels:()=>r.aW,zoomToScale:()=>r.EO});var r=n(7013)},2540:()=>{},9125:()=>{},5307:()=>{},4942:(t,e,n)=>{"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:()=>r})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";var t=n(1431),e=n(743),r=n(4088),i=n(8569),o=n(3121),s=n(5555),a=n(9900),u=n(7359);function c(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var s=e[i][0],a=e[i][1],u=e[o][0],c=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+c*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(c-t[1])<=0)return!n;a>t[1]!=c>t[1]&&t[0]<(u-s)*(t[1]-a)/(c-a)+s&&(r=!r)}return r}function l(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function h(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function A(){}n(2044);var f=.7,p=1/f,d="\\s*([+-]?\\d+)\\s*",g="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",y="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",m=/^#([0-9a-f]{3,8})$/,_=new RegExp("^rgb\\("+[d,d,d]+"\\)$"),v=new RegExp("^rgb\\("+[y,y,y]+"\\)$"),b=new RegExp("^rgba\\("+[d,d,d,g]+"\\)$"),w=new RegExp("^rgba\\("+[y,y,y,g]+"\\)$"),E=new RegExp("^hsl\\("+[g,y,y]+"\\)$"),x=new RegExp("^hsla\\("+[g,y,y,g]+"\\)$"),S={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function P(){return this.rgb().formatHex()}function T(){return this.rgb().formatRgb()}function C(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=m.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?M(e):3===n?new R(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?I(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?I(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=_.exec(t))?new R(e[1],e[2],e[3],1):(e=v.exec(t))?new R(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=b.exec(t))?I(e[1],e[2],e[3],e[4]):(e=w.exec(t))?I(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=E.exec(t))?F(e[1],e[2]/100,e[3]/100,1):(e=x.exec(t))?F(e[1],e[2]/100,e[3]/100,e[4]):S.hasOwnProperty(t)?M(S[t]):"transparent"===t?new R(NaN,NaN,NaN,0):null}function M(t){return new R(t>>16&255,t>>8&255,255&t,1)}function I(t,e,n,r){return r<=0&&(t=e=n=NaN),new R(t,e,n,r)}function O(t){return t instanceof A||(t=C(t)),t?new R((t=t.rgb()).r,t.g,t.b,t.opacity):new R}function R(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function L(){return"#"+D(this.r)+D(this.g)+D(this.b)}function N(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function D(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function F(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new B(t,e,n,r)}function k(t){if(t instanceof B)return new B(t.h,t.s,t.l,t.opacity);if(t instanceof A||(t=C(t)),!t)return new B;if(t instanceof B)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new B(s,a,u,t.opacity)}function B(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function j(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}l(A,C,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:P,formatHex:P,formatHsl:function(){return k(this).formatHsl()},formatRgb:T,toString:T}),l(R,(function(t,e,n,r){return 1===arguments.length?O(t):new R(t,e,n,null==r?1:r)}),h(A,{brighter:function(t){return t=null==t?p:Math.pow(p,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:L,formatHex:L,formatRgb:N,toString:N})),l(B,(function(t,e,n,r){return 1===arguments.length?k(t):new B(t,e,n,null==r?1:r)}),h(A,{brighter:function(t){return t=null==t?p:Math.pow(p,t),new B(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?f:Math.pow(f,t),new B(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new R(j(t>=240?t-240:t+120,i,r),j(t,i,r),j(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));const U=function(){const t=[""];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),z={target:[0,0,0],minZoom:0,maxZoom:10,zoom:0},G=t=>{const e=C(t);return[e.r,e.g,e.b,255*e.opacity]},V=(t,e,n)=>{const r=document.createElement("div");return r.classList.add("picker-widget-ctrl"),n&&(r.style.cssText=n),r.innerHTML=t,e.appendChild(r),r},Z=(t,e,n)=>{var r;return function(){var i=this,o=arguments,s=function(){r=null,n||t.apply(i,o)},a=n&&!r;clearTimeout(r),r=setTimeout(s,e),a&&t.apply(i,o)}},H=(t,e,n,r,i)=>{var o=(e[1]-e[0])/(r[1]-r[0]),s=(n[1]-n[0])/(i[1]-i[0]);return t.map((t=>({...t,x:o*(t.x-r[0])+e[0],y:s*(t.y-i[0])+n[0]})))},q=(t,e,n,r,i)=>{var o=(e[1]-e[0])/(r[1]-r[0]),s=(n[1]-n[0])/(i[1]-i[0]);return t.map((t=>({...t,x1:o*(t.x1-r[0])+e[0],x2:o*(t.x2-r[0])+e[0],y1:s*(t.y1-i[0])+n[0],y2:s*(t.y2-i[0])+n[0]})))},W=t=>t.map((t=>({...t,contour:[[t.x1,t.y1],[t.x1,t.y2],[t.x2,t.y2],[t.x2,t.y1]]})));HTMLWidgets.widget({name:"picker",type:"output",factory:function(n,l,h){var A,f,p,d,g,y,m,_,v,b,w,E,x,S=10;const P=(t,e)=>{HTMLWidgets.shinyMode&&Shiny.onInputChange(n.id+e,t)},T=({isDragging:t})=>t?"grabbing":"default",C=()=>"cell";var M=(t,{index:e})=>k.colors[e],I=T,O=u.ViewMode;const R=(t=>{const e=document.createElement("div");return e.classList.add("picker-widget-ctrl-group","picker-widget-ctrl-top-right"),t.appendChild(e),e})(n),L=V('<button class="btn-picker"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path fill="none" d="M0 0h24v24H0V0z"/>\n    <path d="M21 3L3 10.53v.98l6.84 2.65L12.48 21h.98L21 3z"/>\n</svg>\n</button>',R),N=V('<button class="btn-picker"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24" height="24" viewBox="0 0 24 24">\n  <g transform="translate(0,3)">\n    <path\n      style="stroke-width:0.343565"\n      d="M 23.942314,4.6958443 C 23.446206,1.8868581 19.727461,0 14.687364,0 13.437819,0 12.150138,0.11543779 10.859708,0.34287772 4.1629423,1.5250844 -0.58168816,5.2884937 0.05768601,8.911385 c 0.25355086,1.439193 1.35605049,2.63583 3.04638949,3.461072 -0.2569865,0.387198 -0.4074679,0.826617 -0.4074679,1.29524 0,1.337498 1.1863293,2.457176 2.7639791,2.728248 l -1.3615475,2.333149 c -0.1576963,0.271073 -0.066308,0.61876 0.2047647,0.776457 0.090014,0.05291 0.1886171,0.07799 0.2858459,0.07799 0.1951448,0 0.3851362,-0.100665 0.4912977,-0.281723 l 1.6803757,-2.88148 C 8.41868,16.20561 9.6895264,15.063601 9.6998333,13.683844 c 6.872e-4,-0.0055 0.00137,-0.01065 0.00137,-0.01615 0,-0.02336 -0.00344,-0.04569 -0.00481,-0.06837 1.1292977,-0.0213 2.2847067,-0.130211 3.4435507,-0.334975 6.69711,-1.181863 11.44174,-4.9456164 10.802366,-8.5685077 z M 3.83312,13.667353 c 0,-0.30749 0.1281497,-0.59849 0.3470005,-0.848261 0.1219655,0.04295 0.2456489,0.08383 0.3717372,0.123339 l 1.2234344,2.352045 C 4.6865351,15.149835 3.83312,14.46408 3.83312,13.667353 Z M 7.0141869,15.216144 6.0223152,13.309702 5.4008064,12.114097 c 0.121622,-0.03161 0.2477103,-0.05634 0.3772342,-0.07387 0.1367388,-0.0189 0.2772568,-0.02886 0.420867,-0.02886 0.5067581,0 0.980534,0.11956 1.3701366,0.317454 0.5696305,0.289968 0.9554538,0.750345 0.9904974,1.262944 0.00137,0.02542 0.0055,0.05016 0.0055,0.07593 0,0.698124 -0.6562089,1.310356 -1.5508518,1.548447 z m 5.9185921,-3.126441 c -1.217251,0.214728 -2.429691,0.323982 -3.6060571,0.324669 -0.5765018,-0.911821 -1.7614569,-1.53917 -3.1278143,-1.53917 -0.4717146,0 -0.921441,0.07593 -1.332001,0.211292 -0.3061162,0.100665 -0.5878394,0.237403 -0.8427645,0.39991 C 2.4598914,10.828133 1.4360682,9.8579062 1.2319907,8.7035283 0.72660678,5.8381974 5.2307418,2.5475333 11.067221,1.5175259 c 1.222061,-0.2161023 2.439998,-0.3246688 3.620143,-0.3246688 4.371863,0 7.694479,1.5250844 8.080645,3.7101568 0.505041,2.8653309 -3.998751,6.1566821 -9.83523,7.1866891 z"\n      id="path10" />\n  </g>\n</svg>\n</button>',R),D=V('<button class="btn-picker"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 22 22">\n    <path d="m432.71 528.79l8.434 4.217-8.434 4.217-8.435-4.217 8.435-4.217m0 9.968l-6.083-3.042-2.351 1.176 8.435 4.217 8.434-4.217-2.351-1.176-6.083 3.042m0 3.681l-6.083-3.042-2.351 1.176 8.435 4.217 8.434-4.217-2.351-1.176-6.083 3.042" fill="#4d4d4d" transform="translate(-421.71-525.79)"/>\n</svg></button>',R);L.addEventListener("click",(()=>{L.firstElementChild.classList.add("active"),N.firstElementChild.classList.remove("active"),O=u.ViewMode,I=T,B()})),N.addEventListener("click",(()=>{N.firstElementChild.classList.add("active"),L.firstElementChild.classList.remove("active"),O=u.DrawPolygonByDraggingMode,I=C,B()})),D.addEventListener("click",(()=>{D.firstElementChild.classList.toggle("active"),k.showGrid=!k.showGrid,k.showGrid&&null!==v?(M=G(v),k.colors=v):(M=(t,{index:e})=>k.colors[e],k.colors=k.origColors),P(k.showGrid,"_show_grid"),B()})),L.firstElementChild.classList.add("active");var F={type:"FeatureCollection",features:[]};const k=new t.Z({initialViewState:z,parent:n,views:new e.Z({flipY:!1}),controller:!0,useDevicePixels:2,onViewStateChange:({viewState:t})=>{var{zoom:e,target:n}=t;return 0===e&&(n=[0,0]),t.target=n,P({zoom:e,target:n},"_view_state"),t}});k.grid=D,k.showGrid=!1;const B=()=>{const t=[new i.Z({id:"scatterplot",data:f,coordinateSystem:r.Df.CARTESIAN,getPosition:t=>[t.x,t.y],getFillColor:M,updateTriggers:{getFillColor:k.colors,getTooltip:m,getPosition:f},getPointRadius:1,pickable:!0,opacity:.8,stroked:!0,filled:!0,radiusScale:1,getLineColor:[51,51,51,100],radiusMinPixels:3,radiusMaxPixels:20,lineWidthMinPixels:1,lineWidthMaxPixels:0,...b}),new o.Z({id:"polygons",data:k.contours,coordinateSystem:r.Df.CARTESIAN,pickable:!1,stroked:!0,filled:!0,wireframe:!0,visible:k.showGrid,lineWidthMinPixels:1,lineWidthMaxPixels:0,getLineColor:[221,221,221,255],getLineWidth:1,getPolygon:t=>t.contour,getFillColor:t=>t.color,...x}),new a.nk({id:"nebula",data:F,selectedFeatureIndexes:[],mode:O,onEdit:({updatedData:t,editType:e})=>{if("addFeature"===e){const{coordinates:e}=t.features[0].geometry,n=function(t,e,n){void 0===n&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return function(t,e,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}({type:"Polygon",coordinates:t},e,n)}(e),r=f.reduce(((t,e,r)=>function(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r,i=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),o="Feature"===(r=e).type?r.geometry:r,s=o.type,a=e.bbox,u=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(i,a))return!1;"Polygon"===s&&(u=[u]);for(var l=!1,h=0;h<u.length&&!l;h++)if(c(i,u[h][0],n.ignoreBoundary)){for(var A=!1,f=1;f<u[h].length&&!A;)c(i,u[h][f],!n.ignoreBoundary)&&(A=!0),f++;A||(l=!0)}return l}([e.x,e.y],n)?t.concat(r):t),[]);P(r,"_selected_points")}},filled:!0,pointRadiusMinPixels:2,pointRadiusScale:2e3,extruded:!0,getElevation:1e3,getFillColor:[200,0,80,180],_subLayerProps:{guides:{pointRadiusMinPixels:2,pointRadiusMaxPixels:2}},pickable:!0,autoHighlight:!0,coordinateSystem:r.Df.CARTESIAN}),new s.Z({data:k.scaledLabelCoords,getPosition:t=>[t.x,t.y],getText:t=>t.label,getSize:18,background:!0,getBackgroundColor:[255,255,255,100],fontFamily:"Helvetica, Arial, sans-serif",getTextAnchor:"start",getAlignmentBaseline:"top",getColor:[51,51,51],characterSet:U,...w})];k.setProps({layers:t,getCursor:I,getTooltip:({index:t})=>t&&m[t],...E})};return HTMLWidgets.shinyMode&&Shiny.addCustomMessageHandler("proxythis",(function(t){const e=(n=t.id,HTMLWidgets.find("#"+n)).getDeck();var n;const{xTo:r,yTo:i,xFrom:o,yFrom:s}=e;if(null!==t.initialViewState&&e.setProps({initialViewState:{...z,...t.initialViewState}}),null!==t.colors&&(e.colors=t.colors.map((t=>G(t))),e.render()),null!==t.labelCoords&&(e.labelCoords=HTMLWidgets.dataframeToD3(t.labelCoords),e.scaledLabelCoords=H(e.labelCoords,r,i,o,s),e.render()),null!==t.polygons){t.polygons.color=t.polygons.color.map((t=>G(t))),e.polygons=HTMLWidgets.dataframeToD3(t.polygons);const n=q(e.polygons,r,i,o,s);e.contours=W(n),e.grid.style.display="block",e.render()}t.showGrid&&!e.showGrid&&e.grid.click()})),{renderValue:t=>{t.showControls||(N.style.display="none",L.style.display="none"),k.labelCoords=HTMLWidgets.dataframeToD3(t.labelCoords),A=HTMLWidgets.dataframeToD3(t.coords),p=k.xFrom=t.xrange,d=k.yFrom=t.yrange,g=k.xTo=[-l/2+S,l/2-S],y=k.yTo=[-h/2+S,h/2-S],f=H(A,g,y,p,d),k.scaledLabelCoords=H(k.labelCoords,g,y,p,d),v=t.pointColorPolygons,x=t.polygonLayerProps,null!==t.polygons?(t.polygons.color=t.polygons.color.map((t=>G(t))),k.polygons=HTMLWidgets.dataframeToD3(t.polygons),_=q(k.polygons,g,y,p,d),k.contours=W(_)):(k.showGrid&&k.grid.click(),k.grid.style.display="none"),k.colors=k.origColors=t.colors.map((t=>G(t))),k.render=B,m=t.labels,b=t.scatterPlotLayerProps,w=t.textLayerProps,E=t.deckProps,B()},resize:Z(((t,e)=>{g=k.xTo=[-t/2+S,t/2-S],y=k.yTo=[-e/2+S,e/2-S];const{xFrom:n,yFrom:r}=k;f=H(A,g,y,n,r),k.scaledLabelCoords=H(k.labelCoords,g,y,n,r),void 0!==k.polygons&&(_=q(k.polygons,g,y,n,r),k.contours=W(_)),B()}),50),getDeck:()=>k}}})})()})();